var t=Object.defineProperty,e=(e,i)=>{for(var s in i)t(e,s,{get:i[s],enumerable:!0})},i={};e(i,{error:()=>o,errorOnce:()=>h,log:()=>n,logGroup:()=>u,reset:()=>d,table:()=>r,warn:()=>a,warnOnce:()=>c});var s=new Set;function n(...t){console.log(...t)}function a(t,...e){console.warn(`AG Charts - ${t}`,...e)}function o(t,...e){"object"==typeof t?console.error("AG Charts error",t,...e):console.error(`AG Charts - ${t}`,...e)}function r(...t){console.table(...t)}function l(t,e,i){let n;n=t instanceof Error?t.message:"string"==typeof t?t:"object"==typeof t?JSON.stringify(t):String(t);const a=`${e}: ${n}`;s.has(a)||(i(t),s.add(a))}function c(t,...e){l(t,"Logger.warn",t=>a(t,...e))}function h(t,...e){l(t,"Logger.error",t=>o(t,...e))}function d(){s.clear()}function u(t,e){console.groupCollapsed(t);try{return e()}finally{console.groupEnd()}}var p={};e(p,{detectChartDefinition:()=>M,getAxisModule:()=>S,getPresetModule:()=>I,getSeriesModule:()=>D,hasModule:()=>b,listModulesByType:()=>v,register:()=>f,registerMany:()=>y,reset:()=>x});var g=(t=>(t.Axis="axis",t.Chart="chart",t.Preset="preset",t.Plugin="plugin",t.Series="series",t))(g||{}),m=new Map;function f(t,e){const{def:i,version:s}=m.get(t.name)??{};if(i)if(i.enterprise||!t.enterprise||e!==s){if(s!==e)throw new Error([`AG Charts - Module '${t.name}' already registered with different version:`,`${s} vs ${e}`,"","Check your package.json for conflicting dependencies - depending on your package manager","one of these commands may help:","- npm ls ag-charts-community","- yarn why ag-charts-community"].join("\n"));a([`AG Charts - Module '${t.name}' already registered,',\n                'ignoring (version: ${s}).`,"Check your code for duplicate loading of charts NPM modules."].join(" "))}else m.set(t.name,{def:t,version:e});else m.set(t.name,{def:t,version:e})}function y(t,e){for(const i of t)f(i,e)}function x(){m.clear()}function b(t){return m.has(t)}function*v(t){for(const e of m.values())k(t,e.def)&&(yield e.def)}function M(t){for(const e of m.values())if(k("chart",e.def)&&e.def.detect(t))return e.def;throw new Error("AG Charts - Unknown chart type; Check options are correctly structured and series types are specified")}function S(t){const e=m.get(t);if(k("axis",e?.def))return e?.def}function I(t){const e=m.get(t);if(k("preset",e?.def))return e?.def}function D(t){const e=m.get(t);if(k("series",e?.def))return e?.def}function k(t,e){return e?.type===t}var A=class{constructor(){this.events=new Map}on(t,e){return this.events.has(t)||this.events.set(t,new Set),this.events.get(t)?.add(e),()=>this.off(t,e)}off(t,e){const i=this.events.get(t);i&&(i.delete(e),0===i.size&&this.events.delete(t))}emit(t,e){const i=this.events.get(t);if(i)for(const t of i)t(e)}clear(t){t?this.events.delete(t):this.events.clear()}},w=class{constructor(t){if(this.maxCacheSize=t,this.store=new Map,t<=0)throw new Error("LRUCache size must be greater than 0")}get(t){if(!this.store.has(t))return;const e=this.store.get(t);return this.store.delete(t),this.store.set(t,e),e}has(t){return this.store.has(t)}set(t,e){return this.store.set(t,e),this.store.size>this.maxCacheSize&&this.store.delete(this.store.keys().next().value),e}clear(){this.store.clear()}};function C(t,e,i){return Math.min(i,Math.max(t,e))}function N(t,e,i=1e-10){return t===e||Math.abs(t-e)<i}function L(t){return-1===Math.sign(t)||Object.is(t,-0)}function T(t,e=2){const i=10**e;return Math.round(t*i)/i}function E(t){if(Math.floor(t)===t)return 0;let e=String(t),i=0;if(t<1e-6||t>=1e21){let t;[e,t]=e.split("e"),null!=t&&(i=Number(t))}const s=e.split(".")[1]?.length??0;return Math.max(s-i,0)}var O,R={};function P(t){return t?R.document?.[t]:R.document}function z(t){return t?R.window?.[t]:R.window}function j(t,e,i){const s=P().createElement(t);if("object"==typeof e&&(i=e,e=void 0),e)for(const t of e.split(" "))s.classList.add(t);return i&&Object.assign(s.style,i),s}function B(t){return P().createElementNS("http://www.w3.org/2000/svg",t)}function F(t,e,i,s){return t.addEventListener(e,i,s),()=>t.removeEventListener(e,i,s)}function V(t){return null!=t}function G(t){return Array.isArray(t)}function $(t){return t instanceof Date}function H(t){return $(t)&&!Number.isNaN(Number(t))}function U(t){return"function"==typeof t}function W(t){return"object"==typeof t&&null!==t&&!G(t)}function _(t){return G(t)||Y(t)}function Y(t){return"object"==typeof t&&null!==t&&"Object"===t.constructor?.name}function K(t){if("object"!=typeof t||null===t)return!1;for(const e in t)return!1;return!0}function Z(t){return"string"==typeof t}function X(t){return"number"==typeof t}function Q(t){return Number.isFinite(t)}function q(t){return"symbol"==typeof t}void 0!==globalThis.window&&(R.window=globalThis.window),"undefined"!=typeof document?R.document=document:void 0!==globalThis.global&&(R.document=globalThis.document);var J=/^(?:(.)?([<>=^]))?([+\-( ])?([$€£¥₣₹#])?(0)?(\d+)?(,)?(?:\.(\d+))?(~)?([%a-z])?$/i,tt=/^((?:[^#]|#[^{])*)#{([^}]+)}(.*)$/;function et(t){let e,s;const n=tt.exec(t);n&&([,e,t,s]=n);const a=J.exec(t);if(!a)return void i.warnOnce(`The number formatter is invalid: ${t}`);const[,o,r,l,c,h,d,u,p,g,m]=a;return{fill:o,align:r,sign:l,symbol:c,zero:h,width:Number.parseInt(d),comma:u,precision:Number.parseInt(p),trim:Boolean(g),type:m,prefix:e,suffix:s}}function it(t){const e="string"==typeof t?et(t):t;if(null==e)return;const{fill:i,align:s,sign:n="-",symbol:a,zero:o,width:r,comma:l,type:c,prefix:h="",suffix:d="",precision:u}=e;let{trim:p}=e;const g=null==u||Number.isNaN(u);let m;if(c)if(c in nt&&c in st)m=g?st[c]:nt[c];else if(c in nt)m=nt[c];else{if(!(c in st))throw new Error(`The number formatter type is invalid: ${c}`);m=st[c]}else m=nt.g,p=!0;const f=c?6:12;let y;return g||(y=u),(t,e)=>{let u=m(t,y??e??f);return p&&(u=function(t){if(!t.endsWith("0")||!t.includes("."))return t;let e=t.length-1;for(;e>0;){if("0"!=t[e]){if("."==t[e]){e-=1;break}break}e-=1}return t.substring(0,e+1)}(u)),l&&(u=function(t,e){let i=t.indexOf(".");i<0&&(i=t.length);const s=t.substring(0,i).split(""),n=t.substring(i);for(let t=s.length-3;t>0;t-=3)s.splice(t,0,e);return`${s.join("")}${n}`}(u,l)),u=function(t,e,i=""){if("("===i)return t>=0?e:`(${e})`;return`${t>=0?"+"===i?"+":"":lt}${e}`}(t,u,n),a&&"#"!==a&&(u=`${a}${u}`),"#"===a&&"x"===c&&(u=`0x${u}`),"s"===c&&(u=`${u}${function(t){return rt[ht(t)]}(t)}`),"%"!==c&&"p"!==c||(u=`${u}%`),null==r||Number.isNaN(r)||(u=function(t,e,i=" ",s=">"){let n=t;if(">"!==s&&s){if("<"===s)n=n.padEnd(e,i);else if("^"===s){const t=Math.max(0,e-n.length),s=Math.ceil(t/2),a=Math.floor(t/2);n=n.padStart(s+n.length,i),n=n.padEnd(a+n.length,i)}}else n=n.padStart(e,i);return n}(u,r,i??o,s)),u=`${h}${u}${d}`,u}}var st={b:t=>ct(t).toString(2),c:t=>String.fromCodePoint(t),d:t=>Math.round(Math.abs(t)).toFixed(0),o:t=>ct(t).toString(8),x:t=>ct(t).toString(16),X:t=>st.x(t).toUpperCase(),n:t=>st.d(t),"%":t=>`${ct(100*t).toFixed(0)}`},nt={e:(t,e)=>Math.abs(t).toExponential(e),E:(t,e)=>nt.e(t,e).toUpperCase(),f:(t,e)=>Math.abs(t).toFixed(e),F:(t,e)=>nt.f(t,e).toUpperCase(),g:(t,e)=>{if(0===t)return"0";const i=Math.abs(t),s=Math.floor(Math.log10(i));return s>=-4&&s<e?i.toFixed(e-1-s):i.toExponential(e-1)},G:(t,e)=>nt.g(t,e).toUpperCase(),n:(t,e)=>nt.g(t,e),p:(t,e)=>nt.r(100*t,e),r:(t,e)=>{if(0===t)return"0";const i=Math.abs(t),s=Math.floor(Math.log10(i))-(e-1);if(s<=0)return i.toFixed(-s);const n=10**s;return(Math.round(i/n)*n).toFixed()},s:(t,e)=>{const i=ht(t);return nt.r(t/10**i,e)},"%":(t,e)=>nt.f(100*t,e)},at=-24,ot=24,rt={[at]:"y",[-21]:"z",[-18]:"a",[-15]:"f",[-12]:"p",[-9]:"n",[-6]:"µ",[-3]:"m",0:"",3:"k",6:"M",9:"G",12:"T",15:"P",18:"E",21:"Z",[ot]:"Y"},lt="−";function ct(t){return Math.floor(Math.abs(t))}function ht(t){return C(at,t?3*Math.floor(Math.log10(Math.abs(t))/3):0,ot)}var dt={periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]};function ut(t,e=new Date(t.getFullYear(),0,1)){const i=t.getTimezoneOffset()-e.getTimezoneOffset(),s=t.getTime()-e.getTime()+6e4*i;return Math.floor(s/864e5)}function pt(t,e){const i=(e-new Date(t.getFullYear(),0,1).getDay()+7)%7,s=new Date(t.getFullYear(),0,i+1);return s<=t?Math.floor(ut(t,s)/7)+1:0}function gt(t,e=t.getFullYear()){const i=new Date(e,0,1).getDay(),s=new Date(e,0,(4-i+7)%7-3+1);return s<=t?Math.floor(ut(t,s)/7)+1:gt(t,e-1)}var mt={a:t=>dt.shortDays[t.getDay()],A:t=>dt.days[t.getDay()],b:t=>dt.shortMonths[t.getMonth()],B:t=>dt.months[t.getMonth()],c:"%x, %X",d:(t,e)=>yt(t.getDate(),2,e??"0"),e:"%_d",f:(t,e)=>yt(1e3*t.getMilliseconds(),6,e??"0"),H:(t,e)=>yt(t.getHours(),2,e??"0"),I:(t,e)=>{const i=t.getHours()%12;return 0===i?"12":yt(i,2,e??"0")},j:(t,e)=>yt(ut(t)+1,3,e??"0"),m:(t,e)=>yt(t.getMonth()+1,2,e??"0"),M:(t,e)=>yt(t.getMinutes(),2,e??"0"),L:(t,e)=>yt(t.getMilliseconds(),3,e??"0"),p:t=>t.getHours()<12?"AM":"PM",Q:t=>String(t.getTime()),s:t=>String(Math.floor(t.getTime()/1e3)),S:(t,e)=>yt(t.getSeconds(),2,e??"0"),u:t=>{let e=t.getDay();return e<1&&(e+=7),String(e%7)},U:(t,e)=>yt(pt(t,0),2,e??"0"),V:(t,e)=>yt(gt(t),2,e??"0"),w:(t,e)=>yt(t.getDay(),2,e??"0"),W:(t,e)=>yt(pt(t,1),2,e??"0"),x:"%-m/%-d/%Y",X:"%-I:%M:%S %p",y:(t,e)=>yt(t.getFullYear()%100,2,e??"0"),Y:(t,e)=>yt(t.getFullYear(),4,e??"0"),Z:t=>function(t){const e=t.getTimezoneOffset(),i=Math.abs(e);return`${e>0?"-":"+"}${yt(Math.floor(i/60),2,"0")}${yt(Math.floor(i%60),2,"0")}`}(t),"%":()=>"%"},ft={_:" ",0:"0","-":""};function yt(t,e,i){const s=String(Math.floor(t));return s.length>=e?s:`${i.repeat(e-s.length)}${s}`}function xt(t){const e=[];for(;t.length>0;){let i=t.indexOf("%");if(0!==i){const s=i>0?t.substring(0,i):t;e.push(s)}if(i<0)break;const s=t[i+1],n=ft[s];null!=n&&i++;const a=t[i+1],o=mt[a];if("function"==typeof o)e.push([o,n]);else if("string"==typeof o){const t=xt(o);e.push([t,n])}else e.push(`${n??""}${a}`);t=t.substring(i+2)}return t=>{const i="number"==typeof t?new Date(t):t;return e.map(t=>"string"==typeof t?t:t[0](i,t[1])).join("")}}function bt(t,e,i){const{leading:s=!0,trailing:n=!0}=i??{};let a,o,r=!1;function l(){n&&o?(a=setTimeout(l,e),t(...o)):r=!1,o=null}return Object.assign(function(...i){r?o=i:(r=!0,a=setTimeout(l,e),s?t(...i):o=i)},{cancel(){clearTimeout(a),r=!1,o=null}})}function vt(t,e,i=""){try{return t(...e)}catch(t){c("Uncaught exception in user callback"+(i?` \`${i}\``:""),t)}}function Mt(t,e="and",i=String,s=1/0){if(0===t.length)return"";if(1===t.length)return i(t[0]);const n=(t=t.map(i)).pop();if(t.length>=s){const i=t.length-(s-1);return`${t.slice(0,s-1).join(", ")}, and ${i} more ${e} ${n}`}return`${t.join(", ")} ${e} ${n}`}function St(t,e=1/0){if("number"==typeof t){if(Number.isNaN(t))return"NaN";if(t===1/0)return"Infinity";if(t===-1/0)return"-Infinity"}const i=JSON.stringify(t)??typeof t;return i.length>e?`${i.slice(0,e)}... (+${i.length-e} characters)`:i}function It(t,e){if(t===e)return 0;const[i,s]=t.length<e.length?[t,e]:[e,t],n=i.length,a=s.length;let o=new Array(n+1).fill(0).map((t,e)=>e),r=new Array(n+1);for(let t=1;t<=a;t++){r[0]=t;for(let e=1;e<=n;e++){const n=s[t-1]===i[e-1]?0:1;r[e]=Math.min(o[e]+1,r[e-1]+1,o[e-1]+n)}[o,r]=[r,o]}return o[n]}function Dt(t){return t.replaceAll(kt,(t,e)=>(e>0?"-":"")+t.toLowerCase())}var kt=/[A-Z]+(?![a-z])|[A-Z]/g;function At(t,e=""){return null==t?e:G(t)?t.map(t=>t.text).join(""):Z(t)?t:String(t)}var wt=Symbol("description"),Ct=Symbol("required"),Nt=Symbol("marked"),Lt=Symbol("undocumented"),Tt=Symbol("union"),Et=[["placement","position"],["padding","spacing","gap"],["color","fill","stroke"],["whisker","wick"],["nodeClick","seriesNodeClick"],["nodeDoubleClick","seriesNodeDoubleClick"],["src","url"]].reduce((t,e)=>{for(const i of e)t.set(i.toLowerCase(),new Set(e.filter(t=>t!==i)));return t},new Map),Ot=(t=>(t.Invalid="invalid",t.Required="required",t.Unknown="unknown",t))(Ot||{});function Rt(t,e){return Q(e)?`${t}[${e}]`:t?`${t}.${e}`:e}var Pt=class{constructor(t,e,i,s,n){this.type=t,this.description=e,this.value=i,this.path=s,this.key=n}setUnionType(t,e){if(this.path.startsWith(e)){const i=this.path.slice(e.length);this.altPath=`${e}[type=${t}]${i}`}}getPrefix(){const{altPath:t=this.path,key:e}=this;return t||e?`Option \`${e?Rt(t,e):t}\``:"Value"}toString(){const{description:t="unknown",type:e,value:i}=this;return"required"===e&&null==i?`${this.getPrefix()} is required and has not been provided; expecting ${t}, ignoring.`:`${this.getPrefix()} cannot be set to \`${St(i,50)}\`; expecting ${t}, ignoring.`}},zt=class extends Pt{constructor(t,e,i,s){super("unknown",void 0,e,i,s),this.suggestions=t,this.key=s}getPrefix(){return`Unknown option \`${Rt(this.altPath??this.path,this.key)}\``}getPostfix(){const t=Mt(function(t,e,i=2){const s=[],n=t.toLowerCase(),a=Et.get(n);for(const t of e){const e=t.toLowerCase();(a?.has(t)||e.includes(n)||It(n,e)<=i)&&s.push(t)}return s}(this.key,this.suggestions),"or",t=>`\`${t}\``);return t?`; Did you mean ${t}? Ignoring.`:", ignoring."}toString(){return`${this.getPrefix()}${this.getPostfix()}`}};function jt(t,e,i=""){if(!W(t))return{cleared:null,invalid:[new Pt("required","an object",t,i)]};const s={},n=[],a=new Set(Object.keys(t)),o=[];if(Tt in e){const a=Object.keys(e),o=e[Tt];if(null!=t.type&&a.includes(t.type)||null==t.type&&null!=o){const{type:a=o,...r}=t,l=jt(r,e[a],i);Object.assign(s,{type:a},l.cleared);for(const t of l.invalid)t.setUnionType(a,i);n.push(...l.invalid)}else{const e=Mt(a,"or",t=>`'${t}'`);n.push(new Pt("required",`a keyword such as ${e}`,t.type,i,"type"))}return{cleared:s,invalid:n}}for(const r of Object.keys(e)){const l=e[r],c=l[Ct],h=t[r];if(a.delete(r),void 0===h&&(l[Lt]||o.push(r),!c))continue;const d=Rt(i,r);if(U(l)){const e=l(h,{options:t,path:d});if("object"==typeof e){if(n.push(...e.invalid),e.valid){s[r]=e.cleared;continue}if(xe(e.invalid,d))continue}else if(e){s[r]=h;continue}n.push(new Pt(c?"required":"invalid",l[wt],h,i,r))}else{const t=jt(h,l,d);null!=t.cleared&&(s[r]=t.cleared),n.push(...t.invalid)}}for(const e of a){const s=t[e];void 0!==s&&n.push(new zt(o,s,i,e))}return{cleared:s,invalid:n}}function Bt(t,e){if(U(t)){let i=function(e,i){return t(e,i)};return i[wt]=e,i}return{...t,[wt]:e}}function Ft(t){return Object.assign(U(t)?(e,i)=>t(e,i):Ht(t),{[Ct]:!0,[wt]:t[wt]})}function Vt(t){return Object.assign(U(t)?(e,i)=>t(e,i):Ht(t),{[Lt]:!0,[wt]:t[wt]})}var Gt,$t,Ht=(t,e="an object",i=!1)=>Bt((e,s)=>{const n=jt(e,t,s.path),a=!xe(n.invalid,s.path);return{valid:a,cleared:a||!i?n.cleared:null,invalid:n.invalid}},e),Ut=(t,e,i)=>({...t,[wt]:e,[Tt]:i}),Wt=(...t)=>Bt((e,i)=>{const s=[];for(const n of t){const t=n(e,i);if("object"==typeof t){if(s.push(...t.invalid),!t.valid)return{valid:!1,cleared:e,invalid:s};e=t.cleared}else if(!t)return!1}return{valid:!0,cleared:e,invalid:s}},t.filter(t=>!t[Lt]).map(t=>t[wt]).filter(Boolean).join(" and ")),_t=(...t)=>Bt((e,i)=>{for(const s of t){const t=s(e,i);if("object"==typeof t?t.valid:t)return t}return!1},t.filter(t=>!t[Lt]).map(t=>t[wt]).filter(Boolean).join(" or ")),Yt=t=>Q(t)||H(t),Kt=Bt(G,"an array"),Zt=Bt(function(t){return"boolean"==typeof t},"a boolean"),Xt=Bt(U,"a function"),Qt=Bt(function(t){return Z(t)&&("none"===t||null!=function(t){if(null==O){const t=z("Option");O=(new t).style}O.color=t;const e=O.color||null;return O.color="",e}(t))},"a color string"),qt=Bt(t=>$(t)||(Q(t)||Z(t))&&H(new Date(t)),"a date"),Jt=Bt(V,"a defined value"),te=Bt(Q,"a number"),ee=Bt(W,"an object"),ie=Bt(Z,"a string"),se=Bt(t=>"undefined"==typeof HTMLElement||t instanceof HTMLElement,"an html element"),ne=(t,e=1/0)=>{let i;return i=e===1/0?`an array of at least ${t} items`:t===e?`an array of exactly ${t} items`:0===t?`an array of no more than ${e} items`:`an array of at least ${t} and no more than ${e} items`,Bt(i=>G(i)&&i.length>=t&&i.length<=e,i)},ae=(t,e=1/0)=>{let i;return i=e===1/0?`a string of at least ${t} characters`:t===e?`an string of exactly ${t} characters`:0===t?`an string of no more than ${e} characters`:`an string of at least ${t} and no more than ${e} characters`,Bt(i=>Z(i)&&i.length>=t&&i.length<=e,i)},oe=(t,e=!0)=>Bt(i=>Q(i)&&(i>t||e&&i===t),`a number greater than ${e?"or equal to ":""}${t}`),re=oe(0),le=oe(0,!1),ce=Bt(t=>Q(t)&&t>=Gt&&t<=$t,`a number between ${Gt=0} and ${$t=1} inclusive`),he=t=>Bt((e,{options:i})=>!Yt(e)||!Yt(i[t])||e<i[t],`the value to be less than \`${t}\``),de=t=>Bt((e,{options:i})=>!Yt(e)||!Yt(i[t])||e>i[t],`the value to be greater than \`${t}\``);function ue(...t){return W(t[0])&&(t=Object.values(t[0])),Bt(e=>t.includes(e),`a keyword such as ${Mt(t,"or",t=>`'${t}'`)}`)}var pe=t=>Bt(e=>t===e,`the value ${JSON.stringify(t)}`),ge=(t,e,i=!0)=>Bt((e,s)=>{if(!G(e))return!1;let n=i;const a=[],o=[],r=t=>n=i?n&&t:n||t;if(0===e.length)return{valid:!0,cleared:a,invalid:o};for(let i=0;i<e.length;i++){const l=e[i],c=t(l,{options:l,path:`${s.path}[${i}]`});"object"==typeof c?(n=r(c.valid),o.push(...c.invalid),null!=c.cleared&&a.push(c.cleared)):(n=r(c),c&&a.push(l))}return{valid:n,cleared:n||!i?a:null,invalid:o}},e??`${t[wt]} array`),me=(t,e="an object array")=>Bt((e,i)=>{if(!G(e))return!1;const s=[],n=[];for(let a=0;a<e.length;a++){const o=`${i.path}[${a}]`,r=jt(e[a],t,o);xe(r.invalid,o)||s.push(r.cleared),n.push(...r.invalid)}return{valid:!0,cleared:s,invalid:n}},e),fe=(t,e)=>Bt((i,s)=>!!U(i)&&(Nt in i||{valid:!0,cleared:Object.assign((...n)=>{const a=vt(i,n);if(null==a)return;const o=t(a,{options:a,path:""});if("object"==typeof o){for(const i of o.invalid)be(s,e??t[wt])(i);if(o.valid)return o.cleared}else{if(o)return a;c(`Callback \`${s.path}\` returned an invalid value \`${St(a,50)}\`; expecting ${e??t[wt]}, ignoring.`)}},{[Nt]:!0}),invalid:[]}),"a function"),ye=(t,e="an object")=>Bt((i,s)=>!!U(i)&&(Nt in i||{valid:!0,cleared:Object.assign((...n)=>{const a=vt(i,n,s.path);if(null==a)return;const o=jt(a,t);for(const t of o.invalid)be(s,e)(t);return o.cleared},{[Nt]:!0}),invalid:[]}),"a function");function xe(t,e){return t.some(t=>"required"===t.type&&t.path===e)}function be(t,e){return i=>{if(i instanceof zt)return c(`Callback \`${t.path}\` returned an unknown property \`${Rt(i.path,i.key)}\`${i.getPostfix()}`);const s=St(i.value,50);c(i.key?`Callback \`${t.path}\` returned an invalid property \`${Rt(i.path,i.key)}\`: \`${s}\`; expecting ${i.description}, ignoring.`:`Callback \`${t.path}\` returned an invalid value \`${s}\`; expecting ${e??i.description}, ignoring.`)}}var ve=t=>{if(!W(t))return!1;const e=Object.keys(t);return 1===e.length&&e[0].startsWith("$")},Me=Ht({color:Qt,stop:ce},""),Se=Bt(t=>{let e=-1/0;for(const i of t)if(null!=i?.stop){if(i.stop<e)return!1;e=i.stop}return!0},"color stops to be defined in ascending order"),Ie=Wt(ne(2),ge(Me),Se),De=ue("axis","item","series"),ke=Ht({type:Ft(pe("gradient")),colorStops:Ft(Ie),rotation:te,gradient:Vt(ue("linear","radial","conic")),bounds:Vt(De),reverse:Vt(Zt),colorSpace:Vt(ue("rgb","oklch"))},"a gradient object with color stops"),Ae={stroke:Qt,strokeWidth:re,strokeOpacity:ce},we=Ht({type:Ft(pe("gradient")),gradient:Ft(ue("linear","radial","conic")),bounds:Ft(De),colorStops:Ft(_t(Ie,Wt(ne(2),ge(Qt)))),rotation:Ft(te),reverse:Ft(Zt),colorSpace:Ft(ue("rgb","oklch"))}),Ce=Ht({type:Ft(pe("pattern")),pattern:Ft(ue("vertical-lines","horizontal-lines","forward-slanted-lines","backward-slanted-lines","circles","squares","triangles","diamonds","stars","hearts","crosses")),path:ae(2),width:Ft(re),height:Ft(re),fill:Ft(Qt),fillOpacity:Ft(ce),backgroundFill:Ft(Qt),backgroundFillOpacity:Ft(ce),padding:Ft(re),rotation:Ft(te),scale:Ft(re),stroke:Ft(Qt),strokeWidth:Ft(re),strokeOpacity:Ft(ce)}),Ne=Ht({type:Ft(pe("image")),url:ie,width:re,height:re,rotation:Ft(te),backgroundFill:Ft(Qt),backgroundFillOpacity:ce,fit:Ft(ue("stretch","contain","cover")),repeat:Ft(ue("repeat","repeat-x","repeat-y","no-repeat"))}),Le=Ut({gradient:{colorStops:Ie,rotation:te,gradient:Vt(ue("linear","radial","conic")),bounds:Vt(De),reverse:Vt(Zt),colorSpace:Vt(ue("rgb","oklch"))},pattern:{pattern:ue("vertical-lines","horizontal-lines","forward-slanted-lines","backward-slanted-lines","circles","squares","triangles","diamonds","stars","hearts","crosses"),path:ae(2),width:re,height:re,rotation:te,scale:re,fill:Qt,fillOpacity:ce,backgroundFill:Qt,backgroundFillOpacity:ce,...Ae,padding:Vt(re)},image:{url:Ft(ie),backgroundFill:Qt,backgroundFillOpacity:ce,width:re,height:re,fit:ue("stretch","contain","cover","none"),repeat:ue("repeat","repeat-x","repeat-y","no-repeat"),rotation:te}},"a color object"),Te=_t(Qt,Ht(Le,"a color object")),Ee={fill:Te,fillOpacity:ce};Ee.fillGradientDefaults=Vt(we),Ee.fillPatternDefaults=Vt(Ce),Ee.fillImageDefaults=Vt(Ne);var Oe={lineDash:ge(re),lineDashOffset:te},Re={...Ee,...Ae,...Oe,opacity:ce,cornerRadius:re},Pe={...Ae,...Oe,opacity:ce},ze={...Ee,...Ae,...Oe,opacity:ce};function je(t){return{enabled:Zt,range:ue("tooltip","node"),highlightedItem:t,unhighlightedItem:t}}function Be(t,e){return{enabled:Zt,range:ue("tooltip","node"),highlightedItem:t,unhighlightedItem:t,highlightedSeries:e,unhighlightedSeries:e,bringToFront:Zt}}var Fe={start:Jt,stop:Jt,...Ae,...Ee,...Oe},Ve={start:Jt,stop:Jt,...Ae,...Oe},Ge=Ht({enabled:Zt,key:Ft(ue("x","y")),segments:me(Fe,"path segments array")},"a segmentation object",!0),$e=Ht({enabled:Zt,key:Ft(ue("x","y")),segments:me(Ve,"path segments array")},"a segmentation object",!0),He=Ht({googleFont:ie},"google font"),Ue=_t(ie,ve,He,ge(_t(ie,He))),We={color:Qt,fontFamily:Ue,fontSize:re,fontStyle:ue("normal","italic","oblique"),fontWeight:_t(re,ue("normal","bold","bolder","lighter"))},_e=Ht({top:te,right:te,bottom:te,left:te},"padding object"),Ye=_t(te,_e),Ke={enabled:Zt,stroke:Qt,strokeWidth:re,strokeOpacity:ce},Ze={border:{...Ke},cornerRadius:te,padding:Ye,...Ee};function Xe(t,e,i,s=0,n=0){const a=Math.cos(i),o=Math.sin(i),r=t-s,l=e-n;return{x:s+r*a-l*o,y:n+r*o+l*a}}function Qe(t){return void 0===t?[]:Array.isArray(t)?t:[t]}function qe(t,e){return t.reduce((t,i)=>{const s=e(i);return t[s]??(t[s]=[]),t[s].push(i),t},{})}function Je(t,e){if(null==t||null==e||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(Array.isArray(t[i])&&Array.isArray(e[i])){if(!Je(t[i],e[i]))return!1}else if(t[i]!==e[i])return!1;return!0}function ti(t,e,i=0){if(0===t.length)return[];const s=[];for(let n=0;n<e;n++)s.push(t.at((n+i)%t.length));return s}function ei(t,e){let i=0;for(;i<t.length&&e(t[i]);)i+=1;const s=i;0!==s&&t.splice(0,s)}function ii(t,e){let i=t.length-1;for(;i>=0&&e(t[i]);)i-=1;const s=t.length-1-i;0!==s&&t.splice(t.length-s,s)}var si=class{constructor(){this.queue=[]}await(t=50){return new Promise(e=>{const i=()=>{clearTimeout(s),e(!0)},s=setTimeout(()=>{const t=this.queue.indexOf(i);t<0||(this.queue.splice(t,1),e(!1))},t);this.queue.push(i)})}notify(){for(const t of this.queue.splice(0))t()}};function ni(t=0){return new Promise(e=>{setTimeout(e,t)})}function*ai(...t){for(const e of t)null!=e&&(e[Symbol.iterator]?yield*e:yield e)}function oi(t){for(const e of t)return e;throw new Error("AG Charts - no first() value found")}function*ri(t){const e=[void 0,void 0];for(const i of Object.keys(t))e[0]=i,e[1]=t[i],yield e}function li(t){return"true"===t}function ci(t){return t}var hi={role:ci,"aria-checked":li,"aria-controls":ci,"aria-describedby":ci,"aria-disabled":li,"aria-expanded":li,"aria-haspopup":ci,"aria-hidden":li,"aria-label":ci,"aria-labelledby":ci,"aria-live":ci,"aria-orientation":ci,"aria-selected":li,"data-focus-override":li,"data-focus-visible-override":li,"data-preventdefault":li,class:ci,for:ci,id:ci,tabindex:function(t){return Number(t)},title:ci,placeholder:ci};function di(t,e,i){null==i||""===i||""===i?t?.removeAttribute(e):t?.setAttribute(e,i.toString())}function ui(t,e){if(null!=e)for(const[i,s]of ri(e))"class"!==i&&di(t,i,s)}function pi(t,e,i){if(!(t instanceof HTMLElement))return;const s=t.getAttribute(e);return null===s?i:hi[e]?.(s)??void 0}function gi(t,e,i){null!=t&&(null==i?t.style.removeProperty(e):t.style.setProperty(e,i.toString()))}function mi(t,e,i,s,n){return e<t.x+t.width&&e+s>t.x&&i<t.y+t.height&&i+n>t.y}function fi(t,e,i,s=0,n=0){return e>=t.x&&e+s<=t.x+t.width&&i>=t.y&&i+n<=t.y+t.height}function yi(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function xi(t,e,i){if(t>e)return;let s;for(;e>=t;){const n=Math.floor((e+t)/2);i(n)?(s=n,t=n+1):e=n-1}return s}function bi(t,e,i){if(t>e)return;let s;for(;e>=t;){const n=Math.floor((e+t)/2);i(n)?(s=n,e=n-1):t=n+1}return s}var vi=class{constructor(t){this.getter=t}get(){let t=this.result?.deref();return t||(t=this.getter(),this.result=new WeakRef(t),t)}clear(){this.result=void 0}},Mi=class{constructor(){this.callbacks=new Set}flush(){for(const t of this.callbacks)t();this.callbacks.clear()}merge(t){for(const e of t.callbacks)this.callbacks.add(e)}register(...t){for(const e of t)e&&this.callbacks.add(e)}};function Si(t){return Array.isArray(t)&&t.length>=2&&t.every(Q)}function Ii(t){return Array.isArray(t)&&t.length>=2&&t.every(Si)}function Di(t){const e=t[0],i=t.at(-1);return void 0!==i&&N(e[0],i[0],.001)&&N(e[1],i[1],.001)}function ki(t){return Array.isArray(t)&&t.every(Ii)&&t.every(Di)}function Ai(t){if(null===t)return!0;if(!W(t)||null==t.type)return!1;const{type:e,coordinates:i}=t;switch(e){case"GeometryCollection":return Array.isArray(t.geometries)&&t.geometries.every(Ai);case"MultiPolygon":return Array.isArray(i)&&i.every(ki);case"Polygon":return ki(i);case"MultiLineString":return Array.isArray(i)&&i.every(Ii);case"LineString":case"MultiPoint":return Ii(i);case"Point":return Si(i);default:return!1}}function wi(t){return W(t)&&"Feature"===t.type&&Ai(t.geometry)}var Ci=Bt(function(t){return W(t)&&"FeatureCollection"===t.type&&Array.isArray(t.features)&&t.features.every(wi)},"a GeoJSON object"),Ni=class{constructor(t,e,i){this._vertexCount=0,this._edgeCount=0,this.pendingProcessingEdgesFrom=[],this.pendingProcessingEdgesTo=[],this.cachedNeighboursEdge=t,this.processedEdge=e,this.singleValueEdges=i}clear(){this._vertexCount=0,this._edgeCount=0,this.pendingProcessingEdgesFrom=[],this.pendingProcessingEdgesTo=[],this.singleValueEdges?.clear()}getVertexCount(){return this._vertexCount}getEdgeCount(){return this._edgeCount}addVertex(t){const e=new Li(t);return this._vertexCount++,e}addEdge(t,e,i){i===this.cachedNeighboursEdge?t.updateCachedNeighbours().set(e.value,e):i===this.processedEdge&&(this.pendingProcessingEdgesFrom.push(t),this.pendingProcessingEdgesTo.push(e));const{edges:s}=t,n=s.get(i);n?n.includes(e)||(this.singleValueEdges?.has(i)?s.set(i,[e]):(n.push(e),this._edgeCount++)):(s.set(i,[e]),this._edgeCount++)}removeVertex(t){this._vertexCount--;const e=t.edges;if(e){for(const[,t]of e)this._vertexCount-=t.length;t.clear()}}removeEdge(t,e,i){const s=t.edges.get(i);if(!s)return;const n=s.indexOf(e);-1!==n&&(s.splice(n,1),0===s.length&&t.edges.delete(i),this._edgeCount--,i===this.cachedNeighboursEdge&&t.readCachedNeighbours()?.delete(e.value))}removeEdges(t,e){t.edges.delete(e)}getVertexValue(t){return t.value}*neighbours(t){for(const[,e]of t.edges)for(const t of e)yield t}*neighboursAndEdges(t){for(const[e,i]of t.edges)for(const t of i)yield[t,e]}neighboursWithEdgeValue(t,e){return t.edges.get(e)}findNeighbour(t,e){return t.edges.get(e)?.[0]}findNeighbourValue(t,e){const i=this.findNeighbour(t,e);if(i)return this.getVertexValue(i)}findNeighbourWithValue(t,e,i){const s=null==i?this.neighbours(t):this.neighboursWithEdgeValue(t,i);if(s)for(const t of s)if(this.getVertexValue(t)===e)return t}findVertexAlongEdge(t,e,i){if(i===this.cachedNeighboursEdge){let i;for(const s of e)if(i=(i??t).readCachedNeighbours()?.get(s),!i)return;return i}if(0===e.length)return;let s=t;for(const t of e){const e=s?this.neighboursWithEdgeValue(s,i):void 0;if(!e)return;s=e.find(e=>e.value===t)}return s}adjacent(t,e){for(const[,i]of t.edges)if(i.includes(e))return!0;return!1}},Li=class{constructor(t){this.value=t,this.edges=new Map}readCachedNeighbours(){return this._cachedNeighbours}updateCachedNeighbours(){return this._cachedNeighbours??(this._cachedNeighbours=new Map),this._cachedNeighbours}clear(){this.edges.clear(),this._cachedNeighbours?.clear()}},Ti=new Map,Ei=(Symbol("ElementID"),1);function Oi(t){const e=t.constructor,i=Object.hasOwn(e,"className")?e.className:e.name;if(!i)throw new Error(`The ${e} is missing the 'className' property.`);const s=(Ti.get(i)??0)+1;return Ti.set(i,s),`${i}-${s}`}function Ri(){return"ag-charts-"+Ei++}function Pi(){return crypto.randomUUID?.()??function(){const t=new Uint8Array(16);crypto.getRandomValues(t),t[6]=15&t[6]|64,t[8]=63&t[8]|128;let e="";for(let i=0;i<t.length;i++)4!==i&&6!==i&&8!==i&&10!==i||(e+="-"),e+=t[i].toString(16).padStart(2,"0");return e}()}function zi(t,e,i){let s=t,n=s;for(const t of e)if(null==s||i(s.value,t)>0)s={value:t,next:s},n=s;else{for(;null!=n.next&&i(n.next.value,t)<=0;)n=n.next;n.next={value:t,next:n.next}}return s}var ji="…",Bi=/\r?\n/g,Fi="​";function Vi({fontSize:t,fontStyle:e,fontWeight:i,fontFamily:s}){let n="";return e&&"normal"!==e&&(n+=`${e} `),i&&"normal"!==i&&400!==i&&(n+=`${i} `),n+=`${t}px`,n+=` ${s}`,n}function Gi(t,e=1.15){return Math.round(t*e)}var $i=/[\s.,;:-]{1,5}$/;function Hi(t){return t.replace($i,"")+ji}function Ui(t){return Fi+t+Fi}function Wi(t){return t.replaceAll(Fi,"")}function _i(t){return t.endsWith(ji)}function Yi(t){return t?.text.endsWith(ji)??!1}var Ki=class{constructor(t,e){this.ctx=t,this.measureTextCached=e,this.baselineMap=new Map,this.charMap=new Map,this.lineHeightCache=null}baselineDistance(t){if("alphabetic"===t)return 0;if(this.baselineMap.has(t))return this.baselineMap.get(t);this.ctx.textBaseline=t;const{alphabeticBaseline:e}=this.ctx.measureText("");return this.baselineMap.set(t,e),this.ctx.textBaseline="alphabetic",e}lineHeight(){return this.lineHeightCache??(this.lineHeightCache=this.measureText("").height),this.lineHeightCache}measureText(t){const e=this.measureTextCached?.(t)??this.ctx.measureText(t),{width:i,fontBoundingBoxAscent:s=e.emHeightAscent,fontBoundingBoxDescent:n=e.emHeightDescent}=e;return{width:i,height:s+n,ascent:s,descent:n}}measureLines(t){const e="string"==typeof t?t.split(Bi):t;let i=0,s=0;const n=e.map(t=>{const e=this.measureText(t);return i<e.width&&(i=e.width),s+=e.height,{text:t,...e}});return{width:i,height:s,lineMetrics:n}}textWidth(t,e){if(e){let e=0;for(let i=0;i<t.length;i++)e+=this.textWidth(t.charAt(i));return e}return t.length>1?this.ctx.measureText(t).width:this.charMap.get(t)??this.charWidth(t)}charWidth(t){const{width:e}=this.ctx.measureText(t);return this.charMap.set(t,e),e}},Zi=new w(50);function Xi(t){"object"==typeof t&&(t=Vi(t));let e=Zi.get(t);if(e)return e;const i=new w(1e4),s=function(t=0,e=0){return new OffscreenCanvas(t,e).getContext("2d")}();return s.font=t,e=new Ki(s,t=>{let e=i.get(t);return e||(e=s.measureText(t),i.set(t,e),e)}),Zi.set(t,e),e}function Qi(t,e){let i={segments:[],width:0,height:0,ascent:0,descent:0};const s=[i];for(const n of t){const{text:t,fontSize:a=e.fontSize,fontStyle:o=e.fontStyle,fontWeight:r=e.fontWeight,fontFamily:l=e.fontFamily,...c}=n,h={fontSize:a,fontStyle:o,fontWeight:r,fontFamily:l},d=Xi(h),u=t.split(Bi);for(let t=0;t<u.length;t++){const e=u[t],n=d.measureText(e);t>0&&(i={segments:[],width:0,height:0,ascent:0,descent:0},s.push(i)),e&&(i.width+=n.width,i.ascent=Math.max(i.ascent,n.ascent),i.descent=Math.max(i.descent,n.descent),i.height=Math.max(i.height,i.ascent+i.descent),i.segments.push({...h,...c,text:e,textMetrics:n}))}}let n=0,a=0;for(const t of s)n=Math.max(n,t.width),a+=t.height;return{width:n,height:a,lineMetrics:s}}function qi(t,e){return"hide"===e.overflow&&t.some(_i)}function Ji(t,e){return G(t)?ns(t,e):ts(t,e).join("\n")}function ts(t,e){return is(t,e)}function es(t,e,i,s){const n=e.textWidth(ji);let a=0,o=0;for(;o<t.length;o++){const s=e.textWidth(t.charAt(o));if(a+s>i)break;a+=s}if(t.length===o&&(!s||a+n<=i))return s?Hi(t):t;for(t=t.slice(0,o).trimEnd();t.length&&e.textWidth(t)+n>i;)t=t.slice(0,-1).trimEnd();return Hi(t)}function is(t,e,i=0){const s=t.split(Bi),n=Xi(e.font),a=[];if("never"===e.textWrap){for(const t of s){const s=es(t.trimEnd(),n,Math.max(0,e.maxWidth-i));if(!s)break;a.push(s),i=0}return qi(a,e)?[]:a}const o="hyphenate"===e.textWrap,r=null==e.textWrap||"on-space"===e.textWrap;for(const t of s){let s=t.trimEnd();if(""===s){a.push(s);continue}let l=0,c=0,h=0;for(a.length||(c=i);l<s.length;){const t=s.charAt(l);if(" "===t&&(h=l),c+=n.textWidth(t),c>e.maxWidth){if(0===l){s="";break}let t=n.textWidth(s.slice(0,l+1));if(a.length||(t+=i),t<=e.maxWidth){c=t,l++;continue}if(h){const t=ss(s,h+1),i=n.textWidth(t);if(i<=e.maxWidth){a.push(s.slice(0,h).trimEnd()),s=s.slice(h).trimStart(),l=0,c=0,h=0;continue}r&&i>e.maxWidth&&a.push(s.slice(0,h).trimEnd(),es(s.slice(h).trimStart(),n,e.maxWidth,!0))}else if(r){const t=es(s,n,e.maxWidth,!0);t&&a.push(t)}if(r){s="";break}const d=o?"-":"";let u=s.slice(0,l).trim();for(;u.length&&n.textWidth(u+d)>e.maxWidth;)u=u.slice(0,-1).trimEnd();if(!u||u===Fi){s="";break}a.push(u+d),s=s.slice(u.length).trimStart(),l=-1,c=0,h=0}l++}s&&a.push(s)}!function(t,e,i){if(!1===i.avoidOrphans||t.length<2)return;const{length:s}=t,n=t[s-1],a=t[s-2];if(a.length<n.length)return;const o=a.lastIndexOf(" ");if(-1===o||o===a.indexOf(" ")||n.includes(" "))return;const r=a.slice(o+1);e.textWidth(n+r)<=i.maxWidth&&(t[s-2]=a.slice(0,o),t[s-1]=r+" "+n)}(a,n,e);const l=function(t,e,i){if(!Q(i.maxHeight))return t;const{height:s,lineMetrics:n}=e.measureLines(t);if(s<=i.maxHeight)return t;for(let s=0,a=0;s<n.length;s++)if(a+=n[s].height,a>i.maxHeight){if("hide"===i.overflow||0===s)return[];const n=t.slice(0,s),a=n.pop();return n.concat(_i(a)?a:es(a,e,i.maxWidth,!0))}return t}(a,n,e);return qi(l,e)?[]:l}function ss(t,e){const i=t.indexOf(" ",e);return-1===i?t.slice(e):t.slice(e,i)}function ns(t,e){const{maxHeight:i=1/0}=e,s=[];let n=0,a=0;function o(){const t=s.pop();if(!t)return;const i=Xi(t),n=es(t.text,i,e.maxWidth,!0),a=i.measureText(n);s.push({...t,text:n,textMetrics:a})}for(const{width:r,height:l,segments:c}of Qi(t,e.font).lineMetrics){if(a+l>i){s.length&&o();break}if(n+r<=e.maxWidth)n+=r,a+=l,s.push(...c);else for(const t of c){if(n+t.textMetrics.width<=e.maxWidth){n+=t.textMetrics.width,s.push(t);continue}const r=Xi(t),l=Ui(t.text),c={...e,font:t,maxHeight:i-a};let h=is(l,{...c,overflow:"hide"},n);if(0===h.length)if("never"===e.textWrap)h=is(l,c,n);else{h=is(l,c);const t=s.at(-1);t&&(t.text+="\n",n=0)}if(0===h.length){o();break}const d=h.findIndex(_i);-1!==d&&(h=h.slice(0,d+1));const u=h.at(-1);for(const e of h){const i=Wi(e),o=r.measureText(i),l={...t,text:i,textMetrics:o};e===u?n+=o.width:(l.text+="\n",n=0),a+=o.height,s.push(l)}if(-1!==d)break}}return s}Xi.clear=()=>Zi.clear();var as=Object.defineProperty,os=Object.getOwnPropertyDescriptor,rs=(t,e)=>{for(var i in e)as(t,i,{get:e[i],enumerable:!0})},ls=(t,e,i,s)=>{for(var n,a=s>1?void 0:s?os(e,i):e,o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s?n(e,i,a):n(a))||a);return s&&a&&as(e,i,a),a},cs=class{constructor(){this.cleanup=new Mi}destroy(){this.cleanup.flush()}},hs=new class{constructor(){this.modules=[],this.dependencies=new Map,this.modulesByOptionKey=new Map}register(...t){for(const e of t){this.registerDependencies(e);const t=this.modules.find(t=>!(e.type!==t.type||"optionsKey"in e&&"optionsKey"in t&&e.optionsKey!==t.optionsKey||e.identifier!==t.identifier));if(t){if("enterprise"===e.packageType&&"community"===t.packageType){const i=this.modules.indexOf(t);this.modules.splice(i,1,e),"optionsKey"in e&&this.modulesByOptionKey.set(e.optionsKey,e)}}else this.modules.push(e),"optionsKey"in e&&this.modulesByOptionKey.set(e.optionsKey,e)}}hasEnterpriseModules(){return this.modules.some(t=>"enterprise"===t.packageType)}*byType(...t){const e=new Set,i=this.modules.filter(e=>t.includes(e.type)),s=t=>{const e=this.dependencies.get(t);return e?.flatMap(s).concat(e)??[]},n=[];for(const a of i){const i="optionsKey"in a?a.optionsKey:a.contextKey;if(!e.has(i)){for(const a of s(i)){if(e.has(a))continue;const i=this.modulesByOptionKey.get(a);i?t.includes(i.type)&&(yield i,e.add(a)):n.push(a)}yield a,e.add(i)}}if(n.length>0)throw new Error(`Could not resolve module dependencies: ${n}`)}registerDependencies(t){if(null==t.dependencies||0===t.dependencies.length)return;const e="optionsKey"in t?t.optionsKey:t.contextKey;this.dependencies.set(e,t.dependencies)}},ds=Symbol("interpolate"),us=t=>null!=t[ds];function ps(t,e,i,s=1/0){const n={nearest:void 0,distanceSquared:s};for(const s of i){const i=s.distanceSquared(t,e);if(0===i)return{nearest:s,distanceSquared:0};i<n.distanceSquared&&(n.nearest=s,n.distanceSquared=i)}return n}function gs(t,e,i,s=1/0){const{x:n=t,y:a=e}=i.transformPoint?.(t,e)??{},o={nearest:void 0,distanceSquared:s};for(const t of i.children){const{nearest:e,distanceSquared:i}=t.nearestSquared(n,a,o.distanceSquared);if(0===i)return{nearest:e,distanceSquared:i};i<o.distanceSquared&&(o.nearest=e,o.distanceSquared=i)}return o}var ms=class t{constructor(t,e,i,s){this.x=t,this.y=e,this.width=i,this.height=s}static fromObject({x:e,y:i,width:s,height:n}){return new t(e,i,s,n)}static merge(e){let i=1/0,s=1/0,n=-1/0,a=-1/0;for(const t of e)t.x<i&&(i=t.x),t.y<s&&(s=t.y),ys(t.x,t.width)>n&&(n=ys(t.x,t.width)),ys(t.y,t.height)>a&&(a=ys(t.y,t.height));return new t(i,s,n-i,a-s)}static nearestBox(t,e,i){return ps(t,e,i)}toDOMRect(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.y,left:this.x,right:ys(this.x,this.width),bottom:ys(this.y,this.height),toJSON:()=>({})}}clone(){const{x:e,y:i,width:s,height:n}=this;return new t(e,i,s,n)}equals(t){return yi(this,t)}containsPoint(t,e){return fi(this,t,e)}intersection(e){const i=Math.max(this.x,e.x),s=Math.max(this.y,e.y),n=Math.min(ys(this.x,this.width),ys(e.x,e.width)),a=Math.min(ys(this.y,this.height),ys(e.y,e.height));if(!(i>n||s>a))return new t(i,s,n-i,a-s)}collidesBBox(t){return this.x<ys(t.x,t.width)&&ys(this.x,this.width)>t.x&&this.y<ys(t.y,t.height)&&ys(this.y,this.height)>t.y}computeCenter(){return{x:this.x+this.width/2,y:this.y+this.height/2}}isFinite(){return Number.isFinite(this.x)&&Number.isFinite(this.y)&&Number.isFinite(this.width)&&Number.isFinite(this.height)}distanceSquared(t,e){if(this.containsPoint(t,e))return 0;const i=t-C(this.x,t,ys(this.x,this.width)),s=e-C(this.y,e,ys(this.y,this.height));return i*i+s*s}shrink(t,e){if("number"==typeof t)this.applyMargin(t,e);else for(const e of Object.keys(t)){const i=t[e];"number"==typeof i&&this.applyMargin(i,e)}return this.width<0&&(this.width=0),this.height<0&&(this.height=0),this}grow(t,e){if("number"==typeof t)this.applyMargin(-t,e);else for(const e of Object.keys(t)){const i=t[e];"number"==typeof i&&this.applyMargin(-i,e)}return this}applyMargin(t,e){switch(e){case"top":this.y+=t;case"bottom":this.height-=t;break;case"left":this.x+=t;case"right":this.width-=t;break;case"vertical":this.y+=t,this.height-=2*t;break;case"horizontal":this.x+=t,this.width-=2*t;break;case void 0:this.x+=t,this.y+=t,this.width-=2*t,this.height-=2*t}}translate(t,e){return this.x+=t,this.y+=e,this}[ds](e,i){return new t(this.x*(1-i)+e.x*i,this.y*(1-i)+e.y*i,this.width*(1-i)+e.width*i,this.height*(1-i)+e.height*i)}};ms.zero=Object.freeze(new ms(0,0,0,0)),ms.NaN=Object.freeze(new ms(Number.NaN,Number.NaN,Number.NaN,Number.NaN));var fs=ms;function ys(t,e){return t===-1/0&&e===1/0?1/0:t+e}var xs=Date.now(),bs={create:(...t)=>Object.assign((...e)=>{bs.check(...t)&&("function"==typeof e[0]&&(e=Qe(e[0]())),(()=>{const t=Date.now()-xs;if(t>2e3){const e=(Math.floor(t/100)/10).toFixed(1);i.log(`**** ${e}s since last log message ****`)}xs=Date.now()})(),i.log(...e))},{check:()=>bs.check(...t),group:(e,s)=>bs.check(...t)?i.logGroup(e,s):s()}),check:(...t)=>(0===t.length&&t.push(!0),Qe(z("agChartsDebug")).some(e=>t.includes(e))),inDevelopmentMode(t){if(bs.check("dev"))return t()}};function vs({context:t,pixelRatio:e,width:i,height:s}){t.save();try{t.resetTransform(),t.clearRect(0,0,Math.ceil(i*e),Math.ceil(s*e))}finally{t.restore()}}function Ms(t){if(bs.check("canvas")){const e=t.save.bind(t),i=t.restore.bind(t);let s=0;Object.assign(t,{save(){e(),s++},restore(){if(0===s)throw new Error("AG Charts - Unable to restore() past depth 0");i(),s--},verifyDepthZero(){if(0!==s)throw new Error(`AG Charts - Save/restore depth is non-zero: ${s}`)}})}}function Ss(t,e,i){return[Math.floor(t*i),Math.floor(e*i)]}var Is=class{constructor(t){const{width:e,height:i,pixelRatio:s,willReadFrequently:n=!1}=t;this.width=e,this.height=i,this.pixelRatio=s;const[a,o]=Ss(e,i,s);this.canvas=new OffscreenCanvas(a,o),this.context=this.canvas.getContext("2d",{willReadFrequently:n}),this.context.setTransform(s,0,0,s,0,0),Ms(this.context)}drawImage(t,e=0,i=0){return t.drawImage(this.canvas,e,i)}transferToImageBitmap(){return this.canvas.transferToImageBitmap()}resize(t,e,i){if(!(t>0&&e>0))return;const{canvas:s,context:n}=this;if(t!==this.width||e!==this.height||i!==this.pixelRatio){const[n,a]=Ss(t,e,i);s.width=n,s.height=a}n.setTransform(i,0,0,i,0,0),this.width=t,this.height=e,this.pixelRatio=i}clear(){vs(this)}destroy(){this.canvas.width=0,this.canvas.height=0,this.context.clearRect(0,0,0,0),this.canvas=null,this.context=null,Object.freeze(this)}},Ds=Symbol("BREAK"),ks="__decorator_config",As="__decorator_accessors";function ws(t,e){Cs(t,e).optional=!0}function Cs(t,e){if(null==Object.getOwnPropertyDescriptor(t,ks)&&Object.defineProperty(t,ks,{value:{}}),null==Object.getOwnPropertyDescriptor(t,As)){const e=Object.getPrototypeOf(t)?.[As],i=e?.slice()??[];Object.defineProperty(t,As,{value:i})}const i=t[ks],s=e.toString();if(null!=i[s])return i[s];i[s]={setters:[],getters:[],observers:[]};const n=Object.getOwnPropertyDescriptor(t,e);let a=n?.get,o=n?.set;if(null==a||null==o){const i=t[As];let s=i.indexOf(e);-1===s&&(s=i.push(e)-1),a??(a=function(){let t=this.__accessors;return null==t&&(t=i.slice().fill(void 0),Object.defineProperty(this,"__accessors",{value:t})),t[s]}),o??(o=function(t){let e=this.__accessors;null==e&&(e=i.slice().fill(void 0),Object.defineProperty(this,"__accessors",{value:e})),e[s]=t})}return Object.defineProperty(t,e,{set:function(t){const{setters:n,observers:r}=i[s];let l;n.some(t=>t.length>2)&&(l=a.call(this));for(const i of n)if((t=i(this,e,t,l))===Ds)return;o.call(this,t);for(const e of r)e(this,t,l)},get:function(){let t=a.call(this);for(const n of i[s].getters)if(t=n(this,e,t),t===Ds)return;return t},enumerable:!0,configurable:!1}),i[s]}function Ns(t,e,i){return(s,n)=>{const a=Cs(s,n);a.setters.push(t),e&&a.getters.unshift(e),i&&Object.assign(a,i)}}function Ls(t){return(e,i)=>{Cs(e,i).observers.push(t)}}function Ts(t){return void 0!==t&&ks in t}function Es(t){const e=new Set;for(;Ts(t);)e.add(t?.[ks]),t=Object.getPrototypeOf(t);return Array.from(e).flatMap(t=>Object.keys(t))}function Os(t){return Es(t).reduce((e,i)=>(e[String(i)]=t[i]??null,e),{})}function Rs(t,e){return Array.isArray(t)?!!Array.isArray(e)&&t.length===e.length&&t.every((t,i)=>Rs(t,e[i])):Y(t)?!!Y(e)&&Ps(t,e,Rs):t===e}function Ps(t,e,i){if(Object.is(t,e))return!0;for(const i of Object.keys(e))if(!(i in t))return!1;for(const s of Object.keys(t)){if(!(s in e))return!1;if(!i(t[s],e[s]))return!1}return!0}function zs(...t){const e={};for(const i of t){if(!W(i))continue;const t=Ts(i)?Es(i):Object.keys(i);for(const s of t)Y(e[s])&&Y(i[s])?e[s]=zs(e[s],i[s]):e[s]??(e[s]=i[s])}return e}function js(...t){const e={};for(const i of t){if(!W(i))continue;const t=Ts(i)?Es(i):Object.keys(i);for(const s of t)Y(e[s])&&Y(i[s])?e[s]=js(e[s],i[s]):s in e||(e[s]??(e[s]=i[s]))}return e}function Bs(t,...e){return e&&G(t)?t.map(t=>zs(t,...e)):t}function Fs(t,e){const i={};for(const[s,n]of ri(t))i[s]=e(n,s,t);return i}function Vs(t,e){const i={...t};for(const t of e)delete i[t];return i}function Gs(t,e){if(null==t)return;const i={};for(const s of e)Object.hasOwn(t,s)&&(i[s]=t[s]);return i}function $s(t,e){return(G(e)?e:e.split(".")).reduce((t,e)=>t[e],t)}var Hs=new Set(["__proto__","constructor","prototype"]);function Us(t,e,i){const s=G(e)?e.slice():e.split("."),n=s.pop();if(s.some(t=>Hs.has(t)))return;const a=s.reduce((t,e)=>t[e],t);return a[n]=i,a[n]}function Ws(t,e,i){if(void 0===i)return e;for(const s of t){const t=i[s];void 0!==t&&(e[s]=t)}return e}function _s(t){if(null==t||"object"!=typeof t||!Y(t))return t;Object.freeze(t);for(const e of Object.getOwnPropertyNames(t)){const i=t[e];null===i||"object"!=typeof i&&"function"!=typeof i||Object.isFrozen(i)||_s(i)}return t}function Ys(t,e){return Y(t)&&e in t}function Ks(t,e){return Ys(t,e)&&"string"==typeof t[e]}var Zs=(t,e)=>t===e;function Xs(t){return function(e,i){const s=`__${i}`;e[i]||function(t,e,i,s){const{changeCb:n,convertor:a,checkDirtyOnAssignment:o=!1}=s??{},r={changeCb:n,checkDirtyOnAssignment:o,convertor:a},l=function(t,e,i){const{checkDirtyOnAssignment:s}=i;return s?function(i){const s=e.call(this,i);return!0===i?._dirty&&this.markDirty(t),s}:e}(i,function(t,e){const{changeCb:i}=e;return i?function(e){const s=t.call(this,e);return s!==tn&&i.call(this,this),s}:t}(function(t,e){const{convertor:i}=e;return i?function(e){t.call(this,i(e))}:t}(function(t,e){const{equals:i=Zs}=e;return function(e){const s=this[t];return i(e,s)?tn:(this[t]=e,this.onChangeDetection(t),e)}}(i,r),r),r),r);Object.defineProperty(t,e,{set:l,get:function(){return this[i]},enumerable:!0,configurable:!0})}(e,i,s,t)}}function Qs(t){return Xs(t)}function qs(t){return Xs(t)}function Js(t){return(t??{}).equals=Je,Xs(t)}var tn=Symbol("no-change"),en=(t,e)=>Math.sign(t-e);function sn(t,e){if("number"==typeof t&&"number"==typeof e)return en(t,e);const i="number"==typeof t?[t]:t,s="number"==typeof e?[e]:e,n=Math.min(i.length,s.length);for(let t=0;t<n;t+=1){const e=en(i[t],s[t]);if(0!==e)return e}return en(i.length,s.length)}var nn=(t=>(t[t.All=0]="All",t[t.None=1]="None",t))(nn||{}),an=class t{constructor(e){this.serialNumber=t._nextSerialNumber++,this.childNodeCounts={groups:0,nonGroups:0,thisComplexity:0,complexity:0},this.id=Oi(this),this.name=void 0,this.transitionOut=void 0,this.pointerEvents=0,this._datum=void 0,this._previousDatum=void 0,this.scene=void 0,this._debugDirtyProperties=void 0,this.parentNode=void 0,this.cachedBBox=void 0,this.isContainerNode=!1,this.visible=!0,this.zIndex=0,this.batchLevel=0,this.batchDirty=!1,this.name=e?.name,this.tag=e?.tag??Number.NaN,this.zIndex=e?.zIndex??0,this.scene=e?.scene,(e?.debugDirty??t._debugEnabled)&&(this._debugDirtyProperties=new Map([["__first__",[]]]))}static toSVG(t,e,i){const s=t?.toSVG();if(null==s||!s.elements.length&&!s.defs?.length)return;const n=B("svg");if(n.setAttribute("width",String(e)),n.setAttribute("height",String(i)),n.setAttribute("viewBox",`0 0 ${e} ${i}`),n.setAttribute("overflow","visible"),s.defs?.length){const t=B("defs");t.append(...s.defs),n.append(t)}return n.append(...s.elements),n.outerHTML}static*extractBBoxes(t,e){for(const i of t)if(!e||i.visible&&!i.transitionOut){const t=i.getBBox();t&&(yield t)}}get datum(){return this._datum}set datum(t){this._datum!==t&&(this._previousDatum=this._datum,this._datum=t)}get previousDatum(){return this._previousDatum}get layerManager(){return this.scene?.layersManager}get imageLoader(){return this.scene?.imageLoader}closestDatum(){for(const{datum:t}of this.traverseUp(!0))if(null!=t)return t}preRender(t,e=1){if(this.childNodeCounts.groups=0,this.childNodeCounts.nonGroups=1,this.childNodeCounts.complexity=e,this.childNodeCounts.thisComplexity=e,this.batchLevel>0||this.batchDirty)throw new Error("AG Charts - illegal rendering state; batched update in progress");return this.childNodeCounts}isolatedRender(t){t.ctx.save();try{this.render(t)}catch(t){const e=t.errorCount??1;if(e>=5)throw t.errorCount=e,t;i.warnOnce("Error during rendering",t,t.stack)}finally{t.ctx.restore()}}render(t){const{stats:e}=t;if(this.debugDirtyProperties(),t.debugNodeSearch){const e=this.name??this.id;t.debugNodeSearch.some(t=>"string"==typeof t?t===e:t.test(e))&&(t.debugNodes[this.name??this.id]=this)}e&&(e.nodesRendered++,e.opsPerformed+=this.childNodeCounts.thisComplexity)}setScene(t){this.scene=t}*traverseUp(t){t&&(yield this);let e=this.parentNode;for(;e;)yield e,e=e.parentNode}isRoot(){return!this.parentNode}removeChild(t){throw new Error(`AG Charts - internal error, unknown child node ${t.name??t.id} in $${this.name??this.id}`)}remove(){this.parentNode?.removeChild(this)}destroy(){this.parentNode&&this.remove()}batchedUpdate(t){this.batchLevel++,t(),this.batchLevel--,0===this.batchLevel&&this.batchDirty&&(this.markDirty(),this.batchDirty=!1)}setProperties(t){return this.batchLevel++,Object.assign(this,t),this.batchLevel--,0===this.batchLevel&&this.batchDirty&&(this.markDirty(),this.batchDirty=!1),this}containsPoint(t,e){return!1}pickNode(t,e){if(this.containsPoint(t,e))return this}pickNodes(t,e,i=[]){return this.containsPoint(t,e)&&i.push(this),i}getBBox(){return this.cachedBBox??(this.cachedBBox=Object.freeze(this.computeBBox())),this.cachedBBox}computeBBox(){}onChangeDetection(t){this.markDirty(t)}markDirtyChildrenOrder(){this.cachedBBox=void 0}markDirty(t){this.batchLevel>0?this.batchDirty=!0:(null!=t&&this._debugDirtyProperties&&this.markDebugProperties(t),this.cachedBBox=void 0,this.parentNode?.markDirty())}markDebugProperties(t){const e=this._debugDirtyProperties?.get(t)??[],i=new Error("Stack trace for property change tracking").stack?.split("\n").filter(t=>!("Error"===t||t.includes(".markDebugProperties")||t.includes(".markDirty")||t.includes("Object.assign ")||t.includes(`${this.constructor.name}.`)))??"unknown";e.push(i[0].replace(" at ","").trim()),this._debugDirtyProperties?.set(t,e)}debugDirtyProperties(){if(null!=this._debugDirtyProperties){if(!this._debugDirtyProperties.has("__first__"))for(const[t,e]of this._debugDirtyProperties.entries())if(e.length>1){console.groupCollapsed(`Property changed multiple times before render: ${this.constructor.name}.${t} (${e.length}x)`);for(const t of e)console.log(t);console.groupEnd()}this._debugDirtyProperties.clear()}}onZIndexChange(){this.parentNode?.markDirtyChildrenOrder()}toSVG(){}};an._nextSerialNumber=0,an._debugEnabled=!1,ls([Xs()],an.prototype,"visible",2),ls([qs({equals:Rs,changeCb:t=>t.onZIndexChange()})],an.prototype,"zIndex",2);var on=an,rn=2*Math.PI,ln=Math.PI/2;function cn(t){return t%=rn,(t+=rn)%rn}function hn(t){return t%=rn,(t+=rn)!==rn&&(t%=rn),t}function dn(t){return(t%=rn)<-Math.PI?t+=rn:t>=Math.PI&&(t-=rn),t}function un(t,e,i){const s=cn(t),n=cn(e),a=cn(i);return n<a?n<=s&&s<=a:n>a?n<=s||s<=a:e!==i}function pn(t){return t/180*Math.PI}function gn(t){return t/Math.PI*180}function mn(t,e){return t=cn(t),(e=cn(e))-t+(t>e?rn:0)}function fn(t){const e=cn(t);return e<=ln?e/ln:e<=Math.PI?(Math.PI-e)/ln:e<=1.5*Math.PI?(e-Math.PI)/ln:(rn-e)/ln}function yn(t,e,i){const s=fn(i);return t*s+e*Math.abs(1-s)}function xn(t){return t?cn(pn(t)):0}var bn=(t,e,i)=>t*(1-i)+e*i,vn=t=>{const e=t<0?-1:1,i=Math.abs(t);return i<=.04045?t/12.92:e*((i+.055)/1.055)**2.4},Mn=t=>{const e=t<0?-1:1,i=Math.abs(t);return i>.0031308?e*(1.055*i**(1/2.4)-.055):12.92*t},Sn=class t{constructor(t,e,i,s=1){this.r=C(0,t||0,1),this.g=C(0,e||0,1),this.b=C(0,i||0,1),this.a=C(0,s||0,1)}static validColorString(e){return e.includes("#")?!!t.parseHex(e):e.includes("rgb")?!!t.stringToRgba(e):t.nameToHex.has(e.toLowerCase())}static fromString(e){if(e.includes("#"))return t.fromHexString(e);const i=t.nameToHex.get(e.toLowerCase());if(i)return t.fromHexString(i);if(e.includes("rgb"))return t.fromRgbaString(e);throw new Error(`Invalid color string: '${e}'`)}static parseHex(t){let e;switch((t=t.replaceAll(" ","").slice(1)).length){case 6:case 8:e=[];for(let i=0;i<t.length;i+=2)e.push(Number.parseInt(`${t[i]}${t[i+1]}`,16));break;case 3:case 4:e=t.split("").map(t=>Number.parseInt(t,16)).map(t=>t+16*t)}if(e?.length>=3&&e.every(t=>t>=0))return 3===e.length&&e.push(255),e}static fromHexString(e){const i=t.parseHex(e);if(i){const[e,s,n,a]=i;return new t(e/255,s/255,n/255,a/255)}throw new Error(`Malformed hexadecimal color string: '${e}'`)}static stringToRgba(t){let e=-1,i=-1;for(let s=0;s<t.length;s++){const n=t[s];if(-1===e&&"("===n)e=s;else if(")"===n){i=s;break}}if(-1===e||-1===i)return;const s=t.substring(e+1,i).split(","),n=[];for(let t=0;t<s.length;t++){const e=s[t];let i=Number.parseFloat(e);if(!Number.isFinite(i))return;e.includes("%")?(i=C(0,i,100),i/=100):3===t?i=C(0,i,1):(i=C(0,i,255),i/=255),n.push(i)}return n}static fromRgbaString(e){const i=t.stringToRgba(e);if(i){if(3===i.length)return new t(i[0],i[1],i[2]);if(4===i.length)return new t(i[0],i[1],i[2],i[3])}throw new Error(`Malformed rgb/rgba color string: '${e}'`)}static fromArray(e){if(4===e.length)return new t(e[0],e[1],e[2],e[3]);if(3===e.length)return new t(e[0],e[1],e[2]);throw new Error("The given array should contain 3 or 4 color components (numbers).")}static fromHSB(e,i,s,n=1){const a=t.HSBtoRGB(e,i,s);return new t(a[0],a[1],a[2],n)}static fromHSL(e,i,s,n=1){const a=t.HSLtoRGB(e,i,s);return new t(a[0],a[1],a[2],n)}static fromOKLCH(e,i,s,n=1){const a=t.OKLCHtoRGB(e,i,s);return new t(a[0],a[1],a[2],n)}static padHex(t){return 1===t.length?"0"+t:t}toHexString(){let e="#"+t.padHex(Math.round(255*this.r).toString(16))+t.padHex(Math.round(255*this.g).toString(16))+t.padHex(Math.round(255*this.b).toString(16));return this.a<1&&(e+=t.padHex(Math.round(255*this.a).toString(16))),e}toRgbaString(t=3){const e=[Math.round(255*this.r),Math.round(255*this.g),Math.round(255*this.b)],i=Math.pow(10,t);return 1!==this.a?(e.push(Math.round(this.a*i)/i),`rgba(${e.join(", ")})`):`rgb(${e.join(", ")})`}toString(){return 1===this.a?this.toHexString():this.toRgbaString()}toHSB(){return t.RGBtoHSB(this.r,this.g,this.b)}static RGBtoOKLCH(t,e,i){const s=vn(t),n=vn(e),a=vn(i),o=Math.cbrt(.4122214708*s+.5363325363*n+.0514459929*a),r=Math.cbrt(.2119034982*s+.6806995451*n+.1073969566*a),l=Math.cbrt(.0883024619*s+.2817188376*n+.6299787005*a),c=.2104542553*o+.793617785*r-.0040720468*l,h=1.9779984951*o-2.428592205*r+.4505937099*l,d=.0259040371*o+.7827717662*r-.808675766*l,u=180*Math.atan2(d,h)/Math.PI;return[c,Math.hypot(h,d),u>=0?u:u+360]}static OKLCHtoRGB(t,e,i){const s=t,n=e*Math.cos(i*Math.PI/180),a=e*Math.sin(i*Math.PI/180),o=(s+.3963377774*n+.2158037573*a)**3,r=(s-.1055613458*n-.0638541728*a)**3,l=(s-.0894841775*n-1.291485548*a)**3,c=-1.2684380046*o+2.6097574011*r-.3413193965*l,h=-.0041960863*o-.7034186147*r+1.707614701*l;return[Mn(4.0767416621*o-3.3077115913*r+.2309699292*l),Mn(c),Mn(h)]}static RGBtoHSL(t,e,i){const s=Math.min(t,e,i),n=Math.max(t,e,i),a=(n+s)/2;let o,r;if(n===s)o=0,r=0;else{const l=n-s;r=a>.5?l/(2-n-s):l/(n+s),o=n===t?(e-i)/l+(e<i?6:0):n===e?(i-t)/l+2:(t-e)/l+4,o*=60}return[o,r,a]}static HSLtoRGB(t,e,i){if(0===e)return[i,i,i];const s=i<.5?i*(1+e):i+e-i*e,n=2*i-s;function a(t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(s-n)*t:t<.5?s:t<2/3?n+(s-n)*(2/3-t)*6:n}return[a((t=(t%360+360)%360)/360+1/3),a(t/360),a(t/360-1/3)]}static RGBtoHSB(t,e,i){const s=Math.min(t,e,i),n=Math.max(t,e,i);let a=0;if(s!==n){const o=n-s,r=(n-t)/o,l=(n-e)/o,c=(n-i)/o;a=t===n?c-l:e===n?2+r-c:4+l-r,a/=6,a<0&&(a+=1)}return[360*a,0===n?0:(n-s)/n,n]}static HSBtoRGB(t,e,i){t=(t%360+360)%360/360;let s=0,n=0,a=0;if(0===e)s=n=a=i;else{const o=6*(t-Math.floor(t)),r=o-Math.floor(o),l=i*(1-e),c=i*(1-e*r),h=i*(1-e*(1-r));switch(Math.trunc(o)){case 0:s=i,n=h,a=l;break;case 1:s=c,n=i,a=l;break;case 2:s=l,n=i,a=h;break;case 3:s=l,n=c,a=i;break;case 4:s=h,n=l,a=i;break;case 5:s=i,n=l,a=c}}return[s,n,a]}static mix(e,i,s){return new t(bn(e.r,i.r,s),bn(e.g,i.g,s),bn(e.b,i.b,s),bn(e.a,i.a,s))}static lighten(e,i){const s=t.RGBtoOKLCH(e.r,e.g,e.b);return t.fromOKLCH(C(0,s[0]+i,1),s[1],s[2])}static darken(e,i){const s=t.RGBtoOKLCH(e.r,e.g,e.b);return t.fromOKLCH(C(0,s[0]-i,1),s[1],s[2])}static interpolate(e,i){const s=1/(e.length-1),n=e.map(e=>t.RGBtoOKLCH(e.r,e.g,e.b));return Array.from({length:i},(a,o)=>{const r=o/(i-1),l=e.length<=2?0:Math.min(Math.floor(r*(e.length-1)),e.length-2),c=(r-l*s)/s,h=n[l],d=n[l+1];return t.fromOKLCH(bn(h[0],d[0],c),bn(h[1],d[1],c),bn(h[2],d[2],c))})}};Sn.nameToHex=new Map([["aliceblue","#F0F8FF"],["antiquewhite","#FAEBD7"],["aqua","#00FFFF"],["aquamarine","#7FFFD4"],["azure","#F0FFFF"],["beige","#F5F5DC"],["bisque","#FFE4C4"],["black","#000000"],["blanchedalmond","#FFEBCD"],["blue","#0000FF"],["blueviolet","#8A2BE2"],["brown","#A52A2A"],["burlywood","#DEB887"],["cadetblue","#5F9EA0"],["chartreuse","#7FFF00"],["chocolate","#D2691E"],["coral","#FF7F50"],["cornflowerblue","#6495ED"],["cornsilk","#FFF8DC"],["crimson","#DC143C"],["cyan","#00FFFF"],["darkblue","#00008B"],["darkcyan","#008B8B"],["darkgoldenrod","#B8860B"],["darkgray","#A9A9A9"],["darkgreen","#006400"],["darkgrey","#A9A9A9"],["darkkhaki","#BDB76B"],["darkmagenta","#8B008B"],["darkolivegreen","#556B2F"],["darkorange","#FF8C00"],["darkorchid","#9932CC"],["darkred","#8B0000"],["darksalmon","#E9967A"],["darkseagreen","#8FBC8F"],["darkslateblue","#483D8B"],["darkslategray","#2F4F4F"],["darkslategrey","#2F4F4F"],["darkturquoise","#00CED1"],["darkviolet","#9400D3"],["deeppink","#FF1493"],["deepskyblue","#00BFFF"],["dimgray","#696969"],["dimgrey","#696969"],["dodgerblue","#1E90FF"],["firebrick","#B22222"],["floralwhite","#FFFAF0"],["forestgreen","#228B22"],["fuchsia","#FF00FF"],["gainsboro","#DCDCDC"],["ghostwhite","#F8F8FF"],["gold","#FFD700"],["goldenrod","#DAA520"],["gray","#808080"],["green","#008000"],["greenyellow","#ADFF2F"],["grey","#808080"],["honeydew","#F0FFF0"],["hotpink","#FF69B4"],["indianred","#CD5C5C"],["indigo","#4B0082"],["ivory","#FFFFF0"],["khaki","#F0E68C"],["lavender","#E6E6FA"],["lavenderblush","#FFF0F5"],["lawngreen","#7CFC00"],["lemonchiffon","#FFFACD"],["lightblue","#ADD8E6"],["lightcoral","#F08080"],["lightcyan","#E0FFFF"],["lightgoldenrodyellow","#FAFAD2"],["lightgray","#D3D3D3"],["lightgreen","#90EE90"],["lightgrey","#D3D3D3"],["lightpink","#FFB6C1"],["lightsalmon","#FFA07A"],["lightseagreen","#20B2AA"],["lightskyblue","#87CEFA"],["lightslategray","#778899"],["lightslategrey","#778899"],["lightsteelblue","#B0C4DE"],["lightyellow","#FFFFE0"],["lime","#00FF00"],["limegreen","#32CD32"],["linen","#FAF0E6"],["magenta","#FF00FF"],["maroon","#800000"],["mediumaquamarine","#66CDAA"],["mediumblue","#0000CD"],["mediumorchid","#BA55D3"],["mediumpurple","#9370DB"],["mediumseagreen","#3CB371"],["mediumslateblue","#7B68EE"],["mediumspringgreen","#00FA9A"],["mediumturquoise","#48D1CC"],["mediumvioletred","#C71585"],["midnightblue","#191970"],["mintcream","#F5FFFA"],["mistyrose","#FFE4E1"],["moccasin","#FFE4B5"],["navajowhite","#FFDEAD"],["navy","#000080"],["oldlace","#FDF5E6"],["olive","#808000"],["olivedrab","#6B8E23"],["orange","#FFA500"],["orangered","#FF4500"],["orchid","#DA70D6"],["palegoldenrod","#EEE8AA"],["palegreen","#98FB98"],["paleturquoise","#AFEEEE"],["palevioletred","#DB7093"],["papayawhip","#FFEFD5"],["peachpuff","#FFDAB9"],["peru","#CD853F"],["pink","#FFC0CB"],["plum","#DDA0DD"],["powderblue","#B0E0E6"],["purple","#800080"],["rebeccapurple","#663399"],["red","#FF0000"],["rosybrown","#BC8F8F"],["royalblue","#4169E1"],["saddlebrown","#8B4513"],["salmon","#FA8072"],["sandybrown","#F4A460"],["seagreen","#2E8B57"],["seashell","#FFF5EE"],["sienna","#A0522D"],["silver","#C0C0C0"],["skyblue","#87CEEB"],["slateblue","#6A5ACD"],["slategray","#708090"],["slategrey","#708090"],["snow","#FFFAFA"],["springgreen","#00FF7F"],["steelblue","#4682B4"],["tan","#D2B48C"],["teal","#008080"],["thistle","#D8BFD8"],["tomato","#FF6347"],["transparent","#00000000"],["turquoise","#40E0D0"],["violet","#EE82EE"],["wheat","#F5DEB3"],["white","#FFFFFF"],["whitesmoke","#F5F5F5"],["yellow","#FFFF00"],["yellowgreen","#9ACD32"]]);var In=Sn,Dn=(t=>(t[t.Leading=0]="Leading",t[t.Trailing=1]="Trailing",t[t.Interpolate=2]="Interpolate",t))(Dn||{}),kn=class{ticks(t,e,i){}niceDomain(t,e=this.domain){return e}get bandwidth(){}get step(){}get inset(){}},An=(t,e)=>{const i=Symbol(String(e));t[i]=void 0,Object.defineProperty(t,e,{get(){return this[i]},set(t){this[i]!==t&&(this[i]=t,this.invalid=!0)},enumerable:!0,configurable:!1})},wn=t=>{const e=In.fromString(t),[i,s,n]=In.RGBtoOKLCH(e.r,e.g,e.b);return{l:i,c:s,h:n,a:e.a}},Cn=1e-6,Nn=t=>t.c<Cn||t.l<Cn||t.l>1-Cn,Ln=class extends kn{constructor(){super(...arguments),this.type="color",this.defaultTickCount=0,this.invalid=!0,this.domain=[0,1],this.range=["red","blue"],this.parsedRange=this.range.map(wn)}update(){const{domain:t,range:e}=this;t.length<2&&(i.warnOnce("`colorDomain` should have at least 2 values."),0===t.length?t.push(0,1):1===t.length&&t.push(t[0]+1));for(let e=1;e<t.length;e++)if(t[e-1]>t[e]){i.warnOnce("`colorDomain` values should be supplied in ascending order."),t.sort((t,e)=>t-e);break}if(e.length<t.length)for(let i=e.length;i<t.length;i++)e.push(e.length>0?e[0]:"black");this.parsedRange=this.range.map(wn)}normalizeDomains(...t){return{domain:t.flat(),animatable:!0}}toDomain(){}convert(t){this.refresh();const{domain:e,range:i,parsedRange:s}=this,n=e[0],a=e.at(-1),o=i[0],r=i.at(-1);if(t<=n)return o;if(t>=a)return r;let l,c;if(2===e.length){const e=(t-n)/(a-n),s=1/(i.length-1);l=i.length<=2?0:Math.min(Math.floor(e*(i.length-1)),i.length-2),c=(e-l*s)/s}else{for(l=0;l<e.length-2&&!(t<e[l+1]);l++);const i=e[l];c=(t-i)/(e[l+1]-i)}return((t,e,i)=>{let s;if(i=C(0,i,1),Nn(t))s=e.h;else if(Nn(e))s=t.h;else{const n=t.h;let a=e.h;const o=e.h-t.h;o>180?a-=360:o<-180&&(a+=360),s=n*(1-i)+a*i}const n=t.c*(1-i)+e.c*i,a=t.l*(1-i)+e.l*i,o=t.a*(1-i)+e.a*i;return In.fromOKLCH(a,n,s,o)})(s[l],s[l+1],c).toRgbaString()}invert(){}refresh(){this.invalid&&(this.invalid=!1,this.update(),this.invalid&&i.warnOnce("Expected update to not invalidate scale"))}};ls([An],Ln.prototype,"domain",2),ls([An],Ln.prototype,"range",2);var Tn=class{constructor(t,e=[],i){this.colorSpace=t,this.stops=e,this.bbox=i,this._cache=void 0}createGradient(t,e,i){const s=this.bbox??e;if(!s.isFinite())return;if(null!=this._cache&&this._cache.ctx===t&&this._cache.bbox.equals(s))return this._cache.gradient;const{stops:n,colorSpace:a}=this;if(0===n.length)return;if(1===n.length)return n[0].color;let o=this.createCanvasGradient(t,s,i);if(null==o)return;const r="oklch"===a;let l=n[0];o.addColorStop(l.stop,l.color);for(let t=1;t<n.length;t+=1){const e=n[t];if(r){const t=new Ln;t.domain=[l.stop,e.stop],t.range=[l.color,e.color];for(let i=l.stop+.05;i<e.stop;i+=.05)o.addColorStop(i,t.convert(i)??"transparent")}o.addColorStop(e.stop,e.color),l=e}return"createPattern"in o&&(o=o.createPattern()),this._cache={ctx:t,bbox:s,gradient:o},o}toSvg(t){const e=this.bbox??t,i=this.createSvgGradient(e);for(const{stop:t,color:e}of this.stops){const s=B("stop");s.setAttribute("offset",`${t}`),s.setAttribute("stop-color",`${e}`),i.appendChild(s)}return i}},En=class extends Tn{constructor(t,e,i=0,s){super(t,e,s),this.angle=i}createCanvasGradient(t,e,i){const{angle:s}=this,n=xn(s+-90),a=i?.centerX??e.x+.5*e.width,o=i?.centerY??e.y+.5*e.height;return t.createConicGradient(n,a,o)}createSvgGradient(t){return B("linearGradient")}},On=class extends Tn{constructor(t,e,i=0,s){super(t,e,s),this.angle=i}getGradientPoints(t){const{angle:e}=this,i=xn(e+90),s=Math.cos(i),n=Math.sin(i),a=t.width,o=t.height,r=t.x+.5*a,l=t.y+.5*o,c=Math.hypot(o,a)/2,h=Math.atan2(o,a);let d;d=i<Math.PI/2?i:i<Math.PI?Math.PI-i:i<1.5*Math.PI?i-Math.PI:2*Math.PI-i;const u=c*Math.abs(Math.cos(d-h));return{x0:r+s*u,y0:l+n*u,x1:r-s*u,y1:l-n*u}}createCanvasGradient(t,e){const{x0:i,y0:s,x1:n,y1:a}=this.getGradientPoints(e);if(!(Number.isNaN(i)||Number.isNaN(s)||Number.isNaN(n)||Number.isNaN(a)))return t.createLinearGradient(i,s,n,a)}createSvgGradient(t){const{x0:e,y0:i,x1:s,y1:n}=this.getGradientPoints(t),a=B("linearGradient");return a.setAttribute("x1",String(e)),a.setAttribute("y1",String(i)),a.setAttribute("x2",String(s)),a.setAttribute("y2",String(n)),a.setAttribute("gradientUnits","userSpaceOnUse"),a}},Rn=class extends Tn{constructor(t,e,i){super(t,e,i)}createCanvasGradient(t,e,i){const s=i?.centerX??e.x+.5*e.width,n=i?.centerY??e.y+.5*e.height,a=i?.innerRadius??0,o=i?.outerRadius??Math.hypot(.5*e.width,.5*e.height)/Math.SQRT2;return t.createRadialGradient(s,n,a,s,n,o)}createSvgGradient(t){const e=t.x+.5*t.width,i=t.y+.5*t.height,s=B("radialGradient");return s.setAttribute("cx",String(e)),s.setAttribute("cy",String(i)),s.setAttribute("r",String(Math.hypot(.5*t.width,.5*t.height)/Math.SQRT2)),s.setAttribute("gradientUnits","userSpaceOnUse"),s}},Pn=class{handleUnknownProperties(t,e){}set(t){const{className:e=this.constructor.name}=this.constructor;if(null==t)return this.clear(),this;if("object"!=typeof t)return i.warn(`unable to set ${e} - expecting a properties object`),this;const s=new Set(Object.keys(t));for(const e of Es(this))if(s.has(e)){const n=t[e],a=this;if(jn(a[e]))if(a[e]instanceof zn){const t=a[e].reset(n);null==t?i.warn(`unable to set [${String(e)}] - expecting a properties array`):a[e]=t}else a[e].set(n);else Y(n)?a[e]=js(n,a[e]??{}):a[e]=n;s.delete(e)}this.handleUnknownProperties(s,t);for(const t of s)i.warn(`unable to set [${String(t)}] in ${e} - property is unknown`);return this}clear(){for(const t of Es(this)){const e=this[t];jn(e)?e.clear():this[t]=void 0}return this}toJson(){return Es(this).reduce((t,e)=>{const i=this[e];return t[String(e)]=jn(i)?i.toJson():i,t},{})}},zn=class t extends Array{constructor(t,...e){super(e.length);const i=(s=t,Boolean(s?.prototype?.constructor?.name)?e=>(new t).set(e):t);var s;Object.defineProperty(this,"itemFactory",{value:i,enumerable:!1,configurable:!1}),this.set(e)}set(t){if(G(t)){this.length=t.length;for(let e=0;e<t.length;e++)this[e]=this.itemFactory(t[e])}return this}reset(e){if(Array.isArray(e))return new t(this.itemFactory,...e)}toJson(){return this.map(t=>t?.toJson?.()??t)}};function jn(t){return t instanceof Pn||t instanceof zn}var Bn=class extends Pn{constructor(){super(...arguments),this.color="black"}};function Fn(t){return t.flatMap((e,i)=>{const{stop:s}=e,n=t.at(i+1)?.color;return null==n?[e]:[e,{stop:s,color:n}]})}function Vn(t,e,s,n="continuous"){const a=t.map(t=>"string"==typeof t?{color:t}:t);if(0===a.length)return function(t,e){const i="discrete"===e?1:0,s=t.map((t,e,{length:s})=>({stop:(e+i)/(s-1+i),color:t}));return"discrete"===e?Fn(s):s}(e,n);if(!function(t){let e;for(const i of t)if(null!=i?.stop){if(null!=e&&i.stop<e)return!1;e=i.stop}return!0}(a))return i.warnOnce("[fills] must have the stops defined in ascending order"),[];const o=Math.min(...s),r=Math.max(...s),l="discrete"===n,c=new Float64Array(a.length);let h=0,d=-1;for(let t=0;t<a.length;t+=1){const e=a[t];if(t>=d){d=a.length-1;for(let e=t+1;e<a.length;e+=1)if(null!=a[e]?.stop){d=e;break}}let i=e?.stop;if(null==i){const e=a[h]?.stop,s=a[d]?.stop,n=e??o,c=l&&null==e?1:0;i=n+((s??r)-n)*(t-h+c)/(d-h+c)}else h=t;c[t]=Math.max(0,Math.min(1,(i-o)/(r-o)))}let u,p=a.find(t=>null!=t.color)?.color;const g=a.map((t,i)=>{let s=t?.color;const n=c[i];return null!=s?p=s:null==p?(null==u&&(u=new Ln,u.domain=[0,1],u.range=e),s=u.convert(n)):s=p,{stop:n,color:s}});return"discrete"===n?Fn(g):g}ls([ws],Bn.prototype,"stop",2),ls([ws],Bn.prototype,"color",2);var Gn=class{constructor(t,e){this.imageLoader=t,this._cache=void 0,this.url=e.url,this.backgroundFill=e.backgroundFill??"black",this.backgroundFillOpacity=e.backgroundFillOpacity??1,this.repeat=e.repeat??"no-repeat",this.width=e.width,this.height=e.height,this.fit=e.fit??"stretch",this.rotation=e.rotation??0}createCanvasImage(t,e,s,n){if(!e)return null;const[a,o]=this.getSize(e.width,e.height,s,n);return a<1||o<1?(i.warnOnce("Image fill is too small to render, ignoring."),null):t.createPattern(e,this.repeat)}getSize(t,e,i,s){const{fit:n}=this;let a=t,o=e,r=1;const l=i/s,c=t/e;return"stretch"===n||0===t||0===e?(a=i,o=s):"contain"===n?r=c>l?i/t:s/e:"cover"===n&&(r=c>l?s/e:i/t),[Math.max(1,a*r),Math.max(1,o*r)]}setImageTransform(t,e){if("string"==typeof t)return;const{url:i,rotation:s,width:n,height:a}=this,o=this.imageLoader?.loadImage(i);if(!o)return;const r=xn(s),l=Math.cos(r),c=Math.sin(r),[h,d]=this.getSize(o.width,o.height,n??e.width,a??e.height),u=h/o.width,p=d/o.height,g=e.x+e.width/2,m=e.y+e.height/2,f=(l*h-c*d)/2,y=(c*h+l*d)/2;t?.setTransform(new DOMMatrix([l*u,c*p,-c*u,l*p,g-f,m-y]))}createPattern(t,e,i,s){const n=this.width??e,a=this.height??i,o=this._cache;if(null!=o&&o.ctx===t&&o.width===n&&o.height===a)return o.pattern;const r=this.imageLoader?.loadImage(this.url,s),l=this.createCanvasImage(t,r,n,a);return null!=l?(this._cache={ctx:t,pattern:l,width:n,height:a},l):void 0}toSvg(t,e){const{url:i,rotation:s,backgroundFill:n,backgroundFillOpacity:a}=this,{x:o,y:r,width:l,height:c}=t,h=B("pattern");h.setAttribute("viewBox",`0 0 ${l} ${c}`),h.setAttribute("x",String(o)),h.setAttribute("y",String(r)),h.setAttribute("width",String(l)),h.setAttribute("height",String(c)),h.setAttribute("patternUnits","userSpaceOnUse");const d=B("rect");d.setAttribute("x","0"),d.setAttribute("y","0"),d.setAttribute("width",String(l)),d.setAttribute("height",String(c)),d.setAttribute("fill",n),d.setAttribute("fill-opacity",String(a)),h.appendChild(d);const u=B("image");return u.setAttribute("href",i),u.setAttribute("x","0"),u.setAttribute("y","0"),u.setAttribute("width",String(l)),u.setAttribute("height",String(c)),u.setAttribute("preserveAspectRatio","none"),u.setAttribute("transform",`scale(${1/e}) rotate(${s}, ${l/2}, ${c/2})`),h.appendChild(u),h}};function $n(t,e,i,s){const n=t-i,a=e-s;return n*n+a*a}function Hn(t,e,i,s,n,a,o){if(i===n&&s===a)return Math.min(o,$n(t,e,i,s));const r=n-i,l=a-s,c=Math.max(0,Math.min(1,((t-i)*r+(e-s)*l)/(r*r+l*l))),h=i+c*r,d=s+c*l;return Math.min(o,$n(t,e,h,d))}var Un=/^[\t\n\f\r ]*([achlmqstvz])[\t\n\f\r ]*/i,Wn=/^[+-]?((\d*\.\d+)|(\d+\.)|(\d+))(e[+-]?\d+)?/i,_n=/[\t\n\f\r ]*,?[\t\n\f\r ]*/,Yn=/^[01]/,Kn={z:[],h:[Wn],v:[Wn],m:[Wn,Wn],l:[Wn,Wn],t:[Wn,Wn],s:[Wn,Wn,Wn,Wn],q:[Wn,Wn,Wn,Wn],c:[Wn,Wn,Wn,Wn,Wn,Wn],a:[Wn,Wn,Wn,Yn,Yn,Wn,Wn]};function Zn(t,e,s){const n=Kn[t.toLocaleLowerCase()],a={command:t,params:[]};for(const o of n){const n=e.slice(s),r=o.exec(n);if(null==r)return 1===a.params.length?[s,a]:void i.warnOnce(`Invalid SVG path, error at index ${s}: No path segment parameters for command [${t}]`);{a.params.push(Number.parseFloat(r[0])),s+=r[0].length;const t=_n.exec(n.slice(r[0].length));null!=t&&(s+=t[0].length)}}return[s,a]}function Xn(t,e,i,s,n,a,o,r){const l=(i-t)*(r-a)-(s-e)*(o-n);if(0===l)return 0;const c=((o-n)*(e-a)-(t-n)*(r-a))/l,h=((i-t)*(e-a)-(s-e)*(t-n))/l;return c>=0&&c<=1&&h>=0&&h<=1?1:0}function Qn(t,e,i,s,n,a,o,r,l,c,h,d){let u=0;const p=c-d,g=h-l,m=l*(d-c)-c*(h-l),f=qn(t,i,n,o),y=qn(e,s,a,r),x=function(t,e,i,s,n=1e-6){if(Math.abs(t)<n)return function(t,e,i,s=1e-6){if(Math.abs(t)<s)return function(t,e){const i=-e/t;return 0!==t&&i>=0&&i<=1?[i]:[]}(e,i);const n=e*e-4*t*i,a=[];if(Math.abs(n)<s){const i=-e/(2*t);i>=0&&i<=1&&a.push(i)}else if(n>0){const i=Math.sqrt(n),s=(-e-i)/(2*t),o=(-e+i)/(2*t);s>=0&&s<=1&&a.push(s),o>=0&&o<=1&&a.push(o)}return a}(e,i,s,n);const a=e/t,o=i/t,r=(3*o-a*a)/9,l=(9*a*o-s/t*27-2*a*a*a)/54,c=r*r*r+l*l,h=1/3,d=[];if(c>=0){const t=Math.sqrt(c),e=Math.sign(l+t)*Math.pow(Math.abs(l+t),h),i=Math.sign(l-t)*Math.pow(Math.abs(l-t),h),s=Math.abs(Math.sqrt(3)*(e-i)/2),o=-h*a+(e+i);if(o>=0&&o<=1&&d.push(o),Math.abs(s)<n){const t=-h*a-(e+i)/2;t>=0&&t<=1&&d.push(t)}}else{const t=Math.acos(l/Math.sqrt(-r*r*r)),e=h*a,i=2*Math.sqrt(-r),s=i*Math.cos(h*t)-e,n=i*Math.cos(h*(t+2*Math.PI))-e,o=i*Math.cos(h*(t+4*Math.PI))-e;s>=0&&s<=1&&d.push(s),n>=0&&n<=1&&d.push(n),o>=0&&o<=1&&d.push(o)}return d}(p*f[0]+g*y[0],p*f[1]+g*y[1],p*f[2]+g*y[2],p*f[3]+g*y[3]+m);for(const t of x){const e=t*t,i=t*e,s=f[0]*i+f[1]*e+f[2]*t+f[3],n=y[0]*i+y[1]*e+y[2]*t+y[3];let a;a=l===h?(n-c)/(d-c):(s-l)/(h-l),a>=0&&a<=1&&u++}return u}function qn(t,e,i,s){return[3*e-t-3*i+s,3*t-6*e+3*i,-3*t+3*e,t]}function Jn(t,e,i,s,n){return(1-n)**3*t+3*(1-n)**2*n*e+3*(1-n)*n**2*i+n**3*s}function ta(t,e,i,s,n){if(n<=Math.min(t,s))return t<s?0:1;if(n>=Math.max(t,s))return t<s?1:0;let a=0,o=1,r=Number.NaN;for(let l=0;l<12;l+=1)r=(a+o)/2,Jn(t,e,i,s,r)<n?a=r:o=r;return r}function ea(t,e,i,s,n,a,o,r,l){const c=(1-l)*t+l*i,h=(1-l)*e+l*s,d=(1-l)*i+l*n,u=(1-l)*s+l*a,p=(1-l)*n+l*o,g=(1-l)*a+l*r,m=(1-l)*c+l*d,f=(1-l)*h+l*u,y=(1-l)*d+l*p,x=(1-l)*u+l*g,b=(1-l)*m+l*y,v=(1-l)*f+l*x;return[[{x:t,y:e},{x:c,y:h},{x:m,y:f},{x:b,y:v}],[{x:b,y:v},{x:y,y:x},{x:p,y:g},{x:o,y:r}]]}function ia(t,e,i,s){const n=3*e-t-3*i+s,a=2*(t-2*e+i),o=-t+e;if(0===n){if(0!==a){const t=-o/a;if(t>0&&t<1)return[t]}return[]}const r=a*a-4*n*o;if(r>=0){const t=Math.sqrt(r);return[(-a+t)/(2*n),(-a-t)/(2*n)].filter(t=>t>0&&t<1)}return[]}function sa(t,e,i,s,n,a,o,r){return[...ia(t,i,n,o),...ia(e,s,a,r)]}function na(t,e,i){const s=Jn(t[0].x,t[1].x,t[2].x,t[3].x,.5),n=Jn(t[0].y,t[1].y,t[2].y,t[3].y,.5);return{points:t,distance:Math.hypot(s-e,n-i),minDistance:Math.min(Math.hypot(t[0].x-e,t[0].y-i),Math.hypot(t[1].x-e,t[1].y-i),Math.hypot(t[2].x-e,t[2].y-i),Math.hypot(t[3].x-e,t[3].y-i))}}function aa(t,e,i,s,n,a,o,r,l,c,h=1){let d,u={value:na([{x:t,y:e},{x:i,y:s},{x:n,y:a},{x:o,y:r}],l,c),next:null};for(;null!=u;){const{points:t,distance:e,minDistance:i}=u.value;if(u=u.next,(null==d||e<d.distance)&&(d={distance:e,minDistance:i}),null!=d&&d.distance-i<=h)continue;const[s,n]=ea(t[0].x,t[0].y,t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y,.5);u=zi(u,[na(s,l,c),na(n,l,c)].sort(oa),oa)}return d?.distance??1/0}var oa=(t,e)=>e.minDistance-t.minDistance,ra=class{constructor(){this.path2d=new Path2D,this.previousCommands=[],this.previousParams=[],this.previousClosedPath=!1,this.commands=[],this.params=[],this.cx=Number.NaN,this.cy=Number.NaN,this.sx=Number.NaN,this.sy=Number.NaN,this.openedPath=!1,this.closedPath=!1}isEmpty(){return 0===this.commands.length}isDirty(){return this.closedPath!==this.previousClosedPath||this.previousCommands.length!==this.commands.length||this.previousParams.length!==this.params.length||this.previousCommands.toString()!==this.commands.toString()||this.previousParams.toString()!==this.params.toString()}getPath2D(){return this.path2d}moveTo(t,e){this.openedPath=!0,this.sx=t,this.sy=e,this.cx=t,this.cy=e,this.path2d.moveTo(t,e),this.commands.push(0),this.params.push(t,e)}lineTo(t,e){this.openedPath?(this.cx=t,this.cy=e,this.path2d.lineTo(t,e),this.commands.push(1),this.params.push(t,e)):this.moveTo(t,e)}cubicCurveTo(t,e,i,s,n,a){this.openedPath||this.moveTo(t,e),this.path2d.bezierCurveTo(t,e,i,s,n,a),this.commands.push(2),this.params.push(t,e,i,s,n,a)}closePath(){this.openedPath&&(this.cx=this.sx,this.cy=this.sy,this.sx=Number.NaN,this.sy=Number.NaN,this.path2d.closePath(),this.commands.push(3),this.openedPath=!1,this.closedPath=!0)}rect(t,e,i,s){this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+s),this.lineTo(t,e+s),this.closePath()}roundRect(t,e,i,s,n){n=Math.min(n,i/2,s/2),this.moveTo(t,e+n),this.arc(t+n,e+n,n,Math.PI,1.5*Math.PI),this.lineTo(t+n,e),this.lineTo(t+i-n,e),this.arc(t+i-n,e+n,n,1.5*Math.PI,2*Math.PI),this.lineTo(t+i,e+n),this.lineTo(t+i,e+s-n),this.arc(t+i-n,e+s-n,n,0,Math.PI/2),this.lineTo(t+i-n,e+s),this.lineTo(t+n,e+s),this.arc(t+ +n,e+s-n,n,Math.PI/2,Math.PI),this.lineTo(t,e+s-n),this.closePath()}ellipse(t,e,i,s,n,a,o,r=!1){const l=i,c=s/i,h=Math.cos(n),d=Math.sin(n),u=-c*d,p=c*h,g=l*Math.cos(a),m=l*Math.sin(a),f=t+h*g+u*m,y=e+d*g+p*m,x=(f-this.cx)**2+(y-this.cy)**2;this.openedPath?x>1e-6&&this.lineTo(f,y):this.moveTo(f,y);let b=r?-cn(a-o):cn(o-a);Math.abs(Math.abs(o-a)-2*Math.PI)<1e-6&&b<2*Math.PI&&(b+=2*Math.PI*(r?-1:1));const v=Math.max(Math.ceil(Math.abs(b)/(Math.PI/2)),1),M=b/v,S=4/3*Math.tan(M/4);for(let i=0;i<v;i+=1){const s=a+M*(i+0),n=a+M*(i+1),o=l*Math.sin(s),r=l*Math.cos(s),c=l*Math.sin(n),g=l*Math.cos(n),m=r-S*o,f=o+S*r,y=g+S*c,x=c-S*g,b=g,v=c;this.cubicCurveTo(t+h*m+u*f,e+d*m+p*f,t+h*y+u*x,e+d*y+p*x,t+h*b+u*v,e+d*b+p*v)}}arc(t,e,i,s,n,a){this.ellipse(t,e,i,i,0,s,n,a)}appendSvg(t){const e=function(t){if(!t)return;const e=[];let s,n=0;for(;n<t.length;){const a=Un.exec(t.slice(n));let o;if(null==a){if(!s)return void i.warnOnce(`Invalid SVG path, error at index ${n}: Missing command.`);o=s}else o=a[1],n+=a[0].length;const r=Zn(o,t,n);if(!r)return;n=r[0],s=o,e.push(r[1])}return e}(t);if(null==e)return!1;let s,n,a=0,o=0,r=0,l=0;for(const{command:t,params:i}of e){s??(s=i[0]),n??(n=i[1]);const e=t===t.toLowerCase(),c=e?s:0,h=e?n:0;switch(t.toLowerCase()){case"m":this.moveTo(c+i[0],h+i[1]),s=c+i[0],n=h+i[1],a=s,o=n;break;case"c":this.cubicCurveTo(c+i[0],h+i[1],c+i[2],h+i[3],c+i[4],h+i[5]),r=c+i[2],l=h+i[3],s=c+i[4],n=h+i[5];break;case"s":this.cubicCurveTo(s+s-r,n+n-l,c+i[0],h+i[1],c+i[2],h+i[3]),r=c+i[0],l=h+i[1],s=c+i[2],n=h+i[3];break;case"q":this.cubicCurveTo((c+2*i[0])/3,(h+2*i[1])/3,(2*i[0]+i[2])/3,(2*i[1]+i[3])/3,i[2],i[3]),r=i[0],l=i[1],s=i[2],n=i[3];break;case"t":this.cubicCurveTo((s+2*(s+s-r))/3,(n+2*(n+n-l))/3,(2*(s+s-r)+i[0])/3,(2*(n+n-l)+i[1])/3,i[0],i[1]),r=s+s-r,l=n+n-l,s=i[0],n=i[1];break;case"a":this.svgEllipse(s,n,i[0],i[1],i[2]*Math.PI/180,i[3],i[4],c+i[5],h+i[6]),s=c+i[5],n=h+i[6];break;case"h":this.lineTo(c+i[0],n),s=c+i[0];break;case"l":this.lineTo(c+i[0],h+i[1]),s=c+i[0],n=h+i[1];break;case"v":this.lineTo(s,h+i[0]),n=h+i[0];break;case"z":this.closePath(),s=a,n=o;break;default:throw new Error(`Could not translate command '${t}' with '${i.join(" ")}'`)}}return!0}svgEllipse(t,e,i,s,n,a,o,r,l){i=Math.abs(i),s=Math.abs(s);const c=(t-r)/2,h=(e-l)/2,d=Math.sin(n),u=Math.cos(n),p=u*c+d*h,g=-d*c+u*h,m=p/i,f=g/s;let y=m*m+f*f,x=(t+r)/2,b=(e+l)/2,v=0,M=0;y>=1?(y=Math.sqrt(y),i*=y,s*=y):(y=Math.sqrt(1/y-1),a===o&&(y=-y),v=y*i*f,M=-y*s*m,x+=u*v-d*M,b+=d*v+u*M);const S=Math.atan2((g-M)/s,(p-v)/i),I=S+(Math.atan2((-g-M)/s,(-p-v)/i)-S),D=!!(1-o);this.ellipse(x,b,i,s,n,S,I,D)}clear(t){t&&(this.previousCommands=this.commands,this.previousParams=this.params,this.previousClosedPath=this.closedPath),this.path2d=new Path2D,this.openedPath=!1,this.closedPath=!1,this.commands=[],this.params=[]}isPointInPath(t,e){const i=this.commands,s=this.params,n=i.length,a=-1e4,o=-1e4;let r=Number.NaN,l=Number.NaN,c=0,h=0,d=0;for(let u=0,p=0;u<n;u++)switch(i[u]){case 0:d+=Xn(r,l,c,h,a,o,t,e),c=s[p++],r=c,h=s[p++],l=h;break;case 1:d+=Xn(c,h,s[p++],s[p++],a,o,t,e),c=s[p-2],h=s[p-1];break;case 2:d+=Qn(c,h,s[p++],s[p++],s[p++],s[p++],s[p++],s[p++],a,o,t,e),c=s[p-2],h=s[p-1];break;case 3:d+=Xn(r,l,c,h,a,o,t,e)}return d%2==1}distanceSquared(t,e){let i=1/0;const s=this.commands,n=this.params,a=s.length;let o=Number.NaN,r=Number.NaN,l=0,c=0;for(let h=0,d=0;h<a;h++)switch(s[h]){case 0:l=o=n[d++],c=r=n[d++];break;case 1:{const s=l,a=c;l=n[d++],c=n[d++],i=Hn(t,e,s,a,l,c,i);break}case 2:{const s=l,a=c,o=n[d++],r=n[d++],h=n[d++],u=n[d++];l=n[d++],c=n[d++],i=aa(s,a,o,r,h,u,l,c,t,e)**2;break}case 3:i=Hn(t,e,l,c,o,r,i)}return i}toSVG(t=(t,e)=>({x:t,y:e})){const e=[],{commands:i,params:s}=this,n=(i,n)=>{e.push(i);for(let i=0;i<n;i+=2){const{x:i,y:n}=t(s[a++],s[a++]);e.push(i,n)}};let a=0;for(const t of i)switch(t){case 0:n("M",2);break;case 1:n("L",2);break;case 2:n("C",6);break;case 3:n("Z",0)}return e.join(" ")}computeBBox(){const{commands:t,params:e}=this;let[i,s,n,a]=[1/0,1/0,-1/0,-1/0],[o,r]=[Number.NaN,Number.NaN],[l,c]=[Number.NaN,Number.NaN];const h=(t,e)=>{i=Math.min(e,i),s=Math.min(t,s),n=Math.max(t,n),a=Math.max(e,a),o=t,r=e};let d=0;for(const i of t)switch(i){case 0:h(e[d++],e[d++]),l=o,c=r;break;case 1:h(e[d++],e[d++]);break;case 2:{const t=o,i=r,s=e[d++],n=e[d++],a=e[d++],l=e[d++],c=e[d++],u=e[d++],p=sa(t,i,s,n,a,l,c,u);for(const e of p)h(Jn(t,s,a,c,e),Jn(i,n,l,u,e));h(c,u);break}case 3:h(l,c),l=Number.NaN,c=Number.NaN}return new fs(s,i,n-s,a-i)}};function la(t,e,i){const s=Math.round(e*t)/t;return null==i?s:0===i?0:i<1?Math.ceil(i*t)/t:Math.round((i+e)*t)/t-s}function ca(t,e){return Math.floor(e*t)/t}function ha(t,e,i){const{width:s,height:n,padding:a,strokeWidth:o}=e,r=s/2,l=n/2,c=Math.max(1,s-a-o/2),h=Math.max(1,n-a-o/2);let d=!1;for(const[e,s]of i){const i=r+(e-.5)*c,n=l+(s-.5)*h;d?t.lineTo(i,n):t.moveTo(i,n),d=!0}t.closePath()}var da={circles(t,{width:e,strokeWidth:i,padding:s}){const n=e/2,a=Math.max(1,n-s-i/2);t.arc(n,n,a,0,2*Math.PI)},squares(t,{width:e,height:i,pixelRatio:s,padding:n,strokeWidth:a}){const o=n+a/2;t.moveTo(la(s,o),la(s,o)),t.lineTo(la(s,e-o),la(s,o)),t.lineTo(la(s,e-o),la(s,i-o)),t.lineTo(la(s,o),la(s,i-o)),t.closePath()},triangles(t,e){ha(t,e,[[.5,0],[1,1],[0,1]])},diamonds(t,e){ha(t,e,[[.5,0],[1,.5],[.5,1],[0,.5]])},stars(t,{width:e,height:i,padding:s}){const n=Math.max(1,(e-s)/2),a=n/2,o=Math.PI/2;for(let s=0;s<10;s++){const r=s%2==0?n:a,l=s*Math.PI/5-o,c=e/2+Math.cos(l)*r,h=i/2+Math.sin(l)*r;t.lineTo(c,h)}t.closePath()},hearts(t,{width:e,height:i,padding:s}){const n=Math.max(1,e/4-s/2),a=e/2,o=i/2+n/2;t.arc(a-n,o-n,n,pn(130),pn(330)),t.arc(a+n,o-n,n,pn(220),pn(50)),t.lineTo(a,o+n),t.closePath()},crosses(t,e){ha(t,e,[[.25,0],[.5,.25],[.75,0],[1,.25],[.75,.5],[1,.75],[.75,1],[.5,.75],[.25,1],[0,.75],[.25,.5],[0,.25]])},"vertical-lines"(t,{width:e,height:i,pixelRatio:s,strokeWidth:n}){const a=la(s,e/2)-n%2/2;t.moveTo(a,0),t.lineTo(a,i)},"horizontal-lines"(t,{width:e,height:i,pixelRatio:s,strokeWidth:n}){const a=la(s,i/2)-n%2/2;t.moveTo(0,a),t.lineTo(e,a)},"forward-slanted-lines"(t,{width:e,height:i,strokeWidth:s}){const n=Math.atan2(i,e),a=s*Math.cos(n),o=s*Math.sin(n);t.moveTo(-a,o),t.lineTo(a,-o),t.moveTo(-a,i+o),t.lineTo(e+a,-o),t.moveTo(e-a,i+o),t.lineTo(e+a,i-o)},"backward-slanted-lines"(t,{width:e,height:i,strokeWidth:s}){const n=Math.atan2(i,e),a=s*Math.cos(n),o=s*Math.sin(n);t.moveTo(e-a,-o),t.lineTo(e+a,o),t.moveTo(-a,-o),t.lineTo(e+a,i+o),t.moveTo(-a,i-o),t.lineTo(a,i+o)}},ua=class{constructor(t){this._cache=void 0,this.width=Math.max(t?.width??10,1),this.height=Math.max(t?.height??10,1),this.fill=t.fill??"none",this.fillOpacity=t.fillOpacity??1,this.backgroundFill=t.backgroundFill??"none",this.backgroundFillOpacity=t.backgroundFillOpacity??1,this.stroke=t.stroke??"black",this.strokeOpacity=t.strokeOpacity??1,this.strokeWidth=t.strokeWidth??1,this.padding=t.padding??1,this.pattern=t.pattern??"forward-slanted-lines",this.rotation=t.rotation??0,this.scale=t.scale??1,this.path=t.path}getPath(t){const{pattern:e,width:i,height:s,padding:n,strokeWidth:a,path:o}=this,r=new ra;let l=null!=da[e];return o&&l&&(l=!r.appendSvg(o)),l&&da[e](r,{width:i,height:s,pixelRatio:t,strokeWidth:a,padding:n}),r}renderStroke(t,e){const{stroke:i,strokeWidth:s,strokeOpacity:n}=this;s&&(e.strokeStyle=i,e.lineWidth=s,e.globalAlpha=n,e.stroke(t))}renderFill(t,e){const{fill:i,fillOpacity:s}=this;"none"!==i&&(e.fillStyle=i,e.globalAlpha=s,e.fill(t))}createCanvasPattern(t,e){const{width:s,height:n,scale:a,backgroundFill:o,backgroundFillOpacity:r}=this;if(s*a<1||n*a<1)return i.warnOnce("Pattern fill is too small to render, ignoring."),null;const l=new Is({width:s,height:n,pixelRatio:e*a}),c=l.context;"none"!==o&&(c.fillStyle=o,c.globalAlpha=r,c.fillRect(0,0,s,n));const h=this.getPath(e).getPath2D();this.renderFill(h,c),this.renderStroke(h,c);const d=t.createPattern(l.canvas,"repeat");return this.setPatternTransform(d,e),l.destroy(),d}setPatternTransform(t,e,i=0,s=0){if(null==t)return;const n=xn(this.rotation),a=1/e,o=Math.cos(n)*a,r=Math.sin(n)*a;t.setTransform(new DOMMatrix([o,r,-r,o,i,s]))}createPattern(t,e){if(null!=this._cache&&this._cache.ctx===t&&this._cache.pixelRatio===e)return this._cache.pattern;const i=this.createCanvasPattern(t,e);return null!=i?(this._cache={ctx:t,pattern:i,pixelRatio:e},i):void 0}toSvg(){const{width:t,height:e,fill:i,fillOpacity:s,backgroundFill:n,backgroundFillOpacity:a,stroke:o,strokeWidth:r,strokeOpacity:l,rotation:c,scale:h}=this,d=B("pattern");d.setAttribute("viewBox",`0 0 ${t} ${e}`),d.setAttribute("width",String(t)),d.setAttribute("height",String(e)),d.setAttribute("patternUnits","userSpaceOnUse");const u=B("rect");u.setAttribute("x","0"),u.setAttribute("y","0"),u.setAttribute("width",String(t)),u.setAttribute("height",String(e)),u.setAttribute("fill",n),u.setAttribute("fill-opacity",String(a)),d.appendChild(u);const p=B("path");return p.setAttribute("fill",i),p.setAttribute("fill-opacity",String(s)),p.setAttribute("stroke-opacity",String(l)),p.setAttribute("stroke",o),p.setAttribute("stroke-width",String(r)),p.setAttribute("transform",`rotate(${c}) scale(${h})`),p.setAttribute("d",this.getPath(1).toSVG()),d.appendChild(p),d}};function pa(t){return W(t)&&"gradient"==t.type}function ga(t){return G(t)&&t.every(t=>"string"==typeof t)}function ma(t){return null!==t&&W(t)&&"pattern"==t.type}function fa(t){return null!==t&&W(t)&&"image"==t.type}function ya(t){return pa(t)||ma(t)}function xa(t,e){const{fontStyle:i,fontWeight:s,fontSize:n,fontFamily:a}=e;i&&t.setAttribute("font-style",i),s&&t.setAttribute("font-weight",String(s)),null!=n&&t.setAttribute("font-size",String(n)),a&&t.setAttribute("font-family",a)}var ba=class extends on{constructor(){super(...arguments),this.drawingMode="overlay",this.fillOpacity=1,this.strokeOpacity=1,this.fill="black",this.strokeWidth=0,this.lineDashOffset=0,this.opacity=1}getGradient(t){if(pa(t))return this.createGradient(t)}createGradient(t){const{colorSpace:e="rgb",gradient:i="linear",colorStops:s,rotation:n=0,reverse:a=!1}=t;if(null==s)return;let o=Vn(s,["black"],[0,1]);switch(a&&(o=o.map(t=>({color:t.color,stop:1-t.stop})).reverse()),i){case"linear":return new On(e,o,n);case"radial":return new Rn(e,o);case"conic":return new En(e,o,n)}}getPattern(t){if(ma(t))return this.createPattern(t)}createPattern(t){return new ua(t)}getImage(t){if(fa(t))return this.createImage(t)}createImage(t){return new Gn(this.imageLoader,t)}onFillChange(){"object"==typeof this.fill&&Rs(this._cachedFill??{},this.fill)||(this.fillGradient=this.getGradient(this.fill),this.fillPattern=this.getPattern(this.fill),this.fillImage=this.getImage(this.fill),this._cachedFill=this.fill)}onStrokeChange(){this.strokeGradient=this.getGradient(this.stroke)}align(t,e){return la(this.layerManager?.canvas?.pixelRatio??1,t,e)}markDirty(t){super.markDirty(t),this.cachedDefaultGradientFillBBox=void 0}fillStroke(t,e){"cutout"===this.drawingMode&&(t.globalCompositeOperation="destination-out",this.executeFill(t,e),this.executeStroke(t,e),t.globalCompositeOperation="source-over"),this.renderFill(t,e),this.renderStroke(t,e)}renderFill(t,e){const{fill:i,fillOpacity:s,fillImage:n}=this;if(null!=i&&"none"!==i&&s>0){const{globalAlpha:i}=t;n&&(t.globalAlpha=n.backgroundFillOpacity,t.fillStyle=n.backgroundFill,this.executeFill(t,e),t.globalAlpha=i),this.applyFillAndAlpha(t),this.applyShadow(t),this.executeFill(t,e),t.globalAlpha=i,t.shadowColor="rgba(0, 0, 0, 0)"}}executeFill(t,e){e?t.fill(e):t.fill()}applyFillAndAlpha(t){const{fill:e,fillGradient:i,fillPattern:s,fillImage:n,fillOpacity:a=1,opacity:o=1}=this;if(t.globalAlpha*=o*a,i){const{fillBBox:e=this.getDefaultGradientFillBBox()??this.getBBox(),fillParams:s}=this;t.fillStyle=i.createGradient(t,e,s)??"black"}else if(s){const{x:e,y:i}=this.getBBox(),n=this.layerManager?.canvas?.pixelRatio??1,a=s.createPattern(t,n);s.setPatternTransform(a,n,e,i),a?t.fillStyle=a:(t.fillStyle=s.fill,t.globalAlpha*=s.fillOpacity)}else if(n){const e=this.getBBox(),i=n.createPattern(t,e.width,e.height,this);n.setImageTransform(i,e),t.fillStyle=i??"transparent"}else t.fillStyle="string"==typeof e?e:"black"}applyStrokeAndAlpha(t){const{stroke:e,strokeOpacity:i=1,strokeGradient:s,opacity:n=1}=this;t.strokeStyle=s?.createGradient(t,this.getBBox())??("string"==typeof e?e:void 0)??"black",t.globalAlpha*=n*i}applyShadow(t){const e=this.layerManager?.canvas.pixelRatio??1,i=this.fillShadow;i?.enabled&&(t.shadowColor=i.color,t.shadowOffsetX=i.xOffset*e,t.shadowOffsetY=i.yOffset*e,t.shadowBlur=i.blur*e)}renderStroke(t,e){const{stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:a,lineDashOffset:o,lineCap:r,lineJoin:l,miterLimit:c}=this;if(null!=i&&"none"!==i&&s>0&&n>0){const{globalAlpha:i}=t;this.applyStrokeAndAlpha(t),t.lineWidth=s,a&&t.setLineDash(a),o&&(t.lineDashOffset=o),r&&(t.lineCap=r),l&&(t.lineJoin=l),null!=c&&(t.miterLimit=c),this.executeStroke(t,e),t.globalAlpha=i}}executeStroke(t,e){e?t.stroke(e):t.stroke()}getDefaultGradientFillBBox(){return this.cachedDefaultGradientFillBBox??(this.cachedDefaultGradientFillBBox=Object.freeze(this.computeDefaultGradientFillBBox())),this.cachedDefaultGradientFillBBox}computeDefaultGradientFillBBox(){}containsPoint(t,e){return this.isPointInPath(t,e)}applySvgFillAttributes(t,e){const{fill:i,fillOpacity:s}=this;if("string"==typeof i)t.setAttribute("fill",i);else if(pa(i)&&this.fillGradient){e??(e=[]);const i=this.fillGradient.toSvg(this.fillBBox??this.getBBox()),s=Pi();i.setAttribute("id",s),e.push(i),t.setAttribute("fill",`url(#${s})`)}else if(ma(i)&&this.fillPattern){e??(e=[]);const i=this.fillPattern.toSvg(),s=Pi();i.setAttribute("id",s),e.push(i),t.setAttribute("fill",`url(#${s})`)}else if(fa(i)&&this.fillImage){e??(e=[]);const i=this.layerManager?.canvas?.pixelRatio??1,s=this.fillImage.toSvg(this.getBBox(),i),n=Pi();s.setAttribute("id",n),e.push(s),t.setAttribute("fill",`url(#${n})`)}else t.setAttribute("fill","none");return t.setAttribute("fill-opacity",String(s)),e}applySvgStrokeAttributes(t){const{stroke:e,strokeOpacity:i,strokeWidth:s,lineDash:n,lineDashOffset:a}=this;!function(t,e){const{stroke:i,strokeWidth:s,strokeOpacity:n}=e;i&&t.setAttribute("stroke",i),null!=s&&t.setAttribute("stroke-width",String(s)),null!=n&&t.setAttribute("stroke-opacity",String(n))}(t,{stroke:Z(e)?e:void 0,strokeOpacity:i,strokeWidth:s}),function(t,e){const{lineDash:i,lineDashOffset:s}=e;if(i?.some(t=>0!==t)){const e=i.length%2==1?[...i,...i]:i;t.setAttribute("stroke-dasharray",e.join(" ")),null!=s&&t.setAttribute("stroke-dashoffset",String(s))}}(t,{lineDash:n,lineDashOffset:a})}};ls([Xs()],ba.prototype,"drawingMode",2),ls([Xs()],ba.prototype,"fillOpacity",2),ls([Xs()],ba.prototype,"strokeOpacity",2),ls([qs({equals:Rs,changeCb:t=>t.onFillChange()})],ba.prototype,"fill",2),ls([qs({equals:Rs,changeCb:t=>t.onStrokeChange()})],ba.prototype,"stroke",2),ls([Xs()],ba.prototype,"strokeWidth",2),ls([Js()],ba.prototype,"lineDash",2),ls([Xs()],ba.prototype,"lineDashOffset",2),ls([Xs()],ba.prototype,"lineCap",2),ls([Xs()],ba.prototype,"lineJoin",2),ls([Xs()],ba.prototype,"miterLimit",2),ls([Xs({convertor:t=>C(0,t??1,1)})],ba.prototype,"opacity",2),ls([qs({equals:Zs,checkDirtyOnAssignment:!0})],ba.prototype,"fillShadow",2),ls([qs({equals:yi,changeCb:t=>t.onFillChange()})],ba.prototype,"fillBBox",2),ls([qs({equals:Rs,changeCb:t=>t.onFillChange()})],ba.prototype,"fillParams",2);var va=[1,0,0,1,0,0],Ma=class t{get e(){return[...this.elements]}constructor(t=va){this.elements=[...t]}setElements(t){const e=this.elements;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],this}get identity(){const t=this.elements;return N(t[0],1)&&N(t[1],0)&&N(t[2],0)&&N(t[3],1)&&N(t[4],0)&&N(t[5],0)}AxB(t,e,i){const s=t[0]*e[0]+t[2]*e[1],n=t[1]*e[0]+t[3]*e[1],a=t[0]*e[2]+t[2]*e[3],o=t[1]*e[2]+t[3]*e[3],r=t[0]*e[4]+t[2]*e[5]+t[4],l=t[1]*e[4]+t[3]*e[5]+t[5];(i=i??t)[0]=s,i[1]=n,i[2]=a,i[3]=o,i[4]=r,i[5]=l}multiplySelf(t){return this.AxB(this.elements,t.elements),this}multiply(e){const i=[Number.NaN,Number.NaN,Number.NaN,Number.NaN,Number.NaN,Number.NaN];return e instanceof t?this.AxB(this.elements,e.elements,i):this.AxB(this.elements,[e.a,e.b,e.c,e.d,e.e,e.f],i),new t(i)}preMultiplySelf(t){return this.AxB(t.elements,this.elements,this.elements),this}inverse(){const e=this.elements;let i=e[0],s=e[1],n=e[2],a=e[3];const o=e[4],r=e[5],l=1/(i*a-s*n);return i*=l,s*=l,n*=l,a*=l,new t([a,-s,-n,i,n*r-a*o,s*o-i*r])}invertSelf(){const t=this.elements;let e=t[0],i=t[1],s=t[2],n=t[3];const a=t[4],o=t[5],r=1/(e*n-i*s);return e*=r,i*=r,s*=r,n*=r,t[0]=n,t[1]=-i,t[2]=-s,t[3]=e,t[4]=s*o-n*a,t[5]=i*a-e*o,this}transformPoint(t,e){const i=this.elements;return{x:t*i[0]+e*i[2]+i[4],y:t*i[1]+e*i[3]+i[5]}}transformBBox(t,e){const i=this.elements,s=i[0],n=i[1],a=i[2],o=i[3],r=.5*t.width,l=.5*t.height,c=t.x+r,h=t.y+l,d=Math.abs(r*s)+Math.abs(l*a),u=Math.abs(r*n)+Math.abs(l*o);return e??(e=new fs(0,0,0,0)),e.x=c*s+h*a+i[4]-d,e.y=c*n+h*o+i[5]-u,e.width=d+d,e.height=u+u,e}toContext(t){if(this.identity)return;const e=this.elements;t.transform(e[0],e[1],e[2],e[3],e[4],e[5])}static updateTransformMatrix(t,e,i,s,n,a,o){const r=e,l=i;let c,h;1===r&&1===l?(c=0,h=0):(c=o?.scalingCenterX??0,h=o?.scalingCenterY??0);const d=s,u=Math.cos(d),p=Math.sin(d);let g,m;0===d?(g=0,m=0):(g=o?.rotationCenterX??0,m=o?.rotationCenterY??0);const f=n,y=a,x=c*(1-r)-g,b=h*(1-l)-m;return t.setElements([u*r,p*r,-p*l,u*l,u*x-p*b+g+f,p*x+u*b+m+y]),t}};function Sa(t){return Da(t.constructor)}var Ia=Symbol("isMatrixTransform");function Da(t){return!0===t[Ia]}function ka(t){var e;const i=t;if(Da(t))return t;const s=Symbol("matrix_combined_transform");class n extends i{constructor(){super(...arguments),this[e]=new Ma,this._dirtyTransform=!0}onChangeDetection(t){super.onChangeDetection(t),this._dirtyTransform=!0,this.batchLevel>0||this.markDirty("transform")}updateMatrix(t){}computeTransformMatrix(){this._dirtyTransform&&(this[s].setElements(va),this.updateMatrix(this[s]),this._dirtyTransform=!1)}toParent(t){return this.computeTransformMatrix(),this[s].identity?t.clone():this[s].transformBBox(t)}toParentPoint(t,e){return this.computeTransformMatrix(),this[s].identity?{x:t,y:e}:this[s].transformPoint(t,e)}fromParent(t){return this.computeTransformMatrix(),this[s].identity?t.clone():this[s].inverse().transformBBox(t)}fromParentPoint(t,e){return this.computeTransformMatrix(),this[s].identity?{x:t,y:e}:this[s].inverse().transformPoint(t,e)}computeBBox(){const t=super.computeBBox();return t?this.toParent(t):t}computeBBoxWithoutTransforms(){return super.computeBBox()}pickNode(t,e){return({x:t,y:e}=this.fromParentPoint(t,e)),super.pickNode(t,e)}pickNodes(t,e,i){return({x:t,y:e}=this.fromParentPoint(t,e)),super.pickNodes(t,e,i)}render(t){this.computeTransformMatrix();const{ctx:e}=t,i=this[s];let n=!1;try{i.identity||(e.save(),n=!0,i.toContext(e)),super.render(t)}finally{n&&e.restore()}}toSVG(){this.computeTransformMatrix();const t=super.toSVG(),e=this[s];if(e.identity||null==t)return t;const i=B("g");i.append(...t.elements);const[n,a,o,r,l,c]=e.e;return i.setAttribute("transform",`matrix(${n} ${a} ${o} ${r} ${l} ${c})`),{elements:[i],defs:t.defs}}}return e=s,n[Ia]=!0,n}function Aa(t){var e;const i=t,s=Symbol("matrix_rotation");class n extends(ka(i)){constructor(){super(...arguments),this[e]=new Ma,this.rotationCenterX=0,this.rotationCenterY=0,this.rotation=0}updateMatrix(t){super.updateMatrix(t);const{rotation:e,rotationCenterX:i,rotationCenterY:n}=this;0!==e&&(Ma.updateTransformMatrix(this[s],1,1,e,0,0,{rotationCenterX:i,rotationCenterY:n}),t.multiplySelf(this[s]))}}return e=s,ls([Xs()],n.prototype,"rotationCenterX",2),ls([Xs()],n.prototype,"rotationCenterY",2),ls([Xs()],n.prototype,"rotation",2),n}function wa(t){return"scalingX"in t&&"scalingY"in t&&"scalingCenterX"in t&&"scalingCenterY"in t}function Ca(t){var e;const i=t,s=Symbol("matrix_scale");class n extends(ka(i)){constructor(){super(...arguments),this[e]=new Ma,this.scalingX=1,this.scalingY=1,this.scalingCenterX=0,this.scalingCenterY=0}updateMatrix(t){super.updateMatrix(t);const{scalingX:e,scalingY:i,scalingCenterX:n,scalingCenterY:a}=this;1===e&&1===i||(Ma.updateTransformMatrix(this[s],e,i,0,0,0,{scalingCenterX:n,scalingCenterY:a}),t.multiplySelf(this[s]))}}return e=s,ls([Xs()],n.prototype,"scalingX",2),ls([Xs()],n.prototype,"scalingY",2),ls([Xs()],n.prototype,"scalingCenterX",2),ls([Xs()],n.prototype,"scalingCenterY",2),n}function Na(t){var e;const i=t,s=Symbol("matrix_translation");class n extends(ka(i)){constructor(){super(...arguments),this[e]=new Ma,this.translationX=0,this.translationY=0}updateMatrix(t){super.updateMatrix(t);const{translationX:e,translationY:i}=this;0===e&&0===i||(Ma.updateTransformMatrix(this[s],1,1,0,e,i),t.multiplySelf(this[s]))}}return e=s,ls([Xs()],n.prototype,"translationX",2),ls([Xs()],n.prototype,"translationY",2),n}var La,Ta=class{static fromCanvas(t,e){const i=[];for(const e of t.traverseUp())Sa(e)&&i.unshift(e);for(const t of i)e=t.fromParent(e);return Sa(t)&&(e=t.fromParent(e)),e}static toCanvas(t,e){null==e?e=t.getBBox():Sa(t)&&(e=t.toParent(e));for(const i of t.traverseUp())Sa(i)&&(e=i.toParent(e));return e}static fromCanvasPoint(t,e,i){const s=[];for(const e of t.traverseUp())Sa(e)&&s.unshift(e);for(const t of s)({x:e,y:i}=t.fromParentPoint(e,i));return Sa(t)&&({x:e,y:i}=t.fromParentPoint(e,i)),{x:e,y:i}}static toCanvasPoint(t,e,i){Sa(t)&&({x:e,y:i}=t.toParentPoint(e,i));for(const s of t.traverseUp())Sa(s)&&({x:e,y:i}=s.toParentPoint(e,i));return{x:e,y:i}}},Ea=class t extends on{constructor(t){super(t),this.childNodes=new Set,this.dirty=!1,this.dirtyZIndex=!1,this.clipRect=void 0,this.opacity=1,this.layer=void 0,this.image=void 0,this._lastWidth=Number.NaN,this._lastHeight=Number.NaN,this._lastDevicePixelRatio=Number.NaN,this.isContainerNode=!0,this.renderToOffscreenCanvas=!0===t?.renderToOffscreenCanvas,this.optimizeForInfrequentRedraws=!0===t?.optimizeForInfrequentRedraws}static is(e){return e instanceof t}static computeChildrenBBox(t,e=!0){return fs.merge(on.extractBBoxes(t,e))}static compareChildren(t,e){return sn(t.zIndex,e.zIndex)||t.serialNumber-e.serialNumber}containsPoint(t,e){return!0}computeBBox(){return t.computeChildrenBBox(this.children())}computeSafeClippingBBox(t){const e=this.computeBBox();if(!0!==e?.isFinite())return;let i=0;for(const t of this.descendants())t instanceof ba&&(i=Math.max(i,t.strokeWidth));const s=Math.max(1,i/2*4),{x:n,y:a}=Ta.toCanvasPoint(this,0,0),o=ca(t,n+e.x-s)-n,r=ca(t,a+e.y-s)-a,l=Math.ceil(e.x+e.width-o+s),c=Math.ceil(e.y+e.height-r+s);return new fs(o,r,l,c)}prepareSharedCanvas(t,e,i){return null==La||La.pixelRatio!==i?La=new Is({width:t,height:e,pixelRatio:i}):La.resize(t,e,i),La}setScene(t){super.setScene(t),this.layer&&(this.scene?.layersManager.removeLayer(this.layer),this.layer=void 0);for(const e of this.children())e.setScene(t)}markDirty(t){this.dirty=!0,super.markDirty(t)}markDirtyChildrenOrder(){super.markDirtyChildrenOrder(),this.dirtyZIndex=!0,this.markDirty()}append(t){for(const i of null!=(e=t)&&"object"==typeof e&&Symbol.iterator in e?e:[e])i.remove(),this.childNodes.add(i),i.parentNode=this,i.setScene(this.scene);var e;this.markDirtyChildrenOrder(),this.markDirty()}appendChild(t){return this.append(t),t}removeChild(t){if(!this.childNodes?.delete(t))throw new Error(`AG Charts - internal error, unknown child node ${t.name??t.id} in $${this.name??this.id}`);t.parentNode=void 0,t.setScene(),this.markDirtyChildrenOrder(),this.markDirty()}clear(){for(const t of this.children())delete t.parentNode,t.setScene();this.childNodes?.clear(),this.markDirty()}pickNode(t,e){if(this.visible&&1!==this.pointerEvents&&this.containsPoint(t,e))if(null!=this.childNodes&&0!==this.childNodes.size){const i=[...this.children()];for(let s=i.length-1;s>=0;s--){const n=i[s].pickNode(t,e);if(null!=n)return n}}else if(!this.isContainerNode)return this}pickNodes(t,e,i=[]){if(!this.visible||1===this.pointerEvents||!this.containsPoint(t,e))return i;this.isContainerNode||i.push(this);for(const s of this.children())s.pickNodes(t,e,i);return i}isDirty(t){const{width:e,height:i,devicePixelRatio:s}=t,{dirty:n,layer:a}=this,o=null!=a&&(this._lastWidth!==e||this._lastHeight!==i),r=this._lastDevicePixelRatio!==s;return this._lastWidth=e,this._lastHeight=i,this._lastDevicePixelRatio=s,n||o||r}preRender(t){let e;if(this.dirty){e=super.preRender(t,0);for(const i of this.children()){const s=i.preRender(t);e.groups+=s.groups,e.nonGroups+=s.nonGroups,e.complexity+=s.complexity}e.groups+=1,e.nonGroups-=1}else e=this.childNodeCounts;return this.renderToOffscreenCanvas&&!this.optimizeForInfrequentRedraws&&e.nonGroups>0&&this.getVisibility()?this.layer??(this.layer=this.layerManager?.addLayer({name:this.name})):null!=this.layer&&(this.layerManager?.removeLayer(this.layer),this.layer=void 0),e}render(t){const{layer:e,renderToOffscreenCanvas:i}=this,s={...t},n=this.isDirty(t);if(this.dirty=!1,!i)return this.renderInContext(s),void super.render(s);const{ctx:a,stats:o,devicePixelRatio:r}=t;let{image:l}=this;if(n){l?.bitmap.close(),l=void 0;const t=e?void 0:this.computeSafeClippingBBox(r),i=(t,...e)=>{const i=t.context;s.ctx=i,t.clear(),i.save();try{i.setTransform(...e),i.globalAlpha=1,this.renderInContext(s)}finally{i.restore(),i.verifyDepthZero?.()}};if(e)i(e,a.getTransform());else if(t){const{x:e,y:s,width:n,height:a}=t,o=this.prepareSharedCanvas(n,a,r);i(o,r,0,0,r,-e*r,-s*r),l={bitmap:o.transferToImageBitmap(),x:e,y:s,width:n,height:a}}this.image=l,o&&o.layersRendered++}else o&&o.layersSkipped++;const{globalAlpha:c}=a;if(a.globalAlpha=c*this.opacity,e){a.save();try{a.resetTransform(),e.drawImage(a)}finally{a.restore()}}else if(l){const{bitmap:t,x:e,y:i,width:s,height:n}=l;a.drawImage(t,0,0,s*r,n*r,e,i,s,n)}a.globalAlpha=c,super.render(s)}applyClip(t,e){const{x:i,y:s,width:n,height:a}=e;t.beginPath(),t.rect(i,s,n,a),t.clip()}renderInContext(e){const{ctx:i,stats:s}=e;this.dirtyZIndex&&(this.sortChildren(t.compareChildren),this.dirtyZIndex=!1),i.save();try{i.globalAlpha*=this.opacity,null!=this.clipRect&&(this.applyClip(i,this.clipRect),e.clipBBox=Ta.toCanvas(this,this.clipRect));for(const t of this.children())t.visible?t.isolatedRender(e):s&&(s.nodesSkipped+=t.childNodeCounts.nonGroups+t.childNodeCounts.groups,s.opsSkipped+=t.childNodeCounts.complexity)}finally{i.restore()}}sortChildren(t){if(!this.childNodes)return;const e=[...this.childNodes].sort(t);this.childNodes.clear();for(const t of e)this.childNodes.add(t)}*children(){yield*this.childNodes}*excludeChildren(t){for(const e of this.children())(t.instance&&!(e instanceof t.instance)||t.name&&e.name!==t.name)&&(yield e)}*descendants(){for(const e of this.children())yield e,e instanceof t&&(yield*e.descendants())}setClipRect(t){this.clipRect=t?Ta.fromCanvas(this,t):void 0}setClipRectCanvasSpace(t){this.clipRect=t}getVisibility(){for(const t of this.traverseUp(!0))if(!t.visible)return!1;return!0}toSVG(){if(!this.visible)return;const t=[],e=[];for(const i of this.children()){const s=i.toSVG();null!=s&&(e.push(...s.elements),null!=s.defs&&t.push(...s.defs))}return{elements:e,defs:t}}};Ea.className="Group",ls([Xs({convertor:t=>C(0,t,1)})],Ea.prototype,"opacity",2);var Oa=Ea,Ra=class extends(Ca(Oa)){},Pa=class extends(Aa(Oa)){},za=class extends(Na(Oa)){},ja=class extends(Aa(Na(Oa))){};function Ba(t,e){return!(null==t||!function(t){return"context"in t}(t)||null==e||"object"!=typeof e||void 0!==e.context||(e.context=t.context,0))}function Fa(t,e,i){if(Array.isArray(t)){for(const e of t)if(Ba(e,i))break}else Ba(t,i);return e(i)}var Va=class{constructor(){this.cache=new WeakMap}call(t,e,i){let s,n=this.cache.get(e);try{s=JSON.stringify(i)}catch{return this.invoke(t,e,n,void 0,i)}return null==n&&(n=new Map,this.cache.set(e,n)),n.has(s)?n.get(s):this.invoke(t,e,n,s,i)}invoke(t,e,s,n,a){try{const i=Fa(t,e,a);return s&&null!=n&&s.set(n,i),i}catch(t){return void i.warnOnce("User callback errored, ignoring",t)}}invalidateCache(){this.cache=new WeakMap}};function Ga(t,e){if(!t)return;const{x:i,y:s,width:n,height:a}=function(t){let{x:e,y:i,width:s,height:n}=t;return(null==s||s>0)&&(null==n||n>0)?t:(null!=e&&null!=s&&s<0&&(s=-s,e-=s),null!=i&&null!=n&&n<0&&(n=-n,i-=n),{x:e,y:i,width:s,height:n})}(e);_a(t.style,"width",n),_a(t.style,"height",a),_a(t.style,"left",i),_a(t.style,"top",s)}function $a(t){const e=Number.parseFloat(t.style.width)||t.offsetWidth,i=Number.parseFloat(t.style.height)||t.offsetHeight;return{x:Number.parseFloat(t.style.left)||t.offsetLeft,y:Number.parseFloat(t.style.top)||t.offsetTop,width:e,height:i}}function Ha(t){if(t.focus({preventScroll:!0}),null==t.lastChild?.textContent)return;const e=P().createRange();e.setStart(t.lastChild,t.lastChild.textContent.length),e.setEnd(t.lastChild,t.lastChild.textContent.length);const i=z().getSelection();i?.removeAllRanges(),i?.addRange(e)}function Ua(){const t=z("navigator");if("scheduling"in t){const e=t.scheduling;if("isInputPending"in e)return e.isInputPending({includeContinuous:!0})}return!1}function Wa(t){return`ag-charts-icon ag-charts-icon-${t}`}function _a(t,e,i){null==i?t.removeProperty(e):t.setProperty(e,`${i}px`)}var Ya="class-instance";function Ka(t,e,i){if(G(e)){if(!G(t)||t.length!==e.length||e.some((e,s)=>null!=Ka(t[s],e,i)))return e}else{if(Y(e)){if(!Y(t))return e;const s={},n=new Set([...Object.keys(t),...Object.keys(e)]);for(const a of n)if(t[a]!==e[a])if(i?.has(a))s[a]=e[a];else if(typeof t[a]==typeof e[a]){const n=Ka(t[a],e[a],i);null!==n&&(s[a]=n)}else s[a]=e[a];return Object.keys(s).length?s:null}if(t!==e)return e}return null}function Za(t,e){for(const i of Object.keys(t))if(t[i]!==e?.[i])return!1;return!0}function Xa(t,e){return G(t)?function(t,e){const s=[],n=e?.seen;for(const a of t)"object"==typeof a&&n?.includes(a)?i.warn("cycle detected in array",a):(n?.push(a),s.push(Xa(a,e)),n?.pop());return s}(t,e):Y(t)?function(t,e){const i={};for(const s of Object.keys(t))e?.assign?.has(s)?i[s]=t[s]:e?.shallow?.has(s)?i[s]=Qa(t[s]):i[s]=Xa(t[s],e);return i}(t,e):t instanceof Map?new Map(Xa(Array.from(t))):Qa(t)}function Qa(t){return G(t)?t.slice(0):Y(t)?{...t}:$(t)?new Date(t):t instanceof RegExp?new RegExp(t.source,t.flags):t}function qa(t,e,i,s,n,a){if(G(t)){a=e(t,s,n,a);let o=0;for(const r of t)a=qa(r,e,i,s?.[o],n,a),o++}else if(Y(t)){a=e(t,s,n,a);for(const o of Object.keys(t))i?.has(o)||(a=qa(t[o],e,i,s?.[o],n,a))}return a}function Ja(t,e,s={}){const{path:n,matcherPath:a=n?.replace(/(\[[0-9+]+])/i,"[]"),skip:o=[]}=s;if(null==t)throw new Error(`AG Charts - target is uninitialised: ${n??"<root>"}`);if(null==e)return t;if(jn(t))return t.set(e);const r=t,l=to(t);for(const c of Object.keys(e)){if(Hs.has(c))continue;const h=`${a?a+".":""}${c}`;if(o.includes(h))continue;const d=e[c],u=`${n?n+".":""}${c}`,p=r.constructor,g=r[c];try{const e=to(g),n=to(d);if(l===Ya&&!(c in t)&&"context"!==c){if(void 0===d)continue;i.warn(`unable to set [${u}] in ${p?.name} - property is unknown`);continue}if(null!=e&&null!=n&&n!==e&&(e!==Ya||"object"!==n)){i.warn(`unable to set [${u}] in ${p?.name} - can't apply type of [${n}], allowed types are: [${e}]`);continue}if(jn(g))void 0===d?g.clear():g.set(d);else if("object"===n&&"context"!==c){if(!(c in r)){i.warn(`unable to set [${u}] in ${p?.name} - property is unknown`);continue}null==g?r[c]=d:Ja(g,d,{...s,path:u,matcherPath:h})}else r[c]=d}catch(t){i.warn(`unable to set [${u}] in [${p?.name}]; nested error is: ${t.message}`)}}return t}function to(t){return null==t?null:function(t){return void 0!==globalThis.window&&t instanceof HTMLElement}(t)||$(t)?"primitive":G(t)?"array":W(t)?Y(t)?"object":Ya:U(t)?"function":"primitive"}var eo=class{constructor(){this.available=!0,this.acquireQueue=[]}acquire(t){return new Promise(e=>{this.acquireQueue.push([t,e]),this.available&&this.dispatchNext().catch(t=>i.errorOnce(t))})}async acquireImmediately(t){return!!this.available&&(await this.acquire(t),!0)}async waitForClearAcquireQueue(){return this.acquire(()=>Promise.resolve(void 0))}async dispatchNext(){this.available=!1;let[t,e]=this.acquireQueue.shift()??[];for(;t;){try{await t(),e?.()}catch(t){i.error("mutex callback error",t),e?.()}[t,e]=this.acquireQueue.shift()??[]}this.available=!0}},io=class{constructor(){this.eventListeners=new Map}addEventListener(t,e){if("function"!=typeof e)throw new TypeError("AG Charts - listener must be a Function");const i=this.eventListeners.get(t);i?i.add(e):this.eventListeners.set(t,new Set([e]))}removeEventListener(t,e){const i=this.eventListeners.get(t);null!=i&&(i.delete(e),0===i.size&&this.eventListeners.delete(t))}hasEventListener(t){return this.eventListeners.has(t)}clearEventListeners(){this.eventListeners.clear()}fireEvent(t){const e=this.eventListeners.get(t.type);if(e)for(const i of e)i(t)}},so=class extends Pn{constructor(t=0,e=t,i=t,s=e){super(),this.top=t,this.right=e,this.bottom=i,this.left=s}};function no(t,e){const i=G(t)?t:t.split(".");if(1===i.length){const[t]=i;return Ns((e,i,s)=>e[t]=s,e=>e[t],e)}return Ns((t,e,s)=>Us(t,i,s),t=>$s(t,i),e)}function ao(t){return Ns((e,i,s)=>e[t]=s)}function oo(t,e){return Ns((i,s,n)=>i[t][e??s]=n)}function ro(t){const{newValue:e,oldValue:i,changeValue:s}=t;return Ns((t,n,a,o)=>(a!==o&&(void 0!==o&&i?.call(t,o),void 0!==a&&e?.call(t,a),s?.call(t,a,o)),a))}function lo(t){return Ls(t)}function co(t,e){let i,s,n=0,a=!1;const o=()=>a,r=()=>{a=!1,s?.(),s=void 0,i=void 0,n>0&&t(l)},l=()=>{const t=n;n=0,a=!0;const i=e({count:t});i?i.then(r,r):r()};return{schedule(e){0!==n||o()||t(l,e),n++},async await(){if(o())for(i??(i=new Promise(t=>{s=t}));o();)await i}}}ls([ws],so.prototype,"top",2),ls([ws],so.prototype,"right",2),ls([ws],so.prototype,"bottom",2),ls([ws],so.prototype,"left",2);var ho=["blur","change","contextmenu","focus","keydown","keyup","click","dblclick","mouseenter","mousemove","mouseleave","wheel","touchstart","touchmove","touchend","touchcancel"];function uo(t,e,i){const{offsetX:s,offsetY:n,clientX:a,clientY:o}=e,{currentX:r,currentY:l}=mo.calcCurrentXY(i,e);return{type:t,device:"mouse",offsetX:s,offsetY:n,clientX:a,clientY:o,currentX:r,currentY:l,sourceEvent:e}}function po(t,e,i){return{type:t,sourceEvent:e}}var go={blur:t=>({type:"blur",sourceEvent:t}),change:t=>({type:"change",sourceEvent:t}),contextmenu:(t,e)=>uo("contextmenu",t,e),focus:t=>({type:"focus",sourceEvent:t}),keydown:t=>({type:"keydown",sourceEvent:t}),keyup:t=>({type:"keyup",sourceEvent:t}),click:(t,e)=>uo("click",t,e),dblclick:(t,e)=>uo("dblclick",t,e),mouseenter:(t,e)=>uo("mouseenter",t,e),mousemove:(t,e)=>uo("mousemove",t,e),mouseleave:(t,e)=>uo("mouseleave",t,e),wheel:t=>{const{offsetX:e,offsetY:i,clientX:s,clientY:n}=t,a=0===t.deltaMode?.01:1;return{type:"wheel",offsetX:e,offsetY:i,clientX:s,clientY:n,deltaX:t.deltaX*a,deltaY:t.deltaY*a,sourceEvent:t}},touchstart:(t,e)=>po("touchstart",t),touchmove:(t,e)=>po("touchmove",t),touchend:(t,e)=>po("touchend",t),touchcancel:(t,e)=>po("touchcancel",t)},mo=class{static alloc(t,e,i){return go[t](e,i)}static isHTMLEvent(t){return ho.includes(t)}static calcCurrentXY(t,e){const i=t.getBoundingClientRect();return{currentX:e.clientX-i.x,currentY:e.clientY-i.y}}},fo=class{constructor(){this.widgetListeners={},this.sourceListeners={}}initSourceHandler(t,e){this.sourceListeners??(this.sourceListeners={}),this.sourceListeners[t]=e}lazyGetWidgetListeners(t,e){var i;if(!(t in(this.sourceListeners??{}))){const i=i=>{const s=mo.alloc(t,i,e.getElement());this.dispatch(t,e,s)},s={};t.startsWith("touch")&&(s.passive=!1),this.initSourceHandler(t,i),e.getElement().addEventListener(t,i,s)}return this.widgetListeners??(this.widgetListeners={}),(i=this.widgetListeners)[t]??(i[t]=[]),this.widgetListeners[t]}add(t,e,i){this.lazyGetWidgetListeners(t,e).push(i)}remove(t,e,i){const s=this.lazyGetWidgetListeners(t,e),n=s.indexOf(i);n>-1&&s.splice(n,1)}destroy(t){if(this.widgetListeners=void 0,this.sourceListeners){for(const[e,i]of ri(this.sourceListeners))t.getElement().removeEventListener(e,i);this.sourceListeners=void 0}}dispatch(t,e,i){for(const s of this.widgetListeners?.[t]??[])s(i,e)}},yo=class{constructor(t,e,i,s){this.glob=t,this.self=e,this.window=z(),this.cleanup=new Mi,this.mousegeneral=t=>{t.stopPropagation(),t.stopImmediatePropagation()},this.mousemove=t=>{t.stopPropagation(),t.stopImmediatePropagation(),this.glob.globalMouseDragCallbacks?.mousemove(t)},this.mouseup=t=>{0===t.button&&(t.stopPropagation(),t.stopImmediatePropagation(),this.glob.globalMouseDragCallbacks?.mouseup(t),this.destroy())};const{window:n,mousegeneral:a,mousemove:o,mouseup:r}=this;this.cleanup.register(F(n,"mousedown",a,{capture:!0}),F(n,"mouseenter",a,{capture:!0}),F(n,"mouseleave",a,{capture:!0}),F(n,"mouseout",a,{capture:!0}),F(n,"mouseover",a,{capture:!0}),F(n,"mousemove",o,{capture:!0}),F(n,"mouseup",r,{capture:!0})),e.mouseDragger=this,t.globalMouseDragCallbacks=i,t.globalMouseDragCallbacks.mousedown(s),s.stopPropagation(),s.stopImmediatePropagation()}destroy(){this.cleanup.flush(),this.glob.globalMouseDragCallbacks=void 0,this.self.mouseDragger=void 0}},xo=!1,bo=class{constructor(t,e,i,s,n){this.glob=t,this.self=e,this.initialTouch=s,this.target=n,this.cleanup=new Mi,this.longTapInterrupted=!1,this.longtap=()=>{const{target:t,initialTouch:e}=this;if(!this.longTapInterrupted){const i=new Mi;t.dispatchEvent(new TouchEvent("touchcancel",{touches:[e],bubbles:!0})),xo=!0;const s=t=>t.preventDefault(),n=t=>{xo=!1,t.preventDefault(),i.flush()};i.register(F(t,"touchmove",s,{passive:!1}),F(t,"touchend",n,{passive:!1}),F(t,"touchcancel",n,{passive:!1}));const{clientX:a,clientY:o}=e,r=new PointerEvent("contextmenu",{bubbles:!0,cancelable:!0,view:z(),clientX:a,clientY:o,pointerType:"touch"});t.dispatchEvent(r)}},this.touchmove=t=>{const{glob:e,self:i,initialTouch:s}=this,n=this.findInitialFinger(t.targetTouches);null!=n&&(this.longTapInterrupted=this.longTapInterrupted||function(t,e){const i=t.clientX-e.clientX,s=t.clientY-e.clientY;return i*i+s*s}(s,n)>100,i.dragTouchEnabled&&e.globalTouchDragCallbacks?.touchmove(t,n))},this.touchend=t=>{this.longTapInterrupted=!0;const e=this.findInitialFinger(t.changedTouches,t.touches);null!=e&&this.glob.globalTouchDragCallbacks?.touchend(t,e),this.destroy()},this.longtapTimer=setTimeout(this.longtap,500);const{touchmove:a,touchend:o}=this;this.cleanup.register(F(n,"touchmove",a,{passive:!1}),F(n,"touchstart",o,{passive:!1}),F(n,"touchend",o,{passive:!1}),F(n,"touchcancel",o,{passive:!1})),e.touchDragger=this,t.globalTouchDragCallbacks=i}destroy(){clearTimeout(this.longtapTimer),this.cleanup.flush(),this.glob.globalTouchDragCallbacks=void 0,this.self.touchDragger=void 0}findInitialFinger(...t){const e=t.flatMap(t=>Array.from(t));return Array.from(e).find(t=>t.identifier===this.initialTouch.identifier)}};function vo(t,e,i,s){const{currentX:n,currentY:a}=mo.calcCurrentXY(t.getElement(),s),o=s.pageX-i.pageX,r=s.pageY-i.pageY;return{type:e,device:"mouse",offsetX:i.offsetX+o,offsetY:i.offsetY+r,clientX:s.clientX,clientY:s.clientY,currentX:n,currentY:a,originDeltaX:o,originDeltaY:r,sourceEvent:s}}function Mo(t,{pageX:e,pageY:i}){const{x:s,y:n}=t.getElement().getBoundingClientRect();return{offsetX:e-s,offsetY:i-n}}function So(t,e,i,s,n){const{currentX:a,currentY:o}=mo.calcCurrentXY(t.getElement(),n),r=n.pageX-i.pageX,l=n.pageY-i.pageY;return{type:e,device:"touch",offsetX:i.offsetX+r,offsetY:i.offsetY+l,clientX:n.clientX,clientY:n.clientY,currentX:a,currentY:o,originDeltaX:r,originDeltaY:l,sourceEvent:s}}var Io,Do={},ko=class{constructor(t){this.dispatchCallback=t,this.dragTouchEnabled=!0}destroy(){this.dragTriggerRemover?.(),this.dragTriggerRemover=void 0,this.listeners?.clear(),this.mouseDragger?.destroy(),this.touchDragger?.destroy()}getListenerSet(t){this.listeners??(this.listeners=new Map);let e=this.listeners.get(t);return void 0===e&&(e=new Set,this.listeners.set(t,e)),e}add(t,e,i){switch(this.getListenerSet(t).add(i),t){case"drag-start":case"drag-move":case"drag-end":this.registerDragTrigger(e)}}remove(t,e,i){this.getListenerSet(t).delete(i)}registerDragTrigger(t){if(null==this.dragTriggerRemover){const e=t.getElement(),i=new Mi;i.register(F(e,"mousedown",e=>this.triggerMouseDrag(t,e)),F(e,"touchstart",e=>this.triggerTouchDrag(t,e),{passive:!1})),this.dragTriggerRemover=()=>i.flush()}}triggerMouseDrag(t,e){0===e.button&&this.startMouseDrag(t,e)}startMouseDrag(t,e){const i={pageX:Number.NaN,pageY:Number.NaN,offsetX:Number.NaN,offsetY:Number.NaN};Ws(["pageX","pageY","offsetX","offsetY"],i,e);const s={mousedown:e=>{const s=vo(t,"drag-start",i,e);this.dispatch("drag-start",t,s)},mousemove:e=>{const s=vo(t,"drag-move",i,e);this.dispatch("drag-move",t,s)},mouseup:e=>{const s=vo(t,"drag-end",i,e);this.dispatch("drag-end",t,s),this.endDrag(t,s)}};this.mouseDragger=function(t,e,i,s){if(null==Do.globalMouseDragCallbacks)return new yo(Do,e,i,s)}(0,this,s,e)}endDrag(t,{sourceEvent:e,clientX:i,clientY:s}){const n=t.getElement();fi(n.getBoundingClientRect(),i,s)||(n.dispatchEvent(new MouseEvent("mouseleave",e)),e.target?.dispatchEvent(new MouseEvent("mouseenter",e)))}triggerTouchDrag(t,e){const i=e.targetTouches[0];1===e.targetTouches.length&&null!=i&&this.startOneFingerTouch(t,e,i)}startOneFingerTouch(t,e,i){const s={pageX:Number.NaN,pageY:Number.NaN,...Mo(t,i)};Ws(["pageX","pageY"],s,i);const n={touchmove:(e,i)=>{const n=So(t,"drag-move",s,e,i);this.dispatch("drag-move",t,n)},touchend:(e,i)=>{const n=So(t,"drag-end",s,e,i);this.dispatch("drag-end",t,n)}},a=t.getElement();this.touchDragger=function(t,e,i,s,n){if(null==Do.globalTouchDragCallbacks&&!xo)return new bo(Do,e,i,s,n)}(0,this,n,i,a);const o=So(t,"drag-start",s,e,i);this.dispatch("drag-start",t,o)}dispatch(t,e,i){for(const s of this.getListenerSet(t))s(i,e);this.dispatchCallback(t,i)}},Ao=class{constructor(t){this.elem=t}setBounds(t){Ga(this.elemContainer??this.elem,t)}getBounds(){return $a(this.elemContainer??this.elem)}static setElementContainer(t,e){Ga(e,t.getBounds()),function(t){for(const[e,i]of ri({width:"100%",height:"100%"}))gi(t,e,i)}(t.elem),t.elem.remove(),t.elemContainer=e,t.elemContainer.replaceChildren(t.elem)}},wo=class extends Ao{constructor(){super(...arguments),this.index=Number.NaN,this.children=[]}set id(t){di(this.elem,"id",t)}get id(){return pi(this.elem,"id")}getElement(){return this.elem}getBoundingClientRect(){return this.elem.getBoundingClientRect()}get clientWidth(){return this.elem.clientWidth}get clientHeight(){return this.elem.clientHeight}destroy(){this.destroyListener?.(),this.destroyListener=void 0,this.remove();for(const t of this.children)t.parent=void 0,t.destroy();this.children.length=0,this.destructor(),this.remove(),this.internalListener?.destroy(),this.htmlListener?.destroy(this)}remove(){this.elem.remove(),this.elemContainer?.remove()}setHidden(t){gi(this.elem,"display",t?"none":void 0)}isHidden(){return"none"===z()?.getComputedStyle?.(this.elem).display}setCursor(t){gi(this.elem,"cursor",t)}setTextContent(t){this.elem.textContent=t??null}setAriaDescribedBy(t){di(this.elem,"aria-describedby",t)}setAriaHidden(t){di(this.elem,"aria-hidden",t)}setAriaLabel(t){di(this.elem,"aria-label",t)}setAriaExpanded(t){di(this.elem,"aria-expanded",t)}setAriaControls(t){di(this.elem,"aria-controls",t)}setAriaHasPopup(t){di(this.elem,"aria-haspopup",t)}setInnerHTML(t){this.elem.innerHTML=t}setPointerEvents(t){gi(this.elem,"pointer-events",t)}setCSSVariable(t,e){this.elem.style.setProperty(t,e)}isDisabled(){return pi(this.elem,"aria-disabled",!1)}hasPopup(){const t=pi(this.elem,"aria-haspopup");return void 0!==t&&"false"!==t}parseFloat(t){return""===t?0:Number.parseFloat(t)}cssLeft(){return this.parseFloat(this.elem.style.left)}cssTop(){return this.parseFloat(this.elem.style.top)}cssWidth(){return this.parseFloat(this.elem.style.width)}cssHeight(){return this.parseFloat(this.elem.style.height)}focus(t){this.elem.focus(t)}setFocusOverride(t){di(this.elem,"data-focus-override",t)}setPreventsDefault(t){di(this.elem,"data-preventdefault",t)}setTabIndex(t){di(this.elem,"tabindex",t)}addChild(t){this.addChildToDOM(t,this.getBefore(t)),this.children.push(t),t.index=this.children.length-1,t.parent=this,this.onChildAdded(t)}removeChild(t){const e=this.children.indexOf(t);this.children.splice(e,1),this.removeChildFromDOM(t),this.onChildRemoved(t)}moveChild(t,e){t.domIndex!==e&&(t.domIndex=e,this.removeChildFromDOM(t),this.addChildToDOM(t,this.getBefore(t)))}addClass(...t){this.elem.classList.add(...t)}removeClass(...t){this.elem.classList.remove(...t)}toggleClass(t,e){this.elem.classList.toggle(t,e)}appendOrInsert(t,e){e?e.getElement().insertAdjacentElement("beforebegin",t):this.elem.appendChild(t)}addChildToDOM(t,e){this.appendOrInsert(t.getElement(),e)}removeChildFromDOM(t){t.getElement().remove()}onChildAdded(t){}onChildRemoved(t){}getBefore({domIndex:t}){if(void 0!==t)return this.children.filter(e=>void 0!==e.domIndex&&e.domIndex>t).reduce((t,e)=>!t||e.domIndex<t.domIndex?e:t,void 0)}addListener(t,e){return mo.isHTMLEvent(t)?(this.htmlListener??(this.htmlListener=new fo),this.htmlListener.add(t,this,e)):(this.internalListener??(this.internalListener=new ko(this.onDispatch.bind(this))),this.internalListener.add(t,this,e)),()=>this.removeListener(t,e)}removeListener(t,e){mo.isHTMLEvent(t)?this.htmlListener?.remove(t,this,e):null!=this.htmlListener&&this.internalListener?.remove(t,this,e)}setDragTouchEnabled(t){this.internalListener??(this.internalListener=new ko(this.onDispatch.bind(this))),this.internalListener.dragTouchEnabled=t}onDispatch(t,e){if(!e.sourceEvent?.bubbles)return;let{parent:i}=this;for(;null!=i;){const{internalListener:s}=i;if(null!=s){const n={...e,...mo.calcCurrentXY(i.getElement(),e)};s.dispatch(t,i,n)}i=i.parent}}static addWindowEvent(t,e){return F(z(),"pagehide",t=>{t.persisted||e()})}},Co=class{constructor(){this.stats=new Map,this.lastLogTime=Date.now(),this.LOG_INTERVAL_MS=1e4,this.startPeriodicLogging()}startPeriodicLogging(){bs.check("scene:stats","scene:stats:verbose")&&(this.stopPeriodicLogging(),this.intervalId=setInterval(()=>{this.logAccumulatedStats()},this.LOG_INTERVAL_MS))}stopPeriodicLogging(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0)}recordTiming(t,e){const i=this.stats.get(t);i?(i.min=Math.min(i.min,e),i.max=Math.max(i.max,e),i.sum+=e,i.count+=1):this.stats.set(t,{min:e,max:e,sum:e,count:1})}recordTimings(t){for(const[e,i]of Object.entries(t))"start"!==e&&"number"==typeof i&&this.recordTiming(e,i)}logAccumulatedStats(){if(0===this.stats.size)return;const t=(Date.now()-this.lastLogTime)/1e3,e=Array.from(this.stats.keys()).sort((t,e)=>"⏱️"===t?-1:"⏱️"===e?1:t.localeCompare(e)),s=[];for(const t of e){const e=this.stats.get(t),i=e.sum/e.count;s.push(`${t}[${e.min.toFixed(1)}/${i.toFixed(1)}/${e.max.toFixed(1)}]ms`)}const n=this.stats.get("⏱️"),a=n?.count??0;i.log(`📊 Stats (${t.toFixed(0)}s, ${a} renders): ${s.join(" ")}`),this.stats.clear(),this.lastLogTime=Date.now()}destroy(){this.stopPeriodicLogging(),this.stats.clear()}},No=0;function Lo(t){for(const e of["B","KB","MB","GB"]){if(t<1536)return`${t.toFixed(1)}${e}`;t/=1024}return`${t.toFixed(1)}TB}`}function To(t,e,s,n,a={},o=fs.zero){if(!bs.check("scene:stats","scene:stats:verbose"))return;const{layersRendered:r=0,layersSkipped:l=0,nodesRendered:c=0,nodesSkipped:h=0,opsPerformed:d=0,opsSkipped:u=0}=n??{},p=performance.now(),{start:g,...m}=e,f=p-g,y=(Io??(Io=new Co),Io);y.recordTimings(m),y.recordTiming("⏱️",f);const x=Object.entries(m).map(([t,e])=>Bo(t,e)).filter(t=>null!=t).join(" + "),b=Object.entries(a).map(([t,e])=>`${t}: ${JSON.stringify(e)}`).join(" ; "),v=bs.check("scene:stats:verbose"),M=v?function(){if(!("memory"in performance))return;const{totalJSHeapSize:t,usedJSHeapSize:e,jsHeapSizeLimit:i}=performance.memory,s=[];for(const n of[e,t,i])"number"==typeof n&&s.push(Lo(n));return`Heap ${s.join(" / ")}`}():null,S=[`${Bo("⏱️",g,p)} (${x})`,`${b}`,`Layers: ${v?jo(r,l):t.size}`,v?`Nodes: ${jo(c,h)}`:null,v?`Ops: ${jo(d,u)}`:null,M].filter(Z),I=new Ki(s),D=new Map(S.map(t=>[t,I.measureText(t)])),k=Math.max(...Array.from(D.values(),t=>t.width)),A=function(t,e){let i=0;for(const s of t)i+=e(s);return i}(D.values(),t=>t.height),w=2+o.x;s.save();try{s.fillStyle="white",s.fillRect(w,0,k,A),s.fillStyle="black";let t=0;for(const[e,i]of D.entries())t+=i.height,s.fillText(e,w,t)}catch(t){i.warnOnce("Error during debug stats rendering",t)}finally{s.restore()}}var Eo=new Set,Oo=new Set(["gradient","zIndex","clipRect","cachedBBox","childNodeCounts","path","__zIndex","name","__scalingCenterX","__scalingCenterY","__rotationCenterX","__rotationCenterY","_previousDatum","__fill","__lineDash","borderPath","borderClipPath","_clipPath"]);function Ro(t){const{...e}=t;for(const t of Object.keys(e))Oo.has(t)||"number"!=typeof e[t]&&"string"!=typeof e[t]&&"boolean"!=typeof e[t]&&(Eo.add(t),delete e[t]);return e}function Po(t,e){if(!bs.check(!0,"scene"))return{};let i=0;return{node:"json"===e?Ro(t):t,name:t.name??t.id,dirty:t instanceof Oa?t.dirty:void 0,...Array.from(t instanceof Oa?t.children():[],t=>Po(t,e)).reduce((t,e)=>{let{name:s}=e;const{node:{visible:n,opacity:a,zIndex:o,translationX:r,translationY:l,rotation:c,scalingX:h,scalingY:d},node:u}=e;(!n||a<=0)&&(s=`(${s})`),Oa.is(u)&&u.renderToOffscreenCanvas&&(s=`*${s}*`);const p=Array.isArray(o)?`(${o.join(", ")})`:o,g=[`${(i++).toString().padStart(3,"0")}|`,`${s??"<unknown>"}`,`z: ${p}`,r&&`x: ${r}`,l&&`y: ${l}`,c&&`r: ${c}`,null!=h&&1!==h&&`sx: ${h}`,null!=d&&1!==d&&`sy: ${d}`].filter(t=>!!t).join(" ");let m=g,f=1;for(;null!=t[m]&&f<100;)m=`${g} (${f++})`;return t[m]=e,t},{})}}function zo(t){const e=t instanceof Oa?t.dirty:void 0;if(!e)return{dirtyTree:{},paths:[]};const i=Array.from(t instanceof Oa?t.children():[],t=>zo(t)).filter(t=>t.paths.length>0),s=Oa.is(t)?t.name??t.id:t.id,n=i.length?i.flatMap(t=>t.paths).map(t=>`${s}.${t}`):[s];return{dirtyTree:{name:s,node:t,dirty:e,...i.map(t=>t.dirtyTree).filter(t=>null!=t.dirty).reduce((t,e)=>(t[e.name??"<unknown>"]=e,t),{})},paths:n}}function jo(t,e){const i=t+e;return`${t} / ${i} (${Math.round(100*t/i)}%)`}function Bo(t,e,i){const s=null==i?e:i-e;return`${t}: ${Math.round(100*s)/100}ms`}function Fo(t=!1){Io?!t&&No>0||(Io.destroy(),Io=void 0,t&&(No=0)):t&&(No=0)}var Vo=(t,{x0:e,y0:i,x1:s,y1:n,cx:a,cy:o},r,l)=>{if(l&&t.moveTo(e,i),e!==s||i!==n){const l=Math.atan2(i-o,e-a),c=Math.atan2(n-o,s-a);t.arc(a,o,r,l,c)}else t.lineTo(e,i)},Go=class extends ba{constructor(){super(...arguments),this.path=new ra,this._clipX=Number.NaN,this._clipY=Number.NaN,this.clip=!1,this._dirtyPath=!0,this.lastPixelRatio=Number.NaN}set clipX(t){this._clipX=t,this.dirtyPath=!0}set clipY(t){this._clipY=t,this.dirtyPath=!0}set dirtyPath(t){this._dirtyPath!==t&&(this._dirtyPath=t,t&&this.markDirty("path"))}get dirtyPath(){return this._dirtyPath}checkPathDirty(){this._dirtyPath||(this.dirtyPath=this.path.isDirty()||(this.fillShadow?.isDirty()??!1)||(this._clipPath?.isDirty()??!1))}resetPathDirty(){this.path.clear(!0),this._dirtyPath=!1}isPathDirty(){return this.path.isDirty()}onChangeDetection(t){this._dirtyPath||(this._dirtyPath=!0,super.onChangeDetection(t))}computeBBox(){return this.updatePathIfDirty(),this.path.computeBBox()}isPointInPath(t,e){return this.updatePathIfDirty(),this.path.closedPath&&this.path.isPointInPath(t,e)}distanceSquared(t,e){return this.distanceSquaredTransformedPoint(t,e)}svgPathData(t){return this.updatePathIfDirty(),this.path.toSVG(t)}distanceSquaredTransformedPoint(t,e){return this.updatePathIfDirty(),this.path.closedPath&&this.path.isPointInPath(t,e)?0:this.path.distanceSquared(t,e)}isDirtyPath(){return!1}updatePath(){}updatePathIfDirty(){(this.dirtyPath||this.isDirtyPath())&&(this.updatePath(),this.dirtyPath=!1)}preRender(t){return t.devicePixelRatio!==this.lastPixelRatio&&(this.dirtyPath=!0),this.lastPixelRatio=t.devicePixelRatio,this.updatePathIfDirty(),super.preRender(t,this.path.commands.length)}render(t){const{ctx:e}=t;if(!this.clip||Number.isNaN(this._clipX)||Number.isNaN(this._clipY))this._clipPath=void 0,this.drawPath(e);else{e.save();try{const t=this.strokeWidth/2;this._clipPath??(this._clipPath=new ra),this._clipPath.clear(),this._clipPath.rect(-t,-t,this._clipX+t,this._clipY+t+t),e.clip(this._clipPath?.getPath2D()),this._clipX>0&&this._clipY>0&&this.drawPath(e)}finally{e.restore()}}this.fillShadow?.markClean(),super.render(t)}drawPath(t){this.fillStroke(t,this.path.getPath2D())}toSVG(){if(!this.visible)return;const t=B("path");t.setAttribute("d",this.svgPathData());const e=this.applySvgFillAttributes(t,[]);return this.applySvgStrokeAttributes(t),{elements:[t],defs:e}}};Go.className="Path",ls([Xs()],Go.prototype,"clip",2),ls([Xs()],Go.prototype,"clipX",1),ls([Xs()],Go.prototype,"clipY",1);var $o=(t,e,i,s,n)=>{let a=!1,o=!1,r=s-Math.sqrt(Math.max(n**2-i**2,0)),l=0,c=0,h=i-Math.sqrt(Math.max(n**2-s**2,0));return r>t?(a=!0,r=t,l=i-Math.sqrt(Math.max(n**2-(s-t)**2))):N(r,0)&&(r=0),h>e?(o=!0,c=s-Math.sqrt(Math.max(n**2-(i-e)**2)),h=e):N(h,0)&&(h=0),{leading0:r,leading1:l,trailing0:c,trailing1:h,leadingClipped:a,trailingClipped:o}},Ho=(t,e,i,s,n,a,o)=>{let{topLeft:r,topRight:l,bottomRight:c,bottomLeft:h}=a;const d=Math.max(r+h,l+c),u=Math.max(r+l,h+c);if(d<=0&&u<=0){if(null==o)t.rect(e,i,s,n);else{const a=Math.max(e,o.x),r=Math.min(e+s,o.x+o.width),l=Math.max(i,o.y),c=Math.min(i+n,o.y+o.height);t.rect(a,l,r-a,c-l)}return}if(null==o&&r===l&&r===c&&r===h)return void t.roundRect(e,i,s,n,r);if(s<0&&(e+=s,s=Math.abs(s)),n<0&&(i+=n,n=Math.abs(n)),s<=0||n<=0)return;if(null==o)o=new fs(e,i,s,n);else{const t=Math.max(e,o.x),a=Math.min(e+s,o.x+o.width),r=Math.max(i,o.y),l=Math.min(i+n,o.y+o.height);o=new fs(t,r,a-t,l-r)}const p=Math.max(d/n,u/s,1);p>1&&(r/=p,l/=p,c/=p,h/=p);let g,m,f,y,x=!0,b=!0,v=!0,M=!0;if(x){const t=$o(o.height,o.width,Math.max(e+r-o.x,0),Math.max(i+r-o.y,0),r);t.leadingClipped&&(M=!1),t.trailingClipped&&(b=!1),g={x0:Math.max(o.x+t.leading1,o.x),y0:Math.max(o.y+t.leading0,o.y),x1:Math.max(o.x+t.trailing1,o.x),y1:Math.max(o.y+t.trailing0,o.y),cx:e+r,cy:i+r}}if(b){const t=$o(o.width,o.height,Math.max(i+l-o.y,0),Math.max(o.x+o.width-(e+s-l),0),l);t.leadingClipped&&(x=!1),t.trailingClipped&&(v=!1),m={x0:Math.min(o.x+o.width-t.leading0,o.x+o.width),y0:Math.max(o.y+t.leading1,o.y),x1:Math.min(o.x+o.width-t.trailing0,o.x+o.width),y1:Math.max(o.y+t.trailing1,o.y),cx:e+s-l,cy:i+l}}if(v){const t=$o(o.height,o.width,Math.max(o.x+o.width-(e+s-c),0),Math.max(o.y+o.height-(i+n-c),0),c);t.leadingClipped&&(b=!1),t.trailingClipped&&(M=!1),f={x0:Math.min(o.x+o.width-t.leading1,o.x+o.width),y0:Math.min(o.y+o.height-t.leading0,o.y+o.height),x1:Math.min(o.x+o.width-t.trailing1,o.x+o.width),y1:Math.min(o.y+o.height-t.trailing0,o.y+o.height),cx:e+s-c,cy:i+n-c}}if(M){const t=$o(o.width,o.height,Math.max(o.y+o.height-(i+n-h),0),Math.max(e+h-o.x,0),h);t.leadingClipped&&(v=!1),t.trailingClipped&&(x=!1),y={x0:Math.max(o.x+t.leading0,o.x),y0:Math.min(o.y+o.height-t.leading1,o.y+o.height),x1:Math.max(o.x+t.trailing0,o.x),y1:Math.min(o.y+o.height-t.trailing1,o.y+o.height),cx:e+h,cy:i+n-h}}let S=!1;x&&null!=g&&(Vo(t,g,r,!S),S||(S=!0)),b&&null!=m&&(Vo(t,m,l,!S),S||(S=!0)),v&&null!=f&&(Vo(t,f,c,!S),S||(S=!0)),M&&null!=y&&Vo(t,y,h,!S),t.closePath()},Uo=class extends Go{constructor(){super(...arguments),this.borderPath=new ra,this.x=0,this.y=0,this.width=10,this.height=10,this.topLeftCornerRadius=0,this.topRightCornerRadius=0,this.bottomRightCornerRadius=0,this.bottomLeftCornerRadius=0,this.clipBBox=void 0,this.crisp=!1,this.lastUpdatePathStrokeWidth=this.strokeWidth,this.effectiveStrokeWidth=this.strokeWidth,this.hittester=super.isPointInPath.bind(this),this.distanceCalculator=super.distanceSquaredTransformedPoint.bind(this),this.microPixelEffectOpacity=1}set cornerRadius(t){this.topLeftCornerRadius=t,this.topRightCornerRadius=t,this.bottomRightCornerRadius=t,this.bottomLeftCornerRadius=t}isDirtyPath(){return this.lastUpdatePathStrokeWidth!==this.strokeWidth||Boolean(this.path.isDirty()||this.borderPath.isDirty())}updatePath(){const{path:t,borderPath:e,crisp:i,topLeftCornerRadius:s,topRightCornerRadius:n,bottomRightCornerRadius:a,bottomLeftCornerRadius:o}=this;let{x:r,y:l,width:c,height:h,strokeWidth:d,clipBBox:u}=this;const p=1/(this.layerManager?.canvas.pixelRatio??1);let g=1;if(t.clear(!0),e.clear(!0),0===c||0===h)return this.effectiveStrokeWidth=0,this.lastUpdatePathStrokeWidth=0,void(this.microPixelEffectOpacity=0);if(i&&(c<=p&&(g*=c/p),h<=p&&(g*=h/p),c=this.align(r,c),h=this.align(l,h),r=this.align(r),l=this.align(l),u=null==u?void 0:new fs(this.align(u.x),this.align(u.y),this.align(u.x,u.width),this.align(u.y,u.height))),d)if(c<p){const t=r+p/2;e.moveTo(t,l),e.lineTo(t,l+h),d=p,this.borderClipPath=void 0}else if(h<p){const t=l+p/2;e.moveTo(r,t),e.lineTo(r+c,t),d=p,this.borderClipPath=void 0}else if(d<c&&d<h){const i=d/2;r+=i,l+=i,c-=d,h-=d;const p=u?.clone().shrink(i),g={topLeft:s>0?s-d:0,topRight:n>0?n-d:0,bottomRight:a>0?a-d:0,bottomLeft:o>0?o-d:0};this.borderClipPath=void 0,c>0&&h>0&&(null==p||p?.width>0&&p?.height>0)&&(Ho(t,r,l,c,h,g,p),Ho(e,r,l,c,h,g,p))}else this.borderClipPath=this.borderClipPath??new ra,this.borderClipPath.clear(!0),this.borderClipPath.rect(r,l,c,h),e.rect(r,l,c,h);else{const e={topLeft:s,topRight:n,bottomRight:a,bottomLeft:o};this.borderClipPath=void 0,Ho(t,r,l,c,h,e,u)}if([s,n,a,o].every(t=>0===t)){const t=this.getBBox();this.hittester=t.containsPoint.bind(t),this.distanceSquared=(t,e)=>this.getBBox().distanceSquared(t,e)}else this.hittester=super.isPointInPath,this.distanceCalculator=super.distanceSquaredTransformedPoint;this.effectiveStrokeWidth=d,this.lastUpdatePathStrokeWidth=d,this.microPixelEffectOpacity=g}computeBBox(){const{x:t,y:e,width:i,height:s,clipBBox:n}=this;return n?.clone()??new fs(t,e,i,s)}isPointInPath(t,e){return this.hittester(t,e)}get midPoint(){return{x:this.x+this.width/2,y:this.y+this.height/2}}distanceSquared(t,e){return this.distanceCalculator(t,e)}applyFillAndAlpha(t){super.applyFillAndAlpha(t),t.globalAlpha*=this.microPixelEffectOpacity}applyStrokeAndAlpha(t){super.applyStrokeAndAlpha(t),t.globalAlpha*=this.microPixelEffectOpacity}renderStroke(t){const{stroke:e,effectiveStrokeWidth:i}=this;if(e&&i){const{globalAlpha:e}=t,{lineDash:s,lineDashOffset:n,lineCap:a,lineJoin:o,borderPath:r,borderClipPath:l}=this;l&&t.clip(l.getPath2D()),this.applyStrokeAndAlpha(t),t.lineWidth=i,s&&t.setLineDash(s),n&&(t.lineDashOffset=n),a&&(t.lineCap=a),o&&(t.lineJoin=o),t.stroke(r.getPath2D()),t.globalAlpha=e}}};Uo.className="Rect",ls([Xs()],Uo.prototype,"x",2),ls([Xs()],Uo.prototype,"y",2),ls([Xs()],Uo.prototype,"width",2),ls([Xs()],Uo.prototype,"height",2),ls([Xs()],Uo.prototype,"topLeftCornerRadius",2),ls([Xs()],Uo.prototype,"topRightCornerRadius",2),ls([Xs()],Uo.prototype,"bottomRightCornerRadius",2),ls([Xs()],Uo.prototype,"bottomLeftCornerRadius",2),ls([qs({equals:yi})],Uo.prototype,"clipBBox",2),ls([Xs()],Uo.prototype,"crisp",2);var Wo=class t extends ba{constructor(e){super(e),this.x=0,this.y=0,this.lines=[],this.text=void 0,this.fontCache=void 0,this.fontSize=t.defaultFontSize,this.fontFamily="sans-serif",this.textAlign="start",this.textBaseline="alphabetic",this.boxPadding=0,this.trimText=e?.trimText??!0}onTextChange(){if(this.richText?.clear(),this.textMap?.clear(),G(this.text))this.lines=[],this.richText??(this.richText=new Oa),this.richText.setScene(this.scene),this.richText.append(this.text.flatMap(t=>Z(t.text)?t.text.split(Bi):String(t.text)).filter(Boolean).map(()=>new t({trimText:!1})));else{const t=this.text?.split("\n")??[];this.lines=this.trimText?t.map(t=>t.trim()):t}}get font(){return this.fontCache??(this.fontCache=Vi(this)),this.fontCache}static measureBBox(e,i,s,n){if(G(e)){const{font:a,lineHeight:o,textAlign:r,textBaseline:l}=n,{width:c,height:h,lineMetrics:d}=Qi(e,a),u=o?o*d.length:h,p=t.calcTopOffset(u,d[0],l),g=t.calcLeftOffset(c,r);return new fs(i-g,s-p,c,u)}return t.computeBBox(e?.split(Bi),i,s,n)}static computeBBox(e,i,s,n){const{font:a,lineHeight:o,textAlign:r,textBaseline:l}=n,{width:c,height:h,lineMetrics:d}=Xi(a).measureLines(e),u=o?o*d.length:h,p=t.calcTopOffset(u,d[0],l),g=t.calcLeftOffset(c,r);return new fs(i-g,s-p,c,u)}static calcTopOffset(t,e,i){switch(i){case"alphabetic":return e?.ascent??0;case"middle":return t/2;case"bottom":return t;default:return 0}}static calcLeftOffset(t,e){let i=0;switch(e){case"center":i=.5;break;case"right":case"end":i=1}return t*i}computeBBox(){if(this.generateTextMap(),this.textMap?.size){const e=fs.merge(this.textMap.values());return e.x=this.x-t.calcLeftOffset(e.width,this.textAlign),e.y=this.y,e}const{x:e,y:i,lines:s,textBaseline:n,textAlign:a}=this,o=t.computeBBox(s,e,i,{font:this,textBaseline:n,textAlign:a});return null!=this.boxing&&o.grow(this.boxPadding),o}getTextMeasureBBox(){return this.computeBBox()}getPlainText(){return At(this.text)}isPointInPath(t,e){return this.getBBox()?.containsPoint(t,e)??!1}setScene(t){this.richText?.setScene(t),super.setScene(t)}generateTextMap(){if(!G(this.text)||this.textMap?.size)return;this.textMap??(this.textMap=new Map);let t=0;const e=this.richText.children();for(const{width:i,height:s,ascent:n,segments:a}of Qi(this.text,this).lineMetrics){let o=0;for(const{color:s,textMetrics:r,...l}of a){const a=e.next().value;a.x=this.x-i/2+o,a.y=n+t,a.setProperties({...l,fill:s??this.fill});const c=a.getBBox();this.textMap.set(a,c),o+=r.width}t+=s}}render(e){const{ctx:i,stats:s}=e;if(!this.text||!this.layerManager)return s&&(s.nodesSkipped+=1),super.render(e);if(G(this.text)&&this.richText){this.generateTextMap();const t=this.richText.getBBox(),{width:s,height:n,lineMetrics:a}=Qi(this.text,this);let o=0;switch(this.textAlign){case"left":case"start":o=s/2;break;case"right":case"end":o=s/-2}let r=this.y;switch(this.textBaseline){case"alphabetic":r-=a[0]?.ascent??0;break;case"middle":r-=1===a.length?a[0].ascent+a[0].segments.reduce((t,e)=>Math.min(t,Xi(e).baselineDistance("middle")),0):n/2;break;case"bottom":r-=n}this.renderBoxing(e,t.clone().translate(o,r)),i.save(),i.translate(o,r),this.richText.opacity=this.opacity,this.richText.render(e),i.restore()}else this.renderText(e);if(t.debug.check()&&!this.textMap?.size){const t=this.getBBox();i.strokeStyle="red",i.lineWidth=1,i.strokeRect(t.x,t.y,t.width,t.height)}super.render(e)}markDirty(t){return this.textMap?.clear(),super.markDirty(t)}renderText(t){const{fill:e,stroke:i,strokeWidth:s,font:n,textAlign:a}=this;if(!(e||i&&s)||!this.layerManager)return super.render(t);const{ctx:o}=t;o.font!==n&&(o.font=n),o.textAlign=a,this.renderBoxing(t),this.fillStroke(o)}renderBoxing(e,i){if(!this.boxing)return;const s=i??t.computeBBox(this.lines,this.x,this.y,this);if(0===s.width||0===s.height)return;const{x:n,y:a,width:o,height:r}=s.grow(this.boxPadding);this.boxing.opacity=this.opacity,this.boxing.x=n,this.boxing.y=a,this.boxing.width=o,this.boxing.height=r,this.boxing.preRender(e),this.boxing.render(e)}executeFill(t){this.renderLines((e,i,s)=>t.fillText(e,i,s))}executeStroke(t){this.renderLines((e,i,s)=>t.strokeText(e,i,s))}renderLines(t){const{x:e,y:i,lines:s}=this;if(!Number.isFinite(e)||!Number.isFinite(i))return;const n=Xi(this),{lineMetrics:a}=n.measureLines(s),{textBaseline:o,lineHeight:r=n.lineHeight()}=this;let l=0;"top"===o?l=a[0].ascent:"middle"!==o&&"bottom"!==o||(l=r*(1-s.length),"middle"===o?(l/=2,l-=n.baselineDistance(o)):l-=a[0].descent);for(const s of a)t(s.text,e,i+l),l+=r}setFont(t){this.fontFamily=t.fontFamily,this.fontSize=t.fontSize,this.fontStyle=t.fontStyle,this.fontWeight=t.fontWeight}setAlign(t){this.textAlign=t.textAlign,this.textBaseline=t.textBaseline}setBoxing(t){const e=t.border?.enabled?t.border?.stroke:void 0;null!=t.fill||null!=e?(this.boxing??(this.boxing=new Uo({scene:this.scene})),this.boxing.fill=t.fill,this.boxing.fillOpacity=t.fillOpacity??1,this.boxing.cornerRadius=t.cornerRadius??0,this.boxing.stroke=e,this.boxing.strokeWidth=t.border?.strokeWidth??0,this.boxing.strokeOpacity=t.border?.strokeOpacity??1,this.boxPadding=t.padding??0):this.boxing&&(this.boxing.destroy(),this.boxing=void 0)}getBoxingProperties(){const{fill:t,fillOpacity:e,cornerRadius:i,stroke:s,strokeWidth:n,strokeOpacity:a}=this.boxing??{};return{border:{enabled:null!=s,stroke:s,strokeWidth:n,strokeOpacity:a},cornerRadius:i,fill:t,fillOpacity:e,padding:this.boxPadding}}toSVG(){if(!this.visible||!this.text)return;const t=B("text");if(Z(this.text))this.applySvgFillAttributes(t),xa(t,this),t.setAttribute("text-anchor",{center:"middle",left:"start",right:"end",start:"start",end:"end"}[this.textAlign??"start"]),t.setAttribute("alignment-baseline",this.textBaseline),t.setAttribute("x",String(this.x)),t.setAttribute("y",String(this.y)),t.textContent=this.text;else for(const e of this.text){const i=B("tspan");xa(i,{fontSize:e.fontSize??this.fontSize,fontFamily:e.fontFamily??this.fontFamily,fontWeight:e.fontWeight??this.fontWeight,fontStyle:e.fontStyle??this.fontStyle}),this.applySvgFillAttributes(i),i.textContent=e.text,t.append(i)}return{elements:[t]}}};Wo.className="Text",Wo.debug=bs.create(!0,"scene:text"),Wo.defaultFontSize=10,ls([Xs()],Wo.prototype,"x",2),ls([Xs()],Wo.prototype,"y",2),ls([Qs({changeCb:t=>t.onTextChange()})],Wo.prototype,"text",2),ls([Xs({changeCb:t=>{t.fontCache=void 0}})],Wo.prototype,"fontStyle",2),ls([Xs({changeCb:t=>{t.fontCache=void 0}})],Wo.prototype,"fontWeight",2),ls([Xs({changeCb:t=>{t.fontCache=void 0}})],Wo.prototype,"fontSize",2),ls([Xs({changeCb:t=>{t.fontCache=void 0}})],Wo.prototype,"fontFamily",2),ls([Xs()],Wo.prototype,"textAlign",2),ls([Xs()],Wo.prototype,"textBaseline",2),ls([Xs()],Wo.prototype,"lineHeight",2);var _o=Wo,Yo=class extends(Aa(_o)){},Ko=class extends(Aa(Na(_o))){},Zo={};rs(Zo,{BASE_FONT_SIZE:()=>Qo,CARTESIAN_AXIS_TYPE:()=>tr,CARTESIAN_POSITION:()=>Jo,FONT_SIZE:()=>Xo,FONT_SIZE_RATIO:()=>qo,POLAR_AXIS_SHAPE:()=>ir,POLAR_AXIS_TYPE:()=>er});var Xo=(t=>(t[t.SMALLEST=8]="SMALLEST",t[t.SMALLER=10]="SMALLER",t[t.SMALL=12]="SMALL",t[t.MEDIUM=13]="MEDIUM",t[t.LARGE=14]="LARGE",t[t.LARGEST=17]="LARGEST",t))(Xo||{}),Qo=12,qo={SMALLEST:8/Qo,SMALLER:10/Qo,SMALL:12/Qo,MEDIUM:13/Qo,LARGE:14/Qo,LARGEST:17/Qo},Jo=(t=>(t.TOP="top",t.TOP_RIGHT="top-right",t.TOP_LEFT="top-left",t.RIGHT="right",t.RIGHT_TOP="right-top",t.RIGHT_BOTTOM="right-bottom",t.BOTTOM="bottom",t.BOTTOM_RIGHT="bottom-right",t.BOTTOM_LEFT="bottom-left",t.LEFT="left",t.LEFT_TOP="left-top",t.LEFT_BOTTOM="left-bottom",t))(Jo||{}),tr=(t=>(t.CATEGORY="category",t.GROUPED_CATEGORY="grouped-category",t.ORDINAL_TIME="ordinal-time",t.UNIT_TIME="unit-time",t.TIME="time",t.NUMBER="number",t.LOG="log",t))(tr||{}),er=(t=>(t.ANGLE_CATEGORY="angle-category",t.ANGLE_NUMBER="angle-number",t.RADIUS_CATEGORY="radius-category",t.RADIUS_NUMBER="radius-number",t))(er||{}),ir=(t=>(t.CIRCLE="circle",t.POLYGON="polygon",t))(ir||{}),sr=class extends Pn{constructor(){super(...arguments),this.id=Oi(this),this.node=new Yo({zIndex:1}).setProperties({textAlign:"center",pointerEvents:1}),this.enabled=!1,this.textAlign="center",this.fontSize=10,this.fontFamily="sans-serif",this.wrapping="always",this.padding=0,this.layoutStyle="block",this.truncated=!1}registerInteraction(t,e){return t.eventsHub.on("layout:complete",()=>this.updateA11yText(t,e))}computeTextWrap(t,e){const{text:i,padding:s,wrapping:n}=this,a=Math.min(this.maxWidth??1/0,t)-2*s,o=this.maxHeight??e-2*s,r={maxWidth:a,maxHeight:o,font:this,textWrap:n};if(!Number.isFinite(a)&&!Number.isFinite(o))return void(this.node.text=i);let l;G(i)?(l=ns(i,r),this.truncated=l.some(Yi)):(l=function(t,e){return ts(t,e).join("\n")}(i??"",r),this.truncated=_i(l)),this.node.text=l}updateA11yText(t,e){const{proxyInteractionService:i}=t;if(this.enabled&&this.text){const s=Ta.toCanvas(this.node);if(s){const{id:n}=this;this.proxyText??(this.proxyText=i.createProxyElement({type:"text",domManagerId:n,where:e})),this.proxyText.textContent=At(this.text),this.proxyText.setBounds(s),this.proxyText.addListener("mousemove",e=>this.handleMouseMove(t,e)),this.proxyText.addListener("mouseleave",e=>this.handleMouseLeave(t,e))}}else this.proxyText?.destroy(),this.proxyText=void 0}handleMouseMove(t,e){if(null!=e&&this.enabled&&this.truncated){const{x:i,y:s}=Ta.toCanvas(this.node),n=e.sourceEvent.offsetX+i,a=e.sourceEvent.offsetY+s;t.tooltipManager.updateTooltip(this.id,{canvasX:n,canvasY:a,showArrow:!1},[{type:"structured",title:At(this.text)}])}}handleMouseLeave(t,e){t.tooltipManager.removeTooltip(this.id)}};sr.SMALL_PADDING=10,ls([ws,oo("node","visible")],sr.prototype,"enabled",2),ls([ws,oo("node")],sr.prototype,"text",2),ls([ws,oo("node")],sr.prototype,"textAlign",2),ls([ws,oo("node")],sr.prototype,"fontStyle",2),ls([ws,oo("node")],sr.prototype,"fontWeight",2),ls([ws,oo("node")],sr.prototype,"fontSize",2),ls([ws,oo("node")],sr.prototype,"fontFamily",2),ls([ws,oo("node","fill")],sr.prototype,"color",2),ls([ws],sr.prototype,"spacing",2),ls([ws],sr.prototype,"maxWidth",2),ls([ws],sr.prototype,"maxHeight",2),ls([ws],sr.prototype,"wrapping",2),ls([ws],sr.prototype,"padding",2),ls([ws],sr.prototype,"layoutStyle",2);var nr=(t=>(t.X="x",t.Y="y",t.Angle="angle",t.Radius="radius",t))(nr||{});function ar(t){switch(t){case"x":case"y":case"angle":case"radius":return!0;default:return!1}}var or=class{constructor(){this.title=new sr,this.subtitle=new sr,this.footnote=new sr}positionCaptions(t){const{title:e,subtitle:i,footnote:s}=this,n=t.layoutBox.height/10;e.enabled&&(this.positionCaption("top",e,t.layoutBox,n),this.shrinkLayoutByCaption("top",e,t.layoutBox)),i.enabled&&(this.positionCaption("top",i,t.layoutBox,n),this.shrinkLayoutByCaption("top",i,t.layoutBox)),s.enabled&&(this.positionCaption("bottom",s,t.layoutBox,n),this.shrinkLayoutByCaption("bottom",s,t.layoutBox))}positionAbsoluteCaptions(t){const{title:e,subtitle:i,footnote:s}=this,{rect:n}=t.series;for(const t of[e,i,s])if("overlay"===t.layoutStyle)if("left"===t.textAlign)t.node.x=n.x+t.padding;else if("right"===t.textAlign){const e=t.node.getBBox();t.node.x=n.x+n.width-e.width-t.padding}}computeX(t,e){return"left"===t?e.x:"right"===t?e.x+e.width:e.x+e.width/2}positionCaption(t,e,i,s){if(!e.text)return;const{lineMetrics:n}=G(e.text)?Qi(e.text,e):Xi(e).measureLines(e.text),a=Math.max(n[0].height,s);e.node.x=this.computeX(e.textAlign,i)+e.padding,e.node.y=i.y+("top"===t?0:i.height)+e.padding,e.node.textBaseline=t,e.computeTextWrap(i.width,a)}shrinkLayoutByCaption(t,e,i){if("block"===e.layoutStyle){const s=e.node.getBBox().clone(),{spacing:n=0}=e;"bottom"===t&&G(e.text)&&(s.y-=s.height),i.shrink("top"===t?Math.ceil(s.y-i.y+s.height+n):Math.ceil(i.y+i.height-s.y+n),t)}}};ls([ws],or.prototype,"title",2),ls([ws],or.prototype,"subtitle",2),ls([ws],or.prototype,"footnote",2);var rr=["candlestick","hollow-candlestick","ohlc","line","step-line","hlc","high-low"],lr=class{constructor(t){this.chartService=t,this.mementoOriginatorKey="chartType"}createMemento(){let t=this.chartService.publicApi?.getOptions()?.chartType;return t??(t="candlestick"),t}guardMemento(t){return null==t||rr.includes(t)}restoreMemento(t,e,s){if(null==s)return;const n={chartType:s};this.chartService.publicApi?.updateDelta(n).catch(t=>i.error("error restoring state",t))}},cr="12.3.0",hr=Symbol("previous-memento-not-found"),dr=class{constructor(t){this.history=[],this.historyIndex=-1,this.originators=new Map,this.clearState=new Map,this.maxHistoryLength=100,this.debug=bs.create(!0,"history"),this.cleanup=new Mi,this.cleanup.register(t.on("series:undo",this.undo.bind(this)),t.on("series:redo",this.redo.bind(this)))}destroy(){this.cleanup.flush()}addMementoOriginator(t){this.originators.set(t.mementoOriginatorKey,t),this.clearState.set(t.mementoOriginatorKey,t.createMemento()),this.debugEvent("History add originator:",t.mementoOriginatorKey)}clear(){this.debug("History clear:",Object.keys(this.originators)),this.history=[],this.historyIndex=-1;for(const[t,e]of this.originators.entries())this.clearState.set(t,e.createMemento())}record(t,...e){this.historyIndex<this.history.length-1&&(this.history=this.history.slice(0,this.historyIndex+1)),this.history.length>this.maxHistoryLength&&(this.history=this.history.slice(-this.maxHistoryLength));const i=new Map;for(const t of e){if(!this.originators.has(t.mementoOriginatorKey))throw new Error(`Originator [${t.mementoOriginatorKey}] has not been added to the HistoryManager.`);i.set(t.mementoOriginatorKey,t.createMemento())}this.history.push({label:t,mementos:i}),this.historyIndex=this.history.length-1,this.debugEvent(`History record: [${t}]`)}undo(){const t=this.history[this.historyIndex];if(t){for(const e of t.mementos.keys()){const t=this.findPreviousMemento(e);if(t===hr)throw new Error(`Could not find previous memento for [${e}].`);this.restoreMemento(e,t)}this.historyIndex-=1,this.debugEvent(`History undo: [${t.label}]`)}}redo(){const t=this.history[this.historyIndex+1];if(t){for(const[e,i]of t.mementos.entries())this.restoreMemento(e,i);this.historyIndex+=1,this.debugEvent(`History redo: [${t.label}]`)}}findPreviousMemento(t){for(let e=this.historyIndex-1;e>=0;e--)if(this.history[e].mementos.has(t))return this.history[e].mementos.get(t);return this.clearState.has(t)?this.clearState.get(t):hr}restoreMemento(t,e){this.originators.get(t)?.restoreMemento(cr,cr,e)}debugEvent(...t){this.debug(...t,this.history.map((t,e)=>e===this.historyIndex?`** ${t.label} **`:t.label))}},ur=class t{constructor(t){this.version=t.split("-")[0]}save(...t){const e={version:this.version};for(const i of Object.values(t))e[i.mementoOriginatorKey]=this.encode(i,i.createMemento());return e}restore(t,...e){if("object"==typeof t)if(null!=t)if("version"in t&&"string"==typeof t.version)for(const s of e){const e=this.decode(s,t[s.mementoOriginatorKey]),n=[];if(!s.guardMemento(e,n)){const t=n.length>0?`\n\n${n.join("\n\n")}\n\n`:"";return void i.warnOnce(`Could not restore [${s.mementoOriginatorKey}] data, value was invalid, ignoring.${t}`,e)}s.restoreMemento(this.version,t.version,e)}else i.warnOnce("Could not restore data, missing [version] string in object, ignoring.");else i.warnOnce("Could not restore data of type [null], expecting an object, ignoring.");else i.warnOnce(`Could not restore data of type [${typeof t}], expecting an object, ignoring.`)}encode(e,i){try{return JSON.parse(JSON.stringify(i,t.encodeTypes))}catch(t){throw new Error(`Failed to encode [${e.mementoOriginatorKey}] value [${t}].`,{cause:t})}}decode(e,i){if(null==i)return i;try{return JSON.parse(JSON.stringify(i),t.decodeTypes)}catch(t){throw new Error(`Failed to decode [${e.mementoOriginatorKey}] value [${t}].`,{cause:t})}}static encodeTypes(t,e){return $(this[t])?{__type:"date",value:this[t].toISOString()}:e}static decodeTypes(t,e){return W(this[t])&&"__type"in this[t]&&"date"===this[t].__type?new Date(this[t].value):e}},pr=class{constructor(){this.caretaker=new ur(cr),this.state=new Map}setState(t,e){Rs(this.state.get(t.mementoOriginatorKey),e)||this.setStateAndRestore(t,e)}setStateAndRestore(t,e){this.state.set(t.mementoOriginatorKey,e),this.restoreState(t)}restoreState(t){const{caretaker:e,state:i}=this;if(!i.has(t.mementoOriginatorKey))return;const s=i.get(t.mementoOriginatorKey);e.restore({version:e.version,[t.mementoOriginatorKey]:s},t)}},gr=class{constructor(){this.cleanup=new Mi,this.destroyed=!1}destroy(){this.cleanup.flush(),this.destroyed=!0}},mr=class t{constructor(t,e,i){this.element=t,this.topTabGuard=e,this.bottomTabGuard=i,this.cleanup=new Mi,this.guardTabIndex=0,this.hasFocus=!1,this.initTabGuard(this.topTabGuard,!1),this.initTabGuard(this.bottomTabGuard,!0),this.element.addEventListener("focus",()=>this.onFocus(),{capture:!0}),this.element.addEventListener("blur",t=>this.onBlur(t),{capture:!0})}set tabIndex(t){this.guardTabIndex=t,0===this.guardTabIndex?this.setGuardIndices(void 0):this.hasFocus||this.setGuardIndices(this.guardTabIndex)}destroy(){this.cleanup.flush()}initTabGuard(t,e){this.cleanup.register(F(t,"focus",()=>this.onTab(t,e)))}setGuardIndices(t){const e=t;di(this.topTabGuard,"tabindex",e),di(this.bottomTabGuard,"tabindex",e)}onFocus(){this.hasFocus=!0,0!==this.guardTabIndex&&this.setGuardIndices(0)}onBlur({relatedTarget:t}){const{topTabGuard:e,bottomTabGuard:i}=this;this.hasFocus=!1,0!==this.guardTabIndex&&t!==e&&t!==i&&this.setGuardIndices(this.guardTabIndex)}onTab(t,e){if(0!==this.guardTabIndex){let i;0===t.tabIndex?(i=this.findExitTarget(!e),this.setGuardIndices(this.guardTabIndex)):i=this.findEnterTarget(e),i?.focus()}}static queryFocusable(t,e){const i=z();return Array.from(t.querySelectorAll(e)).filter(t=>{if(t instanceof HTMLElement){const e=i.getComputedStyle(t);return"none"!==e.display&&"none"!==e.visibility}return!1})}findEnterTarget(e){const i=t.queryFocusable(this.element,'[tabindex="0"]');return i[e?i.length-1:0]}findExitTarget(e){const i=t.queryFocusable(P(),"[tabindex]").filter(t=>t.tabIndex>0).sort((t,e)=>t.tabIndex-e.tabIndex),{before:s,after:n}=t.findBeforeAndAfter(i,this.guardTabIndex);return e?s:n}static findBeforeAndAfter(t,e){let i,s,n=0,a=t.length-1;for(;n<=a;){const o=Math.floor((n+a)/2),r=t[o].tabIndex;if(r===e){i=t[o-1]||void 0,s=t[o+1]||void 0;break}r<e?(i=t[o],n=o+1):(s=t[o],a=o-1)}return{before:i,after:s}}};function fr(t,e,i=["Escape"]){return F(t,"keydown",t=>{Sr(t,...i)&&e(t)})}function yr(t,e){const i=F(z(),"mousedown",s=>{[0,2].includes(s.button)&&!br(t,s)&&(e(),i())});return i}function xr(t,e){const i=F(z(),"touchstart",s=>{Array.from(s.targetTouches).some(e=>!br(t,e))&&(e(),i())});return i}function br(t,e){return e.target instanceof Element&&null!=e.target.shadowRoot||e.target instanceof Node&&t.contains(e.target)}function vr(t,e,i){const s=t=>{for(const i of e)di(i,"data-focus-visible-override",t)};return s(i),F(t,"keydown",()=>s(!0),{once:!0})}function Mr(t){return!(t.shiftKey||t.altKey||t.ctrlKey||t.metaKey)}function Sr(t,...e){return Mr(t)&&e.includes(t.key)}function Ir(t,e,i){return F(t,"keydown",t=>{Sr(t,i)&&e.focus()})}var Dr={horizontal:{nextKey:"ArrowRight",prevKey:"ArrowLeft"},vertical:{nextKey:"ArrowDown",prevKey:"ArrowUp"}};function kr(t){const{orientation:e,buttons:i,wrapAround:s=!1,onEscape:n,onFocus:a,onBlur:o}=t,{nextKey:r,prevKey:l}=Dr[e],c=t=>{if(t.target&&"tabIndex"in t.target){for(const t of i)t.tabIndex=-1;t.target.tabIndex=0}},[h,d]=s?[i.length,i.length]:[0,1/0],u=new Mi;for(let t=0;t<i.length;t++){const e=i[(h+t-1)%d],s=i[t],p=i[(h+t+1)%d];u.register(F(s,"focus",c),a&&F(s,"focus",a),o&&F(s,"blur",o),n&&fr(s,n),e&&Ir(s,e,l),p&&Ir(s,p,r),F(s,"keydown",t=>{Sr(t,r,l)&&t.preventDefault()})),s.tabIndex=0===t?0:-1}return u}function Ar(t,e){return i=>{if("true"===t.ariaDisabled)return i.preventDefault();e(i)}}function wr(t){return"button"in t?0===t.button:Mr(t)&&("Space"===t.code||"Enter"===t.key)}function Cr(t){if(t?.target instanceof HTMLElement&&"tabindex"in t.target.attributes)return t.target}function Nr(t){return F(t,"keydown",t=>{t.defaultPrevented||pi(t.target,"data-preventdefault",!0)&&Sr(t,"ArrowRight","ArrowLeft","ArrowDown","ArrowUp")&&t.preventDefault()})}var Lr=class{constructor(t){this.callback=t,this.devicePixelRatio=z("devicePixelRatio")??1,this.devicePixelRatioMediaQuery=void 0,this.devicePixelRatioListener=t=>{t.matches||(this.devicePixelRatio=z("devicePixelRatio")??1,this.unregisterDevicePixelRatioListener(),this.registerDevicePixelRatioListener(),this.callback(this.pixelRatio))}}get pixelRatio(){return this.devicePixelRatio}observe(){this.registerDevicePixelRatioListener()}disconnect(){this.unregisterDevicePixelRatioListener()}unregisterDevicePixelRatioListener(){this.devicePixelRatioMediaQuery?.removeEventListener("change",this.devicePixelRatioListener),this.devicePixelRatioMediaQuery=void 0}registerDevicePixelRatioListener(){const t=z("matchMedia")?.(`(resolution: ${this.pixelRatio}dppx)`);t?.addEventListener("change",this.devicePixelRatioListener),this.devicePixelRatioMediaQuery=t}},Tr=class{constructor(){let t;this.elements=new Map,this.documentReady=!1,this.queuedObserveRequests=[],this.onLoad=()=>{this.documentReady=!0;for(const[t,e]of this.queuedObserveRequests)this.observe(t,e);this.queuedObserveRequests=[],this.observeWindow()},"undefined"!=typeof ResizeObserver&&(this.resizeObserver=new ResizeObserver(t=>{for(const{target:e,contentRect:{width:i,height:s}}of t){const t=this.elements.get(e);this.checkSize(t,e,i,s)}})),this.pixelRatioObserver=new Lr(()=>{clearTimeout(t),t=setTimeout(()=>this.checkPixelRatio(),0)}),this.documentReady="complete"===P("readyState"),this.documentReady?this.observeWindow():z()?.addEventListener("load",this.onLoad)}destroy(){z()?.removeEventListener("load",this.onLoad),this.resizeObserver?.disconnect(),this.resizeObserver=void 0,this.pixelRatioObserver?.disconnect(),this.pixelRatioObserver=void 0}observeWindow(){this.pixelRatioObserver?.observe()}checkPixelRatio(){const t=this.pixelRatioObserver?.pixelRatio??1;for(const[e,i]of this.elements)if(null!=i.size&&i.size.pixelRatio!==t){const{width:s,height:n}=i.size;i.size={width:s,height:n,pixelRatio:t},i.cb(i.size,e)}}checkSize(t,e,i,s){if(t&&(i!==t.size?.width||s!==t.size?.height)){const n=this.pixelRatioObserver?.pixelRatio??1;t.size={width:i,height:s,pixelRatio:n},t.cb(t.size,e)}}observe(t,e){if(!this.documentReady)return void this.queuedObserveRequests.push([t,e]);this.elements.has(t)?this.removeFromQueue(t):this.resizeObserver?.observe(t);const i={cb:e};this.elements.set(t,i)}unobserve(t){this.resizeObserver?.unobserve(t),this.elements.delete(t),this.removeFromQueue(t),this.elements.size||this.destroy()}removeFromQueue(t){this.queuedObserveRequests=this.queuedObserveRequests.filter(([e])=>e!==t)}},Er=class extends Map{constructor(t,e){super(),this.defaultValue=t,this.defaultState=e}set(t,e){return this.delete(t),void 0!==e&&super.set(t,e),delete this.cachedState,delete this.cachedValue,this}delete(t){return delete this.cachedState,delete this.cachedValue,super.delete(t)}stateId(){return this.cachedState??(this.cachedState=Array.from(this.keys()).pop()??this.defaultState),this.cachedState}stateValue(){return this.cachedValue??(this.cachedValue=Array.from(this.values()).pop()??this.defaultValue),this.cachedValue}},Or=["styles","canvas","canvas-center","canvas-container","canvas-overlay","canvas-proxy","series-area","tooltip-container"],Rr=new Set(["styles","canvas-container","canvas","tooltip-container"]),Pr=new Map([["styles",{childElementType:"style"}],["canvas",{childElementType:"canvas"}],["canvas-proxy",{childElementType:"div"}],["canvas-overlay",{childElementType:"div"}],["canvas-center",{childElementType:"div"}],["series-area",{childElementType:"div"}],["tooltip-container",{childElementType:"div"}]]),zr={x:0,y:0,width:0,height:0,top:0,bottom:0,left:0,right:0,toJSON:()=>zr};function jr(t,e){const i=j("div");return i.className="ag-charts-tab-guard",t.insertAdjacentElement(e,i),i}var Br=class t extends gr{constructor(t,e,i,s,n="normal"){super(),this.eventsHub=t,this.chart=e,this.styleContainer=s,this.mode=n,this.anchorName=`--${Oi(this)}`,this.styles=new Map,this.pendingContainer=void 0,this.container=void 0,this.documentRoot=void 0,this.initiallyConnected=void 0,this.containerSize=void 0,this.sizeMonitor=new Tr,this.cursorState=new Er("default"),this.minWidth=0,this.minHeight=0,this.element=this.initDOM(),this.rootElements=this.initRootElements(),this.rootElements.canvas.element.style.setProperty("anchor-name",this.anchorName);let a=!1;if(this.observer=function(t,e){if("undefined"==typeof IntersectionObserver)return;const i=new IntersectionObserver(i=>{for(const s of i)s.target===t&&e(s.intersectionRatio)},{root:t});return i.observe(t),i}(this.element,t=>{0!==t||a||this.eventsHub.emit("dom:hidden",null),a=0===t}),this.setSizeOptions(),this.updateContainerSize(),this.addStyles("ag-charts-community",'.ag-charts-wrapper,.ag-charts-wrapper:after,.ag-charts-wrapper:before,.ag-charts-wrapper *,.ag-charts-wrapper *:after,.ag-charts-wrapper *:before{box-sizing:border-box}.ag-charts-wrapper{--align-items: center;--justify-content: center;position:relative;user-select:none;-webkit-user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.ag-charts-wrapper--safe-horizontal{--justify-content: flex-start}.ag-charts-wrapper--safe-vertical{--align-items: flex-start}.ag-charts-tab-guard{width:0%;height:0%;position:absolute;pointer-events:none}.ag-charts-canvas-center{width:100%;height:100%;position:absolute;touch-action:auto;pointer-events:auto;display:flex;align-items:var(--align-items);justify-content:var(--justify-content)}.ag-charts-canvas-container,.ag-charts-canvas{position:relative;user-select:none;-webkit-user-select:none}.ag-charts-canvas-container>*,.ag-charts-canvas>*{pointer-events:none}.ag-charts-canvas canvas{display:block}.ag-charts-series-area{outline:none;pointer-events:auto;position:absolute}.ag-charts-swapchain{top:0;left:0;outline:none;opacity:0;pointer-events:none;position:absolute;width:100%;height:100%}.ag-charts-swapchain:focus-visible{opacity:1}.ag-charts-canvas-proxy,.ag-charts-canvas-overlay{inset:0;pointer-events:none;position:absolute;user-select:none;-webkit-user-select:none}.ag-charts-canvas-overlay>*{position:absolute;pointer-events:auto}.ag-charts-theme-default,.ag-charts-theme-default-dark{--ag-charts-accent-color: #2196f3;--ag-charts-background-color: #fff;--ag-charts-border-color: #dddddd;--ag-charts-border-radius: 4px;--ag-charts-chart-background-color: #fff;--ag-charts-chart-padding: 20px;--ag-charts-focus-shadow: 0 0 0 3px #2196f3;--ag-charts-foreground-color: #181d1f;--ag-charts-font-family: Verdana, sans-serif;--ag-charts-font-size: 12px;--ag-charts-font-weight: 400;--ag-charts-popup-shadow: 0 0 16px rgba(0, 0, 0, .15);--ag-charts-subtle-text-color: #8c8c8c;--ag-charts-text-color: #181d1f;--ag-charts-chrome-background-color: #fafafa;--ag-charts-chrome-font-family: Verdana, sans-serif;--ag-charts-chrome-font-size: 12px;--ag-charts-chrome-font-weight: 400;--ag-charts-chrome-subtle-text-color: #8c8c8c;--ag-charts-chrome-text-color: #181d1f;--ag-charts-button-background-color: #fff;--ag-charts-button-border: 1px solid #dddddd;--ag-charts-button-font-weight: normal;--ag-charts-button-text-color: inherit;--ag-charts-input-background-color: #fff;--ag-charts-input-border: 1px solid #dddddd;--ag-charts-input-text-color: #181d1f;--ag-charts-menu-background-color: #fafafa;--ag-charts-menu-border: 1px solid #dddddd;--ag-charts-menu-text-color: #181d1f;--ag-charts-panel-background-color: #fafafa;--ag-charts-panel-text-color: #181d1f;--ag-charts-tooltip-background-color: #fafafa;--ag-charts-tooltip-border: 1px solid #dddddd;--ag-charts-tooltip-text-color: #181d1f;--ag-charts-tooltip-subtle-text-color: #8c8c8c;--ag-charts-crosshair-label-background-color: #fafafa;--ag-charts-crosshair-label-text-color: #181d1f;--ag-charts-spacing: 4px;--ag-charts-icon-size: 16px;--ag-charts-focus-color: color-mix(in srgb, var(--ag-charts-background-color), var(--ag-charts-accent-color) 12%);--ag-charts-input-border-radius: var(--ag-charts-border-radius);--ag-charts-input-focus-border-color: var(--ag-charts-accent-color);--ag-charts-input-focus-text-color: var(--ag-charts-accent-color);--ag-charts-input-disabled-background-color: color-mix( in srgb, var(--ag-charts-chrome-background-color), var(--ag-charts-foreground-color) 6% );--ag-charts-input-disabled-border-color: var(--ag-charts-border-color);--ag-charts-input-disabled-text-color: color-mix( in srgb, var(--ag-charts-chrome-background-color), var(--ag-charts-input-text-color) 50% );--ag-charts-input-placeholder-text-color: color-mix( in srgb, var(--ag-charts-input-background-color), var(--ag-charts-input-text-color) 60% );--ag-charts-button-border-radius: var(--ag-charts-border-radius);--ag-charts-button-focus-background-color: color-mix( in srgb, var(--ag-charts-button-background-color), var(--ag-charts-accent-color) 12% );--ag-charts-button-focus-border-color: var(--ag-charts-accent-color);--ag-charts-button-focus-text-color: var(--ag-charts-accent-color);--ag-charts-button-disabled-background-color: color-mix( in srgb, var(--ag-charts-chrome-background-color), var(--ag-charts-foreground-color) 6% );--ag-charts-button-disabled-border-color: var(--ag-charts-border-color);--ag-charts-button-disabled-text-color: color-mix( in srgb, var(--ag-charts-chrome-background-color), var(--ag-charts-chrome-text-color) 50% );--ag-charts-checkbox-background-color: color-mix( in srgb, var(--ag-charts-background-color), var(--ag-charts-foreground-color) 35% );--ag-charts-checkbox-checked-background-color: var(--ag-charts-accent-color);--ag-charts-tooltip-border-radius: var(--ag-charts-border-radius);--ag-charts-menu-border-radius: var(--ag-charts-border-radius);--ag-charts-chrome-font-size-small: var(--ag-charts-chrome-font-size);--ag-charts-chrome-font-size-medium: calc(var(--ag-charts-chrome-font-size) * (13 / 12));--ag-charts-chrome-font-size-large: calc(var(--ag-charts-chrome-font-size) * (14 / 12));--ag-charts-border: 1px solid var(--ag-charts-border-color);--ag-charts-focus-border: 1px solid var(--ag-charts-accent-color);--ag-charts-focus-border-shadow: 0 0 0 3px color-mix(in srgb, transparent, var(--ag-charts-accent-color) 20%);--ag-charts-layer-menu: 6;--ag-charts-layer-ui-overlay: 5;--ag-charts-layer-tooltip: 4;--ag-charts-layer-toolbar: 3;--ag-charts-layer-crosshair: 2;--ag-charts-layer-annotations: 1}.ag-charts-theme-default-dark{--ag-charts-focus-color: color-mix(in srgb, var(--ag-charts-background-color), var(--ag-charts-accent-color) 22%)}.ag-chart-canvas-wrapper .ag-charts-theme-default{--ag-charts-border-radius: var(--ag-border-radius, 4px);--ag-charts-border: var(--ag-borders-critical, solid 1px) var(--ag-charts-border-color);--ag-charts-focus-shadow: var(--ag-focus-shadow, 0 0 0 3px var(--ag-charts-accent-color));--ag-charts-focus-border-shadow: var( --ag-focus-shadow, 0 0 0 3px color-mix(in srgb, transparent, var(--ag-charts-accent-color) 20%) )}.ag-charts-icon{display:block;width:20px;height:20px;speak:none;speak:never;mask:var(--icon) center / contain no-repeat;background-color:currentColor;transition:background-color .25s ease-in-out}.ag-charts-icon-align-center{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNNyAxMGg2djFIN3pNNCA3aDEydjFINHptMSA2aDEwdjFINXoiLz48L3N2Zz4=)}.ag-charts-icon-align-left{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNNCAxMGg2djFINHptMC0zaDEydjFINHptMCA2aDEwdjFINHoiLz48L3N2Zz4=)}.ag-charts-icon-align-right{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMTAgMTBoNnYxaC02ek00IDdoMTJ2MUg0em0yIDZoMTB2MUg2eiIvPjwvc3ZnPg==)}.ag-charts-icon-arrow-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE1LjI5MyA0LjVIMTIuNXYtMUgxN3Y0aC0xVjUuMjA3bC05LjY0NiA5LjY0Ny0uNzA4LS43MDh6IiBmaWxsPSIjMDAwIi8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik03IDE2YTIuNSAyLjUgMCAxIDEtNSAwIDIuNSAyLjUgMCAwIDEgNSAwbS0yLjUgMS41YTEuNSAxLjUgMCAxIDAgMC0zIDEuNSAxLjUgMCAwIDAgMCAzIiBmaWxsPSIjMDAwIi8+PC9zdmc+)}.ag-charts-icon-arrow-down-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02IDhMMS41IDhMMTAgMThMMTguNSA4TDE0IDhMMTQgM0w2IDNMNiA4Wk03IDRMNyA5SDMuNjYyNDRMMTAgMTYuNDU2TDE2LjMzNzYgOUwxMyA5TDEzIDRMNyA0WiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==)}.ag-charts-icon-arrow-up-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNCAxMkgxOC41TDEwIDJMMS41IDEySDZMNi4wMDAwMiAxN0gxNFYxMlpNMTMgMTZWMTFIMTYuMzM3NkwxMCAzLjU0NDA1TDMuNjYyNDQgMTFIN0w3LjAwMDAyIDE2SDEzWiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==)}.ag-charts-icon-callout-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMyA0LjVBMS41IDEuNSAwIDAgMSA0LjUgM2gxMUExLjUgMS41IDAgMCAxIDE3IDQuNXY4YTEuNSAxLjUgMCAwIDEtMS41IDEuNWgtNC41MTRhMjYgMjYgMCAwIDAtMi4wMTcgMS41NGwtLjMxNC4yNmMtLjU1LjQ1Ny0xLjExNS45MjYtMS43NiAxLjQtLjY2OS40OTEtMS41NjItLjAxMi0xLjU2Mi0uOFYxNEg0LjVBMS41IDEuNSAwIDAgMSAzIDEyLjV6TTQuNSA0YS41LjUgMCAwIDAtLjUuNXY4YS41LjUgMCAwIDAgLjUuNWgxLjgzM3YzLjM3MmEzNiAzNiAwIDAgMCAxLjY3OC0xLjMzOGwuMzItLjI2NWEyNiAyNiAwIDAgMSAyLjIyNS0xLjY4NWwuMTI2LS4wODRIMTUuNWEuNS41IDAgMCAwIC41LS41di04YS41LjUgMCAwIDAtLjUtLjV6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-candlestick-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNyAxdjNoMnYxMkg3djNINnYtM0g0VjRoMlYxek01IDVoM3YxMEg1ek0xMSAxNFY2aDJWMy4yNWgxVjZoMnY4aC0ydjIuNzVoLTFWMTR6bTEtN2gzdjZoLTN6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-close{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJtNSA1IDEwIDEwTTUgMTUgMTUgNSIgc3Ryb2tlPSIjMDAwIi8+PC9zdmc+)}.ag-charts-icon-comment-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNy41MTMgMy45OTVhNi41IDYuNSAwIDAgMSA2LjA5OCAxMS40MWMtLjU4OC4zOTMtMS4yMTcuNTM2LTEuODI5LjU4NWExMyAxMyAwIDAgMS0xLjI3LjAxN0EyNyAyNyAwIDAgMCAxMCAxNkg0LjVhLjUuNSAwIDAgMS0uNS0uNVYxMHEwLS4yNDctLjAwNy0uNTEzYy0uMDA4LS40MTYtLjAxNi0uODU3LjAxNy0xLjI2OS4wNS0uNjEyLjE5Mi0xLjI0LjU4NS0xLjgzYTYuNSA2LjUgMCAwIDEgMi45MTgtMi4zOTNtMy41Ni42MWE1LjUgNS41IDAgMCAwLTUuNjQ2IDIuMzRjLS4yNjYuMzk3LS4zNzkuODQyLS40MiAxLjM1NC0uMDMuMzYtLjAyMi43MTgtLjAxNSAxLjEwOFE1IDkuNjg5IDUgMTB2NWg1cS4zMTEuMDAxLjU5My4wMDhjLjM5LjAwNy43NDcuMDE1IDEuMTA4LS4wMTUuNTEyLS4wNDEuOTU3LS4xNTQgMS4zNTUtLjQyYTUuNSA1LjUgMCAwIDAtMS45ODMtOS45NjciIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-crosshair-add-line{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTEwIDUuNWEuNS41IDAgMCAxIC41LjV2My41aDMuODc1YS41LjUgMCAwIDEgMCAxSDEwLjV2NC4yNWEuNS41IDAgMSAxLTEgMFYxMC41SDUuNjI1YS41LjUgMCAxIDEgMC0xSDkuNVY2YS41LjUgMCAwIDEgLjUtLjUiLz48L3N2Zz4=)}.ag-charts-icon-date-range-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMiAyaDF2MTZIMnptMTUgMGgxdjE2aC0xeiIgZmlsbD0iIzE4MUQxRiIvPjxwYXRoIGQ9Ik0xMy4xNTcgMTFINXYtMWg3Ljc5M0wxMSA4LjIwN2wuNzA3LS43MDcgMy4xODIgMy4xODItMy4xODIgMy4xODItLjcwNy0uNzA3eiIgZmlsbD0iIzAwMCIvPjwvc3ZnPg==)}.ag-charts-icon-date-price-range-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMyAySDJ2MTZoMXptMy41MDcgNC44OUw4LjUgNC44OTVWMTBINXYxaDMuNXY3aDF2LTdoNS4wODhsLTEuOTU3IDEuOTU3LjcwNy43MDcgMy4xODItMy4xODJMMTMuMzM4IDcuM2wtLjcwNy43MDdMMTQuNjI0IDEwSDkuNVY0LjkzMmwxLjk1NyAxLjk1Ny43MDctLjcwN0w4Ljk4MiAzIDUuOCA2LjE4MnoiIGZpbGw9IiMxODFEMUYiLz48L3N2Zz4=)}.ag-charts-icon-delete{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZD0iTTguNDk2IDguOTk2QS41LjUgMCAwIDEgOSA5LjQ5MnY0YS41LjUgMCAxIDEtMSAuMDA4di00YS41LjUgMCAwIDEgLjQ5Ni0uNTA0TTEyIDkuNWEuNS41IDAgMCAwLTEgMHY0YS41LjUgMCAwIDAgMSAweiIvPjxwYXRoIGZpbGw9IiMxMzE3MjIiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTYgNVYzLjVBMi41IDIuNSAwIDAgMSA4LjUgMWgzQTIuNSAyLjUgMCAwIDEgMTQgMy41VjVoMi44MzNhLjUuNSAwIDAgMSAwIDFIMTV2MTAuMjVjMCAuNDE1LS4wNjYuODYzLS4zIDEuMjIxLS4yNTcuMzk0LS42NzIuNjEyLTEuMi42MTJoLTdjLS41MjggMC0uOTQzLS4yMTgtMS4yLS42MTItLjIzNC0uMzU4LS4zLS44MDYtLjMtMS4yMjFWNkgzLjMzM2EuNS41IDAgMCAxIDAtMXptMS0xLjVBMS41IDEuNSAwIDAgMSA4LjUgMmgzQTEuNSAxLjUgMCAwIDEgMTMgMy41VjVIN3pNNiAxNi4yNVY2aDh2MTAuMjVjMCAuMzM1LS4wNTkuNTU0LS4xMzguNjc1LS4wNTUuMDg1LS4xNC4xNTgtLjM2Mi4xNThoLTdjLS4yMjIgMC0uMzA3LS4wNzMtLjM2Mi0uMTU4LS4wOC0uMTIxLS4xMzgtLjM0LS4xMzgtLjY3NSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-disjoint-channel,.ag-charts-icon-disjoint-channel-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTkuMDI4IDE3LjQ2YTIuMjUgMi4yNSAwIDAgMC00LjA5Mi0xLjg1bC05LjUxMS0yLjM3OGEyLjI1IDIuMjUgMCAxIDAtLjIyNS45NzRsOS40NzUgMi4zNjlhMi4yNTEgMi4yNTEgMCAwIDAgNC4zNTMuODg2bS0xLjY2Mi0xLjk2NWExLjI1IDEuMjUgMCAxIDEtLjg4NSAyLjMzOCAxLjI1IDEuMjUgMCAwIDEgLjg4NS0yLjMzOE00LjM0MyAxMy42NjlhMS4yNSAxLjI1IDAgMSAwLTIuMzM4LS44ODUgMS4yNSAxLjI1IDAgMCAwIDIuMzM4Ljg4NU0zLjk3IDguNzY5YTIuMjUgMi4yNSAwIDAgMCAxLjQ1NS0yLjExbDkuNTExLTIuMzc4YTIuMjUgMi4yNSAwIDEgMC0uMjYtLjk2NUw1LjIgNS42ODVhMi4yNSAyLjI1IDAgMSAwLTEuMjMgMy4wODRtLjM3My0yLjU0N2ExLjI1IDEuMjUgMCAxIDEtMi4zMzguODg1IDEuMjUgMS4yNSAwIDAgMSAyLjMzOC0uODg1bTEzLjc1LTMuNDM4YTEuMjUgMS4yNSAwIDEgMS0yLjMzOC44ODUgMS4yNSAxLjI1IDAgMCAxIDIuMzM4LS44ODUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-drag-handle{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSI1Ljc1IiBjeT0iNy43NSIgcj0iLjc1IiBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii41Ii8+PGNpcmNsZSBjeD0iOS43NSIgY3k9IjcuNzUiIHI9Ii43NSIgZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuNSIvPjxjaXJjbGUgY3g9IjEzLjc1IiBjeT0iNy43NSIgcj0iLjc1IiBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii41Ii8+PGNpcmNsZSBjeD0iMTMuNzUiIGN5PSIxMS43NSIgcj0iLjc1IiBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii41Ii8+PGNpcmNsZSBjeD0iOS43NSIgY3k9IjExLjc1IiByPSIuNzUiIGZpbGw9IiMwMDAiIGZpbGwtb3BhY2l0eT0iLjUiLz48Y2lyY2xlIGN4PSI1Ljc1IiBjeT0iMTEuNzUiIHI9Ii43NSIgZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuNSIvPjwvc3ZnPg==)}.ag-charts-icon-fibonacci-retracement-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMiA1aDEydjFIMnoiLz48Y2lyY2xlIGN4PSIxNS43NSIgY3k9IjUuNSIgcj0iMS43NSIgc3Ryb2tlPSIjMDAwIi8+PGNpcmNsZSBjeD0iNC4yNSIgY3k9IjE0LjUiIHI9IjEuNzUiIHN0cm9rZT0iIzAwMCIvPjxwYXRoIGZpbGw9IiMwMDAiIGQ9Ik0xOCAxNUg2di0xaDEyem0wLTQuNUgydi0xaDE2eiIvPjwvc3ZnPg==)}.ag-charts-icon-fibonacci-retracement-trend-based-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJtNC45OTYgMTIuNjc0IDMuMjkxLTUuNzQzLjg2OC40OTctMy4yOTEgNS43NDN6Ii8+PGNpcmNsZSBjeD0iOS43NSIgY3k9IjUuNSIgcj0iMS43NSIgc3Ryb2tlPSIjMDAwIi8+PGNpcmNsZSBjeD0iNC4zNTEiIGN5PSIxNC41IiByPSIxLjc1IiBzdHJva2U9IiMwMDAiLz48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMTggNmgtN1Y1aDd6bTAgNC41aC03di0xaDd6bTAgNC41SDZ2LTFoMTJ6Ii8+PC9zdmc+)}.ag-charts-icon-fill-color{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJtOC4wNzEgNC4wNi0uOTI0LS45MjQuNzA3LS43MDcgNy4yODggNy4yODgtNC45NSA0Ljk1YTMuNSAzLjUgMCAwIDEtNC45NSAwbC0xLjQxNC0xLjQxNGEzLjUgMy41IDAgMCAxIDAtNC45NXptLjcwNy43MDhMNC41MzYgOS4wMWEyLjUgMi41IDAgMCAwIDAgMy41MzZMNS45NSAxMy45NmEyLjUgMi41IDAgMCAwIDMuNTM1IDBsNC4yNDMtNC4yNDN6bTYuOSA3LjIwMi0uMzQ1LjM2My0uMzQ0LS4zNjNhLjUuNSAwIDAgMSAuNjg4IDBtLS4zNDUgMS4wOGE4IDggMCAwIDAtLjI4LjMyMyA0LjMgNC4zIDAgMCAwLS40MDkuNTgyYy0uMTEzLjIwMS0uMTQ0LjMyNi0uMTQ0LjM3OGEuODMzLjgzMyAwIDAgMCAxLjY2NyAwYzAtLjA1Mi0uMDMxLS4xNzctLjE0NC0uMzc4YTQuMyA0LjMgMCAwIDAtLjQxLS41ODIgOCA4IDAgMCAwLS4yOC0uMzIybS0uMzQ0LTEuMDguMzQ0LjM2My4zNDQtLjM2My4wMDIuMDAyLjAwNC4wMDQuMDEzLjAxMmE2IDYgMCAwIDEgLjIwNi4yMDhjLjEzMS4xMzYuMzA4LjMyNy40ODUuNTQ1LjE3Ni4yMTUuMzYzLjQ2Ny41MDcuNzI0LjEzNy4yNDMuMjczLjU1My4yNzMuODY4YTEuODMzIDEuODMzIDAgMSAxLTMuNjY3IDBjMC0uMzE1LjEzNi0uNjI1LjI3My0uODY4LjE0NC0uMjU3LjMzLS41MDkuNTA3LS43MjRhOSA5IDAgMCAxIC42NDUtLjcwOGwuMDQ2LS4wNDUuMDEzLS4wMTIuMDA0LS4wMDR6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-hollow-candlestick-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1vcGFjaXR5PSIuMTUiIGQ9Ik01IDVoM3YxMEg1eiIvPjxwYXRoIGZpbGw9IiMxMzE3MjIiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTcgMXYzaDJ2MTJIN3YzSDZ2LTNINFY0aDJWMXpNNSA1aDN2MTBINXptNyAyaDN2NmgtM3ptLTEgN1Y2aDJWMy4yNWgxVjZoMnY4aC0ydjIuNzVoLTFWMTR6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-horizontal-line,.ag-charts-icon-horizontal-line-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNLjUgOS41aDcuMzA2YTIuMjUgMi4yNSAwIDAgMSA0LjM4OCAwSDE5LjV2MWgtNy4zMDZhMi4yNSAyLjI1IDAgMCAxLTQuMzg4IDBILjV6bTkuNSAxLjc1YTEuMjUgMS4yNSAwIDEgMCAwLTIuNSAxLjI1IDEuMjUgMCAwIDAgMCAyLjUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-line-color{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTQuMjQyIDIuNzIyYy0uNjEyIDAtMS4yLjI0My0xLjYzMi42NzVsLTEuMzQzIDEuMzQ0YS41LjUgMCAwIDAtLjExMi4xMTJMNC4wNSAxMS45NTljLS4yMDcuMjA3LS4zNi40Ni0uNDQ2Ljc0di4wMDFsLS42OSAyLjc2N3YuMDAyYS44Mi44MiAwIDAgMCAxLjAyMiAxLjAyMWguMDAybDIuNjM0LS44MjJjLjI4LS4wODUuNTM0LS4yMzcuNzQtLjQ0M2w3LjEwNy03LjEwOGEuNS41IDAgMCAwIC4xMTItLjExMmwxLjM0My0xLjM0M2EyLjMwOCAyLjMwOCAwIDAgMC0xLjYzMi0zLjk0TTE0LjEyMiA3bDEuMDQ0LTEuMDQ1YTEuMzA4IDEuMzA4IDAgMSAwLTEuODQ5LTEuODVMMTIuMjcxIDUuMTV6bS0yLjU1OC0xLjE0Mi02LjgwNyA2LjgwOWEuOC44IDAgMCAwLS4xOTYuMzI1bC0uNzUgMi40NjggMi40Ny0uNzQ5YS44LjggMCAwIDAgLjMyNS0uMTk0bDYuODA4LTYuODF6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-line-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJtMTcuMzYyIDQuODczLTQuNTk0IDYuNjU0LTQuODUtMy4zMTctNC4yNTEgNi45NzctLjg1NC0uNTJMNy42MTIgNi43OWw0Ljg5OSAzLjM1IDQuMDI4LTUuODM2eiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-line-style-dashed{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMiA5aDR2MUgyem0xMiAwaDR2MWgtNHpNOCA5aDR2MUg4eiIvPjwvc3ZnPg==)}.ag-charts-icon-line-style-dotted{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIyLjUiIGN5PSI5LjUiIHI9Ii41IiBmaWxsPSIjMDAwIi8+PGNpcmNsZSBjeD0iNC41IiBjeT0iOS41IiByPSIuNSIgZmlsbD0iIzAwMCIvPjxjaXJjbGUgY3g9IjYuNSIgY3k9IjkuNSIgcj0iLjUiIGZpbGw9IiMwMDAiLz48Y2lyY2xlIGN4PSI4LjUiIGN5PSI5LjUiIHI9Ii41IiBmaWxsPSIjMDAwIi8+PGNpcmNsZSBjeD0iMTAuNSIgY3k9IjkuNSIgcj0iLjUiIGZpbGw9IiMwMDAiLz48Y2lyY2xlIGN4PSIxMi41IiBjeT0iOS41IiByPSIuNSIgZmlsbD0iIzAwMCIvPjxjaXJjbGUgY3g9IjE0LjUiIGN5PSI5LjUiIHI9Ii41IiBmaWxsPSIjMDAwIi8+PGNpcmNsZSBjeD0iMTYuNSIgY3k9IjkuNSIgcj0iLjUiIGZpbGw9IiMwMDAiLz48L3N2Zz4=)}.ag-charts-icon-line-style-solid{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMiA5aDE2djFIMnoiLz48L3N2Zz4=)}.ag-charts-icon-line-with-markers-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJtMTguMTk4IDQuODg4LTMuNTU2IDQuOTE4YTIuMjUgMi4yNSAwIDEgMS0zLjg2Ni43NWwtMS40MzItLjlhMi4yNCAyLjI0IDAgMCAxLTIuMDA5LjQzNWwtMy44MjggNi40MjgtLjg2LS41MTJMNi40NSA5LjYyM2EyLjI1IDIuMjUgMCAxIDEgMy41MS0uNzYxbDEuMzI5LjgzNWEyLjI0IDIuMjQgMCAwIDEgMi41NTctLjQ5N2wzLjU0Mi00Ljg5OHptLTQuOTYgNS4xNTNhMS4yNSAxLjI1IDAgMSAwLS42NCAyLjQxOSAxLjI1IDEuMjUgMCAwIDAgLjY0LTIuNDE5TTkuMSA4LjMyMXEuMDY2LS4xOTIuMDY3LS40MDRhMS4yNSAxLjI1IDAgMSAwLS4wNjcuNDA0IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-lock,.ag-charts-icon-locked{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTAuMjA3IDMuNzY0YTIuODk0IDIuODk0IDAgMCAwLTIuODk1IDIuODk0VjloNS43ODlWNi42NThhMi44OTQgMi44OTQgMCAwIDAtMi44OTUtMi44OTRNMTQuMSA5VjYuNjU4YTMuODk0IDMuODk0IDAgMSAwLTcuNzg5IDB2Mi4zNDlBMi41IDIuNSAwIDAgMCA0IDExLjV2M0EyLjUgMi41IDAgMCAwIDYuNSAxN2g4YTIuNSAyLjUgMCAwIDAgMi41LTIuNXYtM0EyLjUgMi41IDAgMCAwIDE0LjUgOXpNNi41IDEwQTEuNSAxLjUgMCAwIDAgNSAxMS41djNBMS41IDEuNSAwIDAgMCA2LjUgMTZoOGExLjUgMS41IDAgMCAwIDEuNS0xLjV2LTNhMS41IDEuNSAwIDAgMC0xLjUtMS41eiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-measurer-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0ibTQuNDYxIDEyLjcxIDEuNTMyLTEuNTMxIDEuNDE0IDEuNDE0LjcwNy0uNzA3TDYuNyAxMC40NzJsMS41MzItMS41MzMgMiAyIC43MDctLjcwNy0yLTIgNi4wMS02LjAxIDIuODMgMi44MjhMNS4wNSAxNy43NzggMi4yMjIgMTQuOTVsMS41MzItMS41MzIgMS40MTQgMS40MTQuNzA3LS43MDd6TS44MDggMTQuOTVsLjcwNy0uNzA3TDE0LjI0MyAxLjUxNWwuNzA3LS43MDcuNzA3LjcwNyAyLjgyOCAyLjgyOC43MDcuNzA3LS43MDcuNzA3TDUuNzU3IDE4LjQ4NWwtLjcwNy43MDctLjcwNy0uNzA3LTIuODI4LTIuODI4em0xMS4wNzgtNi44MzVMMTAuNDcgNi43bC43MDctLjcwNyAxLjQxNSAxLjQxNHptLjgyNC0zLjY1NCAxIDEgLjcwOC0uNzA3LTEtMXoiIGZpbGw9IiMxODFEMUYiLz48L3N2Zz4=)}.ag-charts-icon-note-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMyA0LjVBMS41IDEuNSAwIDAgMSA0LjUgM2gxMUExLjUgMS41IDAgMCAxIDE3IDQuNXY4YTEuNSAxLjUgMCAwIDEtMS41IDEuNWgtMy4yMWwtMS40NjkgMi41N2ExIDEgMCAwIDEtMS42ODIuMDg1TDcuMjQzIDE0SDQuNUExLjUgMS41IDAgMCAxIDMgMTIuNXpNNC41IDRhLjUuNSAwIDAgMC0uNS41djhhLjUuNSAwIDAgMCAuNS41aDMuMjU3bDIuMTk2IDMuMDc0TDExLjcxIDEzaDMuNzlhLjUuNSAwIDAgMCAuNS0uNXYtOGEuNS41IDAgMCAwLS41LS41eiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNi41IDYuNUEuNS41IDAgMCAxIDcgNmg2YS41LjUgMCAwIDEgMCAxSDdhLjUuNSAwIDAgMS0uNS0uNU02LjUgOS41QS41LjUgMCAwIDEgNyA5aDZhLjUuNSAwIDAgMSAwIDFIN2EuNS41IDAgMCAxLS41LS41IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-ohlc-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZD0iTTEzIDExaC0zdi0xaDNWM2gxdjJoNHYxaC00djExaC0xek02IDE3di0yaDN2LTFINlY0SDV2MUgydjFoM3YxMXoiLz48L3N2Zz4=)}.ag-charts-icon-pan-end{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZD0ibTYuNjQ2IDEzLjgxMy0uMzUzLjM1NC43MDcuNzA3LjM1NC0uMzU0ek0xMS4xNjYgMTBsLjM1NC4zNTQuMzU0LS4zNTQtLjM1NC0uMzU0ek03LjM1NSA1LjQ4IDcgNS4xMjZsLS43MDcuNzA3LjM1My4zNTR6bTAgOS4wNCA0LjE2Ni00LjE2Ni0uNzA3LS43MDgtNC4xNjcgNC4xNjd6bTQuMTY2LTQuODc0TDcuMzU0IDUuNDhsLS43MDguNzA3IDQuMTY3IDQuMTY3ek0xMy4wODMgNXYxMGgxVjV6Ii8+PC9zdmc+)}.ag-charts-icon-pan-left{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTIuNzkgNS44MzMgOC42MjUgMTBsNC4xNjYgNC4xNjctLjcwNy43MDdMNy4yMSAxMGw0Ljg3My00Ljg3NHoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-pan-right{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNy4yMSAxNC4xNjcgMTEuMzc2IDEwIDcuMjEgNS44MzNsLjcwNy0uNzA3TDEyLjc5IDEwbC00Ljg3MyA0Ljg3NHoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-pan-start{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTYgNXYxMGgxVjV6TTkuNjI0IDEwbDQuMTY2LTQuMTY3LS43MDctLjcwN0w4LjIxIDEwbDQuODc0IDQuODc0LjcwNy0uNzA3eiIvPjwvc3ZnPg==)}.ag-charts-icon-parallel-channel,.ag-charts-icon-parallel-channel-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTcuNzIgNS4zMzFBMi4yNSAyLjI1IDAgMSAwIDE0LjcwNSAzLjZsLTkuNDkgNC41NjJhMi4yNSAyLjI1IDAgMSAwIC4yMDkgMS4wMWw5LjY2Mi00LjY0NmEyLjI1IDIuMjUgMCAwIDAgMi42MzQuODA1bS4zNzMtMi41NDdhMS4yNSAxLjI1IDAgMSAxLTIuMzM4Ljg4NSAxLjI1IDEuMjUgMCAwIDEgMi4zMzgtLjg4NU00LjM0MyA4LjY3YTEuMjUgMS4yNSAwIDEgMS0yLjMzOC44ODUgMS4yNSAxLjI1IDAgMCAxIDIuMzM4LS44ODVNNS4zMDcgMTYuNzI4YTIuMjUgMi4yNSAwIDEgMS0uNTI1LS44NThsOS45MjMtNC43N2EyLjI1IDIuMjUgMCAxIDEgLjM4MS45MjZ6bS0uOTY0LjI3NGExLjI1IDEuMjUgMCAxIDEtMi4zMzguODg1IDEuMjUgMS4yNSAwIDAgMSAyLjMzOC0uODg1bTEzLjAyMy01LjEwNmExLjI1IDEuMjUgMCAxIDAtLjg4NS0yLjMzOSAxLjI1IDEuMjUgMCAwIDAgLjg4NSAyLjMzOSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-position-bottom{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii4yNSIgZD0iTTMgMTBoMTR2MUgzem0zLTNoOHYxSDZ6Ii8+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTYgMTNoOHYxSDZ6Ii8+PC9zdmc+)}.ag-charts-icon-position-center{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMyAxMGgxNHYxSDN6Ii8+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuMjUiIGQ9Ik02IDdoOHYxSDZ6bTAgNmg4djFINnoiLz48L3N2Zz4=)}.ag-charts-icon-position-top{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9Ii4yNSIgZD0iTTMgMTBoMTR2MUgzeiIvPjxwYXRoIGZpbGw9IiMwMDAiIGQ9Ik02IDdoOHYxSDZ6Ii8+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuMjUiIGQ9Ik02IDEzaDh2MUg2eiIvPjwvc3ZnPg==)}.ag-charts-icon-price-label-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNC41IDNBMS41IDEuNSAwIDAgMCAzIDQuNVYxM2ExLjUgMS41IDAgMCAwIDEuNSAxLjVoLjgzM3YuMDU3Yy4yNDItLjI5OS41OTctLjUwMyAxLS41NDhWMTMuNUg0LjVBLjUuNSAwIDAgMSA0IDEzVjQuNWEuNS41IDAgMCAxIC41LS41aDExYS41LjUgMCAwIDEgLjUuNXY4YS41LjUgMCAwIDEtLjUuNWgtNC44MThsLS4xMjYuMDg0YTI2IDI2IDAgMCAwLTIuMjI1IDEuNjg1bC0uMzIuMjY1LS4wNjguMDU2YTEuNSAxLjUgMCAwIDEtMi42MDkgMS4zNTRjLjAzMy43NjMuOTA1IDEuMjM4IDEuNTYuNzU2LjY0Ni0uNDc0IDEuMjEtLjk0MyAxLjc2MS0xLjRsLjMxMy0uMjZBMjYgMjYgMCAwIDEgMTAuOTg2IDE0SDE1LjVhMS41IDEuNSAwIDAgMCAxLjUtMS41di04QTEuNSAxLjUgMCAwIDAgMTUuNSAzeiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNOC43MTYgMTQuODE1YTIuMjUgMi4yNSAwIDEgMS00LjIxIDEuNTkzIDIuMjUgMi4yNSAwIDAgMSA0LjIxLTEuNTkzbS0xLjY2MiAxLjk2NmExLjI1IDEuMjUgMCAxIDAtLjg4NS0yLjMzOSAxLjI1IDEuMjUgMCAwIDAgLjg4NSAyLjMzOSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-price-range-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNOS4wNDYgMTVWNS44NzdoLjk0MlYxNXoiIGZpbGw9IiMxODFEMUYiLz48cGF0aCBkPSJNOS4wNDYgMTVWNS44NzdoLjk0MlYxNXoiIGZpbGw9IiMxODFEMUYiLz48cGF0aCBkPSJNOS41IDYuMjI4IDcuMTY3IDguMzc2IDYuNSA3Ljc2MiA5LjUgNWwzIDIuNzYyLS42NjcuNjE0eiIgZmlsbD0iIzAwMCIvPjxwYXRoIGQ9Ik0yIDE4di0xaDE2djF6TTIgM1YyaDE2djF6IiBmaWxsPSIjMTgxRDFGIi8+PC9zdmc+)}.ag-charts-icon-reset{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTIuMDQgNC40NDVhNS44MSA1LjgxIDAgMCAwLTcuMjU3IDIuNDUzLjUuNSAwIDAgMS0uODY1LS41MDJBNi44MSA2LjgxIDAgMSAxIDMgOS44MTNhLjUuNSAwIDAgMSAxIDAgNS44MSA1LjgxIDAgMSAwIDguMDQtNS4zNjgiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjxwYXRoIGZpbGw9IiMwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTQuMjg5IDMuMDAyYS41LjUgMCAwIDEgLjUuNXYyLjY1NWgyLjY1NWEuNS41IDAgMCAxIDAgMUg0LjI5YS41LjUgMCAwIDEtLjUtLjVWMy41MDJhLjUuNSAwIDAgMSAuNS0uNSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+)}.ag-charts-icon-settings{--icon: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjAgMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgc3R5bGU9ImZpbGwtcnVsZTpldmVub2RkIj48cGF0aCBkPSJNMTAgMTNhMyAzIDAgMSAwIDAtNiAzIDMgMCAwIDAgMCA2bTAtMWEyIDIgMCAxIDEtLjAwMS0zLjk5OUEyIDIgMCAwIDEgMTAgMTIiLz48cGF0aCBkPSJNMi4zMSAxNC4zNDVjLS44MTctMS40OTEuMDI3LTIuNDk5LjQ3NC0yLjg2NS41MzEtLjQzNC45NjktLjM2NS45NzItMS40OC0uMDAzLTEuMTE1LS40NDEtMS4wNDYtLjk3Mi0xLjQ4MS0uNDU0LS4zNzEtMS4zMTctMS40MDUtLjQzNC0yLjkzNmwuMDA1LS4wMDljLjg4NC0xLjUyIDIuMjA3LTEuMjkgMi43NTUtMS4wODMuNjQxLjI0My44MDEuNjU2IDEuNzY4LjEwMS45NjQtLjU2LjY4Ni0uOTA0Ljc5Ni0xLjU4Mi4wOTQtLjU3OC41NTktMS44NDMgMi4zMjYtMS44NDNoLjAxYzEuNzU5LjAwNSAyLjIyMiAxLjI2NiAyLjMxNiAxLjg0My4xMS42NzgtLjE2OCAxLjAyMi43OTYgMS41ODIuOTY3LjU1NSAxLjEyNy4xNDIgMS43NjgtLjEwMS41NDktLjIwOCAxLjg3Ni0uNDM4IDIuNzYgMS4wOTJzLjAyIDIuNTY1LS40MzQgMi45MzZjLS41MzEuNDM1LS45NjkuMzY2LS45NzIgMS40ODEuMDAzIDEuMTE1LjQ0MSAxLjA0Ni45NzIgMS40OC40NTQuMzcyIDEuMzE3IDEuNDA2LjQzNCAyLjkzN2wtLjAwNS4wMDljLS44ODQgMS41Mi0yLjIwNyAxLjI5LTIuNzU1IDEuMDgzLS42NDEtLjI0My0uODAxLS42NTYtMS43NjgtLjEwMS0uOTY0LjU2LS42ODYuOTA0LS43OTYgMS41ODEtLjA5NC41NzktLjU1OSAxLjg0NC0yLjMyNiAxLjg0NGgtLjAxYy0xLjc1OS0uMDA1LTIuMjIyLTEuMjY2LTIuMzE2LTEuODQ0LS4xMS0uNjc3LjE2OC0xLjAyMS0uNzk2LTEuNTgxLS45NjctLjU1NS0xLjEyNy0uMTQyLTEuNzY4LjEwMS0uNTQ5LjIwOC0xLjg3Ni40MzgtMi43Ni0xLjA5MmwtLjAyLS4wMzZ6TTkuOTg0IDIuMTYySDEwYzEuMzU1IDAgMS4zNDIgMS4wMzkgMS4zNTMgMS40MjUuMDA4LjMxMi4wNCAxLjE2IDEuMjU5IDEuODcybC4wMTUuMDA4YzEuMjI1LjcgMS45NzYuMzA0IDIuMjUxLjE1NS4zMzctLjE4MyAxLjIyNi0uNzExIDEuOTAyLjQ0NWwuMDA4LjAxNGMuNjc4IDEuMTczLS4yMjkgMS42ODItLjU1OCAxLjg4NC0uMjY2LjE2My0uOTg0LjYxNS0uOTkxIDIuMDI3di4wMTZjLjAwNyAxLjQxMi43MjUgMS44NjQuOTkxIDIuMDI3LjMyOC4yMDEgMS4yMjkuNzA3LjU2NiAxLjg3bC0uMDA4LjAxNGMtLjY3NyAxLjE3NC0xLjU3MS42NDMtMS45MS40NTktLjI3NS0uMTQ5LTEuMDI2LS41NDUtMi4yNTEuMTU0bC0uMDE1LjAwOWMtMS4yMTkuNzEyLTEuMjUxIDEuNTYtMS4yNTkgMS44NzItLjAxMS4zODYuMDAyIDEuNDI1LTEuMzUzIDEuNDI1cy0xLjM0Mi0xLjAzOS0xLjM1My0xLjQyNWMtLjAwOC0uMzEyLS4wNC0xLjE2LTEuMjU5LTEuODcybC0uMDE1LS4wMDljLTEuMjI1LS42OTktMS45NzYtLjMwMy0yLjI1MS0uMTU0LS4zMzYuMTgzLTEuMjE5LjcwNi0xLjg5NC0uNDMybC0uMDE2LS4wMjdjLS42NzgtMS4xNzQuMjI5LTEuNjgyLjU1OC0xLjg4NC4yNjYtLjE2My45ODQtLjYxNS45OTEtMi4wMjd2LS4wMTZjLS4wMDctMS40MTItLjcyNS0xLjg2NC0uOTkxLTIuMDI3LS4zMjgtLjIwMS0xLjIyOS0uNzA3LS41NjYtMS44N2wuMDA4LS4wMTRjLjY3Ny0xLjE3NCAxLjU3MS0uNjQzIDEuOTEtLjQ1OS4yNzUuMTQ5IDEuMDI2LjU0NSAyLjI1MS0uMTU1bC4wMTUtLjAwOGMxLjIxOS0uNzEyIDEuMjUxLTEuNTYgMS4yNTktMS44NzIuMDEtLjM4NC0uMDAyLTEuNDE3IDEuMzM3LTEuNDI1Ii8+PC9zdmc+)}.ag-charts-icon-step-line-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzE4MUQxRiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNiA0aDV2OGgzVjhoNXYxaC00djRoLTVWNUg3djEwSDJ2LTFoNHoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-text-annotation{--icon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00IDRIMTZWN0gxNVY1SDEwLjVWMTVIMTRWMTZINlYxNUg5LjVWNUg1VjdINFY0WiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==)}.ag-charts-icon-trend-line,.ag-charts-icon-trend-line-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNS4zMTQgMTAuOTM4YTIuMjUgMi4yNSAwIDEgMSAuMDEtMWg5LjM1MmEyLjI1IDIuMjUgMCAxIDEgLjAxIDF6bS0yLjE4OS43MjlhMS4yNSAxLjI1IDAgMSAwIDAtMi41IDEuMjUgMS4yNSAwIDAgMCAwIDIuNW0xMy43NSAwYTEuMjUgMS4yNSAwIDEgMCAwLTIuNSAxLjI1IDEuMjUgMCAwIDAgMCAyLjUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-unlock,.ag-charts-icon-unlocked{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTAuNjUxIDMuNWEyLjg5NCAyLjg5NCAwIDAgMC0yLjg5NCAyLjg5NFY5SDE0LjVhMi41IDIuNSAwIDAgMSAyLjUgMi41djNhMi41IDIuNSAwIDAgMS0yLjUgMi41aC04QTIuNSAyLjUgMCAwIDEgNCAxNC41di0zQTIuNSAyLjUgMCAwIDEgNi41IDloLjI1N1Y2LjM5NGEzLjg5NCAzLjg5NCAwIDEgMSA3Ljc4OSAwIC41LjUgMCAwIDEtMSAwQTIuODk0IDIuODk0IDAgMCAwIDEwLjY1IDMuNU02LjUgMTBBMS41IDEuNSAwIDAgMCA1IDExLjV2M0ExLjUgMS41IDAgMCAwIDYuNSAxNmg4YTEuNSAxLjUgMCAwIDAgMS41LTEuNXYtM2ExLjUgMS41IDAgMCAwLTEuNS0xLjV6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-vertical-line,.ag-charts-icon-vertical-line-drawing{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTAuNSA3LjgwNmEyLjI1IDIuMjUgMCAwIDEgMCA0LjM4OFYxOS41aC0xdi03LjMwNmEyLjI1IDIuMjUgMCAwIDEgMC00LjM4OFYuNWgxem0tLjUuOTQ0YTEuMjUgMS4yNSAwIDEgMSAwIDIuNSAxLjI1IDEuMjUgMCAwIDEgMC0yLjUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-zoom-in{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTEwIDUuNWEuNS41IDAgMCAxIC41LjV2My41aDMuODc1YS41LjUgMCAwIDEgMCAxSDEwLjV2NC4yNWEuNS41IDAgMSAxLTEgMFYxMC41SDUuNjI1YS41LjUgMCAxIDEgMC0xSDkuNVY2YS41LjUgMCAwIDEgLjUtLjUiLz48L3N2Zz4=)}.ag-charts-icon-zoom-out{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNS41IDEwYS41LjUgMCAwIDEgLjUtLjVoOGEuNS41IDAgMCAxIDAgMUg2YS41LjUgMCAwIDEtLjUtLjUiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-high-low-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNyA0aDJ2MTJINFY0aDNNNSA1aDN2MTBINXpNMTEgMTRWNmg1djhoLTVtMS03aDN2NmgtM3oiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==)}.ag-charts-icon-hlc-series{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzEzMTcyMiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJtMTguMTYzIDEuODM3LTUuMzM0IDExLjYyMUw2Ljk1NyA4LjEybC00LjE5OSA5LjYyMi0uOTE2LS40IDQuNzU2LTEwLjlMMTIuNDkgMTEuOCAxNy4yNTQgMS40MnoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjxwYXRoIGZpbGw9IiMwMDAiIGZpbGwtb3BhY2l0eT0iLjQiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTUuODI1IDIuNzA0LjU1IDEzLjc4NWwuOTAyLjQzIDQuNzI0LTkuOTE5IDYuMDM0IDUuMDI5IDMuMjU1LTguMTQtLjkyOC0uMzctMi43NDUgNi44NnptNy44NTIgMTQuNjM2IDUuNzgtMTMuMTM5LS45MTUtLjQwMi01LjIxOSAxMS44Ni02LjAwNS01LjUwNC0zLjI3OCA3LjY0OC45Mi4zOTQgMi43MjItNi4zNTJ6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ag-charts-icon-chevron-right{--icon: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjAgMjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik03LjQ3IDUuNDdhLjc1Ljc1IDAgMCAxIDEuMDYgMGw0IDRhLjc1Ljc1IDAgMCAxIDAgMS4wNmwtNCA0YS43NS43NSAwIDAgMS0xLjA2LTEuMDZMMTAuOTQgMTAgNy40NyA2LjUzYS43NS43NSAwIDAgMSAwLTEuMDYiIGZpbGw9IiMwMDAiLz48L3N2Zz4=)}.ag-charts-icon-zoom-in-alt{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLXpvb20taW4iPjxjaXJjbGUgY3g9IjExIiBjeT0iMTEiIHI9IjgiLz48bGluZSB4MT0iMjEiIHgyPSIxNi42NSIgeTE9IjIxIiB5Mj0iMTYuNjUiLz48bGluZSB4MT0iMTEiIHgyPSIxMSIgeTE9IjgiIHkyPSIxNCIvPjxsaW5lIHgxPSI4IiB4Mj0iMTQiIHkxPSIxMSIgeTI9IjExIi8+PC9zdmc+)}.ag-charts-icon-zoom-out-alt{--icon: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLXpvb20tb3V0Ij48Y2lyY2xlIGN4PSIxMSIgY3k9IjExIiByPSI4Ii8+PGxpbmUgeDE9IjIxIiB4Mj0iMTYuNjUiIHkxPSIyMSIgeTI9IjE2LjY1Ii8+PGxpbmUgeDE9IjgiIHgyPSIxNCIgeTE9IjExIiB5Mj0iMTEiLz48L3N2Zz4=)}.ag-charts-input{--input-layer-active: 1;--input-layer-focus: 2;--input-padding: calc(var(--ag-charts-spacing) * 2);--input-padding-large: calc(var(--ag-charts-spacing) * 2.5);color:var(--ag-charts-input-text-color);font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size-large);transition-duration:.25s;transition-property:none;transition-timing-function:ease-out}.ag-charts-input:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:var(--input-layer-focus)}.ag-charts-button{background:var(--ag-charts-button-background-color);border:var(--ag-charts-button-border);border-radius:var(--ag-charts-button-border-radius);color:var(--ag-charts-button-text-color);cursor:pointer;padding:var(--input-padding);transition-property:background,border-color}.ag-charts-button:hover{background:var(--ag-charts-focus-color)}.ag-charts-button:has(.ag-charts-icon){padding:2px}.ag-charts-checkbox{--checkbox-transition-duration: .1s;appearance:none;background:var(--ag-charts-checkbox-background-color);border-radius:calc(var(--ag-charts-border-radius) * 9);cursor:pointer;height:18px;margin:0;transition-duration:var(--checkbox-transition-duration);transition-property:margin;width:29px}.ag-charts-checkbox:before{display:block;background:var(--ag-charts-input-background-color);border-radius:calc(var(--ag-charts-border-radius) * 7);content:" ";height:14px;margin:2px;transition-duration:var(--checkbox-transition-duration);transition-property:margin;transition-timing-function:var(--ag-charts-input-transition-easing);width:14px}.ag-charts-checkbox:checked{background:var(--ag-charts-checkbox-checked-background-color)}.ag-charts-checkbox:checked:before{margin-left:13px}.ag-charts-select{background:var(--ag-charts-input-background-color);border:var(--ag-charts-input-border);border-radius:var(--ag-charts-input-border-radius);padding:3px 2px 4px;font-size:inherit}.ag-charts-textarea{--textarea-line-height: 1.38;background:var(--ag-charts-input-background-color);border:var(--ag-charts-input-border);border-radius:var(--ag-charts-input-border-radius);line-height:var(--textarea-line-height);font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size-large);padding:var(--input-padding-large) var(--input-padding)}.ag-charts-textarea::placeholder{color:var(--ag-charts-input-placeholder-text-color)}.ag-charts-proxy-container{pointer-events:none;position:absolute}.ag-charts-proxy-legend-toolbar{pointer-events:auto}.ag-charts-proxy-legend-toolbar>div[role=listitem]{pointer-events:none}.ag-charts-proxy-elem{-webkit-appearance:none;appearance:none;background:none;border:none;color:#0000;overflow:hidden;pointer-events:auto;position:absolute}.ag-charts-proxy-elem::-moz-range-thumb,.ag-charts-proxy-elem::-moz-range-track{opacity:0}.ag-charts-proxy-elem::-webkit-slider-runnable-track,.ag-charts-proxy-elem::-webkit-slider-thumb{opacity:0}.ag-charts-proxy-elem:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow)}.ag-charts-focus-indicator{position:absolute;display:block;pointer-events:none;user-select:none;-webkit-user-select:none;width:100%;height:100%}.ag-charts-focus-indicator>div{position:absolute;outline:solid 1px var(--ag-charts-chrome-background-color);box-shadow:var(--ag-charts-focus-shadow)}.ag-charts-focus-indicator>svg{width:100%;height:100%;fill:none;overflow:visible}.ag-charts-focus-svg-outer-path{stroke:var(--ag-charts-chrome-background-color);stroke-width:4px}.ag-charts-focus-svg-inner-path{stroke:var(--ag-charts-accent-color);stroke-width:2px}.ag-charts-overlay{color:#181d1f;pointer-events:none}.ag-charts-overlay.ag-charts-dark-overlay{color:#fff}.ag-charts-overlay--loading{color:#8c8c8c}.ag-charts-overlay__loading-background{background:#fff;pointer-events:none}.ag-charts-overlay.ag-charts-dark-overlay .ag-charts-overlay__loading-background{background:#192232}.ag-charts-tooltip{--tooltip-arrow-size: 8px;--tooltip-row-spacing: 8px;--tooltip-column-spacing: 16px;position:fixed;inset:unset;margin:0;padding:0;overflow:visible;top:var(--top, 0px);left:var(--left, 0px);width:max-content;max-width:100%;font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size);font-weight:var(--ag-charts-chrome-font-weight);color:var(--ag-charts-tooltip-text-color);background:var(--ag-charts-tooltip-background-color);border:var(--ag-charts-tooltip-border);border-radius:var(--ag-charts-tooltip-border-radius);box-shadow:var(--ag-charts-popup-shadow)}.ag-charts-tooltip--compact .ag-charts-tooltip-content{--tooltip-row-spacing: 2px;--tooltip-column-spacing: 8px;padding:3px 6px}.ag-charts-tooltip--arrow-top:before,.ag-charts-tooltip--arrow-right:before,.ag-charts-tooltip--arrow-bottom:before,.ag-charts-tooltip--arrow-left:before{content:"";position:absolute;display:block;width:var(--tooltip-arrow-size);height:var(--tooltip-arrow-size);border:inherit;border-bottom-color:transparent;border-right-color:transparent;background:inherit;clip-path:polygon(0 0,100% 0,100% 1px,1px 100%,0 100%)}.ag-charts-tooltip--arrow-top:before{bottom:100%;left:50%;transform:translate(-50%) translateY(calc(var(--tooltip-arrow-size) * .5)) rotate(45deg)}.ag-charts-tooltip--arrow-bottom:before{top:100%;left:50%;transform:translate(-50%) translateY(calc(var(--tooltip-arrow-size) * -.5)) rotate(225deg)}.ag-charts-tooltip--arrow-left:before{right:100%;top:50%;transform:translateY(-50%) translate(calc(var(--tooltip-arrow-size) * .5)) rotate(315deg)}.ag-charts-tooltip--arrow-right:before{left:100%;top:50%;transform:translateY(-50%) translate(calc(var(--tooltip-arrow-size) * -.5)) rotate(135deg)}.ag-charts-tooltip--no-interaction{pointer-events:none;user-select:none;-webkit-user-select:none}.ag-charts-tooltip--wrap-always{overflow-wrap:break-word;word-break:break-word;hyphens:none}.ag-charts-tooltip--wrap-hyphenate{overflow-wrap:break-word;word-break:break-word;hyphens:auto}.ag-charts-tooltip--wrap-on-space{overflow-wrap:normal;word-break:normal}.ag-charts-tooltip--wrap-never{white-space:nowrap}.ag-charts-tooltip-heading,.ag-charts-tooltip-title,.ag-charts-tooltip-label,.ag-charts-tooltip-value{overflow:hidden;text-overflow:ellipsis}.ag-charts-tooltip-content{display:grid;grid:auto-flow minmax(1em,auto) / 1fr;padding:8px 12px;gap:var(--tooltip-row-spacing)}.ag-charts-tooltip-content:has(.ag-charts-tooltip-symbol){grid:auto-flow minmax(1em,auto) / auto 1fr}.ag-charts-tooltip-heading{grid-column:1 / -1}.ag-charts-tooltip-symbol{grid-column:1 / 2;place-self:center}.ag-charts-tooltip-symbol svg{display:block}.ag-charts-tooltip-title{grid-column:-2 / -1}.ag-charts-tooltip-row{grid-column:1 / -1;display:flex;gap:var(--tooltip-column-spacing);align-items:baseline;justify-content:space-between;overflow:hidden}.ag-charts-tooltip-row--inline{grid-column:-2 / -1}.ag-charts-tooltip-label{flex:1;min-width:0}.ag-charts-tooltip-value{min-width:0}.ag-charts-tooltip-footer{grid-column:1 / -1;color:var(--ag-charts-tooltip-subtle-text-color);text-align:center}.ag-charts-popover{position:absolute;border:var(--ag-charts-border);border-radius:var(--ag-charts-border-radius);background:var(--ag-charts-panel-background-color);color:var(--ag-charts-chrome-text-color);font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size);font-weight:var(--ag-charts-chrome-font-weight);box-shadow:var(--ag-charts-popup-shadow);z-index:var(--ag-charts-layer-ui-overlay)}.ag-charts-menu{--item-padding: 6px 12px;--icon-color: var(--ag-charts-menu-text-color);display:grid;grid:auto-flow auto / 1fr;column-gap:12px;font-size:var(--ag-charts-chrome-font-size)}.ag-charts-menu:has(.ag-charts-menu__icon,.ag-charts-menu__row--stroke-width-visible){grid:auto-flow auto / auto 1fr}.ag-charts-menu__row--stroke-width-visible:before{content:"";height:var(--strokeWidth);width:12px;background:var(--icon-color)}.ag-charts-menu__row--stroke-width-visible[aria-disabled=true]:before{filter:grayscale(1);opacity:.5}.ag-charts-menu__row{display:grid;grid-column:1 / -1;grid-template-columns:subgrid;align-items:center;padding:var(--item-padding)}.ag-charts-menu__row:not(.ag-charts-menu__row--active){cursor:pointer}.ag-charts-menu__row:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.ag-charts-menu__row:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.ag-charts-menu__row:focus{background:var(--ag-charts-focus-color)}.ag-charts-menu__row:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:var(--ag-charts-layer-menu)}.ag-charts-menu__row--active{--icon-color: var(--ag-charts-accent-color);background:var(--ag-charts-focus-color);color:var(--ag-charts-accent-color)}.ag-charts-menu__label{grid-column:-1 / span 1}.ag-charts-toolbar{--toolbar-gap: calc(var(--ag-charts-spacing) * 2);--toolbar-size: 34px;--toolbar-button-padding: 6px;align-items:center;display:flex;flex-wrap:nowrap;position:absolute}.ag-charts-toolbar__button{align-items:center;background:var(--ag-charts-chrome-background-color);border:var(--ag-charts-button-border);color:var(--ag-charts-button-text-color);cursor:pointer;display:flex;font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size-medium);font-weight:var(--ag-charts-chrome-font-weight);justify-content:center;min-height:var(--toolbar-size);min-width:var(--toolbar-size);padding:var(--toolbar-button-padding);position:relative;transition:background-color .25s ease-in-out,border-color .25s ease-in-out,color .25s ease-in-out;white-space:nowrap}.ag-charts-toolbar__button:hover{background:var(--ag-charts-focus-color);z-index:1}.ag-charts-toolbar__button:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:calc(var(--ag-charts-layer-ui-overlay) + 1)}.ag-charts-toolbar__button--active{background:var(--ag-charts-focus-color);border-color:var(--ag-charts-accent-color);color:var(--ag-charts-accent-color);z-index:2}.ag-charts-toolbar__button[aria-disabled=true]{background:var(--ag-charts-button-disabled-background-color);color:var(--ag-charts-button-disabled-text-color);cursor:default}.ag-charts-toolbar--horizontal{flex-direction:row;.ag-charts-toolbar__button{margin:0 0 0 -1px}.ag-charts-toolbar__button--first{border-bottom-left-radius:var(--ag-charts-border-radius);border-top-left-radius:var(--ag-charts-border-radius);margin:0}.ag-charts-toolbar__button--last{border-bottom-right-radius:var(--ag-charts-border-radius);border-top-right-radius:var(--ag-charts-border-radius)}}.ag-charts-toolbar--vertical{flex-direction:column;.ag-charts-toolbar__button{margin:-1px 0 0;max-width:100%}.ag-charts-toolbar__button--first{border-top-left-radius:var(--ag-charts-border-radius);border-top-right-radius:var(--ag-charts-border-radius);margin:0}.ag-charts-toolbar__button--last{border-bottom-left-radius:var(--ag-charts-border-radius);border-bottom-right-radius:var(--ag-charts-border-radius)}}.ag-charts-toolbar__icon+.ag-charts-toolbar__label{margin-left:var(--toolbar-gap)}.ag-charts-toolbar__icon,.ag-charts-toolbar__label{pointer-events:none}.ag-charts-floating-toolbar{border:none;display:flex;.ag-charts-toolbar{align-items:unset;position:unset}}.ag-charts-floating-toolbar__drag-handle{align-items:center;background:var(--ag-charts-chrome-background-color);border:var(--ag-charts-border);border-bottom-left-radius:var(--ag-charts-border-radius);border-top-left-radius:var(--ag-charts-border-radius);cursor:grab;display:flex;justify-content:center;min-width:24px;padding-left:0;padding-right:0}.ag-charts-floating-toolbar__drag-handle--dragging{cursor:grabbing}\n'),this.setContainer(i),this.cleanup.register(Nr(this.element)),"normal"===this.mode){const t=this.rootElements["canvas-center"].element;if(null==t)throw new Error("Error initializing tab guards");const e=jr(t,"beforebegin"),i=jr(t,"afterend");this.tabGuards=new mr(t,e,i)}}initDOM(){if("normal"===this.mode){const t=j("div");return t.innerHTML='<div class="ag-charts-wrapper ag-charts-styles" data-ag-charts><div role="presentation" class="ag-charts-canvas-center"><div role="presentation" class="ag-charts-canvas-container"><div role="presentation" class="ag-charts-canvas" aria-hidden="true"></div><div role="figure" class="ag-charts-canvas-proxy"><div role="presentation" class="ag-charts-series-area"></div></div><div role="presentation" class="ag-charts-canvas-overlay ag-charts-tooltip-container"></div></div></div></div>',t.firstChild}const t=j("div");t.role="presentation",t.dataset.agCharts="",t.classList.add("ag-charts-wrapper");const e=j("div");return t.appendChild(e),e.role="presentation",e.classList.add("ag-charts-series-area"),t}initRootElements(){const{mode:t,element:e}=this,i={};for(const s of Or){const n=`ag-charts-${s}`;let a;if(a="normal"===t?e.classList.contains(n)?e:e.getElementsByClassName(n)[0]:Rr.has(s)?e:e.getElementsByClassName(n)[0]??j("div"),null==a)throw new Error(`AG Charts - unable to find DOM element ${n}`);i[s]={element:a,children:new Map,listeners:[]}}return i}destroy(){super.destroy(),this.observer?.unobserve(this.element),this.container&&this.sizeMonitor.unobserve(this.container),this.pendingContainer=void 0;for(const t of Object.values(this.rootElements)){for(const e of t.children.values())e.remove();t.element.remove()}this.element.remove()}postRenderUpdate(){"minimal"!==this.mode&&null!=this.pendingContainer&&this.pendingContainer!==this.container&&(0===t.batchedUpdateContainer.length&&z().setTimeout(this.applyBatchedUpdateContainer.bind(this),0),t.batchedUpdateContainer.push(this))}applyBatchedUpdateContainer(){for(const e of t.batchedUpdateContainer)e.destroyed||e.updateContainer();t.batchedUpdateContainer.splice(0)}setSizeOptions(t=300,e=300,i,s){const{style:n}=this.element;n.width=`${i??t}px`,n.height=`${s??e}px`,this.minWidth=i??t,this.minHeight=s??e,this.updateContainerClassName()}updateContainerSize(){const{style:t}=this.rootElements["canvas-center"].element;t.visibility=null==this.containerSize?"hidden":"",this.containerSize?(t.width=`${this.containerSize.width??0}px`,t.height=`${this.containerSize.height??0}px`):(t.width="",t.height=""),this.updateContainerClassName()}setTabGuardIndex(t){this.tabGuards&&(this.tabGuards.tabIndex=t)}setContainer(t){t!==this.container&&(this.pendingContainer=t,"minimal"!==this.mode&&null!=this.container||this.updateContainer())}updateContainer(){const{pendingContainer:t}=this;if(null!=t&&t!==this.container){if(this.container&&(this.element.remove(),this.sizeMonitor.unobserve(this.container)),null!=this.documentRoot)for(const t of this.rootElements.styles.children.keys())this.removeChild("styles",t);this.container=t,this.pendingContainer=void 0,this.documentRoot=this.getShadowDocumentRoot(t),this.initiallyConnected=t.isConnected;for(const[t,e]of this.styles)this.addStyles(t,e);t.appendChild(this.element),this.sizeMonitor.observe(t,t=>{this.containerSize=t,this.updateContainerSize(),this.eventsHub.emit("dom:resize",null)}),this.eventsHub.emit("dom:container-change",null)}}setThemeClass(t){for(const e of Array.from(this.element.classList))e.startsWith("ag-charts-theme-")&&e!==t&&this.element.classList.remove(e);this.element.classList.add(t)}setThemeParameters(t){for(const[e,i]of ri(t)){let t=`${i}`;e.endsWith("Size")||e.endsWith("Radius")?t=`${i}px`:e.endsWith("Border")&&"boolean"==typeof i&&(t=i?"var(--ag-charts-border)":"none"),this.element.style.setProperty(`--ag-charts-${Dt(e)}`,t)}}updateCanvasLabel(t){di(this.rootElements["canvas-proxy"].element,"aria-label",t)}getEventElement(t,e){return["focus","blur","keydown","keyup"].includes(e)?this.rootElements["series-area"].element:t}addEventListener(t,e,i){return F(this.getEventElement(this.element,t),t,e,i)}removeEventListener(t,e,i){this.getEventElement(this.element,t).removeEventListener(t,e,i)}getBoundingClientRect(){return this.rootElements.canvas.element.getBoundingClientRect()}getOverlayClientRect(){const t=z(),e=new fs(0,0,t.innerWidth,t.innerHeight),i=this.getRawOverlayClientRect();return e.intersection(i)?.toDOMRect()??zr}getRawOverlayClientRect(){let t=this.element;const e=this.element.getRootNode()?.fullscreenElement;for(;null!=t;){let i;if(null!=e&&t===e)i=!0;else{const e=t.computedStyleMap?.(),s=e?.get("overflow-y")?.toString();i="auto"===s||"scroll"===s}if(i)return fs.fromObject(t.getBoundingClientRect());t=t.parentElement}if(null!=this.documentRoot)return fs.fromObject(this.documentRoot.getBoundingClientRect());const{innerWidth:i,innerHeight:s}=z();return new fs(0,0,i,s)}getShadowDocumentRoot(t=this.container){const e=t?.ownerDocument?.body??P("body");for(;null!=t;){if(t===e)return;if(t.parentNode instanceof DocumentFragment)return t;t=t.parentNode}}getParent(t){return this.rootElements[t].element}getChildBoundingClientRect(t){const{children:e}=this.rootElements[t],i=[];for(const t of e.values())i.push(fs.fromObject(t.getBoundingClientRect()));return fs.merge(i)}isManagedChildDOMElement(t,e,i){const{children:s}=this.rootElements[e],n=s?.get(i);return null!=n&&t.contains(n)}contains(t,e){return null==e?this.element.contains(t):this.rootElements[e].element.contains(t)}addStyles(e,i){const s="data-ag-charts";if(this.styles.set(e,i),null==this.container)return;const n=t=>t.getAttribute(s)===e,a=t=>{const e=new Set(["TITLE","META"]);let i,a=!0;for(const o of t.children)if(a&&e.has(o.tagName))i=o;else{if(a=!1,n(o))return;o.hasAttribute(s)&&(i=o)}const o=j("style");return null!=this.chart.styleNonce&&(o.nonce=this.chart.styleNonce),null==i?t.prepend(o):t.insertBefore(o,i.nextSibling),o};let o;this.styleContainer?o=a(this.styleContainer):!1===this.initiallyConnected?o=this.addChild("styles",e):null!=this.documentRoot||t.headStyles.has(e)?null!=this.documentRoot&&(o=this.addChild("styles",e)):(o=a(P("head")),t.headStyles.add(e)),null==o||n(o)||(o.setAttribute(s,e),o.innerHTML=i)}removeStyles(t){this.removeChild("styles",t)}updateCursor(t,e){this.cursorState.set(t,e),this.element.style.cursor=this.cursorState.stateValue()}getCursor(){return this.element.style.cursor}addChild(t,e,i,s){const{element:n,children:a,listeners:o}=this.rootElements[t];if(!a)throw new Error("AG Charts - unable to create DOM elements after destroy()");if(a.has(e))return a.get(e);const{childElementType:r="div"}=Pr.get(t)??{};if(i&&i.tagName.toLowerCase()!==r.toLowerCase())throw new Error("AG Charts - mismatching DOM element type");const l=i??j(r);for(const[t,e,i]of o)l.addEventListener(t,e,i);if(a.set(e,l),"style"===r&&null!=this.chart.styleNonce&&(l.nonce=this.chart.styleNonce),s){const t=n.querySelector(s.query);if(null==t)throw new Error(`AG Charts - addChild query failed ${s.query}`);t.insertAdjacentElement(s.where,l)}else n?.appendChild(l);return l}removeChild(t,e){const{children:i}=this.rootElements[t];i&&(i.get(e)?.remove(),i.delete(e))}incrementDataCounter(t){const{dataset:e}=this.element;e[t]??(e[t]="0"),e[t]=String(Number(e[t])+1)}setDataBoolean(t,e){this.element.dataset[t]=String(e)}setDataNumber(t,e){this.element.dataset[t]=String(e)}updateContainerClassName(){const{element:t,containerSize:e,minWidth:i,minHeight:s}=this;t.classList.toggle("ag-charts-wrapper--safe-horizontal",i>=(e?.width??1/0)),t.classList.toggle("ag-charts-wrapper--safe-vertical",s>=(e?.height??1/0))}};Br.batchedUpdateContainer=[],Br.headStyles=new Set;var Fr=Br,Vr=class extends wo{constructor(){super(j("div")),this.textElement=B("text"),this.textElement.role="presentation",this.svgElement=B("svg"),this.svgElement.appendChild(this.textElement),this.svgElement.style.width="100%",this.svgElement.style.opacity="0",this.svgElement.role="presentation",this.elem.appendChild(this.svgElement),this.elem.role="presentation"}set textContent(t){this.textElement.textContent=t;const e=this.textElement,i=e.getBBox?.();i&&this.svgElement.setAttribute("viewBox",`${i.x} ${i.y} ${i.width} ${i.height}`)}get textContent(){return this.textElement.textContent}destructor(){}},Gr=class{constructor(t,e){this.getDispatcher=e,this.onExpanded=()=>{this.controller.setAriaExpanded(!0);const t=this.getDispatcher();if(t&&this.controls){const e={type:"expand-controlled-widget",controlled:this.controls};t.dispatch("expand-controlled-widget",this.controller,e)}},this.onCollapsed=t=>{this.controller.setAriaExpanded(!1),"0"===t.mode&&this.controller.focus()},t.setAriaExpanded(!1),this.controller=t}destroy(){this.controls?.collapse({mode:"2"}),this.setControlled(void 0)}setControlled(t){this.controls&&(this.controls.removeListener("expand-widget",this.onExpanded),this.controls.removeListener("collapse-widget",this.onCollapsed)),this.controls=t,this.controls&&(this.controller.setAriaControls(this.controls.id),this.controls.addListener("expand-widget",this.onExpanded),this.controls.addListener("collapse-widget",this.onCollapsed))}getControlled(){return this.controls}expandControlled(t){this.controller.isDisabled()||this.controls?.expand({controller:this.controller,sourceEvent:void 0,overrideFocusVisible:t?.overrideFocusVisible})}},$r=class extends wo{constructor(t,e){super(t),di(this.elem,"role",e),this.setEnabled(!0),this.addListener("keydown",({sourceEvent:t})=>{wr(t)&&(t.preventDefault(),this.htmlListener?.dispatch("click",this,{type:"click",device:"keyboard",sourceEvent:t}))})}lazyControllerImpl(){return this.controllerImpl??(this.controllerImpl=new Gr(this,()=>this.internalListener)),this.controllerImpl}destructor(){this.controllerImpl?.destroy()}setEnabled(t){di(this.elem,"aria-disabled",!t)}setControlled(t){return this.lazyControllerImpl().setControlled(t)}getControlled(){return this.lazyControllerImpl().getControlled()}expandControlled(t){return this.lazyControllerImpl().expandControlled(t)}addListener(t,e){return super.addListener(t,(i,s)=>{("click"!==t&&"dblclick"!==t||!this.isDisabled())&&e(i,s)})}},Hr=class extends $r{constructor(){super(j("button"))}},Ur=class extends wo{constructor(){super(j("div")),di(this.elem,"role","group")}destructor(){}},Wr=class extends wo{constructor(t,e){super(j("div")),this.focusedChildIndex=0,this.onChildFocus=(t,e)=>{const i=this.children[this.focusedChildIndex];this.focusedChildIndex=e.index,i?.setTabIndex(-1),e.setTabIndex(0)},this.onChildKeyDown=(t,e)=>{const i=this.orientation,[s,n]="both"===i?[Dr.horizontal,Dr.vertical]:[Dr[i],void 0];let a=-1;if(Mr(t.sourceEvent)){const i=t.sourceEvent.key;i===s.nextKey||i===n?.nextKey?a=e.index+1:i!==s.prevKey&&i!==n?.prevKey||(a=e.index-1)}this.children[a]?.focus()},di(this.elem,"role",e),this.orientation=t}get orientation(){return pi(this.elem,"aria-orientation")??"both"}set orientation(t){di(this.elem,"aria-orientation","both"===t?void 0:t)}focus(){this.children[this.focusedChildIndex]?.focus()}clear(){this.focusedChildIndex=0;for(const t of this.children)this.removeChildListeners(t),t.parent=void 0;this.elem.textContent="",this.children.length=0}addChildListeners(t){t.addListener("focus",this.onChildFocus),t.addListener("keydown",this.onChildKeyDown)}removeChildListeners(t){t.removeListener("focus",this.onChildFocus),t.removeListener("keydown",this.onChildKeyDown)}onChildAdded(t){this.addChildListeners(t),t.setTabIndex(1===this.children.length?0:-1)}onChildRemoved(t){this.removeChildListeners(t);const{focusedChildIndex:e,children:i}=this,s=e===t.index;for(let t=0;t<i.length;t++){const s=i[t];s.index===e&&(this.focusedChildIndex=t),s.index=t}if(s){const t=i[e]??i[e-1];t?(this.focusedChildIndex=t.index,t.setTabIndex(0)):this.focusedChildIndex=0}}},_r=class extends Wr{constructor(){super("both","list"),this.setHidden(!0)}destructor(){for(const t of this.children)t.getElement().parentElement.remove()}addChildToDOM(t,e){const i=j("div");di(i,"role","listitem"),gi(i,"position","absolute"),wo.setElementContainer(t,i),this.appendOrInsert(i,e),this.setHidden(!1)}removeChildFromDOM(t){t.getElement().parentElement.remove(),this.setHidden(0===this.children.length)}setHidden(t){0===this.children.length&&(t=!0),super.setHidden(t)}},Yr=class extends wo{constructor(t){super(t)}destructor(){}},Kr=new Intl.NumberFormat("en-US",{style:"percent"});function Zr(t,e=2){return"number"==typeof t?qr(t,e):"string"==typeof t?t:String(t??"")}function Xr(t){return Kr.format(t)}var Qr=(new Map).set(2,new Intl.NumberFormat("en-US",{maximumFractionDigits:2,useGrouping:!1}));function qr(t,e){let i=Qr.get(e);return i||(i=new Intl.NumberFormat("en-US",{maximumFractionDigits:e,useGrouping:!1}),Qr.set(e,i)),i.format(t)}var Jr=class t extends wo{constructor(){super(j("input")),this._step=t.STEP_ONE,this.orientation="both"}get step(){return this._step}set step(t){this._step=t,this.getElement().step=t.attributeValue}get keyboardStep(){return this._keyboardStep?.step??this._step}set keyboardStep(t){if(t!==this._keyboardStep?.step&&(void 0!==this._keyboardStep&&(this.removeListener("keydown",this._keyboardStep.onKeyDown),this.removeListener("keyup",this._keyboardStep.onKeyUp),this.removeListener("blur",this._keyboardStep.onBlur),this._keyboardStep=void 0),void 0!==t)){const e=()=>this.getElement().step=t.attributeValue,i=()=>this.getElement().step=this._step.attributeValue;this._keyboardStep={step:t,onKeyDown:e,onKeyUp:i,onBlur:i},this.addListener("keydown",this._keyboardStep.onKeyDown),this.addListener("keyup",this._keyboardStep.onKeyUp),this.addListener("blur",this._keyboardStep.onBlur)}}get orientation(){return pi(this.elem,"aria-orientation")??"both"}set orientation(e){di(this.elem,"aria-orientation","both"===e?void 0:e),t.registerDefaultPreventers(this,e)}destructor(){}clampValueRatio(t,e){const i=this.getValueRatio(),s=C(t,i,e);return s!==i&&this.setValueRatio(s),s}setValueRatio(t,e){const{divider:i}=this.step,s=Math.round(1e4*t)/i,{ariaValueText:n=Xr(s/i)}=e??{},a=this.getElement();a.value=`${s}`,a.ariaValueText=n}getValueRatio(){return this.getElement().valueAsNumber/this.step.divider}static registerDefaultPreventers(e,i){"both"===i?e.removeListener("keydown",t.onKeyDown):e.addListener("keydown",t.onKeyDown)}static onKeyDown(t,e){let i=[];const{orientation:s}=e;"horizontal"===s?i=["ArrowUp","ArrowDown"]:"vertical"===s&&(i=["ArrowLeft","ArrowRight"]),i.includes(t.sourceEvent.code)&&t.sourceEvent.preventDefault()}};Jr.STEP_ONE={attributeValue:"1",divider:1},Jr.STEP_HUNDRETH={attributeValue:"0.01",divider:100};var tl=Jr,el=class extends Hr{constructor(){super(),di(this.elem,"role","switch"),this.setChecked(!1)}setChecked(t){di(this.elem,"aria-checked",t)}},il=class extends Wr{constructor(t="horizontal"){super(t,"toolbar")}destructor(){}};function sl(t,e){return e.params?.type===t}function nl(t){const e={params:t,result:void 0};return e.result=function(t){if("button"===t)return new Hr;if("slider"===t)return new tl;if("toolbar"===t)return new il;if("group"===t)return new Ur;if("list"===t)return new _r;if("region"===t)return new Yr(j("div"));if("text"===t)return new Vr;if("listswitch"===t)return new el;throw new Error("AG Charts - error allocating meta")}(e.params.type),e}var al=class{constructor(t,e,i){this.eventsHub=t,this.localeManager=e,this.domManager=i,this.cleanup=new Mi}destroy(){this.cleanup.flush()}addLocalisation(t){t(),this.cleanup.register(this.eventsHub.on("locale:change",t))}createProxyContainer(t){const e=nl(t),{params:i,result:s}=e,n=s.getElement();return this.domManager.addChild("canvas-proxy",i.domManagerId,n),n.classList.add(...i.classList,"ag-charts-proxy-container"),n.role=i.type,sl("toolbar",e)&&(e.result.orientation=e.params.orientation),this.addLocalisation(()=>{n.ariaLabel=this.localeManager.t(i.ariaLabel.id,i.ariaLabel.params)}),s}createProxyElement(t){const e=nl(t);if(sl("button",e)){const{params:t,result:i}=e,s=i.getElement();if(this.initInteract(t,i),"string"==typeof t.textContent)s.textContent=t.textContent;else{const{textContent:e}=t;this.addLocalisation(()=>{s.textContent=this.localeManager.t(e.id,e.params)})}this.setParent(e.params,e.result)}if(sl("slider",e)){const{params:t,result:i}=e,s=i.getElement();this.initInteract(t,i),s.type="range",s.role="presentation",s.style.margin="0px",this.addLocalisation(()=>{s.ariaLabel=this.localeManager.t(t.ariaLabel.id,t.ariaLabel.params)}),this.setParent(e.params,e.result)}if(sl("text",e)){const{params:t,result:i}=e;this.initElement(t,i),this.setParent(e.params,e.result)}if(sl("listswitch",e)){const{params:t,result:i}=e;this.initInteract(t,i),i.setTextContent(t.textContent),i.setChecked(t.ariaChecked),i.setAriaDescribedBy(t.ariaDescribedBy),this.setParent(e.params,e.result)}if(sl("region",e)){const{params:t,result:i}=e,s=i.getElement();this.initInteract(t,i),s.role="region",this.setParent(e.params,e.result)}return e.result}initElement(t,e){const i=e.getElement();return gi(i,"cursor",t.cursor),i.classList.toggle("ag-charts-proxy-elem",!0),i}initInteract(t,e){const{tabIndex:i,domIndex:s}=t,n=this.initElement(t,e);void 0!==i&&(n.tabIndex=i),void 0!==s&&(e.domIndex=s)}setParent(t,e){if("parent"in t)t.parent?.addChild(e);else{const i={where:t.where,query:".ag-charts-series-area"};this.domManager.addChild("canvas-proxy",t.domManagerId,e.getElement(),i),e.destroyListener=()=>{this.domManager.removeChild("canvas-proxy",t.domManagerId)}}}},ol={ariaInitSeriesArea:"interactive chart",ariaAnnounceHoverDatum:"${datum}",ariaAnnounceChart:"chart, ${seriesCount}[number] series",ariaAnnounceStandaloneChart:"chart, ${caption}",ariaAnnounceHierarchyChart:"hierarchy chart, ${caption}",ariaAnnounceGaugeChart:"gauge chart, ${caption}",ariaAnnounceHierarchyDatum:"level ${level}[number], ${count}[number] children, ${description}",ariaAnnounceFlowProportionLink:"link ${index} of ${count}, from ${from} to ${to}, ${sizeName} ${size}",ariaAnnounceFlowProportionNode:"node ${index} of ${count}, ${description}",ariaDescriptionLegendItem:"Press Space or Enter to toggle visibility",ariaLabelAddHorizontalLine:"Add Horizontal Line",ariaLabelAnnotationsToolbar:"Annotations",ariaLabelAnnotationOptionsToolbar:"Annotation Options",ariaLabelAnnotationSettingsDialog:"Annotation Settings",ariaLabelColor:"Color",ariaLabelColorPicker:"Color picker",ariaLabelColorPickerAlpha:"Transparency",ariaLabelColorPickerHue:"Hue",ariaLabelColorPickerMultiColor:"Multi Color",ariaLabelColorPickerPalette:"Palette",ariaLabelFinancialCharts:"Financial Charts",ariaLabelGaugeTarget:"Target",ariaLabelGaugeValue:"Value",ariaLabelLegend:"Legend",ariaLabelLegendPagination:"Legend Pagination",ariaLabelLegendPagePrevious:"Previous Legend Page",ariaLabelLegendPageNext:"Next Legend Page",ariaLabelLegendItem:"${label}, Legend item ${index}[number] of ${count}[number]",ariaLabelLegendItemUnknown:"Unknown legend item",ariaLabelNavigator:"Navigator",ariaLabelNavigatorRange:"Range",ariaLabelNavigatorMinimum:"Minimum",ariaLabelNavigatorMaximum:"Maximum",ariaLabelRangesToolbar:"Ranges",ariaLabelSettingsTabBar:"Settings",ariaLabelZoomToolbar:"Zoom",ariaRoleDescription2DSlider:"2D slider",ariaValueColorPalette:"s ${s}[percent0to2dp], v ${v}[percent0to2dp]",ariaValueColorPaletteFirstV:"v ${v}[percent0to2dp], s ${s}[percent0to2dp]",ariaValuePanRange:"${min}[percent0to2dp] to ${max}[percent0to2dp]",iconAltTextLineStyleSolid:"Solid",iconAltTextLineStyleDashed:"Long-dashed",iconAltTextLineStyleDotted:"Short-dashed",iconAltTextPositionTop:"Top",iconAltTextPositionCenter:"Center",iconAltTextPositionBottom:"Bottom",iconAltTextAlignLeft:"Left",iconAltTextAlignCenter:"Center",iconAltTextAlignRight:"Right",iconAltTextClose:"Close",overlayLoadingData:"Loading data...",overlayNoData:"No data to display",overlayNoVisibleSeries:"No visible series",overlayUnsupportedBrowser:"Incompatible browser version. Please upgrade your browser.",seriesHistogramTooltipFrequency:"Frequency",seriesHistogramTooltipSum:"${yName} (sum)",seriesHistogramTooltipCount:"${yName} (count)",seriesHistogramTooltipMean:"${yName} (mean)",toolbarSeriesTypeDropdown:"Chart Type",toolbarSeriesTypeOHLC:"OHLC",toolbarSeriesTypeHLC:"HLC",toolbarSeriesTypeHighLow:"High Low",toolbarSeriesTypeCandles:"Candles",toolbarSeriesTypeHollowCandles:"Hollow Candles",toolbarSeriesTypeLine:"Line",toolbarSeriesTypeLineWithMarkers:"Line with Markers",toolbarSeriesTypeStepLine:"Step Line",toolbarAnnotationsTrendLine:"Trend Line",toolbarAnnotationsFibonacciRetracement:"Fib Retracement",toolbarAnnotationsFibonacciRetracementTrendBased:"Fib Trend Based",toolbarAnnotationsHorizontalLine:"Horizontal Line",toolbarAnnotationsVerticalLine:"Vertical Line",toolbarAnnotationsParallelChannel:"Parallel Channel",toolbarAnnotationsDisjointChannel:"Disjoint Channel",toolbarAnnotationsClearAll:"Clear All",toolbarAnnotationsFillColor:"Fill Color",toolbarAnnotationsLineColor:"Line Color",toolbarAnnotationsLineStyle:"Line Style",toolbarAnnotationsLineStrokeWidth:"Line Stroke Width",toolbarAnnotationsSettings:"Settings",toolbarAnnotationsTextColor:"Text Color",toolbarAnnotationsTextSize:"Text Size",toolbarAnnotationsLock:"Lock",toolbarAnnotationsUnlock:"Unlock",toolbarAnnotationsDelete:"Delete",toolbarAnnotationsDragHandle:"Drag Toolbar",toolbarAnnotationsLineAnnotations:"Trend Lines",toolbarAnnotationsFibonacciAnnotations:"Fibonacci",toolbarAnnotationsTextAnnotations:"Text Annotations",toolbarAnnotationsShapeAnnotations:"Arrows",toolbarAnnotationsMeasurerAnnotations:"Measurers",toolbarAnnotationsCallout:"Callout",toolbarAnnotationsComment:"Comment",toolbarAnnotationsNote:"Note",toolbarAnnotationsText:"Text",toolbarAnnotationsArrow:"Arrow",toolbarAnnotationsArrowUp:"Arrow Up",toolbarAnnotationsArrowDown:"Arrow Down",toolbarAnnotationsDateRange:"Date Range",toolbarAnnotationsPriceRange:"Price Range",toolbarAnnotationsDatePriceRange:"Date and Price",toolbarAnnotationsQuickDatePriceRange:"Measure",toolbarRange1Month:"1M",toolbarRange1MonthAria:"1 month",toolbarRange3Months:"3M",toolbarRange3MonthsAria:"3 months",toolbarRange6Months:"6M",toolbarRange6MonthsAria:"6 months",toolbarRangeYearToDate:"YTD",toolbarRangeYearToDateAria:"Year to date",toolbarRange1Year:"1Y",toolbarRange1YearAria:"1 year",toolbarRangeAll:"All",toolbarRangeAllAria:"All",toolbarZoomZoomOut:"Zoom out",toolbarZoomZoomIn:"Zoom in",toolbarZoomPanLeft:"Pan left",toolbarZoomPanRight:"Pan right",toolbarZoomPanStart:"Pan to the start",toolbarZoomPanEnd:"Pan to the end",toolbarZoomReset:"Reset the zoom",contextMenuDownload:"Download",contextMenuToggleSeriesVisibility:"Toggle Visibility",contextMenuToggleOtherSeries:"Toggle Other Series",contextMenuZoomToCursor:"Zoom to here",contextMenuPanToCursor:"Pan to here",contextMenuResetZoom:"Reset zoom",dialogHeaderChannel:"Channel",dialogHeaderLine:"Line",dialogHeaderFibonacciRange:"Fib Retracement",dialogHeaderDateRange:"Date Range",dialogHeaderPriceRange:"Price Range",dialogHeaderDatePriceRange:"Date and Price",dialogHeaderText:"Text",dialogInputAlign:"Align",dialogInputColorPicker:"Color",dialogInputColorPickerAltText:"Text Color",dialogInputFillColorPicker:"Fill",dialogInputFillColorPickerAltText:"Fill Color",dialogInputExtendChannelStart:"Extend channel start",dialogInputExtendChannelEnd:"Extend channel end",dialogInputExtendLineStart:"Extend line start",dialogInputExtendLineEnd:"Extend line end",dialogInputExtendAbove:"Extend above",dialogInputExtendBelow:"Extend below",dialogInputExtendLeft:"Extend left",dialogInputExtendRight:"Extend right",dialogInputReverse:"Reverse",dialogInputShowFill:"Show Fill",dialogInputFontSize:"Size",dialogInputFontSizeAltText:"Font Size",dialogInputLineStyle:"Dash",dialogInputPosition:"Position",dialogInputStrokeWidth:"Weight",dialogInputStrokeWidthAltText:"Line Weight",dialogInputFibonacciBands:"Bands",dialogInputFibonacciBandsAltText:"Fibonacci Bands",inputTextareaPlaceholder:"Add Text",measurerDateRangeBars:"${value}[number] bars",measurerPriceRangeValue:"${value}[number]",measurerPriceRangePercent:"${value}[percent]",measurerVolume:"Vol ${value}",tooltipPaginationStatus:"${index}[number] of ${count}[number]"},rl=/\$\{(\w+)}(?:\[(\w+)])?/gi,ll={number:new Intl.NumberFormat("en-US"),percent:new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2}),percent0to2dp:new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:0,maximumFractionDigits:2}),date:new Intl.DateTimeFormat("en-US",{dateStyle:"full"}),time:new Intl.DateTimeFormat("en-US",{timeStyle:"full"}),datetime:new Intl.DateTimeFormat("en-US",{dateStyle:"full",timeStyle:"full"})},cl=class{constructor(t){this.eventsHub=t,this.localeText=void 0,this.getLocaleText=void 0}setLocaleText(t){this.localeText!==t&&(this.localeText=t,this.eventsHub.emit("locale:change",null))}setLocaleTextFormatter(t){this.getLocaleText=t,this.getLocaleText!==t&&(this.getLocaleText=t,this.eventsHub.emit("locale:change",null))}t(t,e={}){const{localeText:s=ol,getLocaleText:n}=this,a=s[t];return n?.({key:t,defaultValue:a,variables:e})??(({defaultValue:t,variables:e})=>t?.replaceAll(rl,(t,s,n)=>{const a=e[s],o=null==n?null:ll[n];return null!=n&&null==o&&i.warnOnce(`Format style [${n}] is not supported`),null!=o?o.format(a):"number"==typeof a?ll.number.format(a):a instanceof Date?ll.datetime.format(a):String(a)}))({key:t,defaultValue:a,variables:e})??t}},hl=class{constructor(t){this.enabled=!0,this.width=600,this.height=300;const{width:e,height:i,canvasElement:s,willReadFrequently:n=!1}=t;this.pixelRatio=t.pixelRatio??z("devicePixelRatio")??1,this.element=s??j("canvas"),this.element.style.display="block",this.element.style.width=(e??this.width)+"px",this.element.style.height=(i??this.height)+"px",this.element.width=Math.round((e??this.width)*this.pixelRatio),this.element.height=Math.round((i??this.height)*this.pixelRatio),this.context=this.element.getContext("2d",{willReadFrequently:n}),this.onEnabledChange(),this.resize(e??0,i??0,this.pixelRatio),Ms(this.context)}drawImage(t,e=0,i=0){return t.drawImage(this.context.canvas,e,i)}toDataURL(t){return this.element.toDataURL(t)}resize(t,e,i){if(!(t>0&&e>0))return;const{element:s,context:n}=this;s.width=Math.round(t*i),s.height=Math.round(e*i),n.setTransform(i,0,0,i,0,0),s.style.width=t+"px",s.style.height=e+"px",this.width=t,this.height=e,this.pixelRatio=i}clear(){vs(this)}destroy(){this.element.remove(),this.element.width=0,this.element.height=0,this.context.clearRect(0,0,0,0),Object.freeze(this)}reset(){this.context.reset(),this.context.verifyDepthZero?.()}onEnabledChange(){this.element&&(this.element.style.display=this.enabled?"":"none")}};ls([lo(t=>t.onEnabledChange())],hl.prototype,"enabled",2);var dl=class extends A{constructor(){super(...arguments),this.cache=new Map,this.imageLoadingCount=0}loadImage(t,e){const i=this.cache.get(t);if(i?.image)return i.image;if(null!=i&&e)return void i.nodes.add(e);if(!e)return;const s={image:void 0,nodes:new Set([e])},n=new Image;return this.imageLoadingCount++,n.onload=()=>{s.image=n;for(const t of s.nodes)t.markDirty();s.nodes.clear(),this.imageLoadingCount--,this.emit("image-loaded",{uri:t})},n.onerror=()=>{this.imageLoadingCount--,s.nodes.clear(),this.emit("image-error",{uri:t})},n.src=t,this.cache.set(t,s),s.image}waitingToLoad(){return this.imageLoadingCount>0}destroy(){for(const t of this.cache.values())t.nodes.clear();this.cache.clear()}},ul=class{constructor(t){this.canvas=t,this.debug=bs.create(!0,"scene"),this.layersMap=new Map,this.nextLayerId=0}get size(){return this.layersMap.size}resize(t,e,i){this.canvas.resize(t,e,i);for(const{canvas:s}of this.layersMap.values())s.resize(t,e,i)}addLayer(t){const{width:e,height:i,pixelRatio:s}=this.canvas,{name:n}=t,a=new Is({width:e,height:i,pixelRatio:s});return this.layersMap.set(a,{id:this.nextLayerId++,name:n,canvas:a}),this.debug("Scene.addLayer() - layers",this.layersMap),a}removeLayer(t){this.layersMap.has(t)&&(this.layersMap.delete(t),t.destroy(),this.debug("Scene.removeLayer() -  layers",this.layersMap))}clear(){for(const t of this.layersMap.values())t.canvas.destroy();this.layersMap.clear()}},pl=class extends A{constructor(t){super(),this.debug=bs.create(!0,"scene"),this.id=Oi(this),this.imageLoader=new dl,this.root=null,this.pendingSize=null,this.isDirty=!1,this.cleanup=new Mi,this.updateDebugFlags(),this.canvas=new hl(t),this.layersManager=new ul(this.canvas),this.cleanup.register(this.imageLoader.on("image-loaded",()=>{this.emit("scene-changed",{})}),this.imageLoader.on("image-error",({uri:t})=>{i.warnOnce(`Unable to load image ${t}`)}))}waitingForUpdate(){return this.imageLoader?.waitingToLoad()??!1}get width(){return this.pendingSize?.[0]??this.canvas.width}get height(){return this.pendingSize?.[1]??this.canvas.height}get pixelRatio(){return this.pendingSize?.[2]??this.canvas.pixelRatio}setContainer(t){const{element:e}=this.canvas;return e.remove(),t.appendChild(e),this}setRoot(t){return this.root===t||(this.isDirty=!0,this.root?.setScene(),this.root=t,t&&(t.visible=!0,t.setScene(this))),this}updateDebugFlags(){bs.inDevelopmentMode(()=>on._debugEnabled=!0)}clearCanvas(){this.canvas.clear()}attachNode(t){return this.appendChild(t),()=>t.remove()}appendChild(t){return this.root?.appendChild(t),this}removeChild(t){return t.remove(),this}download(t,e){!function(t,e){const i=P("body"),s=j("a",{display:"none"});s.href=t,s.download=e,i.appendChild(s),s.click(),setTimeout(()=>s.remove())}(this.canvas.toDataURL(e),t?.trim()??"image")}getDataURL(t){return this.canvas.toDataURL(t)}resize(t,e,i){return t=Math.round(t),e=Math.round(e),i??(i=this.pixelRatio),t>0&&e>0&&(t!==this.width||e!==this.height||i!==this.pixelRatio)&&(this.pendingSize=[t,e,i],this.isDirty=!0,!0)}render(t){const{debugSplitTimes:e={start:performance.now()},extraDebugStats:s,seriesRect:n}=t??{},{canvas:a,canvas:{context:o}={},root:r,pendingSize:l,width:c,height:h,pixelRatio:d}=this;if(!o)return;const u=bs.check("scene:stats","scene:stats:verbose");u&&this.ensureDebugStatsRegistration();const p=performance.now();let g,m=!1;if(l&&(m=!0,this.layersManager.resize(...l),this.pendingSize=null),r&&!r.visible)return void(this.isDirty=!1);if(r instanceof Oa&&(g=r.dirty),null!=r&&!1===g&&!this.isDirty)return this.debug.check()&&this.debug("Scene.render() - no-op",{tree:Po(r,"console")}),void(u&&To(this.layersManager,e,o,void 0,s,n));const f={ctx:o,width:c,height:h,devicePixelRatio:d,debugNodes:{}};bs.check("scene:stats:verbose")&&(f.stats={layersRendered:0,layersSkipped:0,nodesRendered:0,nodesSkipped:0,opsPerformed:0,opsSkipped:0}),function(t){const e=Qe(z("agChartsSceneDebug")),i=[];for(const t of e)"layout"===t?i.push("seriesRoot","legend","root",/.*Axis-\d+-axis.*/):i.push(t);t.debugNodeSearch=i}(f);let y=!1;if((!1!==g||m)&&(y=!0,a.clear()),r&&bs.check("scene:dirtyTree")){const{dirtyTree:t,paths:e}=zo(r);bs.create("scene:dirtyTree")("Scene.render() - dirtyTree",{dirtyTree:t,paths:e})}if(r&&y){if(r.visible&&r.preRender(f),this.debug.check()){const t=Po(r,"console");this.debug("Scene.render() - before",{canvasCleared:y,tree:t})}if(r.visible)try{o.save(),r.render(f),o.restore()}catch(t){throw this.canvas.reset(),t}}e["✍️"]=performance.now()-p,o.verifyDepthZero?.(),this.isDirty=!1,u&&To(this.layersManager,e,o,f.stats,s,n),function(t,e){t.save();try{for(const[s,n]of Object.entries(e)){const e=Ta.toCanvas(n);e?(t.globalAlpha=.8,t.strokeStyle="red",t.lineWidth=1,t.strokeRect(e.x,e.y,e.width,e.height),t.fillStyle="red",t.strokeStyle="white",t.font="16px sans-serif",t.textBaseline="top",t.textAlign="left",t.lineWidth=2,t.strokeText(s,e.x,e.y,e.width),t.fillText(s,e.x,e.y,e.width)):i.log(`Scene.render() - no bbox for debugged node [${s}].`)}}catch(t){i.warnOnce("Error during debug rendering",t)}finally{t.restore()}}(o,f.debugNodes),r&&this.debug.check()&&this.debug("Scene.render() - after",{tree:Po(r,"console"),canvasCleared:y})}ensureDebugStatsRegistration(){if(this.releaseDebugStats)return;const t=function(){No++;let t=!1;return()=>{t||0===No||(t=!0,0===--No&&Fo())}}(),e=()=>{t(),this.releaseDebugStats=void 0};this.releaseDebugStats=e,this.cleanup.register(e)}toSVG(){const{root:t,width:e,height:i}=this;if(null!=t)return on.toSVG(t,e,i)}strip(){const{context:t,pixelRatio:e}=this.canvas;t.setTransform(e,0,0,e,0,0),this.layersManager.clear(),this.setRoot(null),this.isDirty=!1,this.clear()}destroy(){this.strip(),this.canvas.destroy(),this.imageLoader.destroy(),this.cleanup.flush(),Fo(),Object.assign(this,{canvas:void 0})}};pl.className="Scene";var gl=class{constructor(t,e,i){this.eventsHub=t,this.annotationRoot=e,this.fireChartEvent=i,this.mementoOriginatorKey="annotations",this.annotations=[]}createMemento(){return this.annotations}guardMemento(t){return null==t||G(t)}restoreMemento(t,e,i){this.annotations=this.cleanData(i??[]).map(t=>zs(t,this.getAnnotationTypeStyles(t.type))),this.eventsHub.emit("annotations:restore",{annotations:this.annotations})}updateData(t){this.annotations=this.cleanData(t??[])}fireChangedEvent(){this.fireChartEvent({type:"annotations",annotations:Xa([...this.annotations])})}attachNode(t){return this.annotationRoot.append(t),()=>(t.remove(),this)}setAnnotationStyles(t){this.styles=t}getAnnotationTypeStyles(t){return this.styles?.[t]}cleanData(t){for(const e of t)"textAlign"in e&&delete e.textAlign;return t}},ml=(t=>(t[t.CHART_BACKGROUND=0]="CHART_BACKGROUND",t[t.AXIS_BAND_HIGHLIGHT=1]="AXIS_BAND_HIGHLIGHT",t[t.AXIS_GRID=2]="AXIS_GRID",t[t.AXIS=3]="AXIS",t[t.SERIES_AREA_CONTAINER=4]="SERIES_AREA_CONTAINER",t[t.ZOOM_SELECTION=5]="ZOOM_SELECTION",t[t.SERIES_CROSSLINE_RANGE=6]="SERIES_CROSSLINE_RANGE",t[t.SERIES_LAYER=7]="SERIES_LAYER",t[t.AXIS_FOREGROUND=8]="AXIS_FOREGROUND",t[t.SERIES_CROSSHAIR=9]="SERIES_CROSSHAIR",t[t.SERIES_CROSSLINE_LINE=10]="SERIES_CROSSLINE_LINE",t[t.SERIES_ANNOTATION=11]="SERIES_ANNOTATION",t[t.CHART_ANNOTATION=12]="CHART_ANNOTATION",t[t.CHART_ANNOTATION_FOCUSED=13]="CHART_ANNOTATION_FOCUSED",t[t.STATUS_BAR=14]="STATUS_BAR",t[t.SERIES_LABEL=15]="SERIES_LABEL",t[t.LEGEND=16]="LEGEND",t[t.NAVIGATOR=17]="NAVIGATOR",t[t.FOREGROUND=18]="FOREGROUND",t))(ml||{}),fl=class{constructor(t,e){this.eventsHub=t,this.sceneRoot=e,this.axes=new Map,this.axisGridGroup=new Oa({name:"Axes-Grids",zIndex:2}),this.axisGroup=new Oa({name:"Axes",zIndex:3}),this.axisLabelGroup=new Oa({name:"Axes-Labels",zIndex:15}),this.axisCrosslineRangeGroup=new Oa({name:"Axes-Crosslines-Range",zIndex:6}),this.axisCrosslineLineGroup=new Oa({name:"Axes-Crosslines-Line",zIndex:10}),this.axisCrosslineLabelGroup=new Oa({name:"Axes-Crosslines-Label",zIndex:15}),this.sceneRoot.appendChild(this.axisGroup),this.sceneRoot.appendChild(this.axisGridGroup),this.sceneRoot.appendChild(this.axisLabelGroup),this.sceneRoot.appendChild(this.axisCrosslineRangeGroup),this.sceneRoot.appendChild(this.axisCrosslineLineGroup),this.sceneRoot.appendChild(this.axisCrosslineLabelGroup)}updateAxes(t,e){const i={axisNode:this.axisGroup,gridNode:this.axisGridGroup,labelNode:this.axisLabelGroup,crossLineRangeNode:this.axisCrosslineRangeGroup,crossLineLineNode:this.axisCrosslineLineGroup,crossLineLabelNode:this.axisCrosslineLabelGroup};for(const s of t)e.includes(s)||(s.detachAxis(i),s.destroy());for(const s of e)t?.includes(s)||s.attachAxis(i);this.axes.clear();for(const t of e){const e=t.createAxisContext();this.axes.has(e.direction)?this.axes.get(e.direction)?.push(e):this.axes.set(e.direction,[e])}this.eventsHub.emit("axis:change",null)}getAxisContext(t){return this.axes.get(t)??[]}destroy(){this.axes.clear(),this.axisGroup.remove(),this.axisGridGroup.remove()}},yl=(t=>(t[t.FULL=0]="FULL",t[t.UPDATE_DATA=1]="UPDATE_DATA",t[t.PROCESS_DATA=2]="PROCESS_DATA",t[t.PROCESS_DOMAIN=3]="PROCESS_DOMAIN",t[t.PERFORM_LAYOUT=4]="PERFORM_LAYOUT",t[t.SERIES_UPDATE=5]="SERIES_UPDATE",t[t.PRE_SCENE_RENDER=6]="PRE_SCENE_RENDER",t[t.SCENE_RENDER=7]="SCENE_RENDER",t[t.NONE=8]="NONE",t))(yl||{}),xl=class{constructor(t,e,i){this.eventsHub=t,this.caller=e,this.animationManager=i,this.dispatchOnlyLatest=!0,this.dispatchThrottle=0,this.requestThrottle=300,this.isLoadingInitialData=!1,this.isLoadingData=!1,this.freshRequests=[],this.requestCounter=0,this.pendingData=void 0,this.debug=bs.create(!0,"data-model","data-source"),this.throttledFetch=this.createThrottledFetch(this.requestThrottle),this.throttledDispatch=this.createThrottledDispatch(this.dispatchThrottle)}updateCallback(t){"function"==typeof t&&(this.debug("DataService - updated data source callback"),this.dataSourceCallback=t,this.isLoadingInitialData=!0,this.animationManager.skip(),this.eventsHub.emit("data:source-change",null))}clearCallback(){this.dataSourceCallback=void 0}load(t){const{pendingData:e}=this;if(null!=e&&e.params.windowStart?.valueOf()===t.windowStart?.valueOf()&&e.params.windowEnd?.valueOf()===t.windowEnd?.valueOf()){const t=this.requestCounter++;return this.isLoadingInitialData=!1,void this.dispatch(t,e.data)}this.isLoadingData=!0,this.throttledFetch(t)}isLazy(){return null!=this.dataSourceCallback}isLoading(){return this.isLazy()&&(this.isLoadingInitialData||this.isLoadingData)}async getData(){const{latestRequest:t}=this;if(!t)return;const{params:e,fetchRequest:i}=t;return{params:e,data:await i}}restoreData(t){this.pendingData=t}createThrottledFetch(t){return bt(t=>this.fetch(t).catch(t=>i.error("callback failed",t)),t,{leading:!1,trailing:!0})}createThrottledDispatch(t){return bt((t,e)=>this.dispatch(t,e),t,{leading:!0,trailing:!0})}dispatch(t,e){this.debug(`DataService - dispatching 'data-load' | ${t}`),this.eventsHub.emit("data:load",{data:e})}async fetch(t){"context"in this.caller&&(t.context=this.caller.context);const e=Promise.resolve().then(async()=>{if(!this.dataSourceCallback)throw new Error("DataService - [dataSource.getData] callback not initialised");const s=performance.now(),n=this.requestCounter++;let a;this.debug(`DataService - requesting | ${n}`);try{a=await this.dataSourceCallback(t),this.debug(`DataService - response | ${performance.now()-s}ms | ${n}`)}catch(t){this.debug(`DataService - request failed | ${n}`),i.errorOnce(`DataService - request failed | [${t}]`)}this.isLoadingInitialData=!1;const o=this.freshRequests.indexOf(e);return-1===o||this.dispatchOnlyLatest&&o!==this.freshRequests.length-1?(this.debug(`DataService - discarding stale request | ${n}`),a):(this.freshRequests=this.freshRequests.slice(o+1),0===this.freshRequests.length&&(this.isLoadingData=!1),Array.isArray(a)?this.throttledDispatch(n,a):this.eventsHub.emit("data:error",null),a)});this.latestRequest={params:t,fetchRequest:e},this.freshRequests.push(e),await e}};ls([ro({newValue(t){this.throttledDispatch=this.createThrottledDispatch(t)}})],xl.prototype,"dispatchThrottle",2),ls([ro({newValue(t){this.throttledFetch=this.createThrottledFetch(t)}})],xl.prototype,"requestThrottle",2);var bl=class{constructor(t,e){this.domManager=t,this.updateService=e,this.observers=[]}updateFonts(t){if(t&&0!==t.size){this.loadFonts(t);for(const e of t)this.observeFontStatus(e)}}destroy(){for(const t of this.observers)t.disconnect();this.observers=[]}loadFonts(t){const e=Array.from(t).map(t=>encodeURIComponent(t)),i=":wght@100;200;300;400;500;600;700;800;900",s=`${i}&family=`,n=`@import url('https://fonts.googleapis.com/css2?family=${e.join(s)}${i}&display=swap');\n`;this.domManager.addStyles(`google-font-${e.join("-")}`,n)}observeFontStatus(t){const e=globalThis.document.createElement("div");e.style.setProperty("position","absolute"),e.style.setProperty("top","0"),e.style.setProperty("margin","0"),e.style.setProperty("padding","0"),e.style.setProperty("overflow","hidden"),e.style.setProperty("visibility","hidden"),e.style.setProperty("width","auto"),e.style.setProperty("max-width","none"),e.style.setProperty("font-synthesis","none"),e.style.setProperty("font-family",t),e.style.setProperty("font-size","16px"),e.style.setProperty("white-space","nowrap"),e.textContent="UVWxyz",this.domManager.addChild("canvas-container",`font-check-${encodeURIComponent(t)}`,e);const i=new ResizeObserver(t=>{const e=t?.at(0)?.contentBoxSize.at(0)?.inlineSize;null!=e&&e>0&&(Xi.clear(),this.updateService.update(4))});i.observe(e),this.observers.push(i)}},vl=class{constructor(){this.registeredListeners=new Map}addListener(t,e){const i={symbol:Symbol(t),handler:e};return this.registeredListeners.has(t)?this.registeredListeners.get(t).push(i):this.registeredListeners.set(t,[i]),()=>this.removeListener(i.symbol)}removeListener(t){for(const[e,i]of this.registeredListeners.entries()){const s=i.findIndex(e=>e.symbol===t);if(s>=0){i.splice(s,1),0===i.length&&this.registeredListeners.delete(e);break}}}dispatch(t,...e){for(const s of this.getListenersByType(t))try{s.handler(...e)}catch(t){i.errorOnce(t)}}getListenersByType(t){return this.registeredListeners.get(t)??[]}destroy(){this.registeredListeners.clear()}},Ml=new WeakMap;function Sl(t,e){const i=JSON.stringify(t,null,0);return Ml.has(e)||Ml.set(e,new Map),Ml.get(e)?.has(i)||Ml.get(e)?.set(i,e(t)),Ml.get(e)?.get(i)}var Il=class{constructor(){this.weak=new WeakMap,this.strong=new Map,this.set=!1,this.value=void 0}};function Dl(t,e){let i=new Il;const s=(...s)=>{let n=i;for(const t of s){const e="object"==typeof t||"symbol"==typeof t?n.weak:n.strong;let i=e.get(t);null==i&&(i=new Il,e.set(t,i)),n=i}if(n.set)return e?.("hit",t,s),n.value;{const i=t(...s);return n.set=!0,n.value=i,e?.("miss",t,s),i}};return s.reset=()=>{i=new Il},s}function kl(t,e){const i=new Map,s={},n=new WeakMap;return(...a)=>{const o=0===a.length?[s]:((...t)=>t.map(t=>"object"==typeof t||"symbol"==typeof t?t:(i.has(t)||i.set(t,{v:t}),i.get(t))))(...a);let r=n;for(const t of o.slice(0,-1))r.has(t)||r.set(t,new WeakMap),r=r.get(t);const l=o.at(-1);let c=r.get(l);return c?e?.("hit",t,a):(c=t(...a),r.set(l,c),e?.("miss",t,a)),c}}var Al={millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e",month:"%b",year:"%Y"},wl={millisecond:"%Y %b %e %H:%M:%S.%L",second:"%Y %b %e %H:%M:%S",minute:"%Y %b %e %H:%M",hour:"%Y %b %e %H:%M",day:"%Y %b %e",month:"%Y %b",year:"%Y"},Cl={year:0,month:1,day:2,hour:3,minute:4,second:5,millisecond:6},Nl=/%[-_0]?L/,Ll=/%[-_0]?S/,Tl=/%[-_0]?M/,El=/%[-_0]?[HI]/,Ol=/^%[-_0]?[de]$/,Rl=/^%[-_0]?[Bbm]$/,Pl=/^%[-_0]?[Yy]$/,zl=class t extends vl{constructor(){super(...arguments),this.formats=new Map,this.dateFormatter=Dl((e,i,s,n,a)=>{const o=t.mergeSpecifiers(e,i)??Al;return t.getFormatter("date",o,s,n,{truncateDate:a})}),this.formatter=void 0}static mergeSpecifiers(...t){let e;for(const i of t)e=Y(i)&&Y(e)?{...e,...i}:i;return e}static getFormatter(t,e,s,n="long",{truncateDate:a}={}){if(Y(e)){if("date"!==t)return void i.warn("Date formatter configuration is not supported for non-date types.");s??(s="millisecond");const o="component"===n?e?.[s]??Al[s]:function(t,e,i){if("string"==typeof t)return t;t??(t=Al);const{millisecond:s=Al.millisecond,second:n=Al.second,minute:a=Al.minute,hour:o=Al.hour,day:r=Al.day,month:l=Al.month,year:c=Al.year}=t,h=Cl[e],d=wl[e],u=i?Cl[i]:-1;if(u<Cl.year&&h>=Cl.year&&!Pl.test(c)||u<Cl.month&&h>=Cl.month&&!Rl.test(l)||u<Cl.day&&h>=Cl.day&&!Ol.test(r))return d;let p,g;switch(e){case"year":return c;case"month":return u<Cl.year?`${l} ${c}`:l;case"day":return u<Cl.year?`${l} ${r} ${c}`:`${l} ${r}`;case"hour":p=o;break;case"minute":p=a;break;case"second":p=n;break;case"millisecond":p=s;break;default:return d}return h>=Cl.hour&&!El.test(p)||h>=Cl.minute&&!Tl.test(p)||h>=Cl.second&&!Ll.test(p)||h>=Cl.millisecond&&!Nl.test(p)?d:(u<Cl.year?g=`${l} ${r} ${c}`:u<Cl.month&&(g=`${l} ${r}`),g?`${p} ${g}`:p)}(e,s,a);return xt(o)}switch(t){case"number":{const t=et(e);if(null==t)return;return it(t)}case"date":return xt(e);case"category":return t=>e.replace("%s",String(t))}}setFormatter(t){this.formatter!==t&&(this.formatter=t,this.formats.clear(),this.dateFormatter.reset(),this.dispatch("format-changed"))}format(e,i,{specifier:s,truncateDate:n}={}){if(null==i.value)return;const{formatter:a}=this;if(null==a)return;if("function"==typeof a){const t=e(a,i);return null==t?void 0:String(t)}const o=a[i.property];if(null==o)return;if("function"==typeof o){const t=e(o,i);return null==t||G(t)?t:String(t)}if("date"===i.type){const{unit:t,style:e}=i,a=this.dateFormatter(o,s,t,e,n);return a?.(i.value)}const r=s??o;if("string"!=typeof r)return;let l=this.formats.get(r);return null==l&&(l=t.getFormatter(i.type,r),this.formats.set(r,l)),l?.(i.value,"number"===i.type?i.fractionDigits:void 0)}defaultFormat(t,{specifier:e,truncateDate:i}={}){const{formatter:s}=this,n="function"==typeof s?void 0:s?.[t.property];switch(t.type){case"date":{const{unit:s,style:a}=t,o=null!=n&&"function"!=typeof n?n:void 0,r=this.dateFormatter(o,e,s,a,i);return r?.(t.value)??String(t.value)}case"number":return Zr(t.value,t.fractionDigits);case"category":return Array.isArray(t.value)?t.value.join(" - "):"string"==typeof t.value?t.value:"number"==typeof t.value?Zr(t.value):String(t.value)}}};function jl(t,e){if("string"==typeof t)try{t=In.fromString(t)}catch{t=In.fromArray([0,0,0])}if("string"==typeof e)try{e=In.fromString(e)}catch{e=In.fromArray([0,0,0])}return i=>In.mix(t,e,i).toRgbaString()}var Bl={};rs(Bl,{easeIn:()=>Vl,easeInOut:()=>$l,easeInOutQuad:()=>Wl,easeInQuad:()=>Hl,easeOut:()=>Gl,easeOutQuad:()=>Ul,inverseEaseOut:()=>_l,linear:()=>Fl});var Fl=t=>t,Vl=t=>1-Math.cos(t*Math.PI/2),Gl=t=>Math.sin(t*Math.PI/2),$l=t=>-(Math.cos(t*Math.PI)-1)/2,Hl=t=>t*t,Ul=t=>1-(1-t)**2,Wl=t=>t<.5?2*t*t:1-(-2*t+2)**2/2,_l=t=>2*Math.asin(t)/Math.PI,Yl=["initial","remove","update","add","trailing","end","none"],Kl={initial:{animationDuration:1,animationDelay:0},add:{animationDuration:.25,animationDelay:.75},remove:{animationDuration:.25,animationDelay:0},update:{animationDuration:.5,animationDelay:.25},trailing:{animationDuration:.2,animationDelay:1,skipIfNoEarlierAnimations:!0},end:{animationDelay:1.2,animationDuration:0,skipIfNoEarlierAnimations:!0},none:{animationDuration:0,animationDelay:0}},Zl=(t=>(t.Loop="loop",t.Reverse="reverse",t))(Zl||{});function Xl(t){return t.every(t=>t instanceof on)?{nodes:t,selections:[]}:{nodes:[],selections:t}}function Ql(t,e){return t===e||(Array.isArray(t)&&Array.isArray(e)?t.length===e.length&&t.every((t,i)=>Ql(t,e[i])):us(t)&&us(e)?t.equals(e):!(!Y(t)||!Y(e))&&Ps(t,e,Ql))}var ql=class{constructor(t){this.isComplete=!1,this.elapsed=0,this.iteration=0,this.isPlaying=!1,this.isReverse=!1,this.id=t.id,this.groupId=t.groupId,this.autoplay=t.autoplay??!0,this.ease=t.ease??Fl,this.phase=t.phase;const e=t.duration??Kl[this.phase].animationDuration;this.duration=e*t.defaultDuration,this.delay=(t.delay??0)*t.defaultDuration,this.onComplete=t.onComplete,this.onPlay=t.onPlay,this.onStop=t.onStop,this.onUpdate=t.onUpdate,this.interpolate=this.createInterpolator(t.from,t.to),this.from=t.from,!0===t.skip&&(this.onUpdate?.(t.to,!1,this),this.onStop?.(this),this.onComplete?.(this),this.isComplete=!0),!1!==t.collapsable&&(this.duration=this.checkCollapse(t,this.duration))}checkCollapse(t,e){return Ql(t.from,t.to)?0:e}play(t=!1){this.isPlaying||this.isComplete||(this.isPlaying=!0,this.onPlay?.(this),this.autoplay&&(this.autoplay=!1,t&&this.onUpdate?.(this.from,!0,this)))}stop(){this.isPlaying=!1,this.isComplete||(this.isComplete=!0,this.onStop?.(this))}update(t){if(this.isComplete)return t;!this.isPlaying&&this.autoplay&&this.play(!0);const e=this.elapsed;if(this.elapsed+=t,this.delay>this.elapsed)return 0;const i=this.interpolate(this.isReverse?1-this.delta:this.delta);this.onUpdate?.(i,!1,this);const s=this.delay+this.duration;return this.elapsed>=s?(this.stop(),this.isComplete=!0,this.onComplete?.(this),t-(s-e)):0}get delta(){return this.ease(C(0,(this.elapsed-this.delay)/this.duration,1))}createInterpolator(t,e){if("object"!=typeof e||us(e))return this.interpolateValue(t,e);if(Array.isArray(e)){const i=[];for(let s=0;s<e.length;s++){const n=this.createInterpolator(t[s],e[s]);null!=n&&i.push(n)}return t=>{const e=[];for(const s of i)e.push(s(t));return e}}const i=[];for(const s of Object.keys(e)){const n=this.createInterpolator(t[s],e[s]);null!=n&&i.push([s,n])}return t=>{const e={};for(const[s,n]of i)e[s]=n(t);return e}}interpolateValue(t,e){if(null!=t&&null!=e){if(us(t))return i=>t[ds](e,i);try{switch(typeof t){case"number":return function(t,e){return i=>Number(t)*(1-i)+Number(e)*i}(t,e);case"string":return jl(t,e);case"boolean":if(t===e)return()=>t;break;case"object":return()=>t;default:throw new Error(`Unable to interpolate values: ${t}, ${e}`)}}catch{}throw new Error(`Unable to interpolate values: ${t}, ${e}`)}}},Jl=class{constructor(t){this.maxAnimationTime=t,this.debug=bs.create(!0,"animation"),this.controllers=new Map,this.stoppedCbs=new Set,this.currentPhase=0,this.phases=new Map(Yl.map(t=>[t,[]])),this.skipAnimations=!1,this.animationTimeConsumed=0,this.isReady=!1}get size(){return this.controllers.size}get consumedTimeMs(){return this.animationTimeConsumed}isActive(){return this.controllers.size>0}getActiveControllers(){return this.phases.get(Yl[this.currentPhase])??[]}checkOverlappingId(t){null!=t&&this.controllers.has(t)&&(this.controllers.get(t).stop(),this.debug(`Skipping animation batch due to update of existing animation: ${t}`),this.skip())}addAnimation(t){if(!t.isComplete)return Yl.indexOf(t.phase)<this.currentPhase?(this.debug("Skipping animation due to being for an earlier phase",t.id),void t.stop()):(this.controllers.set(t.id,t),void this.phases.get(t.phase)?.push(t))}removeAnimation(t){this.controllers.delete(t.id);const e=this.phases.get(t.phase),i=e?.indexOf(t);null!=i&&i>=0&&e?.splice(i,1)}progress(t){if(!this.isReady)return;let e=0===t?.01:t;const i=()=>{const t=Yl[this.currentPhase];return{phaseControllers:[...this.getActiveControllers()],phase:t,phaseMeta:Kl[t]}};let{phase:s,phaseControllers:n,phaseMeta:a}=i();const o=()=>null==Yl[this.currentPhase],r=()=>{for(({phase:s,phaseControllers:n,phaseMeta:a}=i());!o()&&0===n.length;)this.currentPhase++,({phase:s,phaseControllers:n,phaseMeta:a}=i()),this.debug(`AnimationBatch - phase changing to ${s}`,{unusedTime:e},n)},l=this.controllers.size;this.debug(`AnimationBatch - ${t}ms; phase ${s} with ${n?.length} of ${l}`);do{const t=e,i=a.skipIfNoEarlierAnimations&&0===this.animationTimeConsumed;let s=0;for(const a of n)i?a.stop():e=Math.min(a.update(t),e),a.isComplete&&(s++,this.removeAnimation(a));this.animationTimeConsumed+=t-e,this.debug(`AnimationBatch - updated ${n.length} controllers; ${s} completed`,n),this.debug(`AnimationBatch - animationTimeConsumed: ${this.animationTimeConsumed}`),r()}while(e>0&&!o());this.animationTimeConsumed>this.maxAnimationTime&&(this.debug("Animation batch exceeded max animation time, skipping",[...this.controllers]),this.stop())}ready(){if(this.isReady)return;this.isReady=!0,this.debug(`AnimationBatch - ready; skipped: ${this.skipAnimations}`,[...this.controllers]);let t=!0;for(const[,e]of this.controllers)if(e.duration>0&&!0!==Kl[e.phase].skipIfNoEarlierAnimations){t=!1;break}if(!t)for(const[,t]of this.controllers)t.autoplay&&t.play(!0)}skip(t=!0){if(!1===this.skipAnimations&&!0===t){for(const t of this.controllers.values())t.stop();this.controllers.clear()}this.skipAnimations=t}play(){for(const t of this.controllers.values())t.play()}stop(){for(const t of this.controllers.values())try{t.stop(),this.removeAnimation(t)}catch(t){i.error("Error during animation stop",t)}this.dispatchStopped()}stopByAnimationId(t){if(null!=t&&this.controllers.has(t)){const e=this.controllers.get(t);e&&(e.stop(),this.removeAnimation(e))}}stopByAnimationGroupId(t){for(const e of this.controllers.values())e.groupId===t&&this.stopByAnimationId(e.id)}dispatchStopped(){for(const t of this.stoppedCbs)t();this.stoppedCbs.clear()}isSkipped(){return this.skipAnimations}getRemainingTime(t){if(!this.isActive())return 0;let e=0;for(const[i,s]of this.phases)0!==s.length&&(null!=t&&t!==i||(e+=Math.max(...s.map(t=>t.isComplete?0:t.delay+t.duration-(t.elapsed??0)))));return e}destroy(){this.stop(),this.controllers.clear()}},tc=(t=>(t[t.Default=32]="Default",t[t.ZoomDrag=16]="ZoomDrag",t[t.Annotations=8]="Annotations",t[t.ContextMenu=4]="ContextMenu",t[t.Animation=2]="Animation",t[t.AnnotationsSelected=1]="AnnotationsSelected",t[t.Clickable=41]="Clickable",t[t.Focusable=34]="Focusable",t[t.Keyable=43]="Keyable",t[t.ContextMenuable=36]="ContextMenuable",t[t.AnnotationsMoveable=9]="AnnotationsMoveable",t[t.AnnotationsDraggable=57]="AnnotationsDraggable",t[t.ZoomDraggable=50]="ZoomDraggable",t[t.ZoomClickable=34]="ZoomClickable",t[t.ZoomWheelable=59]="ZoomWheelable",t[t.All=63]="All",t))(tc||{}),ec=class{constructor(){this.stateQueue=34}pushState(t){this.stateQueue|=t}popState(t){this.stateQueue&=~t}isState(t){return!!(this.stateQueue&-this.stateQueue&t)}};function ic(t){return null==t||!Number.isNaN(t)&&t>=0&&t<=2}var sc=class{constructor(t,e){this.interactionManager=t,this.chartUpdateMutex=e,this.defaultDuration=1e3,this.maxAnimatableItems=1/0,this.batch=new Jl(1.5*this.defaultDuration),this.debug=bs.create(!0,"animation"),this.events=new A,this.rafAvailable="undefined"!=typeof requestAnimationFrame,this.isPlaying=!0,this.requestId=null,this.skipAnimations=!0,this.currentAnonymousAnimationId=0,this.cumulativeAnimationTime=0}addListener(t,e){return this.events.on(t,e)}animate(t){const e=this.batch;try{e.checkOverlappingId(t.id)}catch(t){return void this.failsafeOnError(t)}let{id:i}=t;null==i&&(i=`__${this.currentAnonymousAnimationId}`,this.currentAnonymousAnimationId+=1);const s=this.isSkipped()||"none"===t.phase;s&&this.debug("AnimationManager - skipping animation");const{delay:n,duration:a}=t;if(!ic(n))throw new Error(`Animation delay of ${n} is unsupported (${i})`);if(!ic(a))throw new Error(`Animation duration of ${a} is unsupported (${i})`);const o=new ql({...t,id:i,skip:s,autoplay:!!this.isPlaying&&t.autoplay,phase:t.phase,defaultDuration:this.defaultDuration});if(!this.forceTimeJump(o,this.defaultDuration))return this.batch.addAnimation(o),o}play(){if(!this.isPlaying){this.isPlaying=!0,this.debug("AnimationManager.play()");try{this.batch.play()}catch(t){this.failsafeOnError(t)}this.requestAnimation()}}stop(){this.isPlaying=!1,this.cancelAnimation(),this.debug("AnimationManager.stop()"),this.batch.stop()}stopByAnimationId(t){try{this.batch.stopByAnimationId(t)}catch(t){this.failsafeOnError(t)}}stopByAnimationGroupId(t){try{this.batch.stopByAnimationGroupId(t)}catch(t){this.failsafeOnError(t)}}reset(){this.isPlaying?(this.stop(),this.play()):this.stop()}skip(t=!0){this.skipAnimations=t}isSkipped(){return!this.rafAvailable||this.skipAnimations||this.batch.isSkipped()}isActive(){return this.isPlaying&&this.batch.isActive()}getRemainingTime(t){return this.batch.getRemainingTime(t)}getCumulativeAnimationTime(){return this.cumulativeAnimationTime}skipCurrentBatch(){this.debug.check()&&this.debug("AnimationManager - skipCurrentBatch()",{stack:new Error("Stack trace for animation skip tracking").stack}),this.batch.skip()}isSkippingFrames(){return!0}scheduleAnimationFrame(t){this.requestId=z().requestAnimationFrame(e=>{t(e).catch(t=>i.error(t))})}forceTimeJump(t,e){return!1}requestAnimation(){if(!this.rafAvailable)return;if(!this.batch.isActive()||null!==this.requestId)return;let t;const e=async i=>{await this.debug.group("AnimationManager.onAnimationFrame()",async()=>{const s=()=>{const e=i-(t??i);t=i,this.debug("AnimationManager",{controllersCount:this.batch.size,deltaTime:e}),this.interactionManager.pushState(2);try{this.batch.progress(e),this.cumulativeAnimationTime+=e}catch(t){this.failsafeOnError(t)}this.events.emit("animation-frame",{type:"animation-frame",deltaMs:e})};this.isSkippingFrames()?await this.chartUpdateMutex.acquireImmediately(s):await this.chartUpdateMutex.acquire(s),this.batch.isActive()?this.scheduleAnimationFrame(e):(this.batch.stop(),this.events.emit("animation-stop",{type:"animation-stop",deltaMs:this.batch.consumedTimeMs}))})};this.events.emit("animation-start",{type:"animation-start",deltaMs:0}),this.scheduleAnimationFrame(e)}cancelAnimation(){null!==this.requestId&&(cancelAnimationFrame(this.requestId),this.events.emit("animation-stop",{type:"animation-stop",deltaMs:this.batch.consumedTimeMs}),this.requestId=null,this.startBatch())}failsafeOnError(t,e=!0){i.error("Error during animation, skipping animations",t),e&&this.cancelAnimation()}startBatch(t){this.debug(`AnimationManager - startBatch() with skipAnimations=${t}.`),this.reset(),this.batch.destroy(),this.batch=new Jl(1.5*this.defaultDuration),!0===t&&this.batch.skip()}endBatch(){this.batch.isActive()?(this.batch.ready(),this.requestAnimation()):(this.interactionManager.popState(2),this.batch.isSkipped()&&this.batch.skip(!1))}onBatchStop(t){this.batch.stoppedCbs.add(t)}destroy(){this.stop(),this.events.clear()}},nc=class{constructor(){this.download={type:"action",showOn:"always",label:"contextMenuDownload",enabled:!0,action:void 0,items:void 0},this["zoom-to-cursor"]={type:"action",showOn:"series-area",label:"contextMenuZoomToCursor",enabled:!0,action:void 0,items:void 0},this["pan-to-cursor"]={type:"action",showOn:"series-area",label:"contextMenuPanToCursor",enabled:!0,action:void 0,items:void 0},this["reset-zoom"]={type:"action",showOn:"series-area",label:"contextMenuResetZoom",enabled:!0,action:void 0,items:void 0},this["toggle-series-visibility"]={type:"action",showOn:"legend-item",label:"contextMenuToggleSeriesVisibility",enabled:!0,action:void 0,items:void 0},this["toggle-other-series"]={type:"action",showOn:"legend-item",label:"contextMenuToggleOtherSeries",enabled:!0,action:void 0,items:void 0},this.separator={type:"separator",showOn:"always",label:"separator",enabled:!0,action:void 0,items:void 0}}},ac=class{constructor(){this.defaults=["download","zoom-to-cursor","pan-to-cursor","reset-zoom","toggle-series-visibility","toggle-other-series"]}},oc=class{constructor(){this.items=new nc,this.lists=new ac}},rc=class{constructor(t){this.eventsHub=t,this.builtins=new oc,this.hiddenActions=new Set,this.toggle("zoom-to-cursor","hide"),this.toggle("pan-to-cursor","hide"),this.toggle("reset-zoom","hide")}static check(t,e){return e.showOn==t}static checkCallback(t,e,i){return t===e}dispatchContext(t,e,i,s){const{widgetEvent:n}=e;if(n.sourceEvent.defaultPrevented)return;const a={showOn:t,x:s?.x??e.canvasX,y:s?.y??e.canvasY,context:i,widgetEvent:n};this.eventsHub.emit("context-menu:setup",a),this.eventsHub.emit("context-menu:complete",a)}isVisible(t){return!this.hiddenActions.has(t)}toggle(t,e){switch(e??(e=this.isVisible(t)?"hide":"show"),e){case"show":this.hiddenActions.delete(t);break;case"hide":this.hiddenActions.add(t)}}},lc=class{constructor(t){this.eventsHub=t,this.highlightStates=new Er}updateHighlight(t,e){const i=this.getActiveHighlight();this.highlightStates.set(t,e);const s=this.getActiveHighlight();this.isEqual(s,i)||this.eventsHub.emit("highlight:change",{callerId:t,currentHighlight:s,previousHighlight:i})}getActiveHighlight(){return this.highlightStates.stateValue()}isEqual(t,e){return t===e||null!=t&&null!=e&&t?.series===e?.series&&t?.itemId===e?.itemId&&t?.datum===e?.datum}},cc=(t=>(t[t.None=0]="None",t[t.Item=1]="Item",t[t.Series=2]="Series",t[t.OtherSeries=3]="OtherSeries",t[t.OtherItem=4]="OtherItem",t))(cc||{}),hc=[0,1,2,3,4];function dc(t){switch(t){case 1:return"highlighted-item";case 4:return"unhighlighted-item";case 2:return"highlighted-series";case 3:return"unhighlighted-series";case 0:return"none";default:return t}}var uc=class extends Pn{};ls([ws],uc.prototype,"fill",2),ls([ws],uc.prototype,"fillOpacity",2),ls([ws],uc.prototype,"stroke",2),ls([ws],uc.prototype,"strokeWidth",2),ls([ws],uc.prototype,"strokeOpacity",2),ls([ws],uc.prototype,"lineDash",2),ls([ws],uc.prototype,"lineDashOffset",2);var pc=class extends Pn{constructor(){super(...arguments),this.enabled=!0,this.range="tooltip",this.bringToFront=!1,this.highlightedItem={},this.unhighlightedItem={},this.highlightedSeries={},this.unhighlightedSeries={}}getItemHighlightStyle(t){switch(t){case 1:return this.highlightedItem;case 4:return this.unhighlightedItem;case 2:return this.highlightedSeries;case 3:return this.unhighlightedSeries}}getSeriesHighlightStyle(t){switch(t){case 1:case 4:case 2:return this.highlightedSeries;case 3:return this.unhighlightedSeries}}getStyle(t){return zs(this.getItemHighlightStyle(t),this.getSeriesHighlightStyle(t))}};ls([ws],pc.prototype,"enabled",2),ls([ws],pc.prototype,"range",2),ls([ws],pc.prototype,"bringToFront",2),ls([ws],pc.prototype,"highlightedItem",2),ls([ws],pc.prototype,"unhighlightedItem",2),ls([ws],pc.prototype,"highlightedSeries",2),ls([ws],pc.prototype,"unhighlightedSeries",2);var gc=class extends Pn{};ls([ws],gc.prototype,"strokeWidth",2),ls([ws],gc.prototype,"dimOpacity",2),ls([ws],gc.prototype,"enabled",2);var mc=class extends Pn{constructor(){super(...arguments),this.color="black"}};ls([ws],mc.prototype,"color",2);var fc=class extends Pn{constructor(){super(...arguments),this.fill="#c16068",this.fillOpacity=1,this.stroke="#874349",this.strokeWidth=2,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};ls([ws],fc.prototype,"start",2),ls([ws],fc.prototype,"stop",2),ls([ws],fc.prototype,"fill",2),ls([ws],fc.prototype,"fillOpacity",2),ls([ws],fc.prototype,"stroke",2),ls([ws],fc.prototype,"strokeWidth",2),ls([ws],fc.prototype,"strokeOpacity",2),ls([ws],fc.prototype,"lineDash",2),ls([ws],fc.prototype,"lineDashOffset",2);var yc=class{constructor(){this.key="x",this.segments=new zn(fc)}};ls([ws],yc.prototype,"enabled",2),ls([ws],yc.prototype,"key",2),ls([ws],yc.prototype,"segments",2);var xc=class extends Pn{constructor(){super(...arguments),this.type="gradient",this.colorStops=[],this.bounds="item",this.gradient="linear",this.rotation=0,this.reverse=!1,this.colorSpace="rgb"}};ls([ws],xc.prototype,"type",2),ls([ws],xc.prototype,"colorStops",2),ls([ws],xc.prototype,"bounds",2),ls([ws],xc.prototype,"gradient",2),ls([ws],xc.prototype,"rotation",2),ls([ws],xc.prototype,"reverse",2),ls([ws],xc.prototype,"colorSpace",2);var bc=class extends Pn{constructor(){super(...arguments),this.type="pattern",this.colorStops=[],this.bounds="item",this.gradient="linear",this.rotation=0,this.scale=1,this.reverse=!1,this.pattern="forward-slanted-lines",this.width=26,this.height=26,this.padding=6,this.fill="black",this.fillOpacity=1,this.backgroundFill="white",this.backgroundFillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0}};ls([ws],bc.prototype,"type",2),ls([ws],bc.prototype,"colorStops",2),ls([ws],bc.prototype,"bounds",2),ls([ws],bc.prototype,"gradient",2),ls([ws],bc.prototype,"rotation",2),ls([ws],bc.prototype,"scale",2),ls([ws],bc.prototype,"reverse",2),ls([ws],bc.prototype,"path",2),ls([ws],bc.prototype,"pattern",2),ls([ws],bc.prototype,"width",2),ls([ws],bc.prototype,"height",2),ls([ws],bc.prototype,"padding",2),ls([ws],bc.prototype,"fill",2),ls([ws],bc.prototype,"fillOpacity",2),ls([ws],bc.prototype,"backgroundFill",2),ls([ws],bc.prototype,"backgroundFillOpacity",2),ls([ws],bc.prototype,"stroke",2),ls([ws],bc.prototype,"strokeOpacity",2),ls([ws],bc.prototype,"strokeWidth",2);var vc=class extends Pn{constructor(){super(...arguments),this.type="image",this.url="",this.rotation=0,this.scale=1,this.backgroundFill="black",this.backgroundFillOpacity=1,this.repeat="no-repeat",this.fit="contain"}};ls([ws],vc.prototype,"type",2),ls([ws],vc.prototype,"url",2),ls([ws],vc.prototype,"rotation",2),ls([ws],vc.prototype,"scale",2),ls([ws],vc.prototype,"backgroundFill",2),ls([ws],vc.prototype,"backgroundFillOpacity",2),ls([ws],vc.prototype,"repeat",2),ls([ws],vc.prototype,"fit",2);var Mc=class extends Pn{constructor(t=!0){super(),this.deprecated=t,this.item=new uc,this.series=new gc,this.text=new mc}set(t){return this.deprecated&&i.warnOnce("highlightStyle is deprecated, use highlight instead."),super.set(t)}};ls([ws],Mc.prototype,"item",2),ls([ws],Mc.prototype,"series",2),ls([ws],Mc.prototype,"text",2);var Sc=class extends Pn{constructor(){super(...arguments),this.visible=!0,this.focusPriority=1/0,this.showInLegend=!0,this.cursor="default",this.nodeClickRange="exact",this.highlight=new pc,this.highlightStyle=new Mc}handleUnknownProperties(t,e){"context"in e&&(this.context=e.context,t.delete("context"))}};function Ic(t,e){if(null==t||0===e.length)return[!1,!1];const i=t.valueOf(),s=e[0],n=e.at(-1);if("string"==typeof s)return[i===s,i===n];let a=s.valueOf(),o=n.valueOf();return a>o&&([a,o]=[o,a]),[i===a,i===o]}function Dc(t,e,i,s,n,a){const[o,r]=Ic(e,a),[l,c]=Ic(t,n);return{xKey:i,yKey:s,xValue:t,yValue:e,first:l,last:c,min:o,max:r}}function kc(t,e,[i,s],n){let a=bi(0,e-1,s=>{const a=1===t?s:e-s,o=n(a)?.[1]??Number.NaN;return!Number.isFinite(o)||o>=i})??0,o=xi(0,e-1,i=>{const a=1===t?i:e-i,o=n(a)?.[0]??Number.NaN;return!Number.isFinite(o)||o<=s})??e-1;return-1===t&&([a,o]=[e-o,e-a]),a=Math.max(a,0),o=Math.min(o+1,e),[a,o]}function Ac(t,e,i){if(i){const{x:t,y:e,width:s,height:n}=i;return{canvasX:t+s/2,canvasY:e+n/2}}const s=e.yBar?.upperPoint??e.midPoint??t.datumMidPoint?.(e);if(s){const{x:e,y:i}=Ta.toCanvasPoint(t.contentGroup,s.x,s.y);return{canvasX:Math.round(e),canvasY:Math.round(i)}}}function wc(t,e,i,s,n){let a=-1,o=0,r=0,l=!1;for(;o<s&&a<=e-t;){a+=1;const s=i+r;l||(r*=-1),r>=0&&(r+=1),l&&r<0&&(r-=1),s<t||s>e?l=!0:n(s)&&(o+=1)}return o}function Cc(t){const e={};for(const i of hc)e[i]=t(void 0,!1,i);return e}function Nc(t,...e){const i={};for(const s of e??["default"])for(const e of hc)(i[s]??(i[s]={}))[e]=t(void 0,!1,e,s);return i}ls([ws],Sc.prototype,"id",2),ls([ws],Sc.prototype,"visible",2),ls([ws],Sc.prototype,"focusPriority",2),ls([ws],Sc.prototype,"showInLegend",2),ls([ws],Sc.prototype,"cursor",2),ls([ws],Sc.prototype,"nodeClickRange",2),ls([ws],Sc.prototype,"highlight",2),ls([ws],Sc.prototype,"highlightStyle",2);var Lc=class{constructor(t,e,i,s){this.domManager=i,this.tooltip=s,this.stateTracker=new Er,this.suppressState=new Er(!1),this.appliedState=null,this.cleanup=new Mi,this.cleanup.register(s.setup(e,i),t.on("dom:hidden",()=>this.tooltip.hide()))}destroy(){this.cleanup.flush()}updateTooltip(t,e,i,s){i??(i=this.stateTracker.get(t)?.content),this.stateTracker.set(t,{meta:e,content:i,pagination:s}),this.applyStates()}removeTooltip(t){this.stateTracker.delete(t),this.applyStates()}suppressTooltip(t){this.suppressState.set(t,!0)}unsuppressTooltip(t){this.suppressState.delete(t)}applyStates(){const t=this.stateTracker.stateId(),e=t?this.stateTracker.get(t):void 0;if(this.suppressState.stateValue()||null==e?.meta||null==e?.content)return this.appliedState=null,void this.tooltip.hide();const i=this.domManager.getBoundingClientRect(),s="extended"===this.tooltip.bounds?this.domManager.getOverlayClientRect():i;if(Rs(this.appliedState?.content,e?.content)&&Rs(this.appliedState?.pagination,e?.pagination)){const t=this.tooltip.isVisible();this.tooltip.show(s,i,e?.meta,null,void 0,t)}else this.tooltip.show(s,i,e?.meta,e?.content,e?.pagination);this.appliedState=e}static makeTooltipMeta(t,e,i,s){const{canvasX:n,canvasY:a}=t,o=e.properties.tooltip,{placement:r,anchorTo:l,xOffset:c,yOffset:h}=o.position,d=Ac(e,i,s);return{canvasX:n,canvasY:a,nodeCanvasX:d?.canvasX??n,nodeCanvasY:d?.canvasY??a,enableInteraction:o.interaction?.enabled??!1,showArrow:o.showArrow,position:{placement:r,anchorTo:l,xOffset:c,yOffset:h}}}};function Tc(t,e){const{device:i,offsetX:s,offsetY:n,clientX:a,clientY:o,currentX:r,currentY:l,sourceEvent:c}=e;return{type:t,device:i,offsetX:s,offsetY:n,clientX:a,clientY:o,currentX:r,currentY:l,sourceEvent:c}}function Ec(t,e){return t*t+e*e>=9}var Oc=class{constructor(t){this.cleanup=new Mi,this.events=new A,this.isDragging=!1,this.touch={distanceTravelledX:0,distanceTravelledY:0,clientX:0,clientY:0},this.cleanup.register(t.addListener("touchstart",this.onTouchStart.bind(this)),t.addListener("touchmove",this.onTouchMove.bind(this)),t.addListener("touchend",this.onTouchEnd.bind(this)),t.addListener("mousemove",this.onMouseMove.bind(this)),t.addListener("dblclick",this.onDblClick.bind(this)),t.addListener("drag-start",this.onDragStart.bind(this)),t.addListener("drag-move",this.onDragMove.bind(this)),t.addListener("drag-end",this.onDragEnd.bind(this)))}destroy(){this.cleanup.flush()}onTouchStart(t){const{clientX:e,clientY:i}=t.sourceEvent.targetTouches[0]??{clientX:1/0,clientY:1/0};this.touch.distanceTravelledX=0,this.touch.distanceTravelledY=0,this.touch.clientX=e,this.touch.clientY=i}onTouchMove(t){const{clientX:e,clientY:i}=t.sourceEvent.targetTouches[0]??{clientX:1/0,clientY:1/0};this.touch.distanceTravelledX+=Math.abs(this.touch.clientX-e),this.touch.distanceTravelledY+=Math.abs(this.touch.clientY-i),this.touch.clientX=e,this.touch.clientY=i}onTouchEnd(t){t.sourceEvent.preventDefault()}onMouseMove(t){this.events.emit("mousemove",t)}onDblClick(t){this.events.emit("dblclick",t)}onDragStart(t){this.dragStartEvent=t}onDragMove(t){null!=this.dragStartEvent&&Ec(t.originDeltaX,t.originDeltaY)&&(this.events.emit("drag-start",this.dragStartEvent),this.events.emit("drag-move",{...this.dragStartEvent,type:"drag-move"}),this.dragStartEvent=void 0,this.isDragging=!0),this.isDragging&&this.events.emit("drag-move",t)}onDragEnd(t){if(this.isDragging)return this.events.emit("drag-end",t),void(this.isDragging=!1);if("mouse"===t.device){const e=Tc("click",t);this.events.emit("click",e)}else if("touchend"===t.sourceEvent.type){if(Ec(this.touch.distanceTravelledX,this.touch.distanceTravelledY))return;const e=Tc("click",t);this.events.emit("click",e);const i=Date.now();if(void 0!==this.lastClick&&i-this.lastClick.time<=505&&function(t,e){const i=t.clientX-e.clientX,s=t.clientY-e.clientY;return i*i+s*s<900}(this.lastClick,t)){const e=Tc("dblclick",t);this.events.emit("dblclick",e),this.lastClick=void 0}else this.lastClick={time:i,clientX:t.clientX,clientY:t.clientY}}}},Rc=class extends Yr{constructor(t){super(t)}addChildToDOM(){}removeChildFromDOM(){}},Pc=class{constructor(t,e){this.seriesWidget=new Rc(t.getParent("series-area")),this.chartWidget=new Rc(t.getParent("canvas-proxy")),this.containerWidget=new Rc(t.getParent("canvas-container")),this.containerWidget.addChild(this.chartWidget),this.chartWidget.addChild(this.seriesWidget),e.withDragInterpretation&&(this.seriesDragInterpreter=new Oc(this.seriesWidget))}destroy(){this.seriesDragInterpreter?.destroy(),this.seriesWidget.destroy(),this.chartWidget.destroy(),this.containerWidget.destroy()}};function zc(t,e){const[i,s]=jc(e);return C(i,t,s)}function jc(t){if(0===t.length)return[];const e=[1/0,-1/0];for(const i of t)i<e[0]&&(e[0]=i),i>e[1]&&(e[1]=i);return e}function Bc(t){const[e,i]=jc(t);return i-e}function Fc(t){return(t=Math.trunc(t))<=0?1:1===t?2:1<<32-Math.clz32(t-1)}function Vc(t){return(t=Math.trunc(t))<=0?0:1===t?1:1<<31-Math.clz32(t)}var Gc=class t extends kn{constructor(e=[],i=[]){super(),this.domain=e,this.range=i,this.defaultTickCount=t.defaultTickCount,this.defaultClamp=!1}static is(e){return e instanceof t}normalizeDomains(...t){return Hc(...t)}calcBandwidth(t=1,e=1){const{domain:i}=this,s=this.getPixelRange();if(0===i.length)return s;let n=Math.abs(i[1].valueOf()-i[0].valueOf())/t+1;if(0!==e){const t=Math.floor(s);n=Math.min(n,t)}return s/Math.max(1,n)}convert(t,e){const{domain:i}=this;if(!i||i.length<2||null==t)return Number.NaN;const{range:s}=this,n=e?.clamp??this.defaultClamp;let a=i[0].valueOf(),o=i[1].valueOf(),r=t.valueOf();if(this.transform&&(a=this.transform(a),o=this.transform(o),r=this.transform(r)),n){const[t,e]=jc([a,o]);if(r<t)return s[0];if(r>e)return s[1]}if(a===o)return(s[0]+s[1])/2;if(r===a)return s[0];if(r===o)return s[1];const l=s[0];return l+(r-a)/(o-a)*(s[1]-l)}invert(t,e){const{domain:i}=this;if(i.length<2)return;let s=i[0].valueOf(),n=i[1].valueOf();this.transform&&(s=this.transform(s),n=this.transform(n));const{range:a}=this,[o,r]=a;let l;return l=o===r?this.toDomain((s+n)/2):this.toDomain(s+(t-o)/(r-o)*(n-s)),this.transformInvert?this.transformInvert(l):l}getPixelRange(){const[t,e]=this.range;return Math.abs(e-t)}};Gc.defaultTickCount=5;var $c=Gc;function Hc(...t){let e,i,s=1/0,n=-1/0;for(const a of t)for(const t of a){const a=t.valueOf();a<s&&(s=a,e=t),a>n&&(n=a,i=t)}return null!=e&&null!=i?{domain:[e,i],animatable:!0}:{domain:[],animatable:!1}}var Uc=class t extends kn{constructor(){super(...arguments),this.invalid=!0,this.range=[0,1],this.round=!1,this._bandwidth=1,this._step=1,this._inset=1,this._rawBandwidth=1,this._paddingInner=0,this._paddingOuter=0}static is(e){return e instanceof t}get bandwidth(){return this.refresh(),this._bandwidth}get step(){return this.refresh(),this._step}get inset(){return this.refresh(),this._inset}get rawBandwidth(){return this.refresh(),this._rawBandwidth}set padding(t){t=C(0,t,1),this._paddingInner=t,this._paddingOuter=t}get padding(){return this._paddingInner}set paddingInner(t){this.invalid=!0,this._paddingInner=C(0,t,1)}get paddingInner(){return this._paddingInner}set paddingOuter(t){this.invalid=!0,this._paddingOuter=C(0,t,1)}get paddingOuter(){return this._paddingOuter}refresh(){this.invalid&&(this.invalid=!1,this.update(),this.invalid&&i.warnOnce("Expected update to not invalidate scale"))}convert(t,e){this.refresh();const i=this.findIndex(t,e?.alignment);return null==i||i<0||i>=this.bands.length?Number.NaN:this.ordinalRange(i)}invertNearestIndex(t){this.refresh();const e=this.bands.length;if(0===e)return-1;let i=0,s=e-1,n=1/0,a=0;for(;i<=s;){const e=Math.trunc((s+i)/2),o=this.ordinalRange(e),r=Math.abs(o-t);if(0===r)return e;r<n&&(n=r,a=e),o<t?i=e+1:s=e-1}return a}update(){const[t,e]=this.range;let{_paddingInner:i}=this;const{_paddingOuter:s,bands:n}=this,a=n.length;if(0===a)return;const o=e-t;let r;1===a?(i=0,r=o*(1-2*s)):r=o/Math.max(1,a-i+2*s);const l=this.round&&Math.floor(r)>0,c=l?Math.floor(r):r;let h=t+(o-c*(a-i))/2,d=c*(1-i);l&&(h=Math.round(h),d=Math.round(d)),this._step=c,this._inset=h,this._bandwidth=d,this._rawBandwidth=r*(1-i)}ordinalRange(t){const{_inset:e,_step:i,range:s}=this;return C(Math.min(s[0],s[1]),e+i*t,Math.max(s[0],s[1]))}};ls([An],Uc.prototype,"range",2),ls([An],Uc.prototype,"round",2);var Wc=Uc,_c=class t extends Wc{static is(e){return e instanceof t}toDomain(t){return new Date(t)}get reversed(){const{domain:t}=this;return t.length>0&&t[0].valueOf()>t.at(-1).valueOf()}convert(t,e){this.refresh(),t instanceof Date||(t=new Date(t));const{domain:i,bands:s,reversed:n}=this;if(i.length<=0)return Number.NaN;const a=this.ordinalRange(0),o=this.ordinalRange(s.length-1);if(0===s.length)return a;if(!0===e?.clamp){const{range:e}=this;if(t<s[0])return e[0];if(t>s.at(-1))return e[1]}if(2!==(e?.alignment??0)){const i=super.convert(t,e);return n?o-(i-a):i}const r=t.valueOf();let l,c=this.findIndex(t)??0;n?(c=Math.min(Math.max(c,1),s.length-1),l=-1):(c=Math.min(Math.max(c,0),s.length-2),l=1);const h=s[c].valueOf(),d=s[c+l].valueOf(),u=this.ordinalRange(c),p=(r-h)/(d-h)*(this.ordinalRange(c+l)-u)+u;return n?o-(p-a):p}invert(t,e=!1){this.refresh();const{domain:i,bands:s}=this;if(i.length<=0)return;const n=i[0].valueOf()>i.at(-1).valueOf();let a;return a=e?this.invertNearestIndex(t-this.bandwidth/2):bi(0,s.length-1,e=>this.ordinalRange(e)>=t)??s.length-1,s[n?s.length-1-a:a]}findIndex(t,e=0){const{bands:i}=this,s=t.valueOf();return 1===e?bi(0,i.length-1,t=>i[t].valueOf()>=s):xi(0,i.length-1,t=>i[t].valueOf()<=s)}},Yc={bottomCenter:function(t){return{x:(t.x1+t.x2)/2,y:Math.max(t.y1,t.y2)}},center:function(t){return{x:(t.x1+t.x2)/2,y:(t.y1+t.y2)/2}},clone:function(t){return{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}},collides:function(t,e){const i=Kc(t),s=Kc(e);return i.x1<=s.x2&&i.x2>=s.x1&&i.y1<=s.y2&&i.y2>=s.y1},end:function(t){return{x:t.x2,y:t.y2}},from:function(t,e,i,s){if("number"==typeof t)return{x1:t,y1:e,x2:i,y2:s};if("width"in t)return Kc({x1:t.x,y1:t.y,x2:t.x+t.width,y2:t.y+t.height});throw new Error(`Values can not be converted into a vector4: [${JSON.stringify(t)}] [${e}] [${i}] [${s}]`)},height:function(t){return Math.abs(t.y2-t.y1)},round:function(t){return{x1:Math.round(t.x1),y1:Math.round(t.y1),x2:Math.round(t.x2),y2:Math.round(t.y2)}},start:function(t){return{x:t.x1,y:t.y1}},topCenter:function(t){return{x:(t.x1+t.x2)/2,y:Math.min(t.y1,t.y2)}},origin:function(){return{x1:0,y1:0,x2:0,y2:0}},width:function(t){return Math.abs(t.x2-t.x1)}};function Kc(t){return{x1:Math.min(t.x1,t.x2),x2:Math.max(t.x1,t.x2),y1:Math.min(t.y1,t.y2),y2:Math.max(t.y1,t.y2)}}function Zc(t,e,i,s,n){return e+(n-t)/(i-t)*(s-e)}function Xc(t,e,i,s,n){return t+(i-t)/(s-e)*(n-e)}function Qc(t,e,i){return[Xc(t,i.min,e,i.max,0),Xc(t,i.min,e,i.max,1)]}function qc(t,e,i,s,n,a){if(i<=n&&a<=s)return i;const o=n-i,r=a-s;return C(t,i+(Math.abs(o)<Math.abs(r)?o:r),e)}function Jc(t,e){const i=t?.valueOf(),s=e?.valueOf();return"number"!=typeof i||"number"!=typeof s?[void 0,void 0]:i<s?[0,1]:[1,0]}var th=class{constructor(){this.enabled=!1,this.padding=0,this.manuallyAdjusted=!1}},eh=t=>Bt((e,{options:i})=>!$c.is(t?.scale)&&!_c.is(t?.scale)||null==e||null==i.end||e<i.end,"to be less than end"),ih=class extends gr{constructor(t,e){super(),this.eventsHub=t,this.fireChartEvent=e,this.mementoOriginatorKey="zoom",this.axisZoomManagers=new Map,this.state=new Er(void 0,"initial"),this.axes=[],this.didLayoutAxes=!1,this.autoScaleYAxis=new th,this.lastRestoredState=void 0,this.independentAxes=!1,this.navigatorModule=!1,this.zoomModule=!1,this.pendingMemento=void 0,this.boundFireOnceChartEvent=this.fireOnceChartEvent.bind(this),this.cleanup.register(t.on("layout:complete",()=>{this.didLayoutAxes=!0;const{pendingMemento:t}=this;t&&this.restoreMemento(t.version,t.mementoVersion,t.memento),this.autoScaleYZoom("zoom-manager")}))}createMemento(){return this.getMementoRanges()}guardMemento(t,e){if(null==t)return!0;if(!W(t))return!1;const i=this.getPrimaryAxis("x"),s=this.getPrimaryAxis("y"),n={rangeX:{start:eh(i),end:Jt},rangeY:{start:eh(s),end:Jt},ratioX:{start:Jt,end:Jt},ratioY:{start:Jt,end:Jt},autoScaledAxes:Jt},{invalid:a}=jt(t,n);return!(a.length>0&&(e.push(...a.map(String)),1))}restoreMemento(t,e,i){const{independentAxes:s}=this;if(!this.axes||!this.didLayoutAxes)return void(this.pendingMemento={version:t,mementoVersion:e,memento:i});this.pendingMemento=void 0;const n=this.getDefinedZoom();if(n.x=i?.rangeX?this.rangeToRatio(i.rangeX,"x")??{min:0,max:1}:i?.ratioX?{min:i.ratioX.start??0,max:i.ratioX.end??1}:{min:0,max:1},!this.navigatorModule||this.zoomModule){let t=i?.autoScaledAxes?.includes("y");if(i?.rangeY)t??(t=!1),n.y=this.rangeToRatio(i.rangeY,"y")??{min:0,max:1};else if(i?.ratioY)t??(t=!1),n.y={min:i.ratioY.start??0,max:i.ratioY.end??1};else{t??(t=!0);const e=t?this.getAutoScaleYZoom(n.x):void 0;n.y=e??{min:0,max:1}}n.autoScaleYAxis=t}if(this.lastRestoredState=n,!0!==s)return void this.updateZoom("zoom-manager",n);const a=this.getPrimaryAxis("x"),o=this.getPrimaryAxis("y");for(const t of[a,o])t&&this.updateAxisZoom("zoom-manager",t.id,n[t.direction])}updateAxes(t){const{axes:e,axisZoomManagers:i}=this,s=new Map(i);i.clear(),e.length=0;for(const n of t)"string"==typeof n?i.set(n,s.get(n)??new sh(n)):(e.push(n),i.set(n.id,s.get(n.id)??new sh(n)));this.state.size>0&&e.length>0&&this.updateZoom(this.state.stateId(),this.state.stateValue())}setIndependentAxes(t=!0){this.independentAxes=t}setAutoScaleYAxis(t,e){this.autoScaleYAxis.enabled=t,this.autoScaleYAxis.padding=e,t&&this.autoScaleYZoom("toggle-auto-scale")}setNavigatorEnabled(t=!0){this.navigatorModule=t}setZoomModuleEnabled(t=!0){this.zoomModule=t}isNavigatorEnabled(){return this.navigatorModule}isZoomEnabled(){return this.zoomModule}updateZoom(t,e){if(e?.x&&(e.x.min<0||e.x.max>1)&&(i.warnOnce(`Attempted to update x-axis zoom to an invalid ratio of [{ min: ${e.x.min}, max: ${e.x.max} }], expecting a ratio of 0 to 1, ignoring.`),e.x=void 0),e?.y&&(e.y.min<0||e.y.max>1)&&(i.warnOnce(`Attempted to update y-axis zoom to an invalid ratio of [{ min: ${e.y.min}, max: ${e.y.max} }], expecting a ratio of 0 to 1, ignoring.`),e.y=void 0),0===this.axisZoomManagers.size){const i=this.state.stateId();return void("initial"!==i&&i!==t||this.state.set(t,e))}this.state.set(t,e);const s=e?.autoScaleYAxis;null!=s&&(this.autoScaleYAxis.manuallyAdjusted=!s);for(const i of this.axisZoomManagers.values())i.updateZoom(t,e?.[i.direction]);this.applyChanges(t)}updateAxisZoom(t,e,i){this.axisZoomManagers.get(e)?.updateZoom(t,i),this.applyChanges(t)}resetZoom(t){this.autoScaleYAxis.manuallyAdjusted=!1;const e=this.getRestoredZoom();this.updateZoom(t,{x:{min:e?.x?.min??0,max:e?.x?.max??1},y:{min:e?.y?.min??0,max:e?.y?.max??1},autoScaleYAxis:e?.autoScaleYAxis??!0})}resetAxisZoom(t,e){const i=this.axisZoomManagers.get(e),s=i?.direction;if(null==s)return;const n=this.getRestoredZoom();if("y"===s){const t=n?.autoScaleYAxis??!0;this.autoScaleYAxis.manuallyAdjusted=!t}for(const e of this.axes)e.direction===s&&this.updateAxisZoom(t,e.id,n?.[s]??{min:0,max:1})}setAxisManuallyAdjusted(t,e){const i=this.axisZoomManagers.get(e)?.direction;"y"===i&&(this.autoScaleYAxis.manuallyAdjusted=!0)}updatePrimaryAxisZoom(t,e,i){const s=this.getPrimaryAxis(e);s&&this.updateAxisZoom(t,s.id,i)}panToBBox(t,e,s){if(!this.isZoomEnabled()&&!this.isNavigatorEnabled())return!1;const n=this.getZoom();if(void 0===n||!n.x&&!n.y)return!1;if(!(e.width>0&&e.height>0&&Math.abs(s.width)<=Math.abs(e.width)&&Math.abs(s.height)<=Math.abs(e.height)))return i.warnOnce("cannot pan to target BBox - chart too small?"),!1;const a=function(t,e,i){const{x:s={min:0,max:1},y:n={min:0,max:1}}=e,a=Yc.from(i),o=Yc.from(t),r=function(t,e,i){const[s,n]=Qc(t.x1,t.x2,e),[a,o]=Qc(t.y1,t.y2,i);return{x1:s,x2:n,y1:a,y2:o}}(o,s,n),l=qc(r.x1,r.x2,o.x1,o.x2,a.x1,a.x2),c=qc(r.y1,r.y2,o.y1,o.y2,a.y1,a.y2),h={x:{min:Zc(o.x1,s.min,o.x2,s.max,l),max:Zc(o.x1,s.min,o.x2,s.max,l+t.width)},y:{min:Zc(o.y1,n.min,o.y2,n.max,c),max:Zc(o.y1,n.min,o.y2,n.max,c+t.height)}},d=h.x.max-h.x.min,u=h.y.max-h.y.min;return h.x.min=C(0,h.x.min,1-d),h.x.max=h.x.min+d,h.y.min=C(0,h.y.min,1-u),h.y.max=h.y.min+u,h}(e,n,s);return this.independentAxes?(this.updatePrimaryAxisZoom(t,"x",a.x),this.updatePrimaryAxisZoom(t,"y",a.y)):this.updateZoom(t,a),!0}fireZoomPanStartEvent(t){this.eventsHub.emit("zoom:pan-start",{callerId:t})}extendToEnd(t,e,i){return this.extendWith(t,e,t=>Number(t)-i)}extendWith(t,e,i){const s=this.getPrimaryAxis(e);if(!s)return;const n=this.getDomainExtents(s);if(!n)return;const[,a]=n,o=i(a),r=this.rangeToRatio({start:o},e);r&&this.updateZoom(t,{[e]:r})}updateWith(t,e,i){const s=this.getPrimaryAxis(e);if(!s)return;const n=this.getDomainExtents(s);if(!n)return;let[a,o]=n;[a,o]=i(a,o);const r=this.rangeToRatio({start:a,end:o},e);r&&this.updateZoom(t,{[e]:r})}getZoom(){let t,e;for(const i of this.axisZoomManagers.values())"x"===i.direction?t??(t=i.getZoom()):"y"===i.direction&&(e??(e=i.getZoom()));if(t||e)return{x:t,y:e}}getAxisZoom(t){return this.axisZoomManagers.get(t)?.getZoom()??{min:0,max:1}}getAxisZooms(){const t={};for(const[e,i]of this.axisZoomManagers.entries())t[e]={direction:i.direction,zoom:i.getZoom()};return t}getRestoredZoom(){return this.lastRestoredState}getPrimaryAxisId(t){return this.getPrimaryAxis(t)?.id}getBoundSeries(){const t=this.getPrimaryAxis("x"),e=this.getPrimaryAxis("y");let i;if(this.independentAxes){const s=new Set(t?.boundSeries??[]),n=new Set(e?.boundSeries??[]);i=new Set;for(const t of s)n.has(t)&&i.add(t)}else i=new Set([...t?.boundSeries??[],...e?.boundSeries??[]]);return i}constrainZoomToItemCount(t,e){const{autoScaleYAxis:i}=this,s=i.enabled&&!i.manuallyAdjusted;let n=[t.x.min,t.x.max],a=s?void 0:[t.y.min,t.y.max];for(const t of this.getBoundSeries()){const i=t.getZoomRangeFittingItems(n,a,e);if(null==i)return;n=i.x,a=i.y}const o={min:n[0],max:n[1]};let r;if(r??(r=this.getAutoScaleYZoom(o)),a&&(r={min:a[0],max:a[1]}),null!=r)return{x:o,y:r}}isVisibleItemsCountAtLeast(t,e){const{autoScaleYAxis:i}=this,s=this.getBoundSeries(),n=[t.x.min,t.x.max],a=i.enabled&&!i.manuallyAdjusted?void 0:[t.y.min,t.y.max];let o=0;for(const t of s){const i=e-(o??0);if(o+=t.getVisibleItems(n,a,i),o>=e)return!0}return 0===s.size}getMementoRanges(){const t=this.getDefinedZoom();let e;return this.autoScaleYAxis.enabled&&(e=this.autoScaleYAxis.manuallyAdjusted?[]:["y"]),{rangeX:this.getRangeDirection(t.x,"x"),rangeY:this.getRangeDirection(t.y,"y"),ratioX:{start:t.x.min,end:t.x.max},ratioY:{start:t.y.min,end:t.y.max},autoScaledAxes:e}}getAutoScaleYZoom(t){if(!this.isZoomEnabled())return;const{independentAxes:e,autoScaleYAxis:i}=this;if(!i.enabled||i.manuallyAdjusted)return;const{padding:s}=i;let n;return n=e?this.primaryAxisZoom("y",t,{padding:s}):this.combinedAxisZoom("y",t,{padding:s}),0===t.min&&1===t.max?null==n?void 0:{min:0,max:1}:n}autoScaleYZoom(t,e=!0){const{independentAxes:i}=this,s=this.getZoom();if(null==s?.x)return;const n=this.getAutoScaleYZoom(s.x);if(null!=n&&!Rs(s.y,n)){if(i){const t=this.getPrimaryAxis("y"),e=null==t?void 0:this.axisZoomManagers.get(t.id);e?.updateZoom("zoom-manager",n)}else for(const t of this.axisZoomManagers.values())"y"===t.direction&&t.updateZoom("zoom-manager",n);e&&this.applyChanges(t)}}applyChanges(t){if(this.autoScaleYZoom(t,!1),!Array.from(this.axisZoomManagers.values(),t=>t.applyChanges()).includes(!0))return;const e={};for(const[t,i]of this.axisZoomManagers.entries())e[t]=i.getZoom();this.eventsHub.emit("zoom:change",{...this.getZoom(),axes:e,callerId:t}),this.eventsHub.on("layout:complete",this.boundFireOnceChartEvent)}fireOnceChartEvent(){this.fireChartEvent({type:"zoom",...this.getMementoRanges()}),this.eventsHub.off("layout:complete",this.boundFireOnceChartEvent)}getRangeDirection(t,e){const i=this.getPrimaryAxis(e);if(!i||!$c.is(i.scale)&&!_c.is(i.scale))return;const s=this.getDomainPixelExtents(i);if(!s)return;const[n,a]=s;let o,r;return n<=a?(o=i.scale.invert(0),r=i.scale.invert(n+(a-n)*t.max)):(o=i.scale.invert(n-(n-a)*t.min),r=i.scale.invert(0)),{start:o,end:r}}rangeToRatio(t,e){const s=this.getPrimaryAxis(e);if(!s)return;const n=this.getDomainPixelExtents(s);if(!n)return;const[a,o]=n,{scale:r}=s,{start:l,end:c}=t,[h=0,d=1]=Jc(l,c);let u=null==l?a:r.convert(l,{alignment:h}),p=null==c?o:r.convert(c,{alignment:d})+(r.bandwidth??0);if(!Q(u)||!Q(p))return;const[g,m]=[Math.min(a,o),Math.max(a,o)];if(u<g||u>m)return void i.warnOnce(`Invalid range start [${l}], expecting a value between [${r.invert(a)}] and [${r.invert(o)}], ignoring.`);if(p<g||p>m)return void i.warnOnce(`Invalid range end [${c}], expecting a value between [${r.invert(a)}] and [${r.invert(o)}], ignoring.`);u=Math.min(m,Math.max(g,u)),p=Math.min(m,Math.max(g,p));const f=o-a;if(0===f)return;const y=Math.abs((u-a)/f),x=Math.abs((p-a)/f);return y>=x?void 0:{min:y,max:x}}getPrimaryAxis(t){return this.axes?.find(e=>e.direction===t)}getDomainExtents(t){const{domain:e}=t.scale,i=e.at(0),s=e.at(-1);if(null!=i&&null!=s)return[i,s]}getDomainPixelExtents(t){const[e,i]=t.scale.range;if(Q(e)&&Q(i))return[e,i]}getDefinedZoom(){const t=this.getZoom();return{x:{min:t?.x?.min??0,max:t?.x?.max??1},y:{min:t?.y?.min??0,max:t?.y?.max??1}}}zoomBounds(t,e,i,s){const n=t.scale,a=n.range;n.range=[0,1];const o=e.scale,r=o.range;o.range=[0,1];let l=1,c=!1,h=0,d=!1;for(const t of e.boundSeries){if(!t.visible)continue;const{connectsToYAxis:e}=t,s=t.getRange("y",[i.min,i.max]);for(const t of s){const i=o.convert(t);Number.isFinite(i)&&(i<l&&(l=i,c=!e||t<0),i>h&&(h=i,d=!e||t>0))}}if(Q(e.min)&&(l=0),Q(e.max)&&(h=1),n.range=a,o.range=r,l>=h)return;const u=(c?s:0)+(d?s:0),p=Math.min((h-l)*(1+u),1);if(!(p<=0)){if(c&&d){const t=(h+l)/2;l=t-p/2,h=t+p/2}else!c&&d?h=l+p:c&&!d&&(l=h-p);return l<0?(h+=-l,l=0):h>1&&(l-=h-1,h=1),{min:l,max:h}}}primaryAxisZoom(t,e,{padding:i=0}={}){const s="x"===t?"y":"x",n=this.getPrimaryAxis(s),a=this.getPrimaryAxis(t);if(null!=n&&null!=a)return this.zoomBounds(n,a,e,i)}combinedAxisZoom(t,e,{padding:i=0}={}){const s="x"===t?"y":"x",n=new Map;for(const t of this.axes)if(t.direction===s)for(const e of t.boundSeries)n.set(e,t);let a=1,o=0;for(const s of this.axes)if(s.direction===t)for(const t of s.boundSeries){const r=n.get(t);if(null==r)continue;const l=this.zoomBounds(r,s,e,i);if(null==l)return;a=Math.min(a,l.min),o=Math.max(o,l.max)}if(a<1e-6&&(a=0),o>.999999&&(o=1),!(a>o))return{min:a,max:o}}},sh=class{constructor(t){let e,i;"string"==typeof t?(this.direction=t,e=0,i=1):(this.direction=t.direction,[e=0,i=1]=t.visibleRange),this.state=new Er({min:e,max:i}),this.currentZoom=this.state.stateValue()}updateZoom(t,e){this.state.set(t,e)}getZoom(){return Xa(this.state.stateValue())}hasChanges(){const t=this.currentZoom,e=this.state.stateValue();return t.min!==e.min||t.max!==e.max}applyChanges(){const t=this.hasChanges();return this.currentZoom=this.state.stateValue(),t}},nh=(t=>(t[t.Caption=0]="Caption",t[t.Legend=1]="Legend",t[t.ToolbarLeft=2]="ToolbarLeft",t[t.ToolbarBottom=3]="ToolbarBottom",t[t.Navigator=4]="Navigator",t[t.Overlay=5]="Overlay",t))(nh||{}),ah=class{constructor(t){this.eventsHub=t,this.elements=new Map}registerElement(t,e){return this.elements.has(t)?this.elements.get(t).add(e):this.elements.set(t,new Set([e])),()=>this.elements.get(t)?.delete(e)}createContext(t,e){const i=new oh(t,e);for(const t of Object.values(nh)){if("number"!=typeof t)continue;const e=this.elements.get(t);if(e)for(const t of e)t(i)}return i}emitLayoutComplete(t,e){const{width:i,height:s}=t;this.eventsHub.emit("layout:complete",{axes:e.axes??[],chart:{width:i,height:s},clipSeries:e.clipSeries??!1,series:e.series})}},oh=class{constructor(t,e){this.width=t,this.height=e,this.layoutBox=new fs(0,0,t,e)}};function rh({point:t,anchor:e},i,s,n,a){if(0===t.size)return!1;let o=t.x,r=t.y;null!=e&&(o-=(e.x-.5)*t.size,r-=(e.y-.5)*t.size);let l=o;o<i?l=i:o>i+n&&(l=i+n);let c=r;r<s?c=s:r>s+a&&(c=s+a);const h=o-l,d=r-c;return Math.hypot(h,d)<=t.size/2}function lh(t){return null!=t&&"object"==typeof t.point&&"object"==typeof t.label}var ch={top:{x:0,y:-1},bottom:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0},"top-left":{x:-1,y:-1},"top-right":{x:1,y:-1},"bottom-left":{x:-1,y:1},"bottom-right":{x:1,y:1}},hh=class{constructor(){this.labelData=new Map}updateLabels(t,e,i=fs.zero){const s={x:-e.left,y:-e.top,width:i.width+e.left+e.right,height:i.height+e.top+e.bottom},n=new Set(t.map(t=>t.id));for(const t of this.labelData.keys())n.has(t)||this.labelData.delete(t);for(const e of t){const t=e.getLabelData();t.every(lh)&&this.labelData.set(e.id,t)}const a=function(t,e,i=5){const s=new Map,n=[],a=new Map(Array.from(t.entries(),([t,e])=>[t,e.toSorted((t,e)=>e.point.size-t.point.size)])),o=[...a.values()].flat();for(const[t,r]of a.entries()){const a=[];if(r[0]?.label){for(let t=0,s=r.length;t<s;t++){const s=r[t],{point:l,label:c,anchor:h}=s,{text:d,width:u,height:p}=c,g=l.size/2;let m=0,f=0;if(g>0&&null!=s.placement){const t=ch[s.placement];m=(u/2+g+i)*t.x,f=(p/2+g+i)*t.y}let y=l.x-u/2+m,x=l.y-p/2+f;if(h&&(y-=(h.x-.5)*l.size,x-=(h.y-.5)*l.size),fi(e,y,x,u,p)&&!o.some(t=>rh(t,y,x,u,p))&&!n.some(t=>mi(t,y,x,u,p))){const e={index:t,text:d,x:y,y:x,width:u,height:p,datum:s};a.push(e),n.push(e)}}s.set(t,a)}}return s}(this.labelData,s,5);for(const e of t)e.updatePlacedLabelData?.(a.get(e.id)??[])}},dh=class{constructor(t){this.eventsHub=t,this.mementoOriginatorKey="legend",this.legendDataMap=new Map}createMemento(){return this.getData().filter(({hideInLegend:t,isFixed:e})=>!t&&!e).map(({enabled:t,seriesId:e,itemId:i,legendItemName:s})=>({visible:t,seriesId:e,itemId:i,legendItemName:s}))}guardMemento(t){return null==t||G(t)}restoreMemento(t,e,i){if(i)for(const t of i){const{seriesId:e,data:i}=this.getRestoredData(t)??{};e&&i&&this.updateData(e,i)}this.update()}getRestoredData(t){const{seriesId:e,itemId:i,legendItemName:s,visible:n}=t;if(e){const t=(this.legendDataMap.get(e)??[]).map(t=>{const s=t.seriesId===e&&(!i||t.itemId===i);return s&&t.isFixed&&this.warnFixed(t.seriesId,t.itemId),!t.isFixed&&s?{...t,enabled:n}:t});return{seriesId:e,data:t}}if(null!=i||null!=s)for(const t of this.getData()){if(null!=i&&t.itemId!==i||null!=s&&t.legendItemName!==s)continue;if(t.isFixed)return void this.warnFixed(t.seriesId,i);const e=(this.legendDataMap.get(t.seriesId)??[]).map(t=>t.itemId===i||t.legendItemName===s?{...t,enabled:n}:t);return{seriesId:t.seriesId,data:e}}}warnFixed(t,e){i.warnOnce(`The legend item with seriesId [${t}] and itemId [${e}] is not configurable, this series item cannot be toggled through the legend.`)}update(t){this.eventsHub.emit("legend:change",{legendData:t??this.getData()})}updateData(t,e=[]){this.eventsHub.emit("legend:change-partial",{seriesId:t,legendData:e}),this.legendDataMap.set(t,e)}clearData(){this.legendDataMap.clear()}toggleItem(t,e,i,s){if(s){for(const e of this.getData()){const i=(this.legendDataMap.get(e.seriesId)??[]).map(e=>e.legendItemName===s?{...e,enabled:t}:e);this.updateData(e.seriesId,i)}return}const n=this.getData(e),a=1===n.length,o=n.map(e=>null==i&&a||e.itemId===i?{...e,enabled:t}:e);this.updateData(e,o)}getData(t){return t?this.legendDataMap.get(t)??[]:[...this.legendDataMap].reduce((t,[e,i])=>t.concat(i),[])}getDatum({seriesId:t,itemId:e}={}){return this.getData(t).find(t=>t.itemId===e)}getSeriesEnabled(t){const e=this.getData(t);if(e.length>0)return e.some(t=>t.enabled)}getItemEnabled({seriesId:t,itemId:e}={}){return this.getDatum({seriesId:t,itemId:e})?.enabled??!0}},uh=class{updateCallback(t){this.resolvePartialCallback=t}resolvePartial(t,e,i){return this.resolvePartialCallback?.(t,e,i)}},ph=class{constructor(){this.groups=new Map}registerSeries({internalId:t,seriesGrouping:e,visible:i,type:s}){if(!e)return;let n=this.groups.get(s);null==n&&(n=new Map,this.groups.set(s,n)),n.set(t,{grouping:e,visible:i})}updateSeries({internalId:t,seriesGrouping:e,visible:i,type:s}){if(!e)return;const n=this.groups.get(s)?.get(t);n&&(n.grouping=e,n.visible=i)}deregisterSeries({internalId:t,type:e}){const i=this.groups.get(e);null!=i&&(i.delete(t),0===i.size&&this.groups.delete(e))}getVisiblePeerGroupIndex({type:t,seriesGrouping:e,visible:i}){if(!e)return{visibleGroupCount:i?1:0,visibleSameStackCount:i?1:0,index:0};const s=new Set,n=new Set,a=this.groups.get(t);for(const t of a?.values()??[])t.visible&&(s.add(t.grouping.groupIndex),t.grouping.groupIndex===e.groupIndex&&n.add(t.grouping.stackIndex));const o=Array.from(s);return o.sort((t,e)=>t-e),{visibleGroupCount:o.length,visibleSameStackCount:n.size,index:o.indexOf(e.groupIndex)}}},gh=class{constructor(t){this.updateCallback=t,this.events=new A}addListener(t,e){return this.events.on(t,e)}destroy(){this.events.clear()}update(t=0,e){this.updateCallback(t,e)}dispatchUpdateComplete(t){this.events.emit("update-complete",{type:"update-complete",apiUpdate:t})}dispatchPreDomUpdate(){this.events.emit("pre-dom-update",{type:"pre-dom-update"})}dispatchPreSceneRender(){this.events.emit("pre-scene-render",{type:"pre-scene-render"})}dispatchProcessData({series:t}){this.events.emit("process-data",{type:"process-data",series:t})}},mh=class{constructor(t,e){this.eventsHub=new A,this.callbackCache=new Va,this.highlightManager=new lc(this.eventsHub),this.formatManager=new zl,this.layoutManager=new ah(this.eventsHub),this.localeManager=new cl(this.eventsHub),this.seriesStateManager=new ph,this.stateManager=new pr,this.seriesLabelLayoutManager=new hh,this.cleanup=new Mi,this.contextModules=[];const{scene:i,root:s,syncManager:n,container:a,fireEvent:o,updateCallback:r,updateMutex:l,styleContainer:c,chartType:h,domMode:d,withDragInterpretation:u}=e;this.chartService=t,this.syncManager=n,this.domManager=new Fr(this.eventsHub,this.chartService,a,c,d),this.widgets=new Pc(this.domManager,{withDragInterpretation:u});const p=this.domManager.addChild("canvas","scene-canvas",i?.canvas.element);this.scene=i??new pl({canvasElement:p}),this.scene.setRoot(s),this.cleanup.register(this.scene.on("scene-changed",()=>{this.updateService.update(7)})),this.axisManager=new fl(this.eventsHub,s),this.legendManager=new dh(this.eventsHub),this.annotationManager=new gl(this.eventsHub,t.annotationRoot,o),this.chartTypeOriginator=new lr(t),this.interactionManager=new ec,this.contextMenuRegistry=new rc(this.eventsHub),this.optionsGraphService=new uh,this.updateService=new gh(r),this.proxyInteractionService=new al(this.eventsHub,this.localeManager,this.domManager),this.fontManager=new bl(this.domManager,this.updateService),this.historyManager=new dr(this.eventsHub),this.animationManager=new sc(this.interactionManager,l),this.dataService=new xl(this.eventsHub,t,this.animationManager),this.tooltipManager=new Lc(this.eventsHub,this.localeManager,this.domManager,t.tooltip),this.zoomManager=new ih(this.eventsHub,o);for(const t of hs.byType("context")){if(!t.chartTypes.includes(h))continue;const e=t.moduleFactory(this);this.contextModules.push(e),this[t.contextKey]=e}}destroy(){this.animationManager.destroy(),this.axisManager.destroy(),this.callbackCache.invalidateCache(),this.domManager.destroy(),this.fontManager.destroy(),this.proxyInteractionService.destroy(),this.tooltipManager.destroy(),this.zoomManager.destroy(),this.widgets.destroy();for(const t of this.contextModules)t.destroy();this.cleanup.flush()}},fh=class extends Pn{constructor(){super(...arguments),this.range="tooltip",this.drawingMode="overlay"}};function yh(t,e){if(t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0}function xh(t,e){if(null==t||null==e)return t===e;if(t.size!==e.size)return!1;for(const[i,s]of t){const t=e.get(i);if(null==t)return!1;if(!yh(s,t))return!1}return!0}function bh(t,e,i,s){return e===t.dataSet&&Je(i,t.ids)&&function(t,e){const{props:i,...s}=t,{props:n,...a}=e;return Rs(s,a)&&function(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i+=1){const{type:s,idsMap:n,scopes:a,data:o,...r}=t[i],{type:l,idsMap:c,scopes:h,data:d,...u}=e[i];if(s!==l)return!1;if(a&&h&&!Je(a,h))return!1;if(o&&d&&o!==d)return!1;if(!Rs(r,u)||!xh(n,c))return!1}return!0}(i,n)}(s,t.opts)}function vh(t){return 0===t.removedIndices.size&&0===t.totalPrependCount&&t.totalAppendCount>0}function Mh(t){return 0===t.removedIndices.size&&0===t.totalAppendCount&&t.totalPrependCount>0}function Sh(t){return 0===t.removedIndices.size}ls([ws],fh.prototype,"range",2),ls([ws],fh.prototype,"drawingMode",2);var Ih=class{constructor(t,e){this.indexMap=t,this.prependValues=e.prependValues,this.appendValues=e.appendValues}getRemovedIndices(){return Array.from(this.indexMap.removedIndices).sort((t,e)=>t-e)}forEachPreservedIndex(t){const{originalLength:e,removedIndices:i,totalPrependCount:s}=this.indexMap;let n=0;const a=Array.from(i).sort((t,e)=>t-e);let o=0;for(let r=0;r<e;r++){for(;o<a.length&&a[o]<r;)n++,o++;i.has(r)||t(r,r+s-n)}}getPrependedValues(){return this.prependValues}getAppendedValues(){return this.appendValues}applyToArray(t,e,i){const{spliceOps:s,finalLength:n,originalLength:a}=this.indexMap;if(a!==n||0!==s.length){for(const n of s){const s=n.insertCount>0?Array.from({length:n.insertCount},(t,i)=>e(n.index+i)):[],a=t.splice(n.index,n.deleteCount,...s);i&&a.length>0&&i(a,n)}t.length!==n&&(t.length=n)}}},Dh=class t{constructor(){this.domain=new Set}static is(e){return e instanceof t}extend(t){this.domain.add(t)}getDomain(){return Array.from(this.domain)}},kh=class t{constructor(){this.domain=[1/0,-1/0]}static is(e){return e instanceof t}static extendDomain(t,e=[1/0,-1/0]){for(const i of t)"number"==typeof i&&(e[0]>i&&(e[0]=i),e[1]<i&&(e[1]=i));return e}extend(t){("number"==typeof t||t instanceof Date)&&(this.domain[0]>t&&(this.domain[0]=t),this.domain[1]<t&&(this.domain[1]=t))}getDomain(){return[...this.domain]}},Ah=class{constructor(t,e={},i=!1){this.bands=[],this.dataSize=0,this.fullDomainCache=null,this.needsReinitialization=!1,this.domainFactory=t,this.isDiscrete=i,this.config={minDataSizeForBanding:e.minDataSizeForBanding??1e3,targetBandCount:e.targetBandCount??10,maxBandSize:e.maxBandSize??1/0,enableBanding:e.enableBanding??!0}}initializeBands(t){if(this.dataSize=t,this.fullDomainCache=null,this.needsReinitialization=!1,!this.config.enableBanding||t<this.config.minDataSizeForBanding)return void(this.bands=[{startIndex:0,endIndex:t,subDomain:this.domainFactory(),isDirty:!0}]);const e=this.getTargetBandCount(this.dataSize),i=Math.ceil(t/e);this.bands=[];for(let s=0;s<e;s++){const e=s*i,n=Math.min((s+1)*i,t);this.bands.push({startIndex:e,endIndex:n,subDomain:this.domainFactory(),isDirty:!0})}}findAffectedBands(t,e){const i=[];for(let s=0;s<this.bands.length;s++){const n=this.bands[s];t<n.endIndex&&e>n.startIndex&&i.push(s)}return i}markBandsDirty(t,e){const i=this.findAffectedBands(t,e);for(const t of i)this.bands[t].isDirty=!0;this.fullDomainCache=null}handleInsertion(t,e){this.dataSize+=e,this.fullDomainCache=null;for(let i=0;i<this.bands.length;i++){const s=this.bands[i],n=i===this.bands.length-1;t<=s.startIndex?(s.startIndex+=e,s.endIndex+=e):(t<s.endIndex||t===s.endIndex&&n)&&(s.endIndex+=e,s.isDirty=!0)}this.considerRebalancing()}handleRemoval(t,e){this.dataSize-=e,this.fullDomainCache=null;for(const i of this.bands)if(t+e<=i.startIndex)i.startIndex=Math.max(0,i.startIndex-e),i.endIndex=Math.max(i.startIndex,i.endIndex-e);else if(t<i.endIndex){if(t<=i.startIndex){const s=Math.min(e,i.endIndex-i.startIndex);i.startIndex=t,i.endIndex=Math.max(i.startIndex,i.endIndex-s)}else i.endIndex=Math.max(i.startIndex,i.endIndex-e);i.isDirty=!0}this.bands=this.bands.filter(t=>t.endIndex>t.startIndex);let i=!1;if(this.bands.length>1){0!==this.bands[0].startIndex&&(i=!0);for(let t=1;t<this.bands.length;t++)if(this.bands[t].startIndex!==this.bands[t-1].endIndex){this.needsReinitialization=!0;break}}if(i&&!this.needsReinitialization){const t=this.bands[0].startIndex;for(const e of this.bands)e.startIndex-=t,e.endIndex-=t}this.considerRebalancing()}markAllBandsDirty(){for(const t of this.bands)t.isDirty=!0;this.fullDomainCache=null}considerRebalancing(){if(!this.needsReinitialization)return;if(this.dataSize<this.config.minDataSizeForBanding)return void(this.bands.length>1&&this.initializeBands(this.dataSize));if(this.config.maxBandSize<1/0&&Math.max(...this.bands.map(t=>t.endIndex-t.startIndex))>this.config.maxBandSize)return void this.initializeBands(this.dataSize);const t=this.getTargetBandCount(this.dataSize);Math.abs(this.bands.length-t)>.5*t&&this.initializeBands(this.dataSize)}getTargetBandCount(t){return Math.max(this.config.targetBandCount,Math.ceil(t/1e3))}extendBandsFromData(t,e){const i=t.length;for(const s of this.bands){if(!s.isDirty)continue;s.subDomain=this.domainFactory();const{startIndex:n,endIndex:a}=s;for(let o=n;o<a&&o<i;o++)e?.[o]||s.subDomain.extend(t[o]);s.isDirty=!1}this.fullDomainCache=null}getDirtyBands(){return this.bands.filter(t=>t.isDirty)}extend(t){this.markAllBandsDirty(),this.fullDomainCache=null}getDomain(){if(null!==this.fullDomainCache)return this.fullDomainCache;if(0===this.bands.length)return this.fullDomainCache=[],[];if(1===this.bands.length)return this.fullDomainCache=this.bands[0].subDomain.getDomain(),this.fullDomainCache;if(this.isDiscrete){const t=new Set;for(const e of this.bands){const i=e.subDomain.getDomain();for(const e of i)t.add(e)}this.fullDomainCache=Array.from(t)}else{let t,e;for(const i of this.bands){const s=i.subDomain.getDomain();if(2===s.length){const[i,n]=s;(void 0===t||null!=i&&null!=t&&i<t)&&(t=i),(void 0===e||null!=n&&null!=e&&n>e)&&(e=n)}}this.fullDomainCache=void 0!==t&&void 0!==e?[t,e]:[]}return this.fullDomainCache}getStats(){const t=this.bands.filter(t=>t.isDirty).length,e=this.bands.reduce((t,e)=>t+(e.endIndex-e.startIndex),0);return{bandCount:this.bands.length,dirtyBandCount:t,averageBandSize:this.bands.length>0?e/this.bands.length:0,dataSize:this.dataSize,needsReinitialization:this.needsReinitialization}}},wh=class{constructor(t){const e=t.reduce((t,e)=>Math.max(t,e.length),0);let i=1<<32-Math.clz32(e);e===i/2&&(i>>>=1),this.maxLevelSize=i;const s=new Float64Array(2*(2*i-1)).fill(Number.NaN);for(const e of t)for(let t=0;t<e.length;t+=1){const n=Number(e[t]),a=i+t-1,o=Math.trunc(2*a)+0,r=Math.trunc(2*a)+1,l=s[o],c=s[r];(!Number.isFinite(l)||n<l)&&(s[o]=n),(!Number.isFinite(c)||n>c)&&(s[r]=n)}for(let t=Math.trunc(i/2);t>=1;t=Math.trunc(t/2)){const e=Math.trunc(t-1),i=Math.trunc(e+t);for(let n=0;n<t;n+=1){const t=e+n,a=i+2*n,o=a+1,r=s[Math.trunc(2*a)+0],l=s[Math.trunc(2*o)+0];s[Math.trunc(2*t)+0]=!Number.isFinite(l)||r<l?r:l;const c=s[Math.trunc(2*a)+1],h=s[Math.trunc(2*o)+1];s[Math.trunc(2*t)+1]=!Number.isFinite(h)||c>h?c:h}}this.buffer=s}computeRangeInto(t,e,i,s,n,a,o){const r=n+a-1;if(r<e||n>=i)return o;if(n>=e&&r<i){const e=t[Math.trunc(2*s)+0],i=t[Math.trunc(2*s)+1];Number.isFinite(e)&&(o[0]=Math.min(o[0],e)),Number.isFinite(i)&&(o[1]=Math.max(o[1],i))}else a>1&&(s=Math.trunc(2*s),a=Math.trunc(a/2),this.computeRangeInto(t,e,i,Math.trunc(s+1),n,a,o),this.computeRangeInto(t,e,i,Math.trunc(s+2),n+a,a,o));return o}rangeBetween(t,e){if(t>e)return[Number.NaN,Number.NaN];const{maxLevelSize:i,buffer:s}=this,n=[1/0,-1/0];return this.computeRangeInto(s,t,e,0,0,i,n),n}get range(){const{buffer:t}=this;return[t[0],t[1]]}};function Ch(t,e){const i=t.length;if(t.length<=1)return 1;let s=0,n=t[0];for(let a=1;a<i;a++){const i=t[a];if(null==i)continue;if("number"!=typeof(e?i.valueOf():i))return;const o=Math.sign(i-n);if(0!==o){if(0!==s&&s!==o)return;s=o}n=i}return 0===s?1:s}var Nh=Symbol("key-sort-orders"),Lh=Symbol("column-sort-orders"),Th=Symbol("domain-ranges"),Eh=Symbol("domain-bands"),Oh=Object.freeze([0]);function Rh(t){return t.map(t=>W(t)?JSON.stringify(t):t).join("-")}function Ph(t){const e=t?.map(Number);return e?.every(Number.isFinite)?e:[]}function zh(t,e){return e?.get(t.id)??0}function jh(t){return"scopes"in t&&Array.isArray(t.scopes)}function Bh(t,e){const i=[];for(let s=0;s<t;s+=1)i[s]=e;return i}function Fh(t,e){const i=[];for(const s of t){const t=s?.[e];if(null==t)return;i.push(t)}return i}function Vh(t){const e=[];let i,s=0;const n=/((?:(?:^|\.)\s*\w+|\[\s*(?:'(?:[^']|(?<!\\)\\')*'|"(?:[^"]|(?<!\\)\\")*"|-?\d+)\s*\])\s*)/g;for(;i=n.exec(t);){if(i.index!==s)return;s=i.index+i[0].length;const t=i[1].trim();if(t.startsWith("."))e.push(t.slice(1).trim());else if(t.startsWith("[")){const i=t.slice(1,-1).trim();i.startsWith("'")?e.push(i.slice(1,-1).replaceAll(/(?<!\\)\\'/g,"'")):i.startsWith('"')?e.push(i.slice(1,-1).replaceAll(/(?<!\\)\\"/g,'"')):e.push(i)}else e.push(t)}if(s===t.length)return e}function Gh(t){return e=>{let i=e;for(const e of t)i=i[e];return i}}var $h=class{constructor(t,e="standalone",i=!1){this.opts=t,this.mode=e,this.suppressFieldDotNotation=i,this.debug=bs.create(!0,"data-model"),this.scopeCache=new Map,this.keys=[],this.values=[],this.aggregates=[],this.groupProcessors=[],this.propertyProcessors=[],this.reducers=[],this.processors=[],this.markScopeDatumInvalid=function(t,e,i,s){for(const n of t)s.has(n)||s.set(n,Bh(e.length,!1)),s.get(n)[i]=!0};let s=!0;for(const e of t.props){if("key"===e.type&&!s)throw new Error("AG Charts - internal config error: keys must come before values.");"value"===e.type&&s&&(s=!1)}const n=({matchGroupIds:t=[]})=>{for(const e of t)if(this.values.every(t=>t.groupId!==e))throw new Error(`AG Charts - internal config error: matchGroupIds properties must match defined groups (${e}).`)},a=new Set,o=new Set;for(const e of t.props){const t="key"===e.type?a:o;if(jh(e)&&e.scopes)for(const i of e.scopes)t.add(i);switch(e.type){case"key":this.keys.push({...e,index:this.keys.length,missing:new Map});break;case"value":if(null==e.property)throw new Error(`AG Charts - internal config error: no properties specified for value definitions: ${JSON.stringify(e)}`);this.values.push({...e,index:this.values.length,missing:new Map});break;case"aggregate":n(e),this.aggregates.push({...e,index:this.aggregates.length});break;case"group-value-processor":n(e),this.groupProcessors.push({...e,index:this.groupProcessors.length});break;case"property-value-processor":this.propertyProcessors.push({...e,index:this.propertyProcessors.length});break;case"reducer":this.reducers.push({...e,index:this.reducers.length});break;case"processor":this.processors.push({...e,index:this.processors.length})}}if(this.opts.groupByKeys||null!=this.opts.groupByFn){const t=new Set(o.values());for(const e of a)t.delete(e);if(t.size>0)throw new Error(`AG Charts - scopes missing key for grouping, illegal configuration: ${[...t.values()]}`)}}resolveProcessedDataDefById(t,e){const i=this.scopeCache.get(t.id)?.get(e);if(!i)throw new Error(`AG Charts - didn't find property definition for [${e}, ${t.id}]`);return{index:i.index,def:i}}resolveProcessedDataIndexById(t,e){return this.resolveProcessedDataDefById(t,e).index}resolveKeysById(t,e,i){const s=this.resolveProcessedDataIndexById(t,e),n=i.keys[s];if(null==n)throw new Error(`AG Charts - didn't find keys for [${e}, ${t.id}]`);return n.get(t.id)}hasColumnById(t,e){return null!=this.scopeCache.get(t.id)?.get(e)}resolveColumnById(t,e,i){const s=this.resolveProcessedDataIndexById(t,e),n=i.columns?.[s];if(null==n)throw new Error(`AG Charts - didn't find column for [${e}, ${t.id}]`);return n}resolveColumnNeedsValueOf(t,e,i){const s=this.resolveProcessedDataIndexById(t,e);return i.columnNeedValueOf?.[s]??!0}resolveAbsoluteIndex(t,e){return t+e}*forEachDatum(t,e,i,s){const n=e.columnScopes.findIndex(e=>e.has(t.id));for(const t of i.datumIndices[n]??[]){const i=this.resolveAbsoluteIndex(s,t);yield e.columns[n][i]}}getUniqueDataSets(t){return new Set(t.dataSources.values())}*forEachGroupDatum(t,e){const i=e.columnScopes.findIndex(e=>e.has(t.id)),s={groupIndex:0,columnIndex:i},n=[];for(const t of e.groups){s.group=t;for(const e of t.datumIndices[i]??n)s.datumIndex=this.resolveAbsoluteIndex(s.groupIndex,e),yield s;s.groupIndex++}}getDomain(t,e,i,s){const n=this.getDomainsByType(i??"value",s);return n?.[this.resolveProcessedDataIndexById(t,e)]??[]}getDomainBetweenRange(t,e,[i,s],n){const a=e.map(e=>this.resolveProcessedDataIndexById(t,e)),o=a.join(":"),r=n[Th];let l=r.get(o);if(null==l){const t=a.map(t=>n.columns[t]);l=new wh(t),r.set(o,l)}return l.rangeBetween(i,s)}getSortOrder(t,e,i,s){let n=i.get(e);return null==n&&(n={sortOrder:Ch(t,s)},i.set(e,n)),n.sortOrder}getKeySortOrder(t,e,i){const s=this.resolveProcessedDataIndexById(t,e),n=i.keys[s]?.get(t.id);return n?this.getSortOrder(n,s,i[Nh],!0):void 0}getColumnSortOrder(t,e,i){const s=this.resolveProcessedDataIndexById(t,e),n=i.columnNeedValueOf?.[s]??!0;return this.getSortOrder(i.columns[s],s,i[Lh],n)}getDomainsByType(t,e){switch(t){case"key":return e.domain.keys;case"value":return e.domain.values;case"aggregate":return e.domain.aggValues;case"group-value-processor":return e.domain.groups;default:return null}}processData(t){const{opts:{groupByKeys:e,groupByFn:s},aggregates:n,groupProcessors:a,reducers:o,processors:r,propertyProcessors:l}=this,c=performance.now();if(e&&0===this.keys.length)return;let h=this.extractData(t);e?h=this.groupData(h):s&&(h=this.groupData(h,s(h))),a.length>0&&"grouped"===h.type&&this.postProcessGroups(h),n.length>0&&"ungrouped"===h.type?this.aggregateUngroupedData(h):n.length>0&&"grouped"===h.type&&this.aggregateGroupedData(h),l.length>0&&this.postProcessProperties(h),o.length>0&&this.reduceData(h),r.length>0&&this.postProcessData(h),this.warnDataMissingProperties(t);const d=performance.now();return h.time=d-c,this.collectOptimizationMetadata(h,"full-process"),this.debug.check()&&function(t){const e=(t,e)=>{e.length>0&&(i.log(`DataModel.processData() - ${t}`),i.table(e))};if(i.log("DataModel.processData() - processedData",t),e("Key Domains",t.domain.keys),e("Value Domains",t.domain.values),e("Aggregate Domains",t.domain.aggValues??[]),t.optimizations){i.log("DataModel.processData() - Optimization Summary");const e=t.optimizations;if(e.performance&&i.log(`  Performance: ${e.performance.processingTime.toFixed(2)}ms (${e.performance.pathTaken})`),e.reprocessing){const t=e.reprocessing.applied?"✓":"✗",s=e.reprocessing.reason?` (${e.reprocessing.reason})`:"";i.log(`  Reprocessing: ${t}${s}`)}if(e.domainBanding){const t=e.domainBanding.keyDefs.filter(t=>t.applied),s=e.domainBanding.valueDefs.filter(t=>t.applied),n=t.length+s.length,a=e.domainBanding.keyDefs.length+e.domainBanding.valueDefs.length;if(n>0){i.log(`  Domain Banding: ✓ (${n}/${a} definitions)`);for(const e of[...t,...s])if(e.stats){const t=(100*e.stats.scanRatio).toFixed(1);i.log(`    ${e.property}: scanned ${e.stats.dirtyBands}/${e.stats.totalBands} bands (${t}%)`)}}else{const t=[...e.domainBanding.keyDefs.filter(t=>!t.applied).map(t=>t.reason),...e.domainBanding.valueDefs.filter(t=>!t.applied).map(t=>t.reason)],s=[...new Set(t)].join(", ");i.log(`  Domain Banding: ✗ (${s})`)}}if(e.sharedDatumIndices){const t=e.sharedDatumIndices.applied?"✓":"✗",s=`${e.sharedDatumIndices.sharedGroupCount}/${e.sharedDatumIndices.totalGroupCount}`;i.log(`  Shared DatumIndices: ${t} (${s} groups)`)}if(e.batchMerging){const t=(100*e.batchMerging.mergeRatio).toFixed(0),s=`${e.batchMerging.originalBatchCount} → ${e.batchMerging.mergedBatchCount}`;i.log(`  Batch Merging: ${s} (${t}% reduction)`)}}}(h),this.processScopeCache(),h}isReprocessingSupported(t){if("grouped"===t.type){if(!t.groupsUnique)return!1;if(1!==this.getUniqueDataSets(t).size)return!1;const e=oi(t.scopes),i=t.invalidKeys?.get(e);if(i?.some(t=>t))return!1}return!(this.aggregates.length>0)&&!(this.reducers.length>0)&&!(this.processors.length>0)&&!(this.propertyProcessors.length>0)&&this.groupProcessors.every(t=>t.supportsReprocessing??!1)}reprocessData(t,e){if(!this.isReprocessingSupported(t)){this.debug.check()&&this.debug("Falling back to full reprocessing - incremental not supported for current configuration");const e=this.getUniqueDataSets(t);for(const t of e)t.commitPendingTransactions();return this.processData(t.dataSources)}const i=performance.now(),s=this.collectScopeChanges(t,e);if(0===s.size)return t;this.commitPendingTransactions(t);const{processValue:n}=this.initDataDomainProcessor("skip"),a=this.processAllInsertions(t,s,n);this.updateBandsForChanges(t,s);const o=this.transformKeysArrays(t,s,a);this.transformColumnsArrays(t,s,a),this.transformInvalidityArrays(t,s,a),"grouped"===t.type&&(this.transformGroupsArray(t,s,a),this.groupProcessors.length>0&&this.reprocessGroupProcessors(t,s)),this.recomputeDomains(t),null!=t.reduced?.diff&&s.size>0&&this.generateDiffMetadata(t,s,o),this.updateProcessedDataMetadata(t);const r=performance.now();return t.time=r-i,this.collectOptimizationMetadata(t,"reprocess"),t}applyOperationToBandedDomains(t,e){for(const i of t.values())i instanceof Ah&&e(i)}updateBandsForChanges(t,e){const i=t[Eh];if(0===i.size)return;const s=new Set;for(const[,t]of e){if(s.has(t))continue;s.add(t);const{indexMap:e}=t,{spliceOps:n}=e;for(const t of n)t.insertCount>0&&this.applyOperationToBandedDomains(i,e=>e.handleInsertion(t.index,t.insertCount)),t.deleteCount>0&&this.applyOperationToBandedDomains(i,e=>e.handleRemoval(t.index,t.deleteCount))}}collectScopeChanges(t,e){const i=new Map;for(const[s,n]of t.dataSources){const t=e?.get(n)??n.getChangeDescription();t&&i.set(s,t)}return i}commitPendingTransactions(t){const e=this.getUniqueDataSets(t);for(const t of e)t.commitPendingTransactions()}processAllInsertions(t,e,i){const s=new Map;for(const[n,a]of e){const e=t.dataSources.get(n);if(!e)continue;const o=this.processInsertionsOnce(n,a,e,i);s.set(n,o)}return s}transformArraysWithCache(t,e,i,s,n,a){for(const[o,r]of t.entries())for(const t of n(r)){const n=e.get(t);if(!n)continue;const l=s(o,t);if(!l)continue;const c=i.get(t);n.applyToArray(l,t=>{const e=c?.get(t);return a(e,r,o)})}}transformKeysArrays(t,e,i){const s=new Map,n=t=>{let e=s.get(t);return e||(e={tuples:[]},s.set(t,e)),e},a=new WeakSet;for(const[o,r]of this.keys.entries())for(const l of r.scopes??[]){const c=e.get(l);if(!c)continue;const h=t.keys[o]?.get(l);if(!h)continue;if(a.has(h)){const e=Array.from(t.keys[o].entries()).find(([t,e])=>e===h)?.[0];e&&e!==l&&s.has(e)&&s.set(l,s.get(e));continue}a.add(h);const d=i.get(l),u=n(l);let p=0;c.applyToArray(h,t=>{const e=d?.get(t);if(e){const t=e.keys.get(o);return t?.valid?t.value:r.invalidValue}return r.invalidValue},t=>{for(const e of t)u.tuples[p]||(u.tuples[p]=new Array(this.keys.length)),u.tuples[p][o]=e,p+=1})}const o=new Map;for(const[t,{tuples:e}]of s){if(0===e.length)continue;const i=new Set;for(const s of e){const e=[];for(const[i,n]of s.entries()){const s=this.keys[i];s.scopes?.includes(t)&&e.push(n)}e.length>0&&i.add(Rh(e))}o.set(t,i)}return o}transformColumnsArrays(t,e,i){this.transformArraysWithCache(this.values,e,i,e=>t.columns[e],t=>[oi(t.scopes)],(t,e,i)=>{if(t){const s=t.values.get(i);return s?.valid?s.value:e.invalidValue}return e.invalidValue})}transformInvalidityMap(t,e,i,s){const n=new Set;for(const[a,o]of e){const e=t.get(a);if(!e)continue;if(n.has(e))continue;n.add(e);const r=i.get(a);o.applyToArray(e,t=>{const e=r?.get(t);return s(e)})}}transformInvalidityArrays(t,e,i){t.invalidKeys&&this.transformInvalidityMap(t.invalidKeys,e,i,t=>t?.hasInvalidKey??!1),t.invalidData&&this.transformInvalidityMap(t.invalidData,e,i,t=>!!t&&(t.hasInvalidKey||t.hasInvalidValue))}transformGroupsArray(t,e,i){const s=oi(t.scopes),n=e.get(s);if(!n)return;const a=i.get(s);for(const[,t]of a??[])if(t.hasInvalidKey)throw new Error("AG Charts - reprocessing grouped data with invalid keys not supported. This typically indicates a data quality issue that requires full reprocessing.");n.applyToArray(t.groups,e=>this.createDataGroupForInsertion(e,t,s,a))}createDataGroupForInsertion(t,e,i,s){const n=[];for(const s of e.keys){const e=s.get(i);e&&n.push(e[t])}const a=e.groups[0],o=a?.datumIndices??Object.freeze(Bh(e.columnScopes.length,Oh)),r=s?.get(t);let l;return r?.hasInvalidValue?(l=new Set(e.scopes),l.delete(i)):l=e.scopes,{keys:n,datumIndices:o,aggregation:[],validScopes:l}}setupDomainForDefinition(t,e,i){if("category"===t.valueType)return new Dh;let s=e.get(t);return s||!1===i?.enableBanding||(s=new Ah(()=>new kh,i,!1),e.set(t,s)),s??new kh}extendDomainFromData(t,e,i){if(t instanceof Ah)t.extendBandsFromData(e,i);else for(let s=0;s<e.length;s++)!0!==i?.[s]&&t.extend(e[s])}initializeBandedDomain(t,e,i){if(!(t instanceof Ah))return;const s=t.getStats(),n=0===s.bandCount||s.dataSize!==e||s.needsReinitialization;this.debug.check()&&n&&i&&this.debug(`Reinitializing bands for ${i}: bandCount=${s.bandCount}, dataSize=${s.dataSize}, dataLength=${e}, needsReinitialization=${s.needsReinitialization}`),n&&t.initializeBands(e)}recomputeDomains(t){const e=this.debug.check()?performance.now():0,i=t[Eh],s=this.opts.domainBandingConfig;let n;const a=new Map,o=new Map;for(const t of this.keys)a.set(t,this.setupDomainForDefinition(t,i,s));for(const t of this.values)o.set(t,this.setupDomainForDefinition(t,i,s));for(const[e,i]of this.keys.entries()){const s=t.keys[e],n=a.get(i),o=Math.max(...Array.from(s.values()).map(t=>t.length));this.initializeBandedDomain(n,o,String(i.property))}for(const[e,i]of this.values.entries()){const s=t.columns[e],n=o.get(i);this.initializeBandedDomain(n,s.length,String(i.property))}const r=new Map;if(i.size>0){n={totalBands:0,dirtyBands:0,totalData:0};for(const t of i.values())if(t instanceof Ah){const e=t.getStats();r.set(t,e),n.totalBands+=e.bandCount,n.dirtyBands+=e.dirtyBandCount,n.totalData=Math.max(n.totalData,e.dataSize)}}for(const[e,i]of this.keys.entries()){const s=t.keys[e],n=a.get(i);for(const e of i.scopes??[]){const i=s.get(e);if(!i)continue;const a=t.invalidKeys?.get(e);this.extendDomainFromData(n,i,a)}}for(const[e,i]of this.values.entries()){const s=t.columns[e],n=o.get(i),a=oi(i.scopes),r=t.invalidData?.get(a);this.extendDomainFromData(n,s,r)}if(t.domain.keys=this.keys.map(t=>{const e=a.get(t),i=e.getDomain();return kh.is(e)&&i[0]>i[1]?[]:i}),t.domain.values=this.values.map(t=>{const e=o.get(t),i=e.getDomain();return kh.is(e)&&i[0]>i[1]?[]:i}),"grouped"===t.type&&(t.domain.groups=t.groups.map(t=>t.keys)),this.collectDomainBandingMetadata(t,a,o,i,r),this.debug.check()&&e>0){const t=performance.now()-e;if(n&&n.totalBands>0){const e=n.dirtyBands/n.totalBands,i=Math.round(e*n.totalData);this.debug(`recomputeDomains with banding: ${t.toFixed(2)}ms, bands: ${n.dirtyBands}/${n.totalBands} dirty, data scanned: ~${i}/${n.totalData} (${(100*e).toFixed(1)}%)`)}else this.debug(`recomputeDomains: ${t.toFixed(2)}ms (no banding)`)}}generateDiffMetadata(t,e,i){const s=(e,i)=>{const s=[];for(const n of t.keys){const t=n.get(e);if(!t)return;s.push(t[i])}return s.length>0?Rh(s):void 0};for(const[n,a]of e){const e={changed:!0,added:new Set,removed:i.get(n)??new Set,updated:new Set,moved:new Set};for(const t of a.indexMap.spliceOps)if(t.insertCount>0)for(let i=0;i<t.insertCount;i++){const a=t.index+i,o=s(n,a);o&&e.added.add(o)}const{originalLength:o,totalPrependCount:r}=a.indexMap;if(vh(a.indexMap));else if(Mh(a.indexMap)&&o>0)for(let t=r;t<r+o;t++){const i=s(n,t);i&&e.moved.add(i)}else if(Sh(a.indexMap)&&r>0)for(let t=0;t<o;t++){const i=s(n,t+r);i&&e.moved.add(i)}else a.forEachPreservedIndex((t,i)=>{if(t!==i){const t=s(n,i);t&&e.moved.add(t)}});t.reduced.diff[n]=e}}updateProcessedDataMetadata(t){let e=0;for(const i of t.dataSources.values())e=Math.max(e,i.data.length);t.input.count=e;let i=0;for(const[e,s]of t.invalidData??new Map){const n=t.invalidKeys?.get(e);for(let t=0;t<s.length;t++)s[t]&&!n?.[t]&&(i+=1)}if(t.partialValidDataCount=i,t.invalidKeyCount)for(const[e,i]of t.invalidKeys??new Map){const s=i.filter(Boolean).length;t.invalidKeyCount.set(e,s)}t[Th].clear(),t[Nh].clear(),t[Lh].clear()}processInsertionsOnce(t,e,i,s){const n=new Map,{finalLength:a}=e.indexMap;for(const o of e.indexMap.spliceOps)if(!(o.insertCount<=0))for(let e=0;e<o.insertCount;e++){const r=o.index+e;if(r<0||r>=a)continue;const l=i.data[r],c=new Map,h=new Map;let d=!1,u=!1;if(null==l||"object"!=typeof l)d=!0,u=!0;else{for(const[e,i]of this.keys.entries()){if(!i.scopes?.includes(t))continue;const n=s(i,l,r,t);c.set(e,{value:n.value,valid:n.valid}),n.valid||(d=!0)}for(const[e,i]of this.values.entries()){if(!i.scopes?.includes(t))continue;const n=s(i,l,r,i.scopes);h.set(e,{value:n.value,valid:n.valid}),n.valid||(u=!0)}}n.set(r,{keys:c,values:h,hasInvalidKey:d,hasInvalidValue:u})}return n}warnDataMissingProperties(t){if(0!==t.size)for(const e of ai(this.keys,this.values))for(const[s,n]of e.missing){if(n<(t.get(s)?.data.length??1/0))continue;const a=null==s?"":` for ${s}`;i.warnOnce(`the key '${e.property}' was not found in any data element${a}.`)}}processScopeCache(){this.scopeCache.clear();for(const t of ai(this.keys,this.values,this.aggregates))if(t.idsMap)for(const[e,i]of t.idsMap)for(const s of i)if(this.scopeCache.has(e)){if(this.scopeCache.get(e)?.has(s))throw new Error("duplicate definition ids on the same scope are not allowed.");this.scopeCache.get(e).set(s,t)}else this.scopeCache.set(e,new Map([[s,t]]))}valueGroupIdxLookup({matchGroupIds:t}){const e=[];for(const[i,s]of this.values.entries())(!t||s.groupId&&t.includes(s.groupId))&&e.push(i);return e}valueIdxLookup(t,e){const i=null==t||0===t.length,s="string"==typeof e?e:e.id,n=this.values.reduce((e,n,a)=>((null==n.scopes||i&&!n.scopes.length||n.scopes.some(e=>t?.includes(e)))&&(n.property===s||n.id===s||(e=>{if(e.idsMap)for(const[i,n]of e.idsMap)if(t?.includes(i)&&n.has(s))return!0;return!1})(n))&&e.push(a),e),[]);if(0===n.length)throw new Error(`AG Charts - configuration error, unknown property ${JSON.stringify(e)} in scope(s) ${JSON.stringify(t)}`);return n}extractData(t){const{dataDomain:e,processValue:i,allScopesHaveSameDefs:s}=this.initDataDomainProcessor("extend"),{keys:n,values:a}=this,{invalidData:o,invalidKeys:r,invalidKeyCount:l,allKeyMappings:c}=this.extractKeys(n,t,i),{columns:h,columnScopes:d,columnNeedValueOf:u,partialValidDataCount:p,maxDataLength:g}=this.extractValues(o,a,t,r,i),m=t=>{const i=e.get(t),s=i.getDomain();return kh.is(i)&&s[0]>s[1]?[]:s};return{type:"ungrouped",input:{count:g},scopes:new Set(t.keys()),dataSources:t,aggregation:void 0,keys:[...c.values()],columns:h,columnScopes:d,columnNeedValueOf:u,invalidKeys:r,invalidKeyCount:l,invalidData:o,domain:{keys:n.map(m),values:a.map(m)},defs:{allScopesHaveSameDefs:s,keys:n,values:a},partialValidDataCount:p,time:0,[Th]:new Map,[Nh]:new Map,[Lh]:new Map,[Eh]:new Map}}extractKeys(t,e,i){const s=new Map,n=new Map,a=new Map,o=new Map;let r,l;const c=(t,e)=>{const i=l.get(t);r.set(e,r.get(i)),s.has(i)&&(s.set(e,s.get(i)),n.set(e,n.get(i)))};for(const h of t){const{invalidValue:t,scopes:d}=h;r=new Map,l=new Map,o.set(h,r);for(const o of d??[]){const d=e.get(o)?.data??[];if(l.has(d)){c(d,o);continue}const u=[];let p,g;r.set(o,u),l.set(d,o);let m=0;for(let e=0;e<d.length;e++){if(null==d[e]||"object"!=typeof d[e])continue;const s=i(h,d[e],e,o);s.valid?u.push(s.value):(u.push(t),p??(p=Bh(d.length,!1)),g??(g=Bh(d.length,!1)),m+=1,p[e]=!0,g[e]=!0)}p&&g&&(s.set(o,p),n.set(o,g),a.set(o,m))}}return{invalidData:n,invalidKeys:s,invalidKeyCount:a,allKeyMappings:o}}extractValues(t,e,i,s,n){let a=0;const o=[],r=[],l=[];let c=0;for(const h of e){const{invalidValue:e}=h;if(new Set(h.scopes.map(t=>i.get(t))).size>1)throw new Error(`AG Charts - more than one data source for: ${JSON.stringify(h)}`);const d=new Set(h.scopes),u=oi(h.scopes),p=i.get(u)?.data??[],g=new Array,m=s.get(u);let f=!1;for(let i=0;i<p.length;i++){if(null==p[i]||"object"!=typeof p[i])continue;const s=p[i],o=null!=m&&m[i],r=n(h,s,i,h.scopes);let l=r.value;!o&&r.valid||this.markScopeDatumInvalid(h.scopes,p,i,t),o?l=e:r.valid||(a+=1,l=e),f||null==l||"object"!=typeof l||(f=!0),g[i]=l}o.push(g),r.push(d),l.push(f),c=Math.max(c,g.length)}return{columns:o,columnScopes:r,columnNeedValueOf:l,partialValidDataCount:a,maxDataLength:c}}groupData(t,e){var i;const{keys:s,columns:n,columnScopes:a,invalidKeys:o,invalidData:r}=t,l=t.scopes,c=[],h=[],d=1!==l.size||null!=e?new Map:void 0;let u=!0,p=0;const g=l.size,m=this.groupBatches(l,n,a,s,r,o),f=m.length;if(this.debug.check()&&!t.optimizations&&(t.optimizations={}),this.debug.check()){const e=g>0?1-f/g:0;t.optimizations.batchMerging={originalBatchCount:g,mergedBatchCount:f,mergeRatio:e}}const y=1===m.length,x=Object.freeze(Bh(m[0][1].length,Oh));for(const[t,s,a,o,r,g]of m){const m=n[oi(s)];for(let n=0;n<m.length;n++){if(!0===g?.[n])continue;const m=a.map(t=>t[n]);if(null==m||0===m.length)throw new Error("AG Charts - no keys found for scope(s): "+t.join(", "));const f=e?.(m)??m,b=null==d?void 0:Rh(f);let v,M,S=d?.get(b),I=!1;if(null==S?(v={keys:f,datumIndices:[],aggregation:[],validScopes:l},M=p++,S=[M,v],I=!0,d?.set(b,S),c.push(v.keys),h.push(v)):([M,v]=S,u=!1),!0===r?.[n]){v.validScopes===l&&(v.validScopes=new Set(l.values()));for(const t of o)v.validScopes.delete(t)}if(I&&n===M&&y)v.datumIndices=x;else{I||v.datumIndices!==x||(v.datumIndices=x.map(t=>[...t]));for(const t of s)(i=v.datumIndices)[t]??(i[t]=[]),v.datumIndices[t].push(n-M)}}}return{...t,type:"grouped",domain:{...t.domain,groups:c},groups:h,groupsUnique:u,optimizations:t.optimizations,[Eh]:t[Eh]}}groupBatches(t,e,i,s,n,a){const o=[],r=new Set;for(const l of t){const t=e.map((t,e)=>e).filter(t=>!r.has(t)&&i[t].has(l));if(0===t.length)continue;for(const e of t)r.add(e);const c=new Set;for(const e of t)for(const t of i[e])c.add(t);const h=s.map(t=>t.get(l)).filter(t=>null!=t),d=n?.get(l),u=a?.get(l);o.push([l,t,h,c,d,u])}return this.mergeCompatibleBatches(o)}areBatchesCompatible(t,e){const[,,i,,s,n]=t,[,,a,,o,r]=e;return i.every((t,e)=>t===a[e])&&n===r&&s===o}mergeCompatibleBatches(t){const e=[],i=new Set;for(let s=0;s<t.length;s++){if(i.has(s))continue;const[n,a,o,r,l,c]=t[s],h=[[n],[...a],o,new Set(r),l,c];this.findAndMergeCompatibleBatches(t,s,h,i),e.push(h),i.add(s)}return e}findAndMergeCompatibleBatches(t,e,i,s){const n=t[e];for(let a=e+1;a<t.length;a++){if(s.has(a))continue;const e=t[a],[o,r,,l]=e;if(this.areBatchesCompatible(n,e)){i[0].push(o),i[1].push(...r);for(const t of l)i[3].add(t);s.add(a)}}}aggregateUngroupedData(t){const e=this.aggregates.map(()=>[1/0,-1/0]);t.domain.aggValues=e;const{columns:i,dataSources:s}=t,n=oi(s.keys()),a=t.keys.map(t=>t.get(n)),o=s.get(n)?.data??[];t.aggregation=o?.map((t,s)=>{const n=[];for(const[t,o]of this.aggregates.entries()){const r=this.valueGroupIdxLookup(o);let l=o.groupAggregateFunction?.()??[1/0,-1/0];const c=r.map(t=>i[t][s]),h=Fh(a,s),d=null==h?void 0:o.aggregateFunction(c,h);d&&(l=o.groupAggregateFunction?.(d,l)??kh.extendDomain(d,l));const u=o.finalFunction?.(l)??l;n[t]=u,kh.extendDomain(u,e[t])}return n})}aggregateGroupedData(t){const e=this.aggregates.map(()=>[1/0,-1/0]);t.domain.aggValues=e;const{columns:i}=t;for(const[s,n]of this.aggregates.entries()){const a=this.valueGroupIdxLookup(n);for(let o=0;o<t.groups.length;o++){const r=t.groups[o];r.aggregation??(r.aggregation=[]);const l=r.keys;let c=n.groupAggregateFunction?.()??[1/0,-1/0];const h=Math.max(...a.map(t=>r.datumIndices[t]?.length??0));for(let t=0;t<h;t++){const e=a.map(e=>{const s=r.datumIndices[e]?.[t];if(null==s)return;const n=this.resolveAbsoluteIndex(o,s);return i[e][n]}),s=n.aggregateFunction(e,l);s&&(c=n.groupAggregateFunction?.(s,c)??kh.extendDomain(s,c))}const d=n.finalFunction?.(c)??c;r.aggregation[s]=d,kh.extendDomain(d,e[s])}}}postProcessGroups(t){const{groupProcessors:e}=this,{columnScopes:i,columns:s,invalidData:n}=t;for(const a of e){const e=this.valueGroupIdxLookup(a),o=a.adjust()();for(let i=0;i<t.groups.length;i++)o(s,e,t.groups[i],i);for(const a of e){const e="category"===this.values[a].valueType,o=s[a],r=oi(i[a]),l=n?.get(r),c=e?new Dh:new kh;for(let t=0;t<o.length;t+=1)!0!==l?.[t]&&c.extend(o[t]);t.domain.values[a]=c.getDomain()}}}reprocessGroupProcessors(t,e){const{groupProcessors:i}=this,{columns:s}=t;for(const t of i)if(!t.supportsReprocessing)throw new Error("AG Charts - attempted to reprocess group processor that does not support reprocessing. This is an internal error that should not occur.");const n=new Set;for(const[,t]of e)n.has(t)||n.add(t);for(const e of i){const i=this.valueGroupIdxLookup(e),a=e.adjust()();for(const e of n){const{indexMap:n}=e;for(const e of n.spliceOps)if(e.insertCount>0)for(let n=0;n<e.insertCount;n++){const o=e.index+n;a(s,i,t.groups[o],o)}}}}postProcessProperties(t){for(const{adjust:e,property:i,scopes:s}of this.propertyProcessors)for(const n of this.valueIdxLookup(s,i))e()(t,n)}reduceData(t){t.reduced??(t.reduced={});const{dataSources:e,keys:i}=t;for(const s of this.reducers){const n=s.reducer();let a=s.initialValue;if("grouped"===t.type)for(const e of t.groups)a=n(a,e.keys);else{const t=jh(s)?s.scopes[0]:oi(e.keys()),o=i.map(e=>e.get(t)).filter(t=>null!=t),r=o.map(()=>{}),l=e.get(t)?.data??[];for(let t=0;t<l.length;t+=1){for(let e=0;e<r.length;e++)r[e]=o[e]?.[t];a=n(a,r)}}t.reduced[s.property]=a}}postProcessData(t){t.reduced??(t.reduced={});for(const e of this.processors)t.reduced[e.property]=e.calculate(t,t.reduced[e.property])}initDataDomainProcessor(t){const{keys:e,values:s}=this,n=new Set;for(const t of s)if(t.scopes)for(const e of t.scopes)n.add(e);const a=new Map,o=new Map;let r=!0;const l=()=>{for(const t of ai(e,s))"category"===t.valueType?a.set(t,new Dh):(a.set(t,new kh),r&&(r=(t.scopes?.length??0)===n.size))};l();const c=this.buildAccessors(ai(e,s)),h={value:void 0,missing:!1,valid:!1};return{dataDomain:a,processValue:(e,s,n,r)=>{let d,u;if(c.has(e.property)){try{u=c.get(e.property)(s)}catch{}d=null!=u}else d=e.property in s,u=d?s[e.property]:e.missingValue;if(null!=e.forceValue&&(u=d&&L(u)?-1*e.forceValue:e.forceValue,d=!0),h.missing=!d,!d&&!("missingValue"in e))if("string"==typeof r){const t=e.missing.get(r)??0;e.missing.set(r,t+1)}else for(const t of r){const i=e.missing.get(t)??0;e.missing.set(t,i+1)}a.has(e)||l();const p="key"===e.type&&null==u;if(d&&!1===e.validation?.(u,s,n)||p){if(h.valid=!1,!("invalidValue"in e))return"integrated"!==this.mode&&i.warnOnce(`invalid value of type [${typeof u}] for [${e.scopes} / ${e.id}] ignored:`,`[${u}]`),h.value=void 0,h;u=e.invalidValue}else h.valid=!0;if(e.processor){let t=o.get(e);null==t&&(t=e.processor(),o.set(e,t)),u=t(u,n)}return"extend"===t&&a.get(e)?.extend(u),h.value=u,h},initDataDomain:l,scopes:n,allScopesHaveSameDefs:r}}collectOptimizationMetadata(t,e){const i=t.optimizations?.domainBanding;t.optimizations={performance:{processingTime:t.time,pathTaken:e},...i&&{domainBanding:i}};const s="reprocess"===e;let n;if(!this.isReprocessingSupported(t)){const e=[];if("grouped"===t.type){t.groupsUnique||e.push("groupsUnique=false"),1!==this.getUniqueDataSets(t).size&&e.push("multiple data sources");const i=oi(t.scopes),s=t.invalidKeys?.get(i);s?.some(t=>t)&&e.push("has invalid keys")}this.aggregates.length>0&&e.push("has aggregates"),this.reducers.length>0&&e.push("has reducers"),this.processors.length>0&&e.push("has processors"),this.propertyProcessors.length>0&&e.push("has property processors"),n=e.length>0?e.join(", "):void 0}if(t.optimizations.reprocessing={applied:s,reason:n},"grouped"===t.type){let e=0;const i=t.groups[0];if(i){const s=i.datumIndices;for(const i of t.groups)i.datumIndices===s&&e++}t.optimizations.sharedDatumIndices={applied:e>0,sharedGroupCount:e,totalGroupCount:t.groups.length}}}collectDomainBandingMetadata(t,e,i,s,n){t.optimizations??(t.optimizations={});const a=[],o=[];for(const t of this.keys){const i=e.get(t),o=s.get(t),r=i instanceof Ah;let l,c;if(r||(l="category"===t.valueType?"discrete domain":!1===this.opts.domainBandingConfig?.enableBanding?"banding disabled":"not configured"),r&&o){const t=n.get(o)??o.getStats(),e=t.bandCount>0?t.dirtyBandCount/t.bandCount:0;c={totalBands:t.bandCount,dirtyBands:t.dirtyBandCount,dataSize:t.dataSize,scanRatio:e}}a.push({property:String(t.property),applied:r,reason:l,stats:c})}for(const t of this.values){const e=i.get(t),a=s.get(t),r=e instanceof Ah;let l,c;if(r||(l="category"===t.valueType?"discrete domain":!1===this.opts.domainBandingConfig?.enableBanding?"banding disabled":"not configured"),r&&a){const t=n.get(a)??a.getStats(),e=t.bandCount>0?t.dirtyBandCount/t.bandCount:0;c={totalBands:t.bandCount,dirtyBands:t.dirtyBandCount,dataSize:t.dataSize,scanRatio:e}}o.push({property:String(t.property),applied:r,reason:l,stats:c})}t.optimizations.domainBanding={keyDefs:a,valueDefs:o}}buildAccessors(t){const e=new Map;if(this.suppressFieldDotNotation)return e;for(const s of t){if(!s.property.includes(".")&&!s.property.includes("["))continue;const t=Vh(s.property);if(null==t){i.warnOnce("Invalid property path [%s]",s.property);continue}const n=Gh(t);e.set(s.property,n)}return e}},Hh=class t{constructor(t){this.data=t,this.pendingTransactions=[]}static empty(){return new t([])}static wrap(e){return new t(e)}netSize(){if(!this.hasPendingTransactions())return this.data.length;const t=this.getChangeDescription();return t?t.indexMap.finalLength:this.data.length}addTransaction(t){this.pendingTransactions.push(t),this.cachedChangeDescription=void 0}hasPendingTransactions(){return this.pendingTransactions.length>0}getPendingTransactionCount(){return this.pendingTransactions.length}commitPendingTransactions(){if(!this.hasPendingTransactions())return!1;const t=this.getChangeDescription();if(!t)return!1;const e=[...t.getPrependedValues(),...t.getAppendedValues()];let i=0;return t.applyToArray(this.data,()=>e[i++]),this.pendingTransactions=[],this.cachedChangeDescription=void 0,!0}clearPendingTransactions(){const t=this.pendingTransactions.length;return this.pendingTransactions=[],this.cachedChangeDescription=void 0,t}getPendingTransactions(){return[...this.pendingTransactions]}toJSON(){return this.data}getChangeDescription(){if(!this.hasPendingTransactions())return;if(this.cachedChangeDescription)return this.cachedChangeDescription;const{indexMap:t,prependValues:e,appendValues:i}=this.buildIndexMap(),s=new Ih(t,{prependValues:e,appendValues:i});return this.cachedChangeDescription=s,s}removeFromGroups(t,e){for(const i of t){let t=0;for(;t<i.length&&e.size>0;)e.has(i[t])?(e.delete(i[t]),i.splice(t,1)):t++;if(0===e.size)break}}buildIndexMap(){const t=this.data.length,e=[],i=[],s=new Set;for(const t of this.pendingTransactions){const{prepend:n,append:a,remove:o}=t;if(Array.isArray(n)&&n.length>0&&e.unshift([...n]),Array.isArray(a)&&a.length>0&&i.push([...a]),Array.isArray(o)&&o.length>0){const t=new Set(o);if(this.removeFromGroups(e,t),t.size>0&&this.removeFromGroups(i,t),t.size>0)for(let e=0;e<this.data.length&&t.size>0;e++){const i=this.data[e];t.has(i)&&(s.add(e),t.delete(i))}}}const n=e.flat(),a=i.flat(),o=n.length,r=a.length,l=t-s.size,c=o+l+r,h=[];if(o>0&&h.push({index:0,deleteCount:0,insertCount:o}),s.size>0){const t=Array.from(s).sort((t,e)=>e-t);let e=t[0],i=1;for(let s=1;s<t.length;s++){const n=t[s];t[s-1]-n===1?i++:(h.push({index:e-i+1+o,deleteCount:i,insertCount:0}),e=n,i=1)}h.push({index:e-i+1+o,deleteCount:i,insertCount:0})}return r>0&&h.push({index:o+l,deleteCount:0,insertCount:r}),{indexMap:{originalLength:t,finalLength:c,spliceOps:h,removedIndices:s,totalPrependCount:o,totalAppendCount:r},prependValues:n,appendValues:a}}};function Uh(t){return t.filter(t=>"key"===t.type).map(t=>t.property).join(";")}var Wh=class t{constructor(t,e){this.mode=t,this.suppressFieldDotNotation=e,this.debug=bs.create(!0,"data-model"),this.requested=[],this.status="setup"}async request(t,e,i){if("setup"!==this.status)throw new Error("AG Charts - data request after data setup phase.");return new Promise((s,n)=>{this.requested.push({id:t,opts:i,dataSet:e,resolve:s,reject:n})})}execute(e){if("setup"!==this.status)throw new Error("AG Charts - data request after data setup phase.");this.status="executed";const s=new Map;for(const t of this.requested)t.dataSet.hasPendingTransactions()&&s.set(t.dataSet,t.dataSet.getChangeDescription()),t.dataSet.commitPendingTransactions();this.debug("DataController.execute() - requested",this.requested);const n=this.validateRequests(this.requested);this.debug("DataController.execute() - validated",n);const a=this.mergeRequested(n);this.debug("DataController.execute() - merged",a),this.debug.check()&&(z().processedData=[]);const o=[];for(const{dataSet:r,ids:l,opts:c,resolves:h,rejects:d}of a){const a=e?.find(t=>bh(t,r,l,c)),u=(t,e)=>{if(this.debug.check()&&z("processedData").push(e),null!=e){o.push({opts:c,dataSet:r,dataLength:r.data.length,ids:l,dataModel:t,processedData:e});for(const i of h)i({dataModel:t,processedData:e})}else for(const t of d)t(new Error("AG Charts - no processed data generated"))},p=()=>{try{const t=new $h(c,this.mode,this.suppressFieldDotNotation),e=new Map(n.map(t=>[t.id,t.dataSet])),i=t.processData(e);return u(t,i),t}catch(t){for(const e of d)e(t)}};if(null==a){p();continue}const{dataModel:g,processedData:m}=a,f=s.get(r);if(m&&f&&g.isReprocessingSupported(m)){if(this.debug("DataController.execute() - reprocessing data",m,r),g.reprocessData(m,s),bs.check("data-model:reprocess-diff")){const e=new $h(c,this.mode,this.suppressFieldDotNotation),s=new Map(n.map(t=>[t.id,t.dataSet])),a=e.processData(s),o=JSON.parse(JSON.stringify(m,t.jsonReplacer)),r=JSON.parse(JSON.stringify(a,t.jsonReplacer));delete o.time,delete o.optimizations,delete r.time,delete r.optimizations;const l=Ka(r,o);l?(i.log("⚠️ DATA-MODEL REPROCESS DIFF DETECTED ⚠️"),i.log("Difference between incremental update and full reprocess:"),i.log(""),i.log("BASELINE (full reprocess):"),i.log(JSON.stringify(r,null,2)),i.log(""),i.log("REPROCESSED (incremental update):"),i.log(JSON.stringify(o,null,2)),i.log(""),i.log("DIFF (what changed):"),i.log(JSON.stringify(l,null,2))):i.log("✅ Data-model reprocess matches baseline (no diff)")}u(g,m)}else p()}return o}validateRequests(t){const e=[];for(const[i,s]of t.entries())i>0&&s.dataSet.data.length!==t[0].dataSet.data.length&&!1===s.opts.groupByData&&!1===s.opts.groupByKeys?s.reject(new Error("all series[].data arrays must be of the same length and have matching keys.")):e.push(s);return e}mergeRequested(e){const i=[];for(const s of e){const e=i.find(t.groupMatch(s));e?e.push(s):i.push([s])}return i.map(t.mergeRequests)}static groupMatch({dataSet:t,opts:e}){const{groupByData:i,groupByKeys:s=!1,groupByFn:n,props:a}=e,o=Uh(a);return([e])=>(!1===i||e.dataSet===t)&&(e.opts.groupByKeys??!1)===s&&e.opts.groupByFn===n&&Uh(e.opts.props)===o}static mergeRequests(e){const i={ids:[],rejects:[],resolves:[],dataSet:e[0].dataSet,opts:{...e[0].opts,props:[]}},s=new Map,n=new Map;let a=0;for(const o of e){const{id:e,dataSet:r,resolve:l,reject:c,opts:{props:h,...d}}=o;i.ids.push(e),i.rejects.push(c),i.resolves.push(l),i.dataSet??(i.dataSet=r),i.opts??(i.opts={...d,props:[]});for(const o of h){const l={...o,scopes:[e],data:r.data};let c;t.createIdsMap(e,l),t.crossScopeMergableTypes.has(l.type)?c=-1:n.has(r.data)?c=n.get(r.data):(c=a++,n.set(r.data,c));const h=`${l.type}-${c}-${l.groupId}`,d=s.get(h),u=d?.find(e=>t.deepEqual(e,l));null!=d?null!=u?(null!=l.scopes&&(u.scopes??(u.scopes=[]),u.scopes.push(...l.scopes)),"key"!==u.type&&"value"!==u.type||!l.idsMap?.size||(u.idsMap??(u.idsMap=new Map),t.mergeIdsMap(l.idsMap,u.idsMap))):(i.opts.props.push(l),d.push(l)):(i.opts.props.push(l),s.set(h,[l]))}}return i}static mergeIdsMap(t,e){for(const[i,s]of t){const t=e.get(i);if(null==t)e.set(i,new Set(s));else for(const e of s)t.add(e)}}static createIdsMap(t,e){null!=e.id&&(e.idsMap??(e.idsMap=new Map),e.idsMap.has(t)?e.idsMap.get(t).add(e.id):e.idsMap.set(t,new Set([e.id])))}static deepEqual(e,i){if(e===i)return!0;if(e&&i&&"object"==typeof e&&"object"==typeof i){if(e.constructor!==i.constructor)return!1;let s,n;if(Array.isArray(e)){if(n=e.length,n!==i.length)return!1;for(s=n-1;s>=0;s--)if(!t.deepEqual(e[s],i[s]))return!1;return!0}const a=Object.keys(e);if(n=a.length,n!==Object.keys(i).length)return!1;for(s=n-1;s>=0;s--){const n=a[s];if(!(t.skipKeys.has(n)||Object.hasOwn(i,n)&&t.deepEqual(e[n],i[n])))return!1}return!0}return!1}static jsonReplacer(t,e){return e instanceof Map?{__type:"Map",value:Array.from(e.entries())}:e instanceof Set?{__type:"Set",value:Array.from(e)}:e}};Wh.crossScopeMergableTypes=new Set(["key","group-value-processor"]),Wh.skipKeys=new Set(["id","idsMap","type","scopes","data"]);var _h=Wh,Yh=new class{constructor(){this.axesMap=new Map,this.themeTemplates=new Map}register(t,e){this.axesMap.set(t,e.moduleFactory),e.themeTemplate&&this.setThemeTemplate(t,e.themeTemplate)}create(t,e){const i=this.axesMap.get(t);if(i)return i(e);throw new Error(`AG Charts - unknown axis type: ${t}`)}has(t){return this.axesMap.has(t)}keys(){return this.axesMap.keys()}setThemeTemplate(t,e){return this.themeTemplates.set(t,e),this}getThemeTemplate(t){return this.themeTemplates.get(t)}},Kh=[{type:"root",optionsKey:"animation",chartTypes:["cartesian","polar","topology","standalone"]},{type:"root",optionsKey:"annotations",chartTypes:["cartesian"]},{type:"root",optionsKey:"background",chartTypes:["cartesian","polar","topology","standalone"],optionsInnerKey:"image"},{type:"root",optionsKey:"foreground",chartTypes:["cartesian","polar","topology","standalone"],optionsInnerKey:"image"},{type:"root",optionsKey:"chartToolbar",chartTypes:["cartesian"]},{type:"root",optionsKey:"contextMenu",chartTypes:["cartesian","polar","topology","standalone"]},{type:"root",optionsKey:"statusBar",chartTypes:["cartesian"],identifier:"status-bar"},{type:"root",optionsKey:"dataSource",chartTypes:["cartesian","polar","topology","standalone"]},{type:"root",optionsKey:"sync",chartTypes:["cartesian"]},{type:"root",optionsKey:"zoom",chartTypes:["cartesian","topology"]},{type:"root",optionsKey:"ranges",chartTypes:["cartesian"]},{type:"legend",optionsKey:"gradientLegend",chartTypes:["cartesian","polar","topology","standalone"],identifier:"gradient"},{type:"root",optionsKey:"navigator",chartTypes:["cartesian"]},{type:"axis",optionsKey:"axes[]",chartTypes:["polar"],identifier:"angle-category"},{type:"axis",optionsKey:"axes[]",chartTypes:["polar"],identifier:"angle-number"},{type:"axis",optionsKey:"axes[]",chartTypes:["polar"],identifier:"radius-category"},{type:"axis",optionsKey:"axes[]",chartTypes:["polar"],identifier:"radius-number"},{type:"axis",optionsKey:"axes[]",chartTypes:["cartesian"],identifier:"ordinal-time"},{type:"axis-option",optionsKey:"crosshair",chartTypes:["cartesian"]},{type:"axis-option",optionsKey:"bandHighlight",chartTypes:["cartesian"]},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"box-plot"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"candlestick"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"cone-funnel"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"funnel"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"ohlc"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"heatmap"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"range-area"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"range-bar"},{type:"series",optionsKey:"series[]",chartTypes:["cartesian"],identifier:"waterfall"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"nightingale"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"radar-area"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"radar-line"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"radial-bar"},{type:"series",optionsKey:"series[]",chartTypes:["polar"],identifier:"radial-column"},{type:"series",optionsKey:"series[]",chartTypes:["topology"],identifier:"map-shape"},{type:"series",optionsKey:"series[]",chartTypes:["topology"],identifier:"map-line"},{type:"series",optionsKey:"series[]",chartTypes:["topology"],identifier:"map-marker"},{type:"series",optionsKey:"series[]",chartTypes:["topology"],identifier:"map-shape-background"},{type:"series",optionsKey:"series[]",chartTypes:["topology"],identifier:"map-line-background"},{type:"series",optionsKey:"series[]",chartTypes:["standalone"],identifier:"pyramid"},{type:"series",optionsKey:"series[]",chartTypes:["standalone"],identifier:"linear-gauge"},{type:"series",optionsKey:"series[]",chartTypes:["standalone"],identifier:"radial-gauge"},{type:"series",optionsKey:"series[]",chartTypes:["standalone"],identifier:"sunburst"},{type:"series",optionsKey:"series[]",chartTypes:["standalone"],identifier:"treemap"},{type:"series",optionsKey:"series[]",chartTypes:["standalone"],identifier:"chord"},{type:"series",optionsKey:"series[]",chartTypes:["standalone"],identifier:"sankey"},{type:"series-option",optionsKey:"errorBar",chartTypes:["cartesian"],identifier:"error-bars"},{type:"context",contextKey:"sharedToolbar",chartTypes:["cartesian"]}];function Zh(t){return Kh.find(e=>"series"===e.type&&e.identifier===t)?.chartTypes}function Xh(t){if(!function(t){return"enterprise"===t.packageType}(t))throw new Error("AG Charts - internal configuration error, only enterprise modules need verification.");const e=Kh.find(e=>e.type===t.type&&(!("optionsKey"in e)||!("optionsKey"in t)||e.optionsKey===t.optionsKey)&&(!("contextKey"in e)||!("contextKey"in t)||e.contextKey===t.contextKey)&&e.identifier===t.identifier&&t.chartTypes.every(t=>e.chartTypes.includes(t)));return e&&(e.useCount??(e.useCount=0),e.useCount++),null!=e}var Qh=new class{constructor(){this.legendMap=new Map,this.themeTemplates=new Map}register(t,{optionsKey:e,moduleFactory:i,themeTemplate:s}){this.legendMap.set(t,{optionsKey:e,moduleFactory:i}),this.themeTemplates.set(e,s)}create(t,e){const i=this.legendMap.get(t)?.moduleFactory;if(i)return i(e);throw new Error(`AG Charts - unknown legend type: ${t}`)}getThemeTemplates(){return Object.fromEntries(this.themeTemplates)}getKeys(){return Array.from(this.legendMap.entries()).reduce((t,[e,i])=>(t[e]=i.optionsKey,t),{})}},qh=class extends Map{get(t){return super.get(t)??"unknown"}isCartesian(t){return"cartesian"===this.get(t)}isPolar(t){return"polar"===this.get(t)}isTopology(t){return"topology"===this.get(t)}isStandalone(t){return"standalone"===this.get(t)}get seriesTypes(){return Array.from(this.keys())}get cartesianTypes(){return this.seriesTypes.filter(t=>this.isCartesian(t))}get polarTypes(){return this.seriesTypes.filter(t=>this.isPolar(t))}get topologyTypes(){return this.seriesTypes.filter(t=>this.isTopology(t))}get standaloneTypes(){return this.seriesTypes.filter(t=>this.isStandalone(t))}},Jh=class extends Map{set(t,e){return super.set(t,zs(e,this.get(t)))}},td=new qh,ed=new qh,id=new Jh,sd=new class{constructor(){this.seriesMap=new Map,this.themeTemplates=new Map}register(t,{chartTypes:[e],moduleFactory:i,predictAxis:s,defaultAxes:n,themeTemplate:a,solo:o,stackable:r,groupable:l,stackedByDefault:c,hidden:h}){this.setThemeTemplate(t,a),this.seriesMap.set(t,{moduleFactory:i,predictAxis:s,defaultAxes:n,solo:o,stackable:r,groupable:l,stackedByDefault:c}),td.set(t,e),h||ed.set(t,e)}create(t,e){const i=this.seriesMap.get(t)?.moduleFactory;if(i)return i(e);throw new Error(`AG Charts - unknown series type: ${t}`)}predictAxes(t,e,i){if(!e)return;const s=e?.data??i;if(!s?.length)return;const n=this.seriesMap.get(t)?.predictAxis;if(!n)return;const a=new Map,o=function(t,e){const i=[0],s=Math.round((e-0)/4);if(s>0)for(let t=0+s;t<e&&!(i.push(t)>=4);t+=s);return i.push(e),i}(0,s.length-1);for(const t of o){const i=s[t];for(const t of Object.values(nr)){const s=n(t,i,e);if(!a.has(t)){a.set(t,s);continue}const o=a.get(t);if(s||o){if(!s||!o)return;for(const t of Object.keys(o))if(o[t]!==s[t])return}}}for(const[t,e]of a)e||a.delete(t);if(0!==a.size){if(1===a.size){const e=this.cloneDefaultAxes(t);if(!e)return;const[i]=a.values();return e.map(t=>"category"===t.type?i:t)}return Array.from(a.values())}}cloneDefaultAxes(t){const e=this.seriesMap.get(t)?.defaultAxes;return null==e?null:Xa(e)}setThemeTemplate(t,e){const i=this.themeTemplates.get(t);this.themeTemplates.set(t,zs(e,i))}getThemeTemplate(t){return this.themeTemplates.get(t)}isSolo(t){return this.seriesMap.get(t)?.solo??!1}isGroupable(t){return this.seriesMap.get(t)?.groupable??!1}isStackable(t){return this.seriesMap.get(t)?.stackable??!1}isStackedByDefault(t){return this.seriesMap.get(t)?.stackedByDefault??!1}},nd=class t{constructor(t){this.chart=t}subscribe(e=t.DEFAULT_GROUP){let i=this.get(e);return i||(i={members:new Set},t.chartsGroups.set(e,i)),i.members.add(this.chart),this}unsubscribe(e=t.DEFAULT_GROUP){const i=this.get(e);return i?.members.delete(this.chart),delete i?.domains?.x?.sources?.[this.chart.id],delete i?.domains?.y?.sources?.[this.chart.id],this}getChart(){return this.chart}getGroupState(e=t.DEFAULT_GROUP){return this.get(e)}getGroupMembers(e=t.DEFAULT_GROUP){const i=this.get(e);return i?Array.from(i.members):[]}getGroupSiblings(e=t.DEFAULT_GROUP){return this.getGroupMembers(e).filter(t=>t!==this.chart)}getGroupSyncMode(e=t.DEFAULT_GROUP){return this.getGroupMembers(e).some(t=>t.series.length>1)?"multi-series":"single-series"}get(e){return t.chartsGroups.get(e)}};nd.chartsGroups=new Map,nd.DEFAULT_GROUP=Symbol("sync-group-default");var ad=nd,od=class extends Pn{constructor(){super(...arguments),this.enabled=!1}};ls([ws],od.prototype,"enabled",2),ls([ws],od.prototype,"tabIndex",2);var rd={};rs(rd,{NODE_UPDATE_STATE_TO_PHASE_MAPPING:()=>ld,fromToMotion:()=>cd,staticFromToMotion:()=>hd});var ld={added:"add",updated:"update",removed:"remove",unknown:"initial","no-op":"none"};function cd(t,e,i,s,n,a,o){const{fromFn:r,toFn:l,applyFn:c=(t,e)=>t.setProperties(e)}=n,{nodes:h,selections:d}=Xl(s),u=(s,n)=>{let h,d=0,u=0;for(const p of n){const g=s[d]===p,m={last:u>=n.length-1,lastLive:d>=s.length-1,prev:n[u-1],prevFromProps:h,prevLive:s[d-1],next:n[u+1],nextLive:s[d+(g?1:0)]},f=`${t}_${e}_${p.id}`;i.stopByAnimationId(f);let y="unknown";g?a&&o&&(y=dd(p,p.datum,a,o)):y="removed",p.transitionOut="removed"===y;const{phase:x,start:b,finish:v,delay:M,duration:S,...I}=r(p,p.datum,y,m),{phase:D,start:k,finish:A,delay:w,duration:C,...N}=l(p,p.datum,y,m),L=null==v;i.animate({id:f,groupId:t,phase:x??D??"update",duration:S??C,delay:M??w,from:I,to:N,ease:Gl,collapsable:L,onPlay:()=>{const t={...b,...k,...I};c(p,t,"start")},onUpdate(t){c(p,t,"update")},onStop:()=>{const t={...b,...k,...I,...N,...v,...A};c(p,t,"end")}}),g&&d++,u++,h=I}};let p=0;for(const s of d){const n=s.nodes();u(n.filter(t=>!s.isGarbage(t)),n),i.animate({id:`${t}_${e}_selection_${p}`,groupId:t,phase:"end",from:0,to:1,ease:Gl,onStop(){s.cleanup()}}),p++}u(h,h)}function hd(t,e,i,s,n,a,o){const{nodes:r,selections:l}=Xl(s),{start:c,finish:h,phase:d}=o;i.animate({id:`${t}_${e}`,groupId:t,phase:d??"update",from:n,to:a,ease:Gl,onPlay:()=>{if(c){for(const t of r)t.setProperties(c);for(const t of l)for(const e of t.nodes())e.setProperties(c)}},onUpdate(t){for(const e of r)e.setProperties(t);for(const e of l)for(const i of e.nodes())i.setProperties(t)},onStop:()=>{for(const t of r)t.setProperties({...a,...h});for(const t of l){for(const e of t.nodes())e.setProperties({...a,...h});t.cleanup()}}})}function dd(t,e,i,s){const n=i(t,e);return s.added.has(n)?"added":s.removed.has(n)?"removed":null==t.previousDatum&&null!=t.datum?"added":null!=t.previousDatum&&null==t.datum?"removed":"updated"}var ud={};function pd(t,e){const{nodes:i,selections:s}=Xl(t);for(const t of s){for(const i of t.nodes()){const t=e(i,i.datum);i.setProperties(t)}t.cleanup()}for(const t of i){const i=e(t,t.datum);t.setProperties(i)}}rs(ud,{resetMotion:()=>pd});var gd=class t{constructor(t,e,i=!0){this.parentNode=t,this.autoCleanup=i,this.garbageBin=new Set,this._nodesMap=new Map,this._nodes=[],this.data=[],this.debug=bs.create(!0,"scene","scene:selections"),this.nodeFactory=Object.prototype.isPrototypeOf.call(on,e)?()=>new e:e}static select(e,i,s=!0){return new t(e,i,s)}static selectAll(t,e){const i=[],s=t=>{if(e(t)&&i.push(t),t instanceof Oa)for(const e of t.children())s(e)};return s(t),i}static selectByClass(e,...i){return t.selectAll(e,t=>i.some(e=>t instanceof e))}static selectByTag(e,i){return t.selectAll(e,t=>t.tag===i)}createNode(t,e,i){const s=this.nodeFactory(t);return s.datum=t,e?.(s),null==i?this._nodes.push(s):this._nodes.splice(i,0,s),this.parentNode.appendChild(s),s}update(t,e,i){if(this.garbageBin.size>0&&this.debug("Selection - update() called with pending garbage",t),i){const s=new Map,n=new Map;for(let e=0;e<t.length;e++){let a=i(t[e]);if(s.has(a)){const t=(n.get(a)??0)+1;n.set(a,t),a=`${a}:${t}`}s.set(a,e)}for(const[e,i]of this._nodesMap.entries()){const n=s.get(i);null==n?this.garbageBin.add(e):(e.datum=t[n],this.garbageBin.delete(e),s.delete(i))}for(const[i,n]of s.entries()){const s=t[n];this._nodesMap.set(this.createNode(s,e,n),i)}}else{const i=Math.max(t.length,this.data.length);for(let s=0;s<i;s++)s>=t.length?this.garbageBin.add(this._nodes[s]):s>=this._nodes.length?this.createNode(t[s],e):(this._nodes[s].datum=t[s],this.garbageBin.delete(this._nodes[s]))}return this.data=t.slice(),this.autoCleanup&&this.cleanup(),this}cleanup(){return 0===this.garbageBin.size||(this._nodes=this._nodes.filter(t=>!this.garbageBin.has(t)||(this._nodesMap.delete(t),this.garbageBin.delete(t),t.destroy(),!1))),this}clear(){return this.update([]),this}isGarbage(t){return this.garbageBin.has(t)}each(t){for(const e of this._nodes.entries())t(e[1],e[1].datum,e[0]);return this}*[Symbol.iterator](){for(let t=0;t<this._nodes.length;t++){const e=this._nodes[t];yield{node:e,datum:e.datum,index:t}}}select(e){return t.selectAll(this.parentNode,e)}selectByClass(e){return t.selectByClass(this.parentNode,e)}selectByTag(e){return t.selectByTag(this.parentNode,e)}nodes(){return this._nodes}at(t){return this._nodes.at(t)}get length(){return this._nodes.length}},md=class extends ba{constructor(t={}){super(t),this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.fill=void 0,this.strokeWidth=1}set x(t){this.x1=t,this.x2=t}set y(t){this.y1=t,this.y2=t}get midPoint(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}}computeBBox(){return new fs(Math.min(this.x1,this.x2),Math.min(this.y1,this.y2),Math.abs(this.x2-this.x1),Math.abs(this.y2-this.y1))}isPointInPath(t,e){return(this.x1===this.x2||this.y1===this.y2)&&this.getBBox().clone().grow(this.strokeWidth/2).containsPoint(t,e)}distanceSquared(t,e){const{x1:i,y1:s,x2:n,y2:a}=this;return Hn(t,e,i,s,n,a,1/0)}render(t){const{ctx:e,devicePixelRatio:i}=t;let{x1:s,y1:n,x2:a,y2:o}=this;if(s===a){const{strokeWidth:t}=this,e=Math.round(s*i)/i+Math.trunc(t*i)%2/(2*i);s=e,a=e}else if(n===o){const{strokeWidth:t}=this,e=Math.round(n*i)/i+Math.trunc(t*i)%2/(2*i);n=e,o=e}e.beginPath(),e.moveTo(s,n),e.lineTo(a,o),this.fillStroke(e),this.fillShadow?.markClean(),super.render(t)}toSVG(){if(!this.visible)return;const t=B("line");return t.setAttribute("x1",String(this.x1)),t.setAttribute("y1",String(this.y1)),t.setAttribute("x2",String(this.x2)),t.setAttribute("y2",String(this.y2)),this.applySvgStrokeAttributes(t),{elements:[t]}}};md.className="Line",ls([Xs()],md.prototype,"x1",2),ls([Xs()],md.prototype,"y1",2),ls([Xs()],md.prototype,"x2",2),ls([Xs()],md.prototype,"y2",2);var fd="color: green",yd="color: grey";function xd(){return Ls(()=>{})}function bd(t,e){const i=Es(e);if(0===i.length)return;const s=Os(t);for(const t of i)t in s&&(e[t]=s[t])}var vd=class{transitionRoot(t,e){this.parent?this.parent.transitionRoot(t,e):this.transition(t,e)}},Md=class t extends vd{constructor(t,e,i){super(),this.defaultState=t,this.states=e,this.enterEach=i,this.debug=bs.create(!0,"animation"),this.state=t,this.debug(`%c${this.constructor.name} | init -> ${t}`,fd)}transition(e,i){if(!this.transitionChild(e,i)||this.state===t.child||this.state===t.parent)return;const s=this.state,n=this.states[this.state];let a=n[e];const o=`%c${this.constructor.name} | ${this.state} -> ${e} ->`;if(Array.isArray(a))a=a.find(t=>{if(!t.guard)return!0;const e=t.guard(i);return e||this.debug(`${o} (guarded)`,t.target,yd),e});else if("object"==typeof a&&!(a instanceof t)&&a.guard&&!a.guard(i))return void this.debug(`${o} (guarded)`,a.target,yd);if(!a)return void this.debug(`${o} ${this.state}`,yd);const r=this.getDestinationState(a),l=r===this.state?void 0:n.onExit;this.debug(`${o} ${r}`,fd),this.state=r,"function"==typeof a?a(i):"object"!=typeof a||a instanceof t||a.action?.(i),l?.(),this.enterEach?.(s,r),r!==s&&r!==t.child&&r!==t.parent&&this.states[r].onEnter?.(s,i)}transitionAsync(t,e){setTimeout(()=>{this.transition(t,e)},0)}is(e){return this.state===t.child&&this.childState?this.childState.is(e):this.state===e}resetHierarchy(){this.debug(`%c${this.constructor.name} | ${this.state} -> [resetHierarchy] -> ${this.defaultState}`,"color: green"),this.state=this.defaultState}transitionChild(e,i){return this.state!==t.child||!this.childState||(bd(this,this.childState),this.childState.transition(e,i),!this.childState.is(t.parent)||(this.debug(`%c${this.constructor.name} | ${this.state} -> ${e} -> ${this.defaultState}`,fd),this.state=this.defaultState,this.states[this.state].onEnter?.(),this.childState.resetHierarchy(),!1))}getDestinationState(e){let i=this.state;return"string"==typeof e?i=e:e instanceof t?(this.childState=e,this.childState.parent=this,i=t.child):"object"==typeof e&&(e.target instanceof t?(this.childState=e.target,this.childState.parent=this,i=t.child):null!=e.target&&(i=e.target)),i}};Md.child="__child",Md.parent="__parent";var Sd=Md,Id=class extends vd{constructor(...t){super(),this.stateMachines=t;for(const e of t)e.parent=this}transition(t,e){for(const i of this.stateMachines)bd(this,i),i.transition(t,e)}transitionAsync(t,e){for(const i of this.stateMachines)bd(this,i),i.transitionAsync(t,e)}},Dd=class{constructor(){this.enabled=!0}};ls([ws],Dd.prototype,"enabled",2),ls([ws],Dd.prototype,"stroke",2),ls([ws],Dd.prototype,"strokeWidth",2),ls([ws],Dd.prototype,"strokeOpacity",2);var kd=class extends Pn{constructor(){super(...arguments),this.enabled=!0,this.border=new Dd,this._cachedFormatter=void 0}formatValue(t,e,i,s){const{formatter:n,format:a}=this;let o;if(null!=n&&(o??(o=t(n,s))),null!=a){let t=this._cachedFormatter;null!=t&&t.type===e&&t.format===a||(t={type:e,format:a,formatter:zl.getFormatter(e,a)},this._cachedFormatter=t),o??(o=t.formatter?.(i))}return null==o||G(o)?o:String(o)}};function Ad(t){const{enabled:e=!1,stroke:i}=t?.border??{},s=null!=t?.fill||e&&null!=i?t?.padding:null;if(null==s)return{bottom:0,left:0,right:0,top:0};if("number"==typeof s)return{bottom:s,left:s,right:s,top:s};{const{bottom:t=0,left:e=0,right:i=0,top:n=0}=s;return{bottom:t,left:e,right:i,top:n}}}ls([ws],kd.prototype,"enabled",2),ls([ws],kd.prototype,"border",2),ls([ws],kd.prototype,"color",2),ls([ws],kd.prototype,"cornerRadius",2),ls([ws],kd.prototype,"fill",2),ls([ws],kd.prototype,"fillOpacity",2),ls([ws],kd.prototype,"fontStyle",2),ls([ws],kd.prototype,"fontWeight",2),ls([ws],kd.prototype,"fontSize",2),ls([ws],kd.prototype,"fontFamily",2),ls([ws],kd.prototype,"formatter",2),ls([ws],kd.prototype,"format",2),ls([ws],kd.prototype,"padding",2),ls([ws],kd.prototype,"itemStyler",2);var wd=class{constructor(){this.moduleMap=new Map}*modules(){for(const t of this.moduleMap.values())yield t.moduleInstance}addModule(t,e){if(this.moduleMap.has(t.optionsKey))throw new Error(`AG Charts - module already initialised: ${t.optionsKey}`);this.moduleMap.set(t.optionsKey,{module:t,moduleInstance:e(t)})}removeModule(t){const e=Z(t)?t:t.optionsKey;this.moduleMap.get(e)?.moduleInstance.destroy(),this.moduleMap.delete(e)}getModule(t){return this.moduleMap.get(Z(t)?t:t.optionsKey)?.moduleInstance}isEnabled(t){return this.moduleMap.has(Z(t)?t:t.optionsKey)}mapModules(t){return Array.from(this.moduleMap.values(),(e,i)=>t(e.moduleInstance,i))}destroy(){for(const t of this.moduleMap.keys())this.moduleMap.get(t)?.moduleInstance.destroy();this.moduleMap.clear()}},Cd=class extends ba{constructor(t={}){super(t),this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.startLine=!1,this.endLine=!1,this.horizontal=!1,this.strokeWidth=1}computeBBox(){return new fs(this.x1,this.y1,this.x2-this.x1,this.y2-this.y1)}isPointInPath(t,e){return!1}render(t){const{ctx:e}=t;let{x1:i,y1:s,x2:n,y2:a}=this;i=this.align(i),s=this.align(s),n=this.align(n),a=this.align(a);const{fill:o,horizontal:r}=this,{globalAlpha:l}=e;null!=o&&(this.applyFillAndAlpha(e),e.beginPath(),e.moveTo(i,s),e.lineTo(n,s),e.lineTo(n,a),e.lineTo(i,a),e.closePath(),e.fill(),e.globalAlpha=l);const{stroke:c,strokeWidth:h,startLine:d,endLine:u}=this;if((d||u)&&c&&h){const{lineDash:t,lineDashOffset:o,lineCap:c,lineJoin:p}=this;this.applyStrokeAndAlpha(e),e.lineWidth=h,t&&e.setLineDash([...t]),o&&(e.lineDashOffset=o),c&&(e.lineCap=c),p&&(e.lineJoin=p),e.beginPath(),d&&(e.moveTo(i,s),r?e.lineTo(i,a):e.lineTo(n,s)),u&&(e.moveTo(n,a),r?e.lineTo(n,s):e.lineTo(i,a)),e.stroke(),e.globalAlpha=l}this.fillShadow?.markClean(),super.render(t)}};function Nd(t){return Q(t)||H(t)||function(t){return null!=t&&Object.hasOwn(t,"valueOf")&&Q(t.valueOf())}(t)}function Ld(t){return function(t){return null!=t&&Object.hasOwn(t,"toString")&&Z(t.toString())}(t)&&Object.hasOwn(t,"id")?t.id:t}function Td(t){switch(t.type){case"line":return t.value;case"range":return t.range}}function Ed(t,e){const i=Td(t);if(null==i)return!1;const s=$c.is(e)||_c.is(e),n=t=>function(t,e){return null!=t&&(!e||Nd(t))}(t,s)&&!Number.isNaN(e.convert(t,{clamp:!0}));if("range"===t.type){const[t,e]=i;return n(t)&&n(e)}return n(i)}Cd.className="Range",ls([Xs()],Cd.prototype,"x1",2),ls([Xs()],Cd.prototype,"y1",2),ls([Xs()],Cd.prototype,"x2",2),ls([Xs()],Cd.prototype,"y2",2),ls([Xs()],Cd.prototype,"startLine",2),ls([Xs()],Cd.prototype,"endLine",2),ls([Xs()],Cd.prototype,"horizontal",2);var Od={top:{rangeH:0,rangeV:-1,labelH:0,labelV:1},"inside-top":{rangeH:0,rangeV:-1,labelH:0,labelV:1},"top-left":{rangeH:-1,rangeV:-1,labelH:-1,labelV:1},"inside-top-left":{rangeH:-1,rangeV:-1,labelH:-1,labelV:1},left:{rangeH:-1,rangeV:0,labelH:1,labelV:0},"inside-left":{rangeH:-1,rangeV:0,labelH:-1,labelV:0},"bottom-left":{rangeH:-1,rangeV:1,labelH:-1,labelV:-1},"inside-bottom-left":{rangeH:-1,rangeV:1,labelH:-1,labelV:-1},bottom:{rangeH:0,rangeV:1,labelH:0,labelV:-1},"inside-bottom":{rangeH:0,rangeV:1,labelH:0,labelV:-1},"bottom-right":{rangeH:1,rangeV:1,labelH:1,labelV:-1},"inside-bottom-right":{rangeH:1,rangeV:1,labelH:1,labelV:-1},right:{rangeH:1,rangeV:0,labelH:-1,labelV:0},"inside-right":{rangeH:1,rangeV:0,labelH:1,labelV:0},"top-right":{rangeH:1,rangeV:-1,labelH:1,labelV:1},"inside-top-right":{rangeH:1,rangeV:-1,labelH:1,labelV:1},inside:{rangeH:0,rangeV:0,labelH:0,labelV:0}},Rd={top:{rangeH:0,rangeV:-1,labelH:0,labelV:1},"inside-top":{rangeH:0,rangeV:-1,labelH:0,labelV:-1},"top-left":{rangeH:-1,rangeV:-1,labelH:1,labelV:-1},"inside-top-left":{rangeH:-1,rangeV:-1,labelH:1,labelV:-1},left:{rangeH:-1,rangeV:0,labelH:1,labelV:0},"inside-left":{rangeH:-1,rangeV:0,labelH:1,labelV:0},"bottom-left":{rangeH:-1,rangeV:1,labelH:1,labelV:1},"inside-bottom-left":{rangeH:-1,rangeV:1,labelH:1,labelV:1},bottom:{rangeH:0,rangeV:1,labelH:0,labelV:-1},"inside-bottom":{rangeH:0,rangeV:1,labelH:0,labelV:1},"bottom-right":{rangeH:1,rangeV:1,labelH:-1,labelV:1},"inside-bottom-right":{rangeH:1,rangeV:1,labelH:-1,labelV:1},right:{rangeH:1,rangeV:0,labelH:-1,labelV:0},"inside-right":{rangeH:1,rangeV:0,labelH:-1,labelV:0},"top-right":{rangeH:1,rangeV:-1,labelH:-1,labelV:-1},"inside-top-right":{rangeH:-1,rangeV:-1,labelH:-1,labelV:-1},inside:{rangeH:0,rangeV:0,labelH:0,labelV:0}},Pd={top:{rangeH:0,rangeV:-1,labelH:0,labelV:1},"inside-top":{rangeH:0,rangeV:-1,labelH:0,labelV:-1},"top-left":{rangeH:-1,rangeV:-1,labelH:-1,labelV:1},"inside-top-left":{rangeH:-1,rangeV:-1,labelH:-1,labelV:-1},left:{rangeH:-1,rangeV:0,labelH:1,labelV:0},"inside-left":{rangeH:-1,rangeV:0,labelH:-1,labelV:0},"bottom-left":{rangeH:-1,rangeV:1,labelH:-1,labelV:-1},"inside-bottom-left":{rangeH:-1,rangeV:1,labelH:-1,labelV:1},bottom:{rangeH:0,rangeV:1,labelH:0,labelV:-1},"inside-bottom":{rangeH:0,rangeV:1,labelH:0,labelV:1},"bottom-right":{rangeH:1,rangeV:1,labelH:1,labelV:-1},"inside-bottom-right":{rangeH:1,rangeV:1,labelH:1,labelV:1},right:{rangeH:1,rangeV:0,labelH:-1,labelV:0},"inside-right":{rangeH:1,rangeV:0,labelH:1,labelV:0},"top-right":{rangeH:1,rangeV:-1,labelH:1,labelV:1},"inside-top-right":{rangeH:1,rangeV:-1,labelH:1,labelV:-1},inside:{rangeH:0,rangeV:0,labelH:0,labelV:0}},zd={top:{rangeH:0,rangeV:-1,labelH:0,labelV:1},"inside-top":{rangeH:0,rangeV:-1,labelH:0,labelV:-1},"top-left":{rangeH:-1,rangeV:-1,labelH:1,labelV:-1},"inside-top-left":{rangeH:-1,rangeV:-1,labelH:-1,labelV:-1},left:{rangeH:-1,rangeV:0,labelH:1,labelV:0},"inside-left":{rangeH:-1,rangeV:0,labelH:-1,labelV:0},"bottom-left":{rangeH:-1,rangeV:1,labelH:1,labelV:1},"inside-bottom-left":{rangeH:-1,rangeV:1,labelH:-1,labelV:1},bottom:{rangeH:0,rangeV:1,labelH:0,labelV:-1},"inside-bottom":{rangeH:0,rangeV:1,labelH:0,labelV:1},"bottom-right":{rangeH:1,rangeV:1,labelH:-1,labelV:1},"inside-bottom-right":{rangeH:1,rangeV:1,labelH:1,labelV:1},right:{rangeH:1,rangeV:0,labelH:-1,labelV:0},"inside-right":{rangeH:1,rangeV:0,labelH:1,labelV:0},"top-right":{rangeH:1,rangeV:-1,labelH:-1,labelV:-1},"inside-top-right":{rangeH:1,rangeV:-1,labelH:1,labelV:-1},inside:{rangeH:0,rangeV:0,labelH:0,labelV:0}},jd=class extends Pn{constructor(){super(...arguments),this.fontSize=14,this.fontFamily="Verdana, sans-serif",this.padding=5,this.color="rgba(87, 87, 87, 1)"}};ls([ws],jd.prototype,"enabled",2),ls([ws],jd.prototype,"text",2),ls([ws],jd.prototype,"fontStyle",2),ls([ws],jd.prototype,"fontWeight",2),ls([ws],jd.prototype,"fontSize",2),ls([ws],jd.prototype,"fontFamily",2),ls([ws],jd.prototype,"padding",2),ls([ws],jd.prototype,"color",2),ls([ws],jd.prototype,"position",2),ls([ws],jd.prototype,"rotation",2),ls([ws],jd.prototype,"parallel",2);var Bd=class extends Pn{constructor(){super(),this.id=Oi(this),this.defaultColorRange=[],this.fill="#c16068",this.label=new jd,this.scale=void 0,this.clippedRange=[-1/0,1/0],this.gridLength=0,this.position="top",this.rangeGroup=new Oa({name:this.id}),this.lineGroup=new Oa({name:this.id}),this.labelGroup=new Oa({name:this.id}),this.crossLineRange=new Cd,this.crossLineLabel=new Ko,this.data=void 0,this.startLine=!1,this.endLine=!1,this._isRange=void 0,this.lineGroup.append(this.crossLineRange),this.labelGroup.append(this.crossLineLabel),this.crossLineRange.pointerEvents=1}get defaultLabelPosition(){return"top"}update(t){const{enabled:e,type:i,data:s,scale:n}=this;if(!(n&&e&&t&&Ed(this,n)&&null!=s))return this.rangeGroup.visible=!1,this.lineGroup.visible=!1,void(this.labelGroup.visible=!1);this.rangeGroup.visible=t,this.lineGroup.visible=t,this.labelGroup.visible=t,this.updateNodes();const a="range"===i;a!==this._isRange&&(a?this.rangeGroup.appendChild(this.crossLineRange):this.lineGroup.appendChild(this.crossLineRange)),this._isRange=a}calculateLayout(t){if(this.data=void 0,!t)return;const{type:e,range:i,value:s,scale:n,clippedRange:a,strokeWidth:o=0}=this;if(!n)return;const r=n.bandwidth??0,l=n.step??0,c=n instanceof Wc?(l-r)/2:0;let h,d,u,p,[g,m]=jc(a);if(g-=r,m+=r,"line"===e){const t=r/2;if(h=n.convert(s)+t,d=Number.NaN,u=n.convert(s,{clamp:!0})+t,p=Number.NaN,u>=m||u<=g)return}else{if(!i)return;{const[t,e]=i,[s,a]=Jc(t,e);if(h=n.convert(t,{alignment:s}),d=n.convert(e,{alignment:a}),u=n.convert(t,{clamp:!0,alignment:s}),p=n.convert(e,{clamp:!0,alignment:a}),u>p&&([u,p]=[p,u],[h,d]=[d,h]),u>=m||p<=g)return;Number.isFinite(h)&&(u-=c),Number.isFinite(d)&&(d+=r,p+=r+c)}}u=zc(u,a),p=zc(p,a),h-c>=u&&(h-=c),d+c<=p&&(d+=c),this.startLine=o>0&&h>=u&&h<=u+c,this.endLine=o>0&&d>=p-r-c&&d<=p,this.data=[u,p],!1!==this.label.enabled&&this.label.text}updateNodes(){const{position:t,data:[e,i]=[0,0],gridLength:s}=this,n=Number.isFinite(i)?i-e:0;let a;switch(t){case"top":case"bottom":a=new fs(e,"top"===t?0:-s,n,s);break;case"left":case"right":a=new fs("left"===t?0:-s,e,s,n)}this.updateRangeNode(a);const{label:o}=this;!1!==o.enabled&&o.text&&(this.updateLabel(),this.positionLabel(a))}updateRangeNode(t){const{type:e,position:i,crossLineRange:s,startLine:n,endLine:a,fill:o,fillOpacity:r,stroke:l,strokeWidth:c,strokeOpacity:h,lineDash:d}=this;s.x1=t.x,s.x2=t.x+t.width,s.y1=t.y,s.y2=t.y+t.height,s.horizontal="top"===i||"bottom"===i,s.startLine=n,s.endLine=a,s.fill="range"===e?o:void 0,s.fillOpacity=r??1,s.stroke=l,s.strokeWidth=c??1,s.strokeOpacity=h??1,s.lineDash=d}updateLabel(){const{crossLineLabel:t,label:e}=this;e.text&&(t.fontStyle=e.fontStyle,t.fontWeight=e.fontWeight,t.fontSize=e.fontSize,t.fontFamily=e.fontFamily,t.fill=e.color,t.text=e.text)}get anchor(){const t="left"===this.position||"right"===this.position,e="range"===this.type,{position:i=this.defaultLabelPosition}=this.label;return e?(t?Pd:zd)[i]:(t?Od:Rd)[i]}positionLabel(t){const{crossLineLabel:e,label:i,anchor:s}=this;e.rotation=pn(i.rotation??0),e.textBaseline="middle",e.textAlign="center";const n=e.getBBox();if(!n)return;const{width:a,height:o}=n,r=i.padding+a/2,l=i.padding+o/2,c=t.x+t.width*(s.rangeH+1)/2-r*s.labelH,h=t.y+t.height*(s.rangeV+1)/2-l*s.labelV;e.x=c,e.y=h,e.rotationCenterX=c,e.rotationCenterY=h}computeLabelSize(){const{label:t}=this;if(!1===t.enabled||!t.text)return;const e=new Ko;e.fontFamily=t.fontFamily,e.fontSize=t.fontSize,e.fontStyle=t.fontStyle,e.fontWeight=t.fontWeight,e.text=t.text,e.rotation=pn(t.rotation??0),e.textBaseline="middle",e.textAlign="center";const i=e.getBBox();if(!i)return;const{width:s,height:n}=i;return{width:s,height:n}}calculatePadding(t){const{label:e,anchor:i}=this,s=this.computeLabelSize();if(!s)return;const{width:n,height:a}=s,o=e.padding+n,r=e.padding+a,l="left"===this.position||"right"===this.position;l&&(-1===i.rangeH&&1===i.labelH?t.left=Math.max(t.left??0,o):1===i.rangeH&&-1===i.labelH&&(t.right=Math.max(t.right??0,o))),l||(-1===i.rangeV&&1===i.labelV?t.top=Math.max(t.top??0,r):1===i.rangeV&&-1===i.labelV&&(t.bottom=Math.max(t.bottom??0,r)))}};Bd.className="CrossLine",ls([ws],Bd.prototype,"enabled",2),ls([ws],Bd.prototype,"type",2),ls([ws],Bd.prototype,"range",2),ls([ws],Bd.prototype,"value",2),ls([ws],Bd.prototype,"defaultColorRange",2),ls([ws],Bd.prototype,"fill",2),ls([ws],Bd.prototype,"fillOpacity",2),ls([ws],Bd.prototype,"stroke",2),ls([ws],Bd.prototype,"strokeWidth",2),ls([ws],Bd.prototype,"strokeOpacity",2),ls([ws],Bd.prototype,"lineDash",2),ls([ws],Bd.prototype,"label",2);var Fd=class{constructor(){this.enabled=!0,this.width=1,this.style=[{fill:void 0,fillOpacity:1,stroke:void 0,strokeWidth:void 0,lineDash:[]}]}};ls([ws],Fd.prototype,"enabled",2),ls([ws],Fd.prototype,"width",2),ls([ws],Fd.prototype,"style",2);var Vd=class extends Pn{};ls([ws],Vd.prototype,"placement",2),ls([ws],Vd.prototype,"step",2),ls([ws],Vd.prototype,"values",2),ls([ws],Vd.prototype,"minSpacing",2),ls([ws],Vd.prototype,"maxSpacing",2);var Gd=class extends Pn{constructor(){super(...arguments),this.enabled=!0,this.border=new Dd,this.wrapping="never",this.truncate=!1,this.spacing=5,this.color="#575757",this.avoidCollisions=!0,this.mirrored=!1,this.parallel=!1,this._formatters={"component:year":void 0,"component:month":void 0,"component:day":void 0,"component:none":void 0,"long:year":void 0,"long:month":void 0,"long:day":void 0,"long:none":void 0}}getSideFlag(){return this.mirrored?1:-1}formatValue(t,e,i,s){const{formatter:n,format:a}=this,{type:o,value:r,domain:l,boundSeries:c}=e,h="number"===e.type?e.fractionDigits:void 0,d="date"===e.type?e.unit:void 0;let u;if(null!=n&&(u=t(n,{value:r,index:i,domain:l,fractionDigits:h,unit:d,step:"date"===e.type?e.step:void 0,boundSeries:c})),null!=a&&null==u){const{specifier:t,dateStyle:e="long",truncateDate:i}=s??{},n=`${e}:${i??"none"}`;let l=this._formatters[n];const c=zl.mergeSpecifiers(t,a);null!=l&&l.type===o&&l.unit===d&&Rs(l.mergedFormat,c)||(l={type:o,mergedFormat:c,unit:d,formatter:zl.getFormatter(o,c,d,e,{truncateDate:i})},this._formatters[n]=l),u=l.formatter?.(r,h)}return null==u||G(u)?u:String(u)}};ls([ws],Gd.prototype,"enabled",2),ls([ws],Gd.prototype,"border",2),ls([ws],Gd.prototype,"cornerRadius",2),ls([ws],Gd.prototype,"fill",2),ls([ws],Gd.prototype,"fillOpacity",2),ls([ws],Gd.prototype,"fontStyle",2),ls([ws],Gd.prototype,"fontWeight",2),ls([ws],Gd.prototype,"fontSize",2),ls([ws],Gd.prototype,"fontFamily",2),ls([ws],Gd.prototype,"wrapping",2),ls([ws],Gd.prototype,"truncate",2),ls([ws],Gd.prototype,"spacing",2),ls([ws],Gd.prototype,"minSpacing",2),ls([ws],Gd.prototype,"color",2),ls([ws],Gd.prototype,"rotation",2),ls([ws],Gd.prototype,"avoidCollisions",2),ls([ws],Gd.prototype,"mirrored",2),ls([ws],Gd.prototype,"padding",2),ls([ws],Gd.prototype,"parallel",2),ls([ws],Gd.prototype,"itemStyler",2),ls([ws],Gd.prototype,"formatter",2),ls([ws],Gd.prototype,"format",2);var $d=class{constructor(){this.enabled=!0,this.width=1,this.stroke=void 0}};ls([ws],$d.prototype,"enabled",2),ls([ws],$d.prototype,"width",2),ls([ws],$d.prototype,"stroke",2);var Hd=class extends Pn{constructor(){super(...arguments),this.enabled=!0,this.width=1,this.size=6}};ls([ws],Hd.prototype,"enabled",2),ls([ws],Hd.prototype,"width",2),ls([ws],Hd.prototype,"size",2),ls([ws],Hd.prototype,"stroke",2);var Ud=class extends Pn{constructor(){super(...arguments),this.caption=new sr,this.enabled=!1,this.spacing=sr.SMALL_PADDING,this.fontSize=10,this.fontFamily="sans-serif",this.wrapping="always"}};ls([ws],Ud.prototype,"enabled",2),ls([ws],Ud.prototype,"text",2),ls([ws],Ud.prototype,"spacing",2),ls([ws],Ud.prototype,"fontStyle",2),ls([ws],Ud.prototype,"fontWeight",2),ls([ws],Ud.prototype,"fontSize",2),ls([ws],Ud.prototype,"fontFamily",2),ls([ws],Ud.prototype,"color",2),ls([ws],Ud.prototype,"wrapping",2),ls([ws],Ud.prototype,"formatter",2);var Wd=(t=>(t[t.TickAndDomain=0]="TickAndDomain",t[t.TicksOnly=1]="TicksOnly",t[t.Off=2]="Off",t))(Wd||{});function _d(t){const[e,i]=jc(t.range),s=Math.floor(e),n=Math.ceil(i);return{min:s,max:n,visible:s!==n}}var Yd=2*Math.PI,Kd=Yd/2;function Zd(t){const{min:e,max:i}=t,s=t=>t<e||t>i,n={fromFn(t,e,i){let{x1:n,x2:a,y1:o,y2:r}=t,l=t.opacity;return("added"===i||s(e.offset))&&(({x1:n,x2:a,y1:o,y2:r}=e),l=0),{x1:n,x2:a,y1:o,y2:r,opacity:l,phase:ld[i]}},toFn(t,e,i){const{x1:s,x2:n,y1:a,y2:o}=e;let r=1;return"removed"===i&&(r=0),{x1:s,x2:n,y1:a,y2:o,opacity:r}},applyFn(t,e){t.setProperties(e),t.visible=!s(t.y)}},a={fromFn(t,e,i){const n=t.previousDatum??e;let{x:a,y:o,rotationCenterX:r,rotationCenterY:l,rotation:c}=n,h=t.opacity;return"removed"===i||s(n.y)?c=e.rotation:("added"===i||s(t.datum.y))&&(({x:a,y:o,rotationCenterX:r,rotationCenterY:l,rotation:c}=e),h=0),{x:a,y:o,rotationCenterX:r,rotationCenterY:l,rotation:c,opacity:h,phase:ld[i]}},toFn(t,e,i){const{x:s,y:n,rotationCenterX:a,rotationCenterY:o}=e;let r=0,l=1;var c,h;return"added"===i?r=e.rotation:"removed"===i?(l=0,r=e.rotation):(c=t.previousDatum?.rotation??e.rotation,h=e.rotation,r=Math.abs(h-c)<Kd?h:c>h?h+Yd:h-Yd),{x:s,y:n,rotationCenterX:a,rotationCenterY:o,rotation:r,opacity:l,finish:{rotation:e.rotation}}}};return{tick:n,line:{fromFn(t,e){const{x1:i,x2:s,y1:n,y2:a}=t.previousDatum??e;return{x1:i,x2:s,y1:n,y2:a,phase:ld.updated}},toFn(t,e){const{x1:i,x2:s,y1:n,y2:a}=e;return{x1:i,x2:s,y1:n,y2:a}}},label:a,group:{fromFn(t,e){const{translationX:i,translationY:s}=t;return{translationX:i,translationY:s,phase:ld.updated}},toFn(t,e){const{translationX:i,translationY:s}=e;return{translationX:i,translationY:s}}}}}function Xd(){return(t,e)=>({translationX:e.translationX,translationY:e.translationY})}function Qd(){return(t,e)=>({x:e.x,y:e.y,rotationCenterX:e.rotationCenterX,rotationCenterY:e.rotationCenterY,rotation:e.rotation})}function qd(){return(t,e)=>{const{x1:i,x2:s,y1:n,y2:a}=e;return{x1:i,x2:s,y1:n,y2:a}}}function Jd(){return(t,e)=>{const{x1:i,x2:s,y1:n,y2:a}=e;return{x:i,y:n,width:s-i,height:a-n}}}var tu=(t=>(t[t.TickLines=0]="TickLines",t[t.AxisLine=1]="AxisLine",t[t.TickLabels=2]="TickLabels",t))(tu||{});function eu(t,e){return t.domain===e.domain&&t.rangeExtent===e.rangeExtent&&t.nice===e.nice&&t.gridLength===e.gridLength&&t.visibleRange[0]===e.visibleRange[0]&&t.visibleRange[1]===e.visibleRange[1]&&t.initialPrimaryTickCount?.unzoomed===e.initialPrimaryTickCount?.unzoomed&&t.initialPrimaryTickCount?.zoomed===e.initialPrimaryTickCount?.zoomed}var iu=class t{constructor(e,i){this.moduleCtx=e,this.scale=i,this.id=Oi(this),this._crossLines=[],this.nice=!0,this.reverse=!1,this.keys=[],this.interval=new Vd,this.dataDomain={domain:[],clipped:!1},this.title=new Ud,this.gridLength=0,this.gridPadding=0,this.seriesAreaPadding=0,this.layoutConstraints={stacked:!0,align:"start",width:100,unit:"percent"},this.boundSeries=[],this.includeInvisibleDomains=!1,this.interactionEnabled=!0,this.axisGroup=new Oa({name:`${this.id}-axis`}),this.tickLineGroup=this.axisGroup.appendChild(new ja({name:`${this.id}-Axis-tick-lines`,zIndex:0})),this.tickLabelGroup=this.axisGroup.appendChild(new ja({name:`${this.id}-Axis-tick-labels`,zIndex:2})),this.labelGroup=new Oa({name:`${this.id}-Labels`,zIndex:11}),this.gridGroup=new za({name:`${this.id}-Axis-grid`,zIndex:2}),this.gridFillGroup=this.gridGroup.appendChild(new Oa({name:`${this.id}-gridFills`})),this.gridLineGroup=this.gridGroup.appendChild(new Oa({name:`${this.id}-gridLines`})),this.crossLineRangeGroup=new ja({name:`${this.id}-CrossLines-Range`,zIndex:6}),this.crossLineLineGroup=new ja({name:`${this.id}-CrossLines-Line`,zIndex:10}),this.crossLineLabelGroup=new ja({name:`${this.id}-CrossLines-Label`,zIndex:15}),this.tickLabelGroupSelection=gd.select(this.tickLabelGroup,Ko,!1),this.line=new $d,this.tick=new Hd,this.gridLine=new Fd,this.label=this.createLabel(),this.defaultTickMinSpacing=t.defaultTickMinSpacing,this.translation={x:0,y:0},this.layout={label:{fractionDigits:0,spacing:this.label.spacing,format:this.label.format}},this.axisContext=void 0,this.cleanup=new Mi,this.isHovering=!1,this.range=[0,1],this.visibleRange=[0,1],this.animatable=!0,this.tickLayout=void 0,this.formatterBoundSeries=new vi(()=>{const{direction:t,boundSeries:e}=this;return _s(e.flatMap(e=>e.getFormatterContext(t)))}),this.moduleMap=new wd,this.range=this.scale.range.slice();for(const t of this.crossLines)this.initCrossLine(t);this.cleanup.register(this.moduleCtx.widgets.containerWidget.addListener("mousemove",t=>this.onMouseMove(t)),this.moduleCtx.widgets.containerWidget.addListener("mouseleave",()=>this.endHovering()))}set crossLines(t){const{CrossLineConstructor:e}=this.constructor;for(const t of this._crossLines)this.detachCrossLine(t);this._crossLines=t.map(t=>{const i=new e;return i.set(t),i});for(const t of this._crossLines)this.attachCrossLine(t),this.initCrossLine(t)}get crossLines(){return this._crossLines}get type(){return this.constructor.type??""}get primaryLabel(){}get primaryTick(){}isCategoryLike(){return!1}resetAnimation(t){}onMouseMove(t){const e=this.tickLabelGroup.pickNode(t.currentX,t.currentY),i=e?.datum,{textUntruncated:s}=i??{};s?(this.moduleCtx.tooltipManager.updateTooltip(this.id,{canvasX:t.currentX,canvasY:t.currentY,showArrow:!1},[{type:"structured",title:s}]),this.isHovering=!0):this.endHovering()}endHovering(){this.isHovering&&(this.moduleCtx.tooltipManager.removeTooltip(this.id),this.isHovering=!1)}attachCrossLine(t){this.crossLineRangeGroup.appendChild(t.rangeGroup),this.crossLineLineGroup.appendChild(t.lineGroup),this.crossLineLabelGroup.appendChild(t.labelGroup)}detachCrossLine(t){t.rangeGroup.remove(),t.lineGroup.remove(),t.labelGroup.remove()}destroy(){this.moduleMap.destroy(),this.cleanup.flush()}setScaleRange(t){const{range:e,scale:i}=this,s=(e[1]-e[0])/(t[1]-t[0]),n=s*t[0],a=e[0]-n;i.range=[a,a+s]}updateScale(){const{range:[t,e]}=this;this.setScaleRange(this.visibleRange);for(const i of this.crossLines)i.clippedRange=[t,e]}setCrossLinesVisible(t){this.crossLineRangeGroup.visible=t,this.crossLineLineGroup.visible=t,this.crossLineLabelGroup.visible=t}attachAxis(t){t.gridNode.appendChild(this.gridGroup),t.axisNode.appendChild(this.axisGroup),t.labelNode.appendChild(this.labelGroup),t.crossLineRangeNode.appendChild(this.crossLineRangeGroup),t.crossLineLineNode.appendChild(this.crossLineLineGroup),t.crossLineLabelNode.appendChild(this.crossLineLabelGroup)}detachAxis(){this.gridGroup.remove(),this.axisGroup.remove(),this.labelGroup.remove(),this.crossLineRangeGroup.remove(),this.crossLineLineGroup.remove(),this.crossLineLabelGroup.remove()}attachLabel(t){this.labelGroup.append(t)}inRange(t,e=0){const[i,s]=jc(this.range);return t>=i-e&&t<=s+e}getRangeOverflow(t){const{range:e,visibleRange:i}=this,s=(e[1]-e[0])/(i[1]-i[0]),[n,a]=jc([e[0]-s*i[0],e[0]-s*i[0]+s]);return t<n?t-n:t>a?t-a:0}onGridLengthChange(t,e){e^t&&this.onGridVisibilityChange();for(const t of this.crossLines)this.initCrossLine(t)}onGridVisibilityChange(){}createLabel(){return new Gd}update(){this.formatterBoundSeries.clear(),this.updatePosition(),this.updateSelections(),this.gridLineGroup.visible=this.gridLine.enabled,this.updateLabels(),this.updateCrossLines()}getLabelStyles(t,e,i=this.label){const s={border:i.border,color:i.color,cornerRadius:i.cornerRadius,fill:i.fill,fillOpacity:i.fillOpacity,fontFamily:i.fontFamily,fontSize:i.fontSize,fontStyle:i.fontStyle,fontWeight:i.fontWeight,padding:i.padding,spacing:i.spacing};let n;i.itemStyler&&(n=this.cachedCallWithContext(i.itemStyler,{...t,...s}));const a=zs(n,e,s);return{border:a.border,color:a.color,cornerRadius:a.cornerRadius,fill:a.fill,fillOpacity:a.fillOpacity,fontFamily:a.fontFamily,fontSize:a.fontSize,fontStyle:a.fontStyle,fontWeight:a.fontWeight,padding:a.padding,spacing:a.spacing}}getTickSize(t=this.tick){return t.enabled?t.size:0}processData(){this.invalidateLayoutCache();const{includeInvisibleDomains:t,boundSeries:e,direction:i}=this,s=(t?e:e.filter(t=>t.isEnabled())).map(t=>t.getDomain(i));this.setDomains(...s)}setDomains(...t){let e,i;t.length>0?({domain:e,animatable:i}=this.scale.normalizeDomains(...t)):(e=[],i=!0),this.dataDomain=this.normaliseDataDomain(e),this.reverse&&this.dataDomain.domain.reverse(),this.animatable=i}calculateDomain(t){const{dataDomain:{domain:e},range:i,nice:s,scale:n,gridLength:a}=this,o=Bc(i),r=[0,1];this.updateScale();const{unzoomedTickLayoutCache:l}=this;let c;if(null!=l&&eu(l,{domain:e,rangeExtent:o,nice:s,gridLength:a,visibleRange:r,initialPrimaryTickCount:t}))c=l.tickLayout;else{const i=n.range;this.setScaleRange([0,1]);const l=s?0:2;c=this.calculateTickLayout(e,l,[0,1],t),n.range=i,this.unzoomedTickLayoutCache={domain:e,rangeExtent:o,nice:s,gridLength:a,visibleRange:r,initialPrimaryTickCount:t,tickLayout:c}}return this.updateScale(),n.domain=c.niceDomain,{unzoomedTickLayout:c,domain:n.domain}}calculateLayout(t,e){this.chartLayout=e;const{visibleRange:i,nice:s}=this,n=0===i[0]&&1===i[1],{unzoomedTickLayout:a,domain:o}=this.calculateDomain(t);let r;if(n)r=a;else{const{range:e,gridLength:n}=this,a=Bc(e),l=s?1:2,{tickLayoutCache:c}=this;null!=c&&eu(c,{domain:o,rangeExtent:a,nice:s,gridLength:n,visibleRange:i,initialPrimaryTickCount:t})?r=c.tickLayout:(r=this.calculateTickLayout(o,l,i,t),this.tickLayoutCache={domain:o,rangeExtent:a,nice:s,gridLength:n,visibleRange:i,initialPrimaryTickCount:t,tickLayout:r})}const{rawTickCount:l=0,fractionDigits:c,bbox:h}=r,d=a.rawTickCount??0,u=0!==l&&0!==d?{zoomed:l,unzoomed:d}:void 0;return this.tickLayout=r.layout,this.layout.label={fractionDigits:c,spacing:this.label.spacing,format:this.label.format},this.layoutCrossLines(),{primaryTickCount:u,bbox:h}}invalidateLayoutCache(){this.unzoomedTickLayoutCache=void 0,this.tickLayoutCache=void 0,this.tickLayout=void 0}updateCrossLines(){const t=this.hasDefinedDomain()||this.hasVisibleSeries();for(const e of this.crossLines)e.update(t)}updatePosition(){const{crossLineRangeGroup:t,crossLineLineGroup:e,crossLineLabelGroup:i,gridGroup:s,translation:n}=this,a=Math.floor(n.x),o=Math.floor(n.y);s.setProperties({translationX:a,translationY:o}),t.setProperties({translationX:a,translationY:o}),e.setProperties({translationX:a,translationY:o}),i.setProperties({translationX:a,translationY:o})}tickFormatter(t,e,i,s,n,a="long"){const{moduleCtx:o,label:r}=this,{formatManager:l}=o,c=i?this.primaryLabel:void 0,h=this.tickFormatParams(t,e,s,n),d=this.formatterBoundSeries.get();let u,p,g;if("number"===h.type)u=h.fractionDigits;else if("date"===h.type){const{unit:t,step:e,epoch:i}=h;p={unit:t,step:e,epoch:i},g=h.truncateDate}const m=this.uncachedCallWithContext.bind(this),f={datum:void 0,seriesId:void 0,legendItemName:void 0,key:void 0,source:"axis-label",property:this.direction,domain:t,boundSeries:d},y=c??r,x=i?r.format:void 0,b={specifier:zl.mergeSpecifiers(c?.format,r.format),truncateDate:g};return(t,e)=>{const i=this.datumFormatParams(t,f,u,p,a);return i.value=t,y.formatValue(m,i,e,{specifier:x,dateStyle:a,truncateDate:g})??l.format(m,i,b)??l.defaultFormat(i,b)}}formatDatum(t,e,i,s,n,a,o,r,l,c){if(null==e)return"";const{moduleCtx:h,direction:d,dataDomain:u}=this;r??(r=u.domain);const{formatManager:p}=h,g=this.formatterBoundSeries.get();let m;switch(i){case"crosshair":case"annotation-label":m=this.layout.label.fractionDigits+1;break;case"series-label":m=2;break;case"tooltip":m=3;break;case"legend-label":m=void 0}const f=this.datumFormatParams(e,{source:i,datum:a,seriesId:s,legendItemName:n,key:o,property:d,domain:r,boundSeries:g},m,void 0,"long"),{type:y,value:x}=f,b=this.createCallWithContext(t),v=l?.formatValue(b,y,x,c??f)??p.format(b,f)??this.label.formatValue(b,f,Number.NaN)??p.defaultFormat(f);return G(v)?v:String(v)}getBBox(){return this.axisGroup.getBBox()}initCrossLine(t){t.scale=this.scale,t.gridLength=this.gridLength}hasVisibleSeries(){return this.boundSeries.some(t=>t.isEnabled())}clipTickLines(t,e,i,s){this.tickLineGroup.setClipRect(new fs(t,e,i,s))}clipGrid(t,e,i,s){this.gridGroup.setClipRect(new fs(t,e,i,s))}getTitleFormatterParams(t){const{direction:e}=this;return{domain:t,direction:e,boundSeries:this.formatterBoundSeries.get(),defaultValue:this.title?.text}}normaliseDataDomain(t){return{domain:[...t],clipped:!1}}getLayoutState(){return{id:this.id,rect:this.getBBox(),gridPadding:this.gridPadding,seriesAreaPadding:this.seriesAreaPadding,tickSize:this.getTickSize(),direction:this.direction,domain:this.dataDomain.domain,scale:this.scale,...this.layout}}getModuleMap(){return this.moduleMap}createModuleContext(){return this.axisContext??(this.axisContext=this.createAxisContext()),{...this.moduleCtx,parent:this.axisContext}}createAxisContext(){const{scale:t}=this;return{axisId:this.id,scale:this.scale,direction:this.direction,continuous:$c.is(t)||_c.is(t),getCanvasBounds:()=>Ta.toCanvas(this.axisGroup),seriesKeyProperties:()=>this.boundSeries.reduce((t,e)=>{const i=e.getKeyProperties(this.direction);for(const e of i)t.add(e);return t},new Set),seriesIds:()=>this.boundSeries.map(t=>t.id),scaleInvert:e=>t.invert(e,!0),scaleInvertNearest:e=>t.invert(e,!0),formatScaleValue:(t,e,i)=>this.formatDatum(void 0,t,e,void 0,void 0,void 0,void 0,void 0,i),attachLabel:t=>this.attachLabel(t),inRange:(t,e)=>this.inRange(t,e),getRangeOverflow:t=>this.getRangeOverflow(t),pickBand:t=>this.pickBand(t)}}pickBand(t){if(!Wc.is(this.scale))return;const{scale:e,range:i}=this,s=e.invert(this.isVertical()?t.y:t.x,!0),n=e.bandwidth??0,a=((e.step??0)-n)/2,o=e.convert(s),r=o-a,l=o+n+a;return{id:this.id,value:s,band:[zc(r,i),zc(l,i)],position:o}}isVertical(){return"y"===this.direction}isReversed(){return this.reverse}cachedCallWithContext(t,e){const{callbackCache:i,chartService:s}=this.moduleCtx;return i.call([this,s],t,e)}uncachedCallWithContext(t,e){const{chartService:i}=this.moduleCtx;return Fa([this,i],t,e)}createCallWithContext(t){const{chartService:e}=this.moduleCtx;return(i,s)=>Fa([t,this,e],i,s)}};iu.defaultTickMinSpacing=50,iu.CrossLineConstructor=Bd,ls([ws],iu.prototype,"nice",2),ls([ws],iu.prototype,"reverse",2),ls([ws],iu.prototype,"keys",2),ls([ws],iu.prototype,"interval",2),ls([ws],iu.prototype,"title",2),ls([lo((t,e,i)=>t.onGridLengthChange(e,i))],iu.prototype,"gridLength",2);var su=iu,nu=class extends Gd{constructor(){super(...arguments),this.autoRotateAngle=335}};ls([ws],nu.prototype,"autoRotate",2),ls([ws],nu.prototype,"autoRotateAngle",2);var au=1e3,ou=6e4,ru=36e5,lu=864e5,cu=2592e6,hu=31536e6,du=(new Date).getTimezoneOffset()*ou,uu={millisecond:{milliseconds:1,hierarchy:"day",encode:t=>t.getTime(),decode:t=>new Date(t)},second:{milliseconds:au,hierarchy:"day",encode(t,e){const i=e?0:du;return Math.floor((t.getTime()-i)/au)},decode:(t,e)=>new Date((e?0:du)+t*au)},minute:{milliseconds:ou,hierarchy:"day",encode(t,e){const i=e?0:du;return Math.floor((t.getTime()-i)/ou)},decode:(t,e)=>new Date((e?0:du)+t*ou)},hour:{milliseconds:ru,hierarchy:"day",encode(t,e){const i=e?0:du;return Math.floor((t.getTime()-i)/ru)},decode:(t,e)=>new Date((e?0:du)+t*ru)},day:{milliseconds:lu,hierarchy:"month",encode(t,e){const i=e?0:t.getTimezoneOffset()*ou;return Math.floor((t.getTime()-i)/lu)},decode(t,e){let i;return e?(i=new Date(0),i.setUTCDate(i.getUTCDate()+t),i.setUTCHours(0,0,0,0)):(i=new Date(1970,0,1),i.setDate(i.getDate()+t)),i}},month:{milliseconds:cu,hierarchy:"year",encode:(t,e)=>e?12*t.getUTCFullYear()+t.getUTCMonth():12*t.getFullYear()+t.getMonth(),decode(t,e){if(e){const e=Math.floor(t/12),i=t-12*e;return new Date(Date.UTC(e,i,1))}{const e=Math.floor(t/12);return new Date(e,t-12*e,1)}}},year:{milliseconds:hu,hierarchy:void 0,encode:(t,e)=>e?t.getUTCFullYear():t.getFullYear(),decode(t,e){let i;return e?(i=new Date,i.setUTCFullYear(t),i.setUTCMonth(0,1),i.setUTCHours(0,0,0,0)):i=new Date(t,0,1,0,0,0,0),i}}};function pu(t){return"string"==typeof t?{unit:t,step:1,epoch:void 0,utc:!1}:{unit:t.unit,step:t.step??1,epoch:t.epoch,utc:t.utc??!1}}function gu(t,e,i,s){if(null==i)return 0;const n=uu[t];return Math.floor(n.encode(new Date(i),s))%e}function mu(t,e,i,s,n){const a=uu[e];return Math.floor((a.encode(new Date(t),s)-n)/i)}function fu(t,e,i,s,n){return uu[e].decode(t*i+n,s)}function yu(t,e,i,s,n){return fu(mu(new Date(t),e,i,s,n),e,i,s,n)}function xu(t,e,i,s,n){return fu(mu(new Date(Number(t)-1),e,i,s,n)+1,e,i,s,n)}function bu(t,e){const{unit:i,step:s,epoch:n,utc:a}=pu(t);return yu(e,i,s,a,gu(i,s,n,a))}function vu(t,e){const{unit:i,step:s,epoch:n,utc:a}=pu(t);return xu(e,i,s,a,gu(i,s,n,a))}function Mu(t,e){const{unit:i,step:s,epoch:n,utc:a}=pu(t),o=gu(i,s,n,a);return fu(mu(xu(e,i,s,a,o),i,s,a,o)-1,i,s,a,o)}function Su(t,e){const{unit:i,step:s,epoch:n,utc:a}=pu(t),o=gu(i,s,n,a);return fu(mu(yu(e,i,s,a,o),i,s,a,o)+1,i,s,a,o)}function Iu(t,e,i){if(t.valueOf()>e.valueOf()&&([t,e]=[e,t],null!=i&&(i=[1-i[1],1-i[0]])),null!=i){const s=e.valueOf()-t.valueOf(),n=t.valueOf();t=new Date(n+i[0]*s),e=new Date(n+i[1]*s)}return[new Date(t),new Date(e)]}function Du(t,e,i,{extend:s=!1,visibleRange:n=[0,1],limit:a,defaultAlignment:o="start"}={}){const r=pu(t),{unit:l,step:c,utc:h}=r;let d;d=null!=r.epoch?r.epoch:"interval"===o?void 0:e.valueOf()>i.valueOf()?i:e;const u=gu(r.unit,r.step,d,r.utc);let[p,g]=Iu(e,i,n);p=s?yu(p,l,c,h,u):xu(p,l,c,h,u),g=s?xu(g,l,c,h,u):yu(g,l,c,h,u);const m=mu(p,l,c,h,u);let f=mu(g,l,c,h,u);return null!=a&&f-m>a&&(f=m+a),{range:[m,f],unit:l,step:c,utc:h,offset:u}}function ku(t,e,i,s){const{range:[n,a]}=Du(t,e,i,s);return Math.abs(a-n)}function Au(t,e,i,s){const{range:[n,a],unit:o,step:r,utc:l,offset:c}=Du(t,e,i,s),h=[];for(let t=n;t<=a;t+=1){const e=fu(t,o,r,l,c);h.push(e)}return h}function wu(t,e,i,{extend:s,visibleRange:n,limit:a,defaultAlignment:o}={}){const{range:[r]}=Du(t,e,i,{extend:s,visibleRange:n,limit:a,defaultAlignment:o}),{range:[l]}=Du(t,e,i,{extend:s,limit:a,defaultAlignment:o});return r-l}function Cu(t){return"string"==typeof t?t:t.unit}function Nu(t){return"string"==typeof t?1:t.step??1}function Lu(t){return"string"==typeof t?void 0:t.epoch}function Tu(t){return uu[Cu(t)].hierarchy}function Eu(t){return Nu(t)*uu[Cu(t)].milliseconds}function Ou(t){return t instanceof Date?t.getTime():t}function Ru(t){return t<au?"millisecond":t<ou?"second":t<ru?"minute":t<828e5?"hour":t<24192e5?"day":t<hu?"month":"year"}function Pu(t){if(0===t.length)return"millisecond";if(1===t.length)return zu(t[0]);let e=1/0;for(let i=1;i<t.length;i++)e=Math.min(e,Math.abs(t[i].valueOf()-t[i-1].valueOf()));return Ru(e)}function zu(t){return bu("second",t)<t?"millisecond":bu("minute",t)<t?"second":bu("hour",t)<t?"minute":bu("day",t)<t?"hour":bu("month",t)<t?"day":bu("year",t)<t?"month":"year"}function ju(t){const[e,i]=0===t.length?[0,0]:jc([t[0].valueOf(),t.at(-1).valueOf()]);if(new Date(e).getFullYear()===new Date(i).getFullYear())return new Date(e).getMonth()!==new Date(i).getMonth()?"year":new Date(e).getDate()!==new Date(i).getDate()?"month":"day"}function Bu(t,e,i){if(null==i||0===i[0]&&1===i[1])return;const s=C(0,Math.floor(i[0]*t.length),t.length),n=C(0,Math.ceil(i[1]*t.length),t.length);return[e?t.length-n:s,e?t.length-s:n]}function Fu(t,e,i){const s=Bu(t,e,i);if(null==s)return{ticks:t,count:t.length,firstTickIndex:0};const[n,a]=s;return{ticks:t.slice(n,a),count:t.length,firstTickIndex:n}}var Vu=class t extends Wc{constructor(){super(...arguments),this.type="category",this.defaultTickCount=0,this.index=new Map,this.indexInitialized=!1,this._domain=[]}static is(e){return e instanceof t}set domain(t){this._domain!==t&&(this.invalid=!0,this._domain=t,this.index.clear(),this.indexInitialized=!1)}get domain(){return this._domain}get bands(){return this._domain}normalizeDomains(...t){let e;const i=new Set;let s=!0;for(const n of t)i.has(n)||(i.add(n),null==e?e=Gu(n):(s&&(s=$u(n,e)),e=Gu([...e,...n])));return e??(e=[]),{domain:e,animatable:s}}toDomain(t){}invert(t,e=!1){this.refresh();const i=e?this.bandwidth/2:0,s=this.invertNearestIndex(Math.max(0,t-i));return e||t===this.ordinalRange(s)?this.domain[s]:void 0}ticks(t,e=this.domain,i){const{bands:s}=this;let{tickCount:n}=t;if(0===n){const t=s.length>1?1:0;return{ticks:s[t]?[s[t]]:[],count:void 0,firstTickIndex:t}}let a=null!=n&&0!==n?Math.trunc(s.length/n):1;if(a=Vc(a),a<=1)return Fu(e,!1,i);n=Math.trunc(s.length/a);const o=a*n,r=Vc(Math.trunc((s.length-o)/2)),l=C(0,Math.floor((i?.[0]??0)*s.length),s.length),c=C(0,Math.ceil((i?.[1]??1)*s.length),s.length),h=Math.floor((l-r)/a)*a+r,d=Math.ceil((c-r)/a)*a+r,u=[];for(let t=h;t<d;t+=a)t>=0&&t<s.length&&u.push(s[t]);let p=u.length>0?this.findIndex(u[0]):void 0;return null!=p&&(p=Math.floor((p-r)/a)),{ticks:u,count:void 0,firstTickIndex:p}}findIndex(t){const{index:e,indexInitialized:i}=this;if(!i){const{domain:t}=this;for(let i=0;i<t.length;i++)e.set(Ou(t[i]),i);this.indexInitialized=!0}return e.get(Ou(t))}};function Gu(t){let e;const i=new Set;for(const s of t){const n=Ou(s),a=i.size;i.add(n),i.size!==a?e?.push(s):e??(e=t.slice(0,i.size))}return e??t}function $u(t,e){let i=-1;for(const s of t){const t=e.indexOf(s);if(-1===t)i=1/0;else{if(t<=i)return!1;i=t}}return!0}function Hu(t,e){return t.valueOf()-e.valueOf()}function Uu(t){const e=t.slice().sort(Hu);return null==Wu(e)?function(t){let e=Number.NaN;const i=[];for(const s of t){const t=s.valueOf();e!==t&&i.push(s),e=t}return i}(e):e}function Wu(t){if(0===t.length)return 1;const e=Number(t.at(-1))>Number(t[0])?1:-1;let i=-1/0*e;for(const s of t){const t=s.valueOf();if(Math.sign(t-i)!==e)return;i=t}return e}function _u(t,[e,i],[s,n]){const a=n-s,o=i-e;return[(e+o*t[0]-s)/a,(e+o*t[1]-s)/a]}var Yu=(t,e)=>({duration:Eu(t)*e,timeInterval:t,step:e}),Ku=[Yu({unit:"second"},1),Yu({unit:"second"},5),Yu({unit:"second"},15),Yu({unit:"second"},30),Yu({unit:"minute"},1),Yu({unit:"minute"},5),Yu({unit:"minute"},15),Yu({unit:"minute"},30),Yu({unit:"hour"},1),Yu({unit:"hour"},3),Yu({unit:"hour"},6),Yu({unit:"hour"},12),Yu({unit:"day"},1),Yu({unit:"day"},2),Yu({unit:"day",step:7},1),Yu({unit:"day",step:7},2),Yu({unit:"day",step:7},3),Yu({unit:"month"},1),Yu({unit:"month"},2),Yu({unit:"month"},3),Yu({unit:"month"},4),Yu({unit:"month"},6),Yu({unit:"year"},1)],Zu=[1,2,5,10];function Xu(t,e){return Math.abs(Math.round(t)-t)<e}function Qu(t,e,i){return Math.abs(e-t)>=i?Math.abs(e-t)/i+1:1}function qu(t,e,i,s,n,a){if(t===e)return{ticks:[t],count:1,firstTickIndex:0};if(i<2)return{ticks:[t,e],count:2,firstTickIndex:0};const o=sp(t,e,i,s,n);if(!Number.isFinite(o))return{ticks:[],count:0,firstTickIndex:void 0};let r=t,l=e;Xu(r/o,1e-12)||(r=Math.ceil(r/o)*o),Xu(l/o,1e-12)||(l=Math.floor(l/o)*o),null!=a&&(a=_u(a,[t,e],[r,l]));const{ticks:c}=op(r,l,o,a),h=c.at(0);return{ticks:c,count:Qu(r,l,o),firstTickIndex:null==h?void 0:Math.round((h-r)/o)}}var Ju=Math.floor(4.666666666666667)/10;function tp({timeInterval:t,step:e}){const i=Eu(t)*e,s=Tu(t);return i<=((s?Eu(s):void 0)??1/0)*Ju}function ep(t,{weekStart:e}){if("day"===t.unit&&7===t.step)return e}function ip(t,e,i,s,n,{weekStart:a,primaryOnly:o=!1,targetInterval:r}){if(i<=0)return;const l=r??Math.abs(e-t)/Math.max(i,1),c=Ku.findLast(t=>(!o||tp(t))&&l>t.duration),h=Ku.find(t=>(!o||tp(t))&&l<=t.duration);if(null==c)return{unit:"millisecond",step:Math.max(sp(t,e,i,s,n),1)};if(null==h)return{unit:"year",step:null==r?sp(t/hu,e/hu,i,s,n):1};const{timeInterval:d,step:u}=l-c.duration<h.duration-l?c:h;return{unit:d.unit,step:Nu(d)*u,epoch:ep(d,{weekStart:a})}}function sp(t,e,i,s=0,n=1/0){if(t===e)return C(1,s,n);if(i<1)return Number.NaN;const a=Math.abs(e-t),o=10**Math.floor(Math.log10(a/i));let r=Number.NaN,l=1/0,c=!1;for(const t of Zu){const e=Math.ceil(a/(t*o)),h=e>=s&&e<=n;if(c&&!h)continue;const d=Math.abs(e-i);(l>d||c!==h)&&(c||(c=h),l=d,r=t)}return r*o}function np(t){for(let e=t.length-1;e>=0;e-=1)if("0"!==t[e])return e+1;return 0}function ap(t,e){const i=et(e??",f");if(null==i)return;(null==i.precision||Number.isNaN(i.precision))&&(!i.type||"eEFgGnprs".includes(i.type)?i.precision=Math.max(...t.map(t=>{if(!Number.isFinite(t))return 0;const[e,s]=t.toExponential((i.type?6:12)-1).split(/[.e]/g);return("1"!==e&&"-1"!==e?1:0)+np(s)+1})):"f%".includes(i.type)&&(i.precision=Math.max(...t.map(t=>{if(!Number.isFinite(t)||0===t)return 0;const e=Math.floor(Math.log10(Math.abs(t))),s=i.type?6:12,n=np(t.toExponential(s-1).split(/[.e]/g)[1]);return Math.max(0,n-e)}))));const s=it(i);return t=>s(Number(t))}function op(t,e,i,s){if(!Number.isFinite(i)||i<=0)return{ticks:[],count:0,firstTickIndex:void 0};if(t===e)return{ticks:[t],count:1,firstTickIndex:0};const n=10**E(i),a=Math.min(t,e),o=Math.max(t,e);let r,l;if(null==s||0===s[0]&&1===s[1])r=a,l=o;else{const i=e-t,n=t+i*s[0],a=e-i*(1-s[1]);r=Math.min(n,a),l=Math.max(n,a)}r=Math.floor(r*n)/n,l=Math.ceil(l*n)/n;const c=[];for(let t=0;;t+=1){const e=Math.round((a+i*t)*n)/n;if(e>o)break;e>=r&&e<=l&&c.push(e)}const h=c.at(0);return{ticks:c,count:Qu(a,o,i),firstTickIndex:null==h?void 0:Math.round((h-a)/i)}}function rp(t,e){return t>=e&&(i.warnOnce("the configured interval results in more than 1 item per pixel, ignoring. Supply a larger interval or omit this configuration"),!0)}function lp(t,e){const i=Math.abs(e-t),s=10**Math.floor(Math.log10(i));let n=1/0,a=[t,e];for(const o of Zu){const r=o*s,l=Math.floor(t/r)*r,c=Math.ceil(e/r)*r,h=1-i/Math.abs(c-l);n>h&&(n=h,a=[l,c])}return a}function cp(t,e,i,s,n,a){if(t<=0)return{minTickCount:0,maxTickCount:0,tickCount:0};a=Math.max(a,t/(n+1)),i??(i=a),s??(s=t),i>s&&(i===a?i=s:s=i),i=Math.max(i,1);const o=Math.max(1,Math.floor(t/(e*i))),r=Math.min(o,Math.ceil(t/(e*s)));return{minTickCount:r,maxTickCount:o,tickCount:C(r,Math.floor(n/e),o)}}var hp=new Date(1970,0,4),dp=class t extends $c{constructor(){super([],[0,1]),this.type="time"}static is(e){return e instanceof t}toDomain(t){return new Date(t)}convert(t,e){return super.convert(t?.valueOf()??Number.NaN,e)}invert(t){return new Date(super.invert(t))}niceDomain(t,e=this.domain){if(e.length<2)return[];let[i,s]=e;const n=this.getPixelRange();for(let e=0;e<4;e++){const[e,a]=gp(i,s,t,n);if(Ou(i)===Ou(e)&&Ou(s)===Ou(a))break;i=e,s=a}return[i,s]}ticks(t,e=this.domain,i=[0,1],{extend:s=!1}={}){const{nice:n,interval:a,tickCount:o=$c.defaultTickCount,minTickCount:r,maxTickCount:l}=t;if(e.length<2)return;const c=e.map(Ou),h=c[0],d=c.at(-1);if(null!=a)return{ticks:pp({start:h,stop:d,interval:a,availableRange:this.getPixelRange(),visibleRange:i,extend:s})??up({start:h,stop:d,tickCount:o,minTickCount:r,maxTickCount:l,visibleRange:i,extend:s}),count:void 0};if(n&&2===o)return{ticks:e,count:void 0};if(n&&1===o)return{ticks:e.slice(0,1),count:void 0};const u=ip(h,d,o,r,l,{weekStart:hp});return null!=u?{ticks:Au(u,new Date(h),new Date(d),{visibleRange:i,extend:s}),count:void 0,firstTickIndex:wu(u,new Date(h),new Date(d),{visibleRange:i,extend:s}),timeInterval:u}:void 0}};function up({start:t,stop:e,tickCount:i,minTickCount:s,maxTickCount:n,visibleRange:a,extend:o}){const r=ip(t,e,i,s,n,{weekStart:hp});return r?Au(r,new Date(t),new Date(e),{visibleRange:a,extend:o}):[]}function pp({start:t,stop:e,interval:i,availableRange:s,visibleRange:n,extend:a}){if(!i)return[];if(Y(i)||"string"==typeof i){const o=Au(i,new Date(t),new Date(e),{visibleRange:n,extend:a});if(rp(o.length,s))return;return o}const o=Math.abs(i);if(rp(Math.abs(e-t)/o,s))return;const r=Ku.findLast(t=>o%t.duration===0);if(r){const{timeInterval:i,step:s,duration:l}=r;return Au({...i,step:s*Nu(i)*Math.round(o/l),epoch:ep(i,{weekStart:hp})},new Date(t),new Date(e),{visibleRange:n,extend:a})}let l=new Date(Math.min(t,e));const c=new Date(Math.max(t,e)),h=[];for(;l<=c;)h.push(l),l=new Date(l),l.setMilliseconds(l.getMilliseconds()+o);return h}function gp(t,e,i,s){const{interval:n}=i,a=Math.min(Ou(t),Ou(e)),o=Math.max(Ou(t),Ou(e));let r;if(Y(n)||"string"==typeof n)r=n;else{let t;"number"==typeof n&&(t=(o-a)/Math.max(n,1),rp(t,s)&&(t=void 0)),t??(t=i.tickCount??$c.defaultTickCount),r=ip(a,o,t,i.minTickCount,i.maxTickCount,{weekStart:hp})}if(null==r)return[t,e];const l=Au(r,new Date(a),new Date(o),{extend:!0});if(null==l||l.length<2)return[t,e];const c=l[0],h=l.at(-1);return t<=e?[c,h]:[h,c]}var mp=class t extends _c{constructor(){super(...arguments),this.type="ordinal-time",this.defaultTickCount=$c.defaultTickCount,this._domain=[],this.isReversed=!1}static is(e){return e instanceof t}set domain(t){t!==this._domain&&(this.invalid=!0,this._domain=t,this._bands=void 0,this.isReversed=fp(t))}get domain(){return this._domain}get bands(){return this._bands??(this._bands=this.isReversed?this.domain.slice().reverse():this.domain),this._bands}normalizeDomains(...t){const e=t.filter(t=>t.length>0);if(0===e.length)return{domain:[],animatable:!1};if(1===e.length){let t=e[0];const i=Wu(t);return-1===i?t=t.slice().reverse():null==i&&(t=Uu(t.slice())),{domain:t,animatable:!0}}return{domain:Uu(e.flat()),animatable:!0}}ticks(t,e,i=[0,1],{extend:s=!1,dropInitial:n=!1}={}){const{interval:a,maxTickCount:o,tickCount:r=o}=t,{bands:l}=this;if(!l.length)return;if(this.refresh(),null==a){const{ticks:t,tickOffset:n,tickEvery:a}=this.getDefaultTicks(e,r,i,s);let o=t.length>0?this.findIndex(t[0]):void 0;return o=null==o?void 0:Math.floor((o-n)/a),{ticks:t,count:void 0,firstTickIndex:o}}let c,h;e&&e.length>=2?(c=e[0].valueOf(),h=e.at(-1).valueOf()):(c=l[0].valueOf(),h=l.at(-1).valueOf());const[d,u]=this.range,p=pp({start:c,stop:h,interval:a,availableRange:Math.abs(u-d),visibleRange:i,extend:s})??this.getDefaultTicks(e,r,i,s).ticks,g=[];let m=-1;for(const t of p){const e=this.findIndex(t,1)??-1,i=e===m;m=e,n&&0===e||-1===e||i||g.push(l[e])}return{ticks:g,count:void 0,firstTickIndex:void 0}}stepTicks(t,e,i=[0,1],s=!0){const n=e?this.bandDomainIndices(e):void 0,a=this.ticksEvery(n,i,t,0,!1),o=a.at(-1),r=s&&t>1?n?.[1]:void 0,l=null!=r&&null!=o?this.findIndex(o):void 0;return null!=l&&null!=r&&r-l<t&&a.pop(),a}bandCount(t=[0,1]){const{domain:e}=this,i=Math.floor(t[0]*e.length);return Math.ceil(t[1]*e.length)-i}getDefaultTicks(t,e,i,s){const{bands:n}=this,a=Math.ceil(n.length/e),o=Math.floor(a/2),r=t?this.bandDomainIndices(t):void 0;return{ticks:this.ticksEvery(r,i,a,o,s),tickOffset:o,tickEvery:a}}bandDomainIndices(t){const e=fp(t);return[this.findIndex(t[e?t.length-1:0],1)??0,this.findIndex(t[e?0:t.length-1],1)??this.bands.length-1]}ticksEvery([t,e]=[0,this.bands.length],i,s,n,a){const{bands:o}=this,r=t,l=e-t+1;let c,h=r+Math.floor(i[0]*l),d=r+Math.ceil(i[1]*l);if(a&&(h-=s,d+=s),h=Math.max(h,0),d=Math.min(d,o.length),s<=1)c=o.slice(h,d);else{c=[];for(let t=h;t<d;t+=1)(t-r+n)%s===0&&c.push(o[t])}return c}};function fp(t){return t.length>0&&t[0]>t.at(-1)}var yp=5e7,xp=class t extends _c{constructor(){super(...arguments),this.type="unit-time",this.defaultTickCount=12,this._domain=[],this._bands=void 0}static is(e){return e instanceof t}static supportsInterval(t,e){return bp(t,e)}set domain(t){t!==this._domain&&(this._domain=t,this._bands=void 0)}get domain(){return this._domain}get interval(){return this._interval}set interval(t){this._interval!==t&&(this._interval=t,this._bands=void 0)}get bands(){return this._bands??(this._bands=this.calculateBands(this._domain,[0,1]).bands),this._bands}normalizeDomains(...t){return Hc(...t)}convert(t,e){this.refresh(),t instanceof Date||(t=new Date(t));const{domain:i,interval:s}=this;if(i.length<2)return Number.NaN;if(!0!==e?.clamp&&null!=s){const e=t.valueOf(),[n,a]=vp(i,s),o=Math.min(n.valueOf(),a.valueOf()),r=Math.max(n.valueOf(),a.valueOf()),l=Su(s,new Date(r)).valueOf();if(e<o||e>=l)return Number.NaN}return super.convert(t,e)}calculateBands(t,e,s=!1){if(t===this.domain&&0===e[0]&&1===e[1]&&!s&&null!=this._bands)return{bands:this._bands,firstBandIndex:0};if(t.length<2)return{bands:[],firstBandIndex:void 0};const{interval:n}=this;if(null==n)return{bands:[],firstBandIndex:void 0};const a={visibleRange:e,extend:s};if(!bp(t,n,a))return{bands:[],firstBandIndex:void 0};const[o,r]=vp(t,n);return ku(n,o,r,a)>yp?(i.warnOnce("the configured unit results in too many bands, ignoring. Supply a larger unit."),{bands:[],firstBandIndex:void 0}):{bands:Au(n,o,r,a),firstBandIndex:wu(n,o,r,a)}}ticks({interval:t},e=this.domain,i=[0,1],{extend:s=!1}={}){if(e.length<2)return;let n,a,o;if(e!==this.domain||s?({bands:n,firstBandIndex:a}=this.calculateBands(e,i,s)):(({bands:n}=this.calculateBands(e,[0,1],!1)),o=function(t,e,i){return Bu(t,!1,i)??[0,t.length]}(n,0,i),a=o[0]),null==t)return{ticks:n,count:void 0,firstTickIndex:a};const r=this.interval?Eu(this.interval):1/0,l=Math.min(e[0].valueOf(),e[1].valueOf()),c=Math.max(e[0].valueOf(),e[1].valueOf());let h,d,u;if(Y(t)||"string"==typeof t)h=Au(t,e[0],e[1],{extend:!0,visibleRange:i}),d=0,u=h.length-1;else{const t=o?o[0]:0,e=o?o[1]:n.length-1;h=n,d=xi(t,e,t=>n[t].valueOf()<=l)??t,u=xi(t,e,t=>n[t].valueOf()<=c)??e}const p=[];let g,m,f;for(let t=d;t<=u;t++){const e=h[t].valueOf(),i=xi(0,n.length-1,t=>n[t].valueOf()<=e),s=null!=i&&i!=g?n[i]:void 0;g=i,null!=s&&e-s.getTime()<=r&&p.push(s)}if(this.interval){const t=vp([new Date(l),new Date(c)],this.interval);m=t[0].valueOf(),f=t[1].valueOf()}else m=l,f=c;let y=bi(0,p.length-1,t=>p[t].valueOf()>=m)??0,x=xi(0,p.length-1,t=>p[t].valueOf()<=f)??p.length-1;return s&&(y=Math.max(y-1,0),x=Math.min(x+1,p.length-1)),{ticks:p.slice(y,x+1),count:p.length,firstTickIndex:a}}};function bp(t,e,i){const[s,n]=vp(t,e);return ku(e,s,n,i)<=yp}function vp(t,e){return[bu(e,t[0]),bu(e,t[1])]}function Mp(){const t=new Map;return e=>{const i=t.get(e);return i?(t.set(e,i+1),`${e}_${i}`):(t.set(e,1),e)}}var Sp=[1,2,3,4,6,8,9,10,12];function Ip(t,e=0){const i=[];for(const s of t){const{x:t,y:n,width:a,height:o}=s;if(i.some(i=>mi(i,t,n,a+e,o+e)))return!0;i.push(s)}return!1}function Dp(t,e,i,s){if(null==t)return e;if("number"!=typeof t){const n=e[0];return Au("string"==typeof t?{unit:t,epoch:n}:{...t,epoch:n},e[0],e[1],{visibleRange:i,extend:s})}const n=[],a=e[0].valueOf(),o=e[1].valueOf();for(let e=a;e<=o;e+=t)n.push(new Date(e));return n}function kp(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i+=1)if(t[i]?.valueOf()!==e[i]?.valueOf())return!1;return!0}function Ap(t){if(t.length<2)return 1/0;let e=0,i=t[0].translation;for(let s=1;s<t.length;s++){const n=t[s].translation,a=Math.abs(n-i);e=Math.max(e,a),i=n}return e}function wp(t,{niceDomain:e,rawTicks:i,rawFirstTickIndex:s=0,generatePrimaryTicks:n,primaryTicksIndices:a,alignment:o,fractionDigits:r,timeInterval:l}){const{scale:c,label:h,tickFormatter:d,inRange:u,isVertical:p,sizeLimit:g=1/0}=t,m=dp.is(c)||_c.is(c),f=Xi(h),y=Mp(),x=[];return Cp(c,e,()=>{const t=Wc.is(c)?c.bandwidth??1/0:1/0,b=(c.bandwidth??0)/2,v=function(t,e,i,s,n,a,o){const r=e?"component":"long",l=e&&a?Tu(a):void 0,c=e?o(i,s,!0,n,l,r):null,h=t?o(i,s,!1,n,a,r):null;return(t,e,i)=>{const s=t?c:h;return s?.(e,i)??String(e)}}(h.enabled,n,e,i,r,l,d),M={font:h,maxWidth:p?g:t,maxHeight:p?t:g,overflow:h.truncate?"ellipsis":"hide",textWrap:h.wrapping};for(let t=0;t<i.length;t++){const e=i[t],n=c.convert(e,{alignment:o})+b;if(u&&!u(n))continue;const r=a?.has(t)??!1,l=v(r,e,t);let d=null;h.avoidCollisions&&(d=Ji(l,M)||null);const p=d??l,g=G(p),S=p!==l&&(!g||Yi(p.at(-1)));let I;if(m){const t=e?.valueOf();Number.isFinite(t)&&(I=y(`v:${t}`))}I??(I=y(`l:${g?At(p.flat()):p}`)),x.push({tick:e,tickId:I,tickLabel:p,isPrimary:r,index:t+s,textUntruncated:S?At(l):void 0,textMetrics:g?Qi(p,h):f.measureLines(p),translation:Math.floor(n)})}}),x}function Cp(t,e,i){const s=t.domain;try{t.domain=e,i()}finally{t.domain=s}}function Np(t,e,i,s,n,a,o,r){if(!dp.is(t)&&!_c.is(t))return;const l=Tu(a);if(null==l)return;o&&(e=[1-e[1],1-e[0]]);const c=Math.min(t.domain[0].valueOf(),t.domain.at(-1).valueOf()),h=Math.max(t.domain[0].valueOf(),t.domain.at(-1).valueOf());let[d,u]=Iu(new Date(c),new Date(h),e);d=bu(l,d),d.valueOf()>=c&&(d=Mu(l,d)),u=vu(l,u),u.valueOf()<=h&&(u=Su(l,u));const p=Au(l,d,u),g=Eu(a),m=mp.is(t),f={...n,interval:a},y=[];let x,b,v,M=0;if(mp.is(t)){const n=Cu(a);b=null!=r&&Eu(r)>=Eu(n)?2:3,v=1;const o=i/s,l=t.bandCount(e)/(18*o);M=Sp.findLast(t=>l>=t)??1}else xp.is(t)&&(null==t.interval||Eu(t.interval)>=g)?b=1:(b=0,v=2);for(let e=0;e<p.length-1;e++){const i=p[e],s=p[e+1],n=0===e,a=e===p.length-2,o=s.valueOf()-i.valueOf(),r=[Math.max((c-i.valueOf())/o,0),Math.min((h-i.valueOf())/o,1)];let l;switch(b){case 0:l=Dp(f.interval,[i,s],r,!0);break;case 1:case 3:{const e=t.ticks(f,[i,s],r,{extend:!0,dropInitial:!0});l=e?.ticks??[];break}case 2:l=t.stepTicks(M,[i,s],void 0,!a)}if(ei(l,t=>t.valueOf()<i.valueOf()),a||ii(l,t=>{switch(b){case 0:case 3:return t.valueOf()+g>s.valueOf();case 1:case 2:return t.valueOf()>=s.valueOf()}}),0===l.length)continue;const d=Hu(l[0],i);!(0===b?0===d:d<=g)||m&&n||(x??(x=new Set),x.add(y.length)),y.push(...l)}return 1===x?.size&&x.has(0)&&(x=void 0),{ticks:y,primaryTicksIndices:x,alignment:v}}function Lp(t,e,i,s,n){const a=Op(t.format,s);if(null==a)return{width:0,height:0};const o=xt(a),r=s?Tu(s):void 0,l=Op(e?.format,r),c=l?xt(l):o,h=new Date(i[0]),d=new Date(i.at(-1)),u=r?Au(r,new Date(i[0]),new Date(i.at(-1)),{extend:!0}):void 0;let p=0,g=0;if(null!=o){const e=Ad(t),i=e.left+e.right,a=e.top+e.bottom;let r,l;null!=u&&u.length>1?(r=u[0],l=u[1]):(r=h,l=d);const c=Au(s,r,l,{limit:50});for(const t of c){const e=o(t),{width:s,height:r}=n.measureLines(e);p=Math.max(p,s+i),g=Math.max(g,r+a)}}if(null!=c&&null!=u){const t=Ad(e),i=t.left+t.right,s=t.top+t.bottom;for(const t of u){const e=c(t),{width:a,height:o}=n.measureLines(e);p=Math.max(p,a+i),g=Math.max(g,o+s)}}return{width:Math.ceil(p),height:Math.ceil(g)}}function Tp(t,e,i,s){return t&&!e?i*s===-1?"top":"bottom":"middle"}function Ep(t,e,i,s,n){const a=e>0&&e<=Math.PI,o=i>0&&i<=Math.PI;if(t){if(!e&&!i)return"center";if(s*(a||o?-1:1)==-1)return"end"}else if(s*n===-1)return"end";return"start"}function Op(t,e){if(null!=t)return"string"==typeof t?t:Y(t)&&null!=e?t[Cu(e)]:void 0}function Rp(t,e,i=0){const s=xn(t),n=!s&&i>=0&&i<=Math.PI?-1:1,a=!s&&i-Math.PI/2>=0&&i-Math.PI/2<=Math.PI?-1:1;let o=0;return e?o=n*(Math.PI/2):-1===a&&(o=Math.PI),{configuredRotation:s,defaultRotation:o,parallelFlipFlag:n,regularFlipFlag:a}}var Pp=new Date(1970,0,4);function zp(t){const{label:e,domain:i,axisRotation:s,labelOffset:n,sideFlag:a}=t,{defaultRotation:o,configuredRotation:r,parallelFlipFlag:l,regularFlipFlag:c}=Rp(e.rotation,e.parallel,s),h=r+o,d=(i,s=0)=>{const a=e.minSpacing??(0===r&&0===s?10:0),o=h+s,l=Ad(e);return Ip(function(t,e,i){const{niceDomain:s,ticks:n,timeInterval:a}=e;if(null==a)return[];const o=Ap(n),{label:r,labelOffset:l,primaryLabel:c,domain:h}=t,{width:d,height:u}=Lp(r,c,s??h,a,Xi(r)),p=[];for(const t of[0,o]){const{x:e,y:s}=Xe(l,t,i);p.push({x:e,y:s,width:d,height:u})}return p}(t,i,o),a)||Ip(function(t,e,i,s){const n=[],a=s.left+s.right,o=s.top+s.bottom;for(const{tickLabel:s,textMetrics:r,translation:l}of t){if(!s)continue;const{x:t,y:c}=Xe(e,l,i),h=r.width+a,d=r.height+o;n.push({x:t,y:c,width:h,height:d})}return n}(i.ticks,n,o,l),a)},{maxTickCount:u}=jp(t),p=function(t){return t.interval?.values?2:null!=t.primaryTickCount?1:0}(t),g=e.enabled&&e.avoidCollisions,m=Number.isFinite(u)?u:10,f=g&&e.autoRotate&&null==e.rotation;let y=0,x=0,b=!0,v={tickDomain:[],niceDomain:i,ticks:[],rawTicks:[],rawTickCount:void 0,timeInterval:void 0,fractionDigits:0};for(;b&&y<=m;)({tickData:v,index:y}=Bp(t,p,v,y)),x=f&&d(v,0)?xn(e.autoRotateAngle):0,b=g&&d(v,x);return{tickData:v,textAlign:Ep(e.parallel,r,x,a,c),textBaseline:Tp(e.parallel,r,a,l),rotation:r+x}}function jp({scale:t,domain:e,range:i,visibleRange:s,label:n,defaultTickMinSpacing:a,interval:{minSpacing:o,maxSpacing:r}}){const{defaultTickCount:l}=t,c=Bc(i),h=Bc(s);if(Vu.is(t)){const t=e.length,i=Math.ceil(c/(h*n.fontSize));return{tickCount:Math.min(i,t),minTickCount:0,maxTickCount:t}}return cp(c,h,o,r,l,a)}function Bp(t,e,i,s){const{step:n,values:a}=t.interval,{maxTickCount:o,minTickCount:r,tickCount:l}=jp(t),c=t=>Math.max(l-t,r),h=null==n&&null==a&&c(s)>r,d=i.rawTicks,u=l-r,p={minTickCount:r,maxTickCount:o,tickCount:c(s)};let g=Fp(t,e,p);if(h&&kp(g.rawTicks,d)){let i=s,n=u;for(;i<=n;){s=Math.trunc((i+n)/2),p.tickCount=c(s);const a=Fp(t,e,p);kp(a.rawTicks,d)?i=s+1:(g=a,n=s-1)}}const{tickDomain:m,niceDomain:f,rawTicks:y,rawTickCount:x,rawFirstTickIndex:b,generatePrimaryTicks:v,primaryTicksIndices:M,alignment:S,fractionDigits:I,timeInterval:D}=g;return{tickData:{tickDomain:m,niceDomain:f,rawTicks:y,rawTickCount:x,fractionDigits:I,timeInterval:D,ticks:wp(t,{niceDomain:f,rawTicks:y,rawFirstTickIndex:b,generatePrimaryTicks:v,primaryTicksIndices:M,alignment:S,fractionDigits:I,timeInterval:D})},index:s+1}}function Fp(t,e,i){const{domain:s,reverse:n,visibleRange:a,scale:o,interval:r,primaryLabel:l,niceMode:c,primaryTickCount:h,minimumTimeGranularity:d}=t,u={nice:0===c,interval:r.step,...i},p={...u};let g;p.nice||(p.nice=1===c),1===e&&null!=h&&$c.is(o)&&(g=function(t,e,i,s,n){let[a,o]=jc(e.map(Number));const r=Math.floor(i.unzoomed);if(r<=1){const[e,i]=function(t,e){let i=t,s=e,n=0;do{[i,s]=lp(i,s);const{ticks:t}=qu(i,s,5);if(t.length%2==1)return[i,s];i-=1,s+=1}while(n++<10);return[t,e]}(a,o),r=5*Math.pow(2,-Math.ceil(Math.log2(n[1]-n[0]))),{ticks:l}=qu(e,i,r,void 0,void 0,n),c=[t.toDomain(e),t.toDomain(i)];return s&&c.reverse(),{domain:c,ticks:l}}if(a===o){const t=Math.floor(Math.log10(a)),e=Math.pow(10,t),i=Math.min(e,1),s=r-1;a-=i*Math.floor(s/2),o=a+i*s}let l=a,c=o;l=function(t,e,i){t=Math.floor(t);const s=Math.abs(e-t)/(i-1),n=Math.floor(Math.log10(s)),a=Math.pow(10,n);return Math.floor(t/a)*a}(l,c,r);const h=function(t,e,i){return function(t){const e=Math.floor(Math.log10(t)),i=Math.pow(10,e),s=t/i;return s>0&&s<=1?i:s>1&&s<=2?2*i:s>2&&s<=5?5*i:s>5&&s<=10?10*i:t}((e-t)/(i-1))}(l,c,r);c=l+(r-1)*h;const d=Math.floor(l/h)*h,u=Math.floor(c/h)*h;d<=a&&u>=o&&(l=d,c=u);const p=[t.toDomain(l),t.toDomain(c)];s&&p.reverse();const g=function(t,e,i){const s=E(e),n=Math.pow(10,s),a=[];for(let s=0;s<i;s++){const i=t+e*s;a.push(Math.round(i*n)/n)}return a}(l,h*((i.unzoomed-1)/(i.zoomed-1)),Math.floor(i.zoomed));return{domain:p,ticks:g}}(o,s,h,n,a));const m=0===c?g?.domain??o.niceDomain(u,s):s;let f,y,x,b,v,M,S=m;const I=!0===l?.enabled&&null==p.interval;Cp(o,m,()=>{switch(e){case 2:if(S=r.values,f=r.values,y=f.length,mp.is(o)?M=1:xp.is(o)&&(M=2),$c.is(o)){const[t,e]=jc(m.map(Number));f=f.filter(i=>Number(i)>=t&&Number(i)<=e).sort((t,e)=>Number(t)-Number(e))}break;case 1:if(g)f=g.ticks,y=g.ticks.length;else{const t=o.ticks(p,m,a);f=t?.ticks,y=t?.count}break;default:{const{tickCount:t,minTickCount:e,maxTickCount:s}=i;if(m.length>0&&null==p.interval&&(xp.is(o)||I&&(dp.is(o)||mp.is(o)))){const i=m,n=Math.min(i[0].valueOf(),i.at(-1).valueOf()),a=Math.max(i[0].valueOf(),i.at(-1).valueOf());b=ip(n,a,t,e,s,{weekStart:null==l?Pp:void 0,primaryOnly:!0})}let r;mp.is(o)?r=d:xp.is(o)&&(r=o.interval),null!=r&&null!=b&&Eu(r)>=Eu(b)&&(b=r);const c=b?Np(o,a,t,s,p,b,n,d):void 0;if(c)({ticks:f,primaryTicksIndices:v,alignment:M}=c);else{const t=xp.is(o)&&null==p.interval&&null!=b?{...p,interval:b}:p,e=o.ticks(t,m,a);if(f=e?.ticks,y=e?.count,x=e?.firstTickIndex,dp.is(o)||_c.is(o)){const t="number"==typeof p.interval?Ru(p.interval):p.interval;b??(b=t??e?.timeInterval)}}}}}),f??(f=[]);let D=0;for(const t of f){if("number"!=typeof t)continue;const e=E(t);e>D&&(D=e)}return I||(v=void 0),{tickDomain:S,niceDomain:m,rawTicks:f,rawTickCount:y,rawFirstTickIndex:x,generatePrimaryTicks:I,primaryTicksIndices:v,alignment:M,fractionDigits:D,timeInterval:b}}var Vp=class t extends su{constructor(t,e){let i;super(t,e),this.maxThicknessRatio=.3,this.crossAxisTranslation={x:0,y:0},this.minimumTimeGranularity=void 0,this.headingLabelGroup=this.axisGroup.appendChild(new za({name:`${this.id}-Axis-heading`})),this.lineNodeGroup=this.axisGroup.appendChild(new za({name:`${this.id}-Axis-line`})),this.lineNode=this.lineNodeGroup.appendChild(new md({zIndex:1})),this.tickLineGroupSelection=gd.select(this.tickLineGroup,md,!1),this.gridLineGroupSelection=gd.select(this.gridLineGroup,md,!1),this.gridFillGroupSelection=gd.select(this.gridFillGroup,Uo,!1),this.tempText=new Ko({debugDirty:!1}),this.tempCaption=new sr,this.animationManager=t.animationManager,this.animationState=new Sd("empty",{empty:{update:{target:"ready",action:()=>this.resetSelectionNodes()},reset:"empty"},ready:{update:t=>this.animateReadyUpdate(t),resize:()=>this.resetSelectionNodes(),reset:"empty"}}),this.headingLabelGroup.appendChild(this.title.caption.node),this.cleanup.register(t.eventsHub.on("layout:complete",t=>{const e=[t.chart.width,t.chart.height];null==i||Je(e,i)||this.animationState.transition("resize"),i=e}),this.title.caption.registerInteraction(this.moduleCtx,"afterend"))}static is(e){return e instanceof t}get horizontal(){return"top"===this.position||"bottom"===this.position}onGridVisibilityChange(){this.gridLineGroupSelection.clear(),this.gridFillGroupSelection.clear()}resetAnimation(t){"initial"===t&&this.animationState.transition("reset")}get direction(){return"top"===this.position||"bottom"===this.position?"x":"y"}createAxisContext(){return{...super.createAxisContext(),position:this.position}}createLabel(){return new nu}updateDirection(){switch(this.position){case"top":this.label.mirrored=!0,this.label.parallel=!0;break;case"right":this.label.mirrored=!0,this.label.parallel=!1;break;case"bottom":this.label.mirrored=!1,this.label.parallel=!0;break;case"left":this.label.mirrored=!1,this.label.parallel=!1}this.axisContext&&(this.axisContext.position=this.position,this.axisContext.direction=this.direction)}calculateLayout(t,e){return this.updateDirection(),super.calculateLayout(t,e)}layoutCrossLines(){const t=this.hasDefinedDomain()||this.hasVisibleSeries();for(const e of this.crossLines)e.calculateLayout?.(t)}calculateTickLayout(t,e,i,s){const n=this.label.getSideFlag(),a=n*(this.getTickSize()+this.label.spacing+this.seriesAreaPadding);if(2===e&&!1===this.label.enabled&&!1===this.tick.enabled&&!1===this.gridLine.enabled){const{bbox:e,spacing:i}=this.tickBBox(t,[],[]);return{ticks:[],rawTickCount:0,tickDomain:t,niceDomain:t,fractionDigits:0,timeInterval:void 0,bbox:e,layout:{ticks:[],tickLines:[],gridLines:[],gridFills:[],labels:[],spacing:i}}}const{label:o,primaryLabel:r,scale:l,range:c,interval:h,reverse:d,defaultTickMinSpacing:u,minimumTimeGranularity:p}=this,g=zp({label:o,scale:l,interval:h,primaryLabel:r,domain:t,range:c,reverse:d,niceMode:e,visibleRange:i,defaultTickMinSpacing:u,minimumTimeGranularity:p,sideFlag:n,labelOffset:a,primaryTickCount:s,axisRotation:this.horizontal?-.5*Math.PI:0,isVertical:"y"===this.direction,sizeLimit:this.chartLayout?.sizeLimit,inRange:t=>this.inRange(t,.001),tickFormatter:(...t)=>this.tickFormatter(...t)}),{tickData:m}=g;if(this.label.avoidCollisions&&this.horizontal&&m.ticks.length>2&&($c.is(this.scale)||_c.is(this.scale))){const t=this.chartLayout?.padding.right??0,e=m.ticks.at(-1);null!=e?.tickLabel&&e.translation+e.textMetrics.width/2>c[1]+t&&(e.tickLabel=void 0,0===i[0]&&1===i[1]&&(m.ticks[0].tickLabel=void 0))}const{ticks:f,tickDomain:y,rawTicks:x,rawTickCount:b,fractionDigits:v,timeInterval:M,niceDomain:S}=m,I=f.map(t=>this.getTickLabelProps(t,g)),{position:D,gridPadding:k,gridLength:A}=this,w="bottom"===D||"right"===D?-1:1,C=w*k,N=w*(A+k),L=this.calculateGridLines(f,C,N),T=this.calculateGridFills(f,C,N),E=this.calculateTickLines(f,w),{bbox:O,spacing:R}=this.tickBBox(y,f,I);return{ticks:x,rawTickCount:b,tickDomain:y,niceDomain:S,fractionDigits:v,timeInterval:M,bbox:O,layout:{ticks:f,gridLines:L,gridFills:T,tickLines:E,labels:I,spacing:R}}}calculateGridLines(t,e,i){return t.map((s,n)=>this.calculateGridLine(s,n,e,i,t))}calculateGridLine({index:t,tickId:e,translation:i},s,n,a,o){const{gridLine:r,horizontal:l}=this,[c,h,d,u]=l?[i,n,i,a]:[n,i,a,i],{style:p}=r,{stroke:g,strokeWidth:m=0,lineDash:f}=p[t%p.length]??{};return{tickId:e,offset:i,x1:c,y1:h,x2:d,y2:u,stroke:g,strokeWidth:m,lineDash:f}}calculateGridFills(t,e,i){const{horizontal:s,range:n,type:a}=this,o=[];if(0==t.length)return o;let r=0;const l=!s&&"unit-time"===a;if(l&&t[0].translation<n[0]||!l&&t[0].translation>n[0]){const s={tickId:`before:${t[0].tickId}`,translation:n[0]};o.push(this.calculateGridFill(s,-1,t[0].index,e,i,t)),r=1}return o.push(...t.map((s,n)=>this.calculateGridFill(s,n,s.index+r,e,i,t))),o}calculateGridFill({tickId:t,translation:e},i,s,n,a,o){const{gridLine:r,horizontal:l,range:c}=this,h=o[i+1],d=e,u=h?h.translation:c[1],[p,g,m,f]=l?[d,Math.max(n,a),u,Math.min(n,a)]:[Math.min(n,a),Math.min(d,u),Math.max(n,a),Math.max(d,u)],{fill:y,fillOpacity:x}=r.style[s%r.style.length]??{};return{tickId:t,x1:p,y1:g,x2:m,y2:f,fill:y,fillOpacity:x}}calculateTickLines(t,e){return t.map(i=>this.calculateTickLine(i,i.index,e,t))}calculateTickLine({isPrimary:t,tickId:e,translation:i},s,n,a){const{horizontal:o,tick:r,primaryTick:l}=this,c=t&&l?.enabled?l:r,h=-n*this.getTickSize(c),[d,u,p,g]=o?[i,0,i,h]:[0,i,h,i],{stroke:m,width:f}=c;return{tickId:e,offset:i,x1:d,y1:u,x2:p,y2:g,stroke:m,strokeWidth:f,lineDash:void 0}}update(){this.updateDirection();const t=Array.from(this.tickLabelGroupSelection.nodes(),t=>t.datum.tickId);super.update();const{tickLayout:e}=this;if(this.updateTitle(this.scale.domain,e?.spacing??0),this.animatable||this.moduleCtx.animationManager.skipCurrentBatch(),e){const{ticks:i}=e;if(this.animationManager.isSkipped())this.resetSelectionNodes();else{const e=function(t,e){const i=Math.max(t.length,e.length),s=new Set,n=new Set;for(let a=0;a<i;a++){const i=t[a],o=e[a];i!==o&&(n.has(o)?n.delete(o):o&&s.add(o),s.has(i)?s.delete(i):i&&n.add(i))}return{changed:s.size>0||n.size>0,added:s,removed:n}}(t,i.map(t=>t.tickId));this.animationState.transition("update",e)}}const{enabled:i,stroke:s,width:n}=this.line;this.lineNode.setProperties({stroke:s,strokeWidth:i?n:0}),this.updateTickLines(),this.updateGridLines(),this.updateGridFills()}getAxisTransform(){return{translationX:Math.floor(this.translation.x+this.crossAxisTranslation.x),translationY:Math.floor(this.translation.y+this.crossAxisTranslation.y)}}updatePosition(){super.updatePosition();const t=this.getAxisTransform();this.tickLineGroup.datum=t,this.tickLabelGroup.datum=t,this.lineNodeGroup.datum=t,this.headingLabelGroup.datum=t}setAxisVisible(t){this.tickLineGroup.visible=t&&(this.tick.enabled||(this.primaryTick?.enabled??!1)),this.tickLabelGroup.visible=t&&(this.label.enabled||(this.primaryTick?.enabled??!1)),this.lineNodeGroup.visible=t,this.headingLabelGroup.visible=t}getAxisLineCoordinates(){const{horizontal:t}=this,[e,i]=jc(this.range);return t?{x1:e,x2:i,y1:0,y2:0}:{x1:0,x2:0,y1:e,y2:i}}getTickLineBBox(t){const{translation:e}=t,{position:i,primaryTick:s}=this;let n=this.getTickSize();switch(s?.enabled&&(n=Math.max(n,this.getTickSize(s))),i){case"top":return new fs(e,-n,e,n);case"bottom":return new fs(e,0,e,n);case"left":return new fs(-n,e,n,e);case"right":return new fs(0,e,n,e)}}lineNodeBBox(){const{position:t,seriesAreaPadding:e}=this,{y1:i,y2:s}=this.getAxisLineCoordinates(),n=s-i;switch(t){case"top":return new fs(i,-e,n,e);case"bottom":return new fs(i,0,n,e);case"left":return new fs(-e,i,e,n);case"right":return new fs(0,i,e,n)}}titleBBox(t,e){const{tempCaption:i}=this;return i.node.setProperties(this.titleProps(i,t,e)),i.node.getBBox()}tickBBox(t,e,i){const{tick:s,primaryTick:n,label:a,primaryLabel:o,title:r,position:l,horizontal:c,seriesAreaPadding:h}=this,d=[];if(d.push(this.lineNodeBBox()),s.enabled||n?.enabled)for(const t of e)d.push(this.getTickLineBBox(t));const{tempText:u}=this;if(a.enabled)for(const t of i){if(!t.visible)continue;u.setProperties(t);const e=u.getBBox();e&&d.push(e)}if(o?.enabled&&"bottom"===l){const t=2;if(d.push(new fs(0,Gi(a.fontSize)+t,1,this.getTickSize(s)+a.spacing+h)),null!=o.format){const{format:e}=o,i=(Y(e)?Object.values(e):[e]).reduce((t,e)=>Math.max(t,function(t){let e=1;for(let i=0;i<t.length;i++)10===t.codePointAt(i)&&e++;return e}(e)),0);d.push(new fs(0,this.getTickSize(n??s)+o.spacing+h,1,i*Gi(o.fontSize)+t))}}let p=0;if(r.enabled){const e=fs.merge(d);p=c?e.height:e.width,d.push(this.titleBBox(t,p))}return{bbox:fs.merge(d),spacing:p}}titleProps(t,e,i){const{title:s}=this;if(!s.enabled)return t.enabled=!1,{visible:!1,text:"",textBaseline:"bottom",x:0,y:0,rotationCenterX:0,rotationCenterY:0,rotation:0};t.enabled=!0,t.color=s.color,t.fontFamily=s.fontFamily,t.fontSize=s.fontSize,t.fontStyle=s.fontStyle,t.fontWeight=s.fontWeight,t.wrapping=s.wrapping;const n=(s.spacing??0)+i,{range:a}=this,o=(a[0]+a[1])/2;let r,l,c,h;switch(this.position){case"top":r=o,l=-n,c=0,h="bottom";break;case"bottom":r=o,l=n,c=0,h="top";break;case"left":r=-n,l=o,c=-.5*Math.PI,h="bottom";break;case"right":r=n,l=o,c=.5*Math.PI,h="bottom"}const{formatter:d=t=>t.defaultValue}=s,u=this.cachedCallWithContext(d,this.getTitleFormatterParams(e));return t.text=u,{visible:!0,text:u,textBaseline:h,x:r,y:l,rotationCenterX:r,rotationCenterY:l,rotation:c}}getTickLabelProps(t,e){const{horizontal:i,primaryLabel:s,primaryTick:n,seriesAreaPadding:a,scale:o}=this,{tickId:r,tickLabel:l="",translation:c,isPrimary:h,textUntruncated:d}=t,u=h&&s?.enabled?s:this.label,p=h&&n?.enabled?n:this.tick,{rotation:g,textBaseline:m,textAlign:f}=e,{range:y}=o,x=this.label.getSideFlag(),b=Ad(u)[this.position],v=x*(this.getTickSize(p)+u.spacing+a)-b,M=""!==l,S=i?c:v,I=i?-v:c;return{...this.getLabelStyles({value:t.tick,formattedValue:l},void 0,u),tickId:r,rotation:g,text:l,textAlign:f,textBaseline:m,textUntruncated:d,visible:M,x:S,y:I,rotationCenterX:S,rotationCenterY:I,range:y}}updateSelections(){if(!this.tickLayout)return;const t=this.getAxisLineCoordinates(),{tickLines:e,gridLines:i,gridFills:s,labels:n}=this.tickLayout,a=t=>t.tickId;this.lineNode.datum=t,this.gridLineGroupSelection.update(this.gridLine.enabled?i:[],void 0,a),this.gridFillGroupSelection.update(this.gridLine.enabled?s:[],void 0,a),this.tickLineGroupSelection.update(e,void 0,a),this.tickLabelGroupSelection.update(n,void 0,a)}updateGridLines(){this.gridLineGroupSelection.each((t,e)=>{t.stroke=e.stroke,t.strokeWidth=e.strokeWidth,t.lineDash=e.lineDash})}updateGridFills(){this.gridFillGroupSelection.each((t,e)=>{t.fill=e.fill,t.fillOpacity=e.fillOpacity??1})}updateTickLines(){this.tickLineGroupSelection.each((t,e)=>{t.stroke=e.stroke,t.strokeWidth=e.strokeWidth,t.lineDash=e.lineDash})}updateTitle(t,e){const{caption:i}=this.title,s=this.titleProps(i,t,e);i.node.visible=s.visible,i.node.text=s.text,i.node.textBaseline=s.textBaseline,i.node.datum=s}updateLabels(){this.label.enabled&&this.tickLabelGroupSelection.each((t,e)=>{t.fill=e.color,t.text=e.text,t.textBaseline=e.textBaseline,t.textAlign=e.textAlign??"center",t.pointerEvents=null==e.textUntruncated?1:0,t.setFont(e),t.setBoxing(e)})}animateReadyUpdate(t){const{animationManager:e}=this.moduleCtx,i=Zd(_d(this));cd(this.id,"axis-group",e,[this.lineNodeGroup,this.tickLabelGroup,this.tickLineGroup,this.headingLabelGroup],i.group),cd(this.id,"line",e,[this.lineNode],i.line),cd(this.id,"line-paths",e,[this.gridLineGroupSelection,this.tickLineGroupSelection],i.tick,(t,e)=>e.tickId,t),cd(this.id,"tick-labels",e,[this.tickLabelGroupSelection],i.label,(t,e)=>e.tickId,t),cd(this.id,"title",e,[this.title.caption.node],i.label,(t,e)=>e.tickId,t)}resetSelectionNodes(){pd([this.lineNodeGroup,this.tickLabelGroup,this.tickLineGroup,this.headingLabelGroup],(t,e)=>({translationX:e.translationX,translationY:e.translationY})),pd([this.gridLineGroupSelection,this.tickLineGroupSelection],(t,e)=>{const{x1:i,x2:s,y1:n,y2:a}=e;return{x1:i,x2:s,y1:n,y2:a}}),pd([this.gridFillGroupSelection],(t,e)=>{const{x1:i,x2:s,y1:n,y2:a}=e;return{x:i,y:n,width:s-i,height:a-n}}),pd([this.tickLabelGroupSelection],(t,e)=>({x:e.x,y:e.y,rotationCenterX:e.rotationCenterX,rotationCenterY:e.rotationCenterY,rotation:e.rotation})),pd([this.title.caption.node],(t,e)=>({x:e.x,y:e.y,rotationCenterX:e.rotationCenterX,rotationCenterY:e.rotationCenterY,rotation:e.rotation})),pd([this.lineNode],(t,e)=>{const{x1:i,x2:s,y1:n,y2:a}=e;return{x1:i,x2:s,y1:n,y2:a}})}};ls([ws],Vp.prototype,"thickness",2),ls([ws],Vp.prototype,"maxThicknessRatio",2),ls([ws],Vp.prototype,"position",2),ls([ws],Vp.prototype,"crossAt",2);var Gp=Vp,$p=["top","right","bottom","left"];function Hp(t){return"string"==typeof t&&$p.includes(t)}var Up=["direction","xKey","yKey","sizeKey","angleKey","radiusKey","normalizedTo"];function Wp(t){const{series:e}=t;return e?.[0]?.type??"line"}function _p(t){const e=Wp(t);return td.isCartesian(e)||function(t){const e=Zh(t)?.find(t=>"cartesian"===t);return"cartesian"===e}(e)}function Yp(t){const e=Wp(t);return td.isTopology(e)||function(t){const e=Zh(t)?.find(t=>"topology"===t);return"topology"===e}(e)}function Kp(t){const e=Wp(t);return td.isStandalone(e)||function(t){const e=Zh(t)?.find(t=>"standalone"===t);return"standalone"===e}(e)}var Zp=class extends wd{applyOptions(t){for(const e of this.moduleMap.values())e.module.optionsKey in t&&jn(e.moduleInstance)&&e.moduleInstance.set(t[e.module.optionsKey])}*legends(){for(const{module:t,moduleInstance:e}of this.moduleMap.values())"legend"===t.type&&(yield{legendType:t.identifier,legend:e})}},Xp="ag-charts-overlay",Qp="ag-charts-dark-overlay",qp=class extends Pn{constructor(t,e){super(),this.className=t,this.defaultMessageId=e,this.enabled=!0}getText(t){return G(this.text)?this.text.map(t=>t.text).join(""):t.t(this.text??this.defaultMessageId)}getElement(t,e,i,s){if(this.content?.remove(),this.focusBox=s,this.renderer){const e={},i=Fa(t,this.renderer,e);if(i instanceof HTMLElement)this.content=i;else{const t=j("div");t.innerHTML=i;const{firstElementChild:e}=t;e instanceof HTMLElement&&1===t.childElementCount?this.content=e:this.content=t}}else{const t=j("div",{display:"flex",alignItems:"center",justifyContent:"center",boxSizing:"border-box",height:"100%",margin:"8px",fontFamily:"var(--ag-charts-font-family)",fontSize:"var(--ag-charts-font-size)",fontWeight:"var(--ag-charts-font-weight)"});if(G(this.text)){const e=j("div");for(const t of this.text){const i=j("span",{color:t.color,fontSize:`${t.fontSize}px`,fontFamily:t.fontFamily??"inherit",fontWeight:String(t.fontWeight),fontStyle:t.fontStyle});i.innerText=t.text,e.appendChild(i)}t.appendChild(e)}else t.innerText=this.getText(i);this.content=t,e?.animate({from:0,to:1,id:"overlay",phase:"add",groupId:"opacity",onUpdate(e){t.style.opacity=String(e)},onStop(){t.style.opacity="1"}})}return this.content}removeElement(t=()=>this.content?.remove(),e){if(this.content){if(e){const{content:i}=this;e.animate({from:1,to:0,phase:"remove",id:"overlay",groupId:"opacity",onUpdate(t){i.style.opacity=String(t)},onStop(){t?.()}})}else t?.();this.content=void 0,this.focusBox=void 0}}};ls([ws],qp.prototype,"enabled",2),ls([ws],qp.prototype,"text",2),ls([ws],qp.prototype,"renderer",2);var Jp=class extends Pn{constructor(){super(...arguments),this.darkTheme=!1,this.loading=new qp("ag-charts-loading-overlay","overlayLoadingData"),this.noData=new qp("ag-charts-no-data-overlay","overlayNoData"),this.noVisibleSeries=new qp("ag-charts-no-visible-series","overlayNoVisibleSeries"),this.unsupportedBrowser=new qp("ag-charts-unsupported-browser","overlayUnsupportedBrowser")}getFocusInfo(t){for(const e of[this.loading,this.noData,this.noVisibleSeries,this.unsupportedBrowser])if(void 0!==e.focusBox)return{text:e.getText(t),rect:e.focusBox}}destroy(){this.loading.removeElement(),this.noData.removeElement(),this.noVisibleSeries.removeElement(),this.unsupportedBrowser.removeElement()}};ls([ws],Jp.prototype,"darkTheme",2),ls([ws],Jp.prototype,"loading",2),ls([ws],Jp.prototype,"noData",2),ls([ws],Jp.prototype,"noVisibleSeries",2),ls([ws],Jp.prototype,"unsupportedBrowser",2);var tg=(t=>(t[t.BACKGROUND=0]="BACKGROUND",t[t.ANY_CONTENT=1]="ANY_CONTENT",t))(tg||{}),eg=(t=>(t[t.FOREGROUND=0]="FOREGROUND",t[t.HIGHLIGHT=1]="HIGHLIGHT",t[t.LABEL=2]="LABEL",t))(eg||{});function ig(t,e,i,s){if(pa(t))return{type:"gradient",gradient:t.gradient??e.gradient,colorStops:t.colorStops??e.colorStops,bounds:t.bounds??e.bounds,rotation:t.rotation??e.rotation,reverse:t.reverse??e.reverse,colorSpace:t.colorSpace??e.colorSpace};if(ma(t)){const e=t.pattern??i.pattern;let s=t.strokeWidth;return"backward-slanted-lines"===e||"forward-slanted-lines"===e||"horizontal-lines"===e||"vertical-lines"===e?s??(s=i.strokeWidth):s??(s=0),{type:"pattern",pattern:e,width:t.width??t.height??i.width,height:t.height??t.width??i.height,path:t.path,padding:t.padding??i.padding,fill:t.fill??i.fill,fillOpacity:t.fillOpacity??i.fillOpacity,backgroundFill:t.backgroundFill??i.backgroundFill,backgroundFillOpacity:t.backgroundFillOpacity??i.backgroundFillOpacity,stroke:t.stroke??i.stroke,strokeOpacity:t.strokeOpacity??i.strokeOpacity,strokeWidth:s,rotation:t.rotation??i.rotation,scale:t.scale??i.scale}}return fa(t)?{type:"image",url:t.url,width:t.width,height:t.height,backgroundFill:t.backgroundFill??s.backgroundFill,backgroundFillOpacity:t.backgroundFillOpacity??s.backgroundFillOpacity,rotation:t.rotation??s.rotation,repeat:t.repeat??s.repeat,fit:t.fit??s.fit}:t}function sg(t,e,i,s){return pa(t?.fill)||ma(t?.fill)||fa(t?.fill)?{...t,fill:ig(t.fill,e,i,s)}:t}function ng(t,e,i,s){null!=i&&pa(e)&&null!=e.bounds&&"item"!==e.bounds?t.fillBBox=i[e.bounds]:t.fillBBox=void 0,t.fillParams=s}function ag(t,e,i,s){const n=e?.opacity??1;t.fill=e?.fill,ng(t,t.fill,i,s),t.fillOpacity=(e?.fillOpacity??1)*n,t.stroke=e?.stroke,t.strokeOpacity=(e?.strokeOpacity??1)*n,t.strokeWidth=e?.strokeWidth??0,t.lineDash=e?.lineDash,t.lineDashOffset=e?.lineDashOffset??0}var og=(t=>(t[t.EXACT_SHAPE_MATCH=0]="EXACT_SHAPE_MATCH",t[t.NEAREST_NODE=1]="NEAREST_NODE",t[t.AXIS_ALIGNED=2]="AXIS_ALIGNED",t))(og||{}),rg=class{constructor(t,e,i,s){this.type=t,this.event=e,this.defaultPrevented=!1,this.datum=i.datum,this.seriesId=s.id}preventDefault(){this.defaultPrevented=!0}},lg=class{constructor(t,e){this.series=t,this.seriesGrouping=e,this.type="groupingChanged"}};function cg(t){switch(t){case"x":return"x";case"y":return"y";case"angle":return"angle";case"radius":return"radius"}}function hg(t){switch(t){case"x":return"x";case"y":return"y";case"angle":return"angle";case"radius":return"radius"}}var dg=class extends io{constructor(t){super(),this.cleanup=new Mi,this.usesPlacedLabels=!1,this.hasChangesOnHighlight=!1,this.seriesGrouping=void 0,this.NodeEvent=rg,this.internalId=Oi(this),this.contentGroup=new za({name:`${this.internalId}-content`,zIndex:1}),this.highlightGroup=new za({name:`${this.internalId}-highlight`,zIndex:1}),this.annotationGroup=new za({name:`${this.internalId}-annotation`}),this.labelGroup=new za({name:`${this.internalId}-series-labels`}),this.axes={},this.directions=["x","y"],this.nodeDataRefresh=!0,this.processedDataUpdated=!0,this.moduleMap=new wd,this.datumCallbackCache=new Map,this.connectsToYAxis=!1,this.declarationOrder=-1,this._broughtToFront=!1,this.events=new A,this._pickNodeCache=new w(5),this.fireEventWrapper=t=>super.fireEvent(t);const{moduleCtx:e,pickModes:i,propertyKeys:s={},propertyNames:n={},canHaveAxes:a=!1,usesPlacedLabels:o=!1}=t;this.ctx=e,this.propertyKeys=s,this.propertyNames=n,this.canHaveAxes=a,this.usesPlacedLabels=o,this.pickModes=i,this.cleanup.register(this.ctx?.eventsHub.on("highlight:change",t=>this.onChangeHighlight(t)))}get pickModeAxis(){return"main"}get id(){return this.properties?.id??this.internalId}get type(){return this.constructor.type??""}get focusable(){return!0}get data(){return this._data??this._chartData}set visible(t){this.properties.visible=t,this.ctx.legendManager.toggleItem(t,this.id),this.ctx.legendManager.update(),this.visibleMaybeChanged()}get visible(){return this.ctx.legendManager.getSeriesEnabled(this.id)??this.properties.visible}get hasData(){const t=this.data;return null!=t&&t.netSize()>0}get tooltipEnabled(){return this.properties.tooltip?.enabled}onDataChange(){this.nodeDataRefresh=!0,this.processedDataUpdated=!0,this._pickNodeCache.clear()}setOptionsData(t){this._data=t,this.onDataChange()}setChartData(t){this._chartData=t,this.data===t&&this.onDataChange()}onSeriesGroupingChange(t,e){const{internalId:i,type:s,visible:n}=this;t&&this.ctx.seriesStateManager.deregisterSeries(this),e&&this.ctx.seriesStateManager.registerSeries({internalId:i,type:s,visible:n,seriesGrouping:e}),this.fireEvent(new lg(this,e))}getBandScalePadding(){return{inner:1,outer:0}}attachSeries(t,e,i){t.appendChild(this.contentGroup),e.appendChild(this.highlightGroup),e.appendChild(this.labelGroup),i?.appendChild(this.annotationGroup)}detachSeries(t,e,i){this.contentGroup.remove(),this.highlightGroup.remove(),this.labelGroup.remove(),this.annotationGroup.remove()}setSeriesIndex(t,e=!1){const i=this.bringToFront();return!(!e&&t===this.declarationOrder&&i===this._broughtToFront||(this.declarationOrder=t,this._broughtToFront=i,this.setZIndex(i?Number.MAX_VALUE:t),this.fireEvent(new lg(this,this.seriesGrouping)),0))}setZIndex(t){this.contentGroup.zIndex=[1,t,0],this.highlightGroup.zIndex=[1,t,1],this.labelGroup.zIndex=[1,t,2],this.annotationGroup.zIndex=t}renderToOffscreenCanvas(){return!1}addEventListener(t,e){return super.addEventListener(t,e)}removeEventListener(t,e){return super.removeEventListener(t,e)}hasEventListener(t){return super.hasEventListener(t)}addChartEventListeners(){}updatedDomains(){}destroy(){this.cleanup.flush(),this.resetDatumCallbackCache(),this.ctx.seriesStateManager.deregisterSeries(this)}getPropertyValues(t,e){const i=cg(t),s=null==i?t:hg(this.resolveKeyDirection(i)),n=e?.[s],a=[];if(!n)return a;const o=(...t)=>{for(const e of t)Array.isArray(e)?o(...e):"object"==typeof e?o(...Object.values(e)):a.push(e)};return o(...n.map(t=>this.properties[t])),a}getKeys(t){return this.getPropertyValues(hg(t),this.propertyKeys)}getKeyProperties(t){return this.propertyKeys[this.resolveKeyDirection(t)]??[]}getNames(t){return this.getPropertyValues(hg(t),this.propertyNames)}getFormatterContext(t){const{id:e}=this,i=this.getPropertyValues(t,this.propertyKeys),s=this.getPropertyValues(t,this.propertyNames),n=[];for(let t=0;t<i.length;t++)n.push({seriesId:e,key:i[t],name:s[t]});return n}resolveKeyDirection(t){return t}getDomain(t){const e=this.getSeriesDomain(t),i=this.moduleMap.mapModules(e=>e.getDomain(t)).flat();return 0===i.length?e:e.concat(i)}getRange(t,e){return this.getSeriesRange(t,e)}getZoomRangeFittingItems(t,e,i){}getVisibleItems(t,e,i){return 1/0}markNodeDataDirty(){this.nodeDataRefresh=!0,this._pickNodeCache.clear(),this.visibleMaybeChanged()}visibleMaybeChanged(){this.ctx.seriesStateManager.updateSeries(this)}getOpacity(){const t=1;if(!this.properties.highlight)return t;const{opacity:e=t}=this.getHighlightStyle();return e}getHighlightState(t,e,i,s){if(e)return 1;if(null==t?.series)return 0;if(this.isSeriesHighlighted(t,s)){const e=this.isItemHighlighted(t,i);return null==e||e?2:4}return 3}getHighlightStateString(t,e,i,s){return dc(this.getHighlightState(t,e,i,s))}onChangeHighlight(t){const e=t.previousHighlight,i=t.currentHighlight,s=this.getHighlightState(i),n=this.getHighlightState(e);this.setSeriesIndex(this.declarationOrder);const a=this.hasItemStylers();if(!a&&s===n)return void(this.hasChangesOnHighlight=!1);const{highlightedSeries:o,unhighlightedItem:r,unhighlightedSeries:l}=this.properties.highlight;this.hasChangesOnHighlight=a||!K(o)||!K(r)||!K(l)}bringToFront(){return this.properties.highlight.bringToFront&&this.isSeriesHighlighted(this.ctx.highlightManager.getActiveHighlight())}isSeriesHighlighted(t,e){return t?.series===this}isItemHighlighted(t,e){if(null!=t?.datumIndex&&null!=e)return t.datumIndex===e}getHighlightStyle(t,e,i,s){const n=this.ctx.highlightManager?.getActiveHighlight();return i??(i=this.getHighlightState(n,t,e,s)),this.properties.highlight.getStyle(i)}filterItemStylerFillParams(t){return pa(t)?Vs(t,["bounds","colorSpace","gradient","reverse"]):ma(t)?Vs(t,["padding"]):t}getModuleTooltipParams(){return this.moduleMap.mapModules(t=>t.getTooltipParams()).reduce((t,e)=>Object.assign(t,e),{})}pickNodes(t,e,i=!1){const{pickModes:s,pickModeAxis:n,visible:a,contentGroup:o}=this;if(!a||!o.visible)return;if("highlight"===e&&!this.properties.highlight.enabled)return;if("highlight-tooltip"===e&&!this.properties.highlight.enabled)return;let r=1/0;if("tooltip"===e||"highlight-tooltip"===e){const{tooltip:t}=this.properties;r="number"==typeof t.range?t.range:1/0,i||(i="exact"===t.range)}else if("event"===e||"context-menu"===e){const{nodeClickRange:t}=this.properties;r="number"==typeof t?t:1/0,i||(i="exact"===t)}const l=s.filter(t=>!i||0===t),{x:c,y:h}=t,d=JSON.stringify({x:c,y:h,maxDistance:r,selectedPickModes:l});if(this._pickNodeCache.has(d))return this._pickNodeCache.get(d);for(const e of l){let i;switch(e){case 0:{const e=this.pickNodesExactShape(t);i=0===e.length?void 0:{datums:e,distance:0};break}case 1:{const e=this.pickNodeClosestDatum(t),s=0===e?.distance?this.pickNodesExactShape(t):void 0;i=null!=s&&0!==s.length?{datums:s,distance:0}:e?{datums:[e.datum],distance:e.distance}:void 0;break}case 2:{const e=null==n?void 0:this.pickNodeMainAxisFirst(t,"main-category"===n);i=null==e?void 0:{datums:[e.datum],distance:e.distance};break}}if(i&&i.distance<=r)return this._pickNodeCache.set(d,{pickMode:e,datums:i.datums,distance:i.distance})}return this._pickNodeCache.set(d,void 0)}pickNodesExactShape(t){const e=[];for(const i of this.contentGroup.pickNodes(t.x,t.y)){const t=i.closestDatum();null!=t&&!0!==t.missing&&e.push(t)}return e}pickNodeClosestDatum(t){throw new Error("AG Charts - Series.pickNodeClosestDatum() not implemented")}pickNodeNearestDistantObject(t,e){const i=ps(t.x,t.y,e),s=i.nearest?.closestDatum();if(null!=s&&!0!==s.missing)return{datum:s,distance:Math.sqrt(i.distanceSquared)}}pickNodeMainAxisFirst(t,e){throw new Error("AG Charts - Series.pickNodeMainAxisFirst() not implemented")}getLabelData(){return[]}updatePlacedLabelData(t){}fireEvent(t){Fa([this.properties,this.ctx.chartService],this.fireEventWrapper,t)}fireNodeClickEvent(t,e){const i=new this.NodeEvent("seriesNodeClick",t,e,this);return this.fireEvent(i),!i.defaultPrevented}fireNodeDoubleClickEvent(t,e){const i=new this.NodeEvent("seriesNodeDoubleClick",t,e,this);return this.fireEvent(i),!i.defaultPrevented}createNodeContextMenuActionEvent(t,e){return new this.NodeEvent("nodeContextMenuAction",t,e,this)}onLegendInitialState(t,e){const{visible:i=!0,itemId:s,legendItemName:n}=e??{};this.toggleSeriesItem(i,t,s,n)}onLegendItemClick(t){const{enabled:e,itemId:i,series:s,legendType:n}=t,a="legendItemName"in this.properties?this.properties.legendItemName:void 0,o="legendItemKey"in this.properties?this.properties.legendItemKey:void 0,r=null!=a&&a===t.legendItemName;(s.id===this.id||r||null!=o)&&this.toggleSeriesItem(e,n,i,a,t)}onLegendItemDoubleClick(t){const{enabled:e,itemId:i,series:s,numVisibleItems:n,legendType:a}=t,o="legendItemName"in this.properties?this.properties.legendItemName:void 0,r="legendItemKey"in this.properties?this.properties.legendItemKey:void 0,l=null!=o&&o===t.legendItemName;s.id===this.id||l||null!=r?this.toggleSeriesItem(!0,a,i,o,t):e&&1===n?this.toggleSeriesItem(!0,a,void 0,o):this.toggleSeriesItem(!1,a,void 0,o)}toggleSeriesItem(t,e,i,s,n){const a=this.id;(t||"category"!==e)&&(this.visible=t),this.nodeDataRefresh=!0,this._pickNodeCache.clear();const o={type:"seriesVisibilityChange",seriesId:a,itemId:i,legendItemName:n?.legendItemName??s,visible:t};this.fireEvent(o),this.ctx.legendManager.toggleItem(t,a,i,s)}isEnabled(){return this.visible}getModuleMap(){return this.moduleMap}createModuleContext(){return{...this.ctx,series:this}}getAxisValueText(t,e,i,s,n,a){const{id:o,properties:r}=this;return t.formatDatum(r,i,e,o,a,s,n)}getLabelText(t,e,i,s,n,a,o){if(null==t)return"";const{axes:r,canHaveAxes:l,ctx:c,id:h,properties:d}=this,u="series-label",p="legendItemName"in d?d.legendItemName:void 0,g={seriesId:this.id,...o},m=l?cg(s):void 0,f=null==m?void 0:r[this.resolveKeyDirection(m)];if(null!=f)return f.formatDatum(d,t,u,h,p,e,i,n,a,g);const{formatManager:y}=c,x=this.callWithContext.bind(this),b=e=>a.formatValue(x,e.type,e.value,g)??y.format(x,e)??String(t),v=this.getFormatterContext(s);switch(s){case"y":case"color":case"size":return b({type:"number",value:t,datum:e,seriesId:h,legendItemName:p,key:i,source:u,property:s,domain:n,boundSeries:v,fractionDigits:void 0});case"x":case"radius":case"angle":case"label":case"secondaryLabel":case"calloutLabel":case"sectorLabel":case"legendItem":return b({type:"category",value:t,datum:e,seriesId:h,legendItemName:p,key:i,source:u,property:s,domain:n,boundSeries:v})}}getMarkerStyle(t,{datumIndex:e,datum:i,point:s},n,a,o={size:s?.size??t.size??0},r){const{itemStyler:l}=t,{highlightState:c,isHighlight:h=!1,checkForHighlight:d=!0,resolveMarkerSubPath:u=["marker"],resolveStyler:p=!1}=a??{},g=["series",`${this.declarationOrder}`,...u];if(p){const t={permissivePath:!0},e=this.ctx.optionsGraphService.resolvePartial(g,o,t);e&&(o={...e,size:e.size??o.size})}let m=zs(d?this.getHighlightStyle(h,e,c):void 0,o,t.getStyle(),r);if(l&&n){const t=this.ctx.highlightManager?.getActiveHighlight(),s=this.getHighlightStateString(t,h,e),a=this.filterItemStylerFillParams(m.fill),o=this.cachedCallWithContext(l,{seriesId:this.id,...m,fill:a,...n,highlighted:h,highlightState:s,datum:i});m=zs(this.ctx.optionsGraphService.resolvePartial(g,o),m)}return m}applyMarkerStyle(t,e,i,s,{applyTranslation:n=!0,selected:a=!0}={}){const{shape:o,size:r=0}=t,l=this.visible&&r>0&&i&&!Number.isNaN(i.x)&&!Number.isNaN(i.y);if(ag(e,t,s),n?e.setProperties({visible:l,shape:o,size:r,x:i?.x,y:i?.y,scalingCenterX:i?.x,scalingCenterY:i?.y}):e.setProperties({visible:l,shape:o,size:r}),a||(e.fillOpacity*=.25,e.strokeOpacity*=.125),"function"==typeof o&&!e.dirtyPath){e.path.clear(!0),e.updatePath(),e.checkPathDirty();const s=e.getBBox();if(null!=i&&s.isFinite()){const e=s.computeCenter(),[n,a]=["x","y"].map(s=>(t.strokeWidth??0)+Math.abs(e[s]-i[s]));i.focusSize=Math.max(s.width+n,s.height+a)}}}get nodeDataDependencies(){return this._nodeDataDependencies??{seriesRectWidth:Number.NaN,seriesRectHeight:Number.NaN}}checkResize(t){const{width:e,height:i}=t??{width:Number.NaN,height:Number.NaN},s=t?{seriesRectWidth:e,seriesRectHeight:i}:void 0,n=null!=Ka(this.nodeDataDependencies,s);return n&&(this._nodeDataDependencies=s,this.markNodeDataDirty()),n}pickFocus(t){}resetDatumCallbackCache(){this.datumCallbackCache.clear()}cachedDatumCallback(t,e){const{datumCallbackCache:s}=this,n=s.get(t);if(null!=n)return n;try{const i=e();return s.set(t,i),i}catch(t){i.error(String(t))}}cachedCallWithContext(t,e){return this.ctx.callbackCache.call([this.properties,this.ctx.chartService],t,e)}callWithContext(t,e){return Fa([this.properties,this.ctx.chartService],t,e)}formatTooltipWithContext(t,e,i){return t.formatTooltip([this.properties,this.ctx.chartService],e,i)}minTimeInterval(){}};ls([ro({changeValue:function(t,e){this.onSeriesGroupingChange(e,t)}})],dg.prototype,"seriesGrouping",2);var ug=class{constructor(t){this.swapChain=t,this.hasBeenActivated=!1,this.div=j("div"),this.svg=B("svg"),this.outerPath=B("path"),this.innerPath=B("path"),this.svg.append(this.outerPath),this.svg.append(this.innerPath),this.outerPath.classList.add("ag-charts-focus-svg-outer-path"),this.innerPath.classList.add("ag-charts-focus-svg-inner-path"),this.element=j("div","ag-charts-focus-indicator"),this.element.ariaHidden="true",this.element.append(this.svg),this.swapChain.addListener("swap",t=>this.onSwap(t))}clear(){}update(t,e,i){if(null!=e)if(t instanceof Go){const i=(i,s)=>{let{x:n,y:a}=Ta.toCanvasPoint(t,i,s);return n-=e.x??0,a-=e.y??0,{x:n,y:a}},s=t.svgPathData(i);this.outerPath.setAttribute("d",s),this.innerPath.setAttribute("d",s),this.show(this.svg)}else{let s;if(i){const i=Math.max(t.x-e.x,0),n=Math.max(t.y-e.y,0),a=Math.min(t.x+t.width-e.x,e.width),o=Math.min(t.y+t.height-e.y,e.height);s=new fs(i,n,a-i,o-n)}else s=new fs(t.x-e.x,t.y-e.y,t.width,t.height);Ga(this.div,s),this.show(this.div)}}onSwap(t){t!==this.element.parentElement&&(this.element.remove(),t.appendChild(this.element),this.overrideFocusVisible(this.focusVisible))}show(t){this.hasBeenActivated=!0,this.element.innerHTML="",this.element.append(t)}overrideFocusVisible(t){this.focusVisible=t;const e=this.element.parentElement;e?.style.setProperty("opacity",{true:"1",false:"0",undefined:""}[`${t}`])}isFocusVisible(t=!1){if(!t&&!this.hasBeenActivated)return!1;const e=this.element.parentElement;return null!=e&&"1"===z().getComputedStyle(e).opacity}},pg=class{constructor(t,e,i,s){this.label1=t,this.label2=e,this.hasFocus=!1,this.skipDispatch=!1,this.listeners={blur:[],focus:[],swap:[]},this.onBlur=t=>(gi(t.target,"pointer-events",void 0),!this.skipDispatch&&this.dispatch("blur",t)),this.onFocus=t=>(gi(t.target,"pointer-events","auto"),!this.skipDispatch&&this.dispatch("focus",t)),di(this.label1,"id",Ri()),di(this.label2,"id",Ri()),gi(this.label1,"display","none"),gi(this.label2,"display","none"),this.label1.textContent=s,this.label2.textContent=s,this.activeAnnouncer=this.createAnnouncer(i),this.inactiveAnnouncer=this.createAnnouncer(i),di(this.activeAnnouncer,"tabindex",0),this.label2.insertAdjacentElement("afterend",this.activeAnnouncer),this.label2.insertAdjacentElement("afterend",this.inactiveAnnouncer),this.swap(s)}createAnnouncer(t){const e=j("div");return e.role=t,e.className="ag-charts-swapchain",e.addEventListener("blur",this.onBlur),e.addEventListener("focus",this.onFocus),e}destroy(){for(const t of[this.activeAnnouncer,this.inactiveAnnouncer])t.removeEventListener("blur",this.onBlur),t.removeEventListener("focus",this.onFocus),t.remove()}focus(t){this.focusOptions=t,this.activeAnnouncer.focus(t),this.focusOptions=void 0}update(t){this.skipDispatch=!0,this.swap(t),this.hasFocus&&this.activeAnnouncer.focus(this.focusOptions),this.skipDispatch=!1}addListener(t,e){this.listeners[t].push(e),"swap"===t&&e(this.activeAnnouncer)}dispatch(t,e){"focus"===t?this.hasFocus=!0:"blur"===t&&(this.hasFocus=!1);for(const i of this.listeners[t])i(e)}swap(t){const e=this.activeAnnouncer.tabIndex;this.label2.textContent=t,[this.inactiveAnnouncer,this.activeAnnouncer]=[this.activeAnnouncer,this.inactiveAnnouncer],[this.label1,this.label2]=[this.label2,this.label1],ui(this.inactiveAnnouncer,{"aria-labelledby":this.label1.id,"aria-hidden":!0,tabindex:void 0}),ui(this.activeAnnouncer,{"aria-labelledby":this.label1.id,"aria-hidden":!1,tabindex:e}),this.dispatch("swap",this.activeAnnouncer)}},gg={arrowdown:{bindings:[{code:"ArrowDown"}]},arrowleft:{bindings:[{code:"ArrowLeft"}]},arrowright:{bindings:[{code:"ArrowRight"}]},arrowup:{bindings:[{code:"ArrowUp"}]},delete:{bindings:[{key:"Backspace"},{key:"Delete"}],activatesFocusIndicator:!1},redo:{bindings:[{key:"y",ctrlOrMeta:!0},{key:"z",ctrlOrMeta:!0,shift:!0}],activatesFocusIndicator:!1},undo:{bindings:[{key:"z",ctrlOrMeta:!0}],activatesFocusIndicator:!1},submit:{bindings:[{key:"Enter"},{code:"Enter"},{code:"Space"}]},zoomin:{bindings:[{key:"+"},{code:"ZoomIn"},{code:"Add"}],activatesFocusIndicator:!1},zoomout:{bindings:[{key:"-"},{code:"ZoomOut"},{code:"Substract"}],activatesFocusIndicator:!1}};function mg(t,e){for(const i of e)if("code"in i){if(i.code===t.code)return!0}else if(!(i.key!==t.key||void 0!==i.shift&&i.shift!==t.shiftKey||void 0!==i.ctrlOrMeta&&i.ctrlOrMeta!==t.ctrlKey&&i.ctrlOrMeta!==t.metaKey))return!0;return!1}function fg(t,e,i,s){let{top:n,right:a,bottom:o,left:r,width:l,height:c}=s;return null!=r?null!=l?a=i.width-r+l:null!=a&&(l=i.width-r-a):null!=a&&null!=l&&(r=i.width-a-l),null!=n?null!=c?o=i.height-n-c:null!=o&&(c=i.height-o-n):null!=o&&null!=c&&(n=i.height-o-c),null==l?null==c?(c=e,l=t):l=Math.ceil(t*c/e):c??(c=Math.ceil(e*l/t)),null==r&&(r=null==a?Math.floor((i.width-l)/2):i.width-a-l),null==n&&(n=null==o?Math.floor((i.height-c)/2):i.height-c-o),{x:r,y:n,width:l,height:c}}var yg=class{constructor(){this.events=new A,this.x1=Number.NaN,this.y1=Number.NaN,this.x=Number.NaN,this.y=Number.NaN,this.vx=0,this.vy=0,this.t0=Number.NaN,this.animationFrameHandle=void 0}reset(){this.x=Number.NaN,this.y=Number.NaN,null!=this.animationFrameHandle&&(cancelAnimationFrame(this.animationFrameHandle),this.animationFrameHandle=void 0)}update(t,e){if(Number.isNaN(this.x)||Number.isNaN(this.y))return this.x=t,this.y=e,this.vx=0,this.vy=0,this.emitUpdate(),void(null!=this.animationFrameHandle&&(cancelAnimationFrame(this.animationFrameHandle),this.animationFrameHandle=void 0));this.x1=t,this.y1=e,this.t0=Date.now(),this.animationFrameHandle??(this.animationFrameHandle=requestAnimationFrame(this.onFrame.bind(this)))}onFrame(){this.animationFrameHandle=void 0;const{x1:t,y1:e,t0:i}=this,s=Date.now(),n=s-i;this.t0=s;const a=.001,o=Math.trunc(Math.ceil(n/1));let{x:r,y:l,vx:c,vy:h}=this;for(let i=0;i<o;i+=1)c+=-(200*(r-t)+12*c)/.1*a,h+=-(200*(l-e)+12*h)/.1*a,r+=c*a,l+=h*a;Math.hypot(r-t,l-e)<.5?(this.x=this.x1,this.y=this.y1,this.vx=0,this.vy=0):(this.x=r,this.y=l,this.vx=c,this.vy=h,this.animationFrameHandle=requestAnimationFrame(this.onFrame.bind(this))),this.emitUpdate()}emitUpdate(){this.events.emit("update",{x:this.x,y:this.y})}},xg=null;function bg(t){return""===t?"":(xg??(xg=j("div")),xg.textContent=At(t),xg.innerHTML.replaceAll("\n","<br>"))}function vg(t,e){const{path:i,size:s}=t,{x:n,y:a}=t;i.clear();let o=!1;for(const[t,r]of e){const e=n+(t-.5)*s,l=a+(r-.5)*s;o?i.lineTo(e,l):i.moveTo(e,l),o=!0}i.closePath()}var Mg={circle({path:t,x:e,y:i,size:s}){const n=s/2;t.arc(e,i,n,0,2*Math.PI),t.closePath()},cross(t){vg(t,[[.25,0],[.5,.25],[.75,0],[1,.25],[.75,.5],[1,.75],[.75,1],[.5,.75],[.25,1],[0,.75],[.25,.5],[0,.25]])},diamond(t){vg(t,[[.5,0],[1,.5],[.5,1],[0,.5]])},heart({path:t,x:e,y:i,size:s}){const n=s/4;i+=n/2,t.arc(e-n,i-n,n,pn(130),pn(330)),t.arc(e+n,i-n,n,pn(220),pn(50)),t.lineTo(e,i+n),t.closePath()},pin({path:t,x:e,y:i,size:s}){const n=.5,a=.5;t.moveTo(e+-.34375*s,i+-.15625*s),t.cubicCurveTo(e+-.34375*s,i+-.348509*s,e+-.192259*s,i+-.5*s,e+0*s,i+-.5*s),t.cubicCurveTo(e+(.692259-n)*s,i+-.5*s,e+.34375*s,i+-.348509*s,e+.34375*s,i+-.15625*s),t.cubicCurveTo(e+.34375*s,i+(.493824-a)*s,e+.284625*s,i+(.600181-a)*s,e+(.716461-n)*s,i+(.695393-a)*s),t.cubicCurveTo(e+.199009*s,i+.219769*s,e+(.681271-n)*s,i+.243104*s,e+(.663785-n)*s,i+(.766105-a)*s),t.cubicCurveTo(e+(.611893-n)*s,i+(.834367-a)*s,e+(.562228-n)*s,i+.399699*s,e+(.528896-n)*s,i+(.980648-a)*s),t.cubicCurveTo(e+(.524075-n)*s,i+(.992358-a)*s,e+(.512663-n)*s,i+.5*s,e+0*s,i+.5*s),t.cubicCurveTo(e+(.487337-n)*s,i+.5*s,e+(.475925-n)*s,i+(.992358-a)*s,e+(.471104-n)*s,i+(.980648-a)*s),t.cubicCurveTo(e+(.487337-n)*s,i+.5*s,e+(.475925-n)*s,i+(.992358-a)*s,e+(.471104-n)*s,i+(.980648-a)*s),t.cubicCurveTo(e+(.437772-n)*s,i+.399699*s,e+(.388107-n)*s,i+(.834367-a)*s,e+(.336215-n)*s,i+(.766105-a)*s),t.cubicCurveTo(e+(.318729-n)*s,i+.243104*s,e+-.199009*s,i+.219769*s,e+(.283539-n)*s,i+(.695393-a)*s),t.cubicCurveTo(e+-.284625*s,i+(.600181-a)*s,e+-.34375*s,i+(.493824-a)*s,e+-.34375*s,i+-.15625*s),t.closePath()},plus(t){vg(t,[[1/3,0],[2/3,0],[2/3,1/3],[1,1/3],[1,2/3],[2/3,2/3],[2/3,1],[1/3,1],[1/3,2/3],[0,2/3],[0,1/3],[1/3,1/3]])},square({path:t,x:e,y:i,size:s,pixelRatio:n}){const a=s/2;t.moveTo(la(n,e-a),la(n,i-a)),t.lineTo(la(n,e+a),la(n,i-a)),t.lineTo(la(n,e+a),la(n,i+a)),t.lineTo(la(n,e-a),la(n,i+a)),t.closePath()},star({path:t,x:e,y:i,size:s}){const n=s/2,a=n/2,o=Math.PI/2;for(let s=0;s<10;s++){const r=s%2==0?n:a,l=s*Math.PI/5-o,c=e+Math.cos(l)*r,h=i+Math.sin(l)*r;t.lineTo(c,h)}t.closePath()},triangle(t){vg(t,[[.5,0],[1,.87],[0,.87]])}},Sg=class extends Go{constructor(){super(...arguments),this.shape="square",this.x=0,this.y=0,this.size=12}isPointInPath(t,e){return this.distanceSquared(t,e)<=0}get midPoint(){return{x:this.x,y:this.y}}distanceSquared(t,e){const i=Ig.anchor(this.shape),s=t-this.x+(i.x-.5)*this.size,n=e-this.y+(i.y-.5)*this.size,a=this.size/2;return Math.max(s*s+n*n-a*a,0)}updatePath(){const{path:t,shape:e,x:i,y:s,size:n}=this,a=this.layerManager?.canvas?.pixelRatio??1,o=Ig.anchor(e),r={path:t,x:i-(o.x-.5)*n,y:s-(o.y-.5)*n,size:n,pixelRatio:a};t.clear(),"string"==typeof e?Mg[e](r):"function"==typeof e&&e(r)}computeBBox(){const{x:t,y:e,size:i}=this,s=Ig.anchor(this.shape);return new fs(t-i*s.x,e-i*s.y,i,i)}executeFill(t,e){if(e)return super.executeFill(t,e)}executeStroke(t,e){if(e)return super.executeStroke(t,e)}};ls([qs({equals:Zs})],Sg.prototype,"shape",2),ls([Xs()],Sg.prototype,"x",2),ls([Xs()],Sg.prototype,"y",2),ls([Xs({convertor:Math.abs})],Sg.prototype,"size",2);var Ig=class extends(Aa(Ca(Na(Sg)))){static anchor(t){return"pin"===t?{x:.5,y:1}:"function"==typeof t&&"anchor"in t?t.anchor:{x:.5,y:.5}}constructor(t){super(t),null!=t?.shape&&(this.shape=t.shape)}};function Dg(t,e,i=e*(5/3)){const s=new Oa,n=Math.min(t.marker.strokeWidth??1,2),a=Math.min(t.line?.strokeWidth??0,2),o=Math.max(!1===t.marker.enabled?0:e,null==t.line?0:i),r=Math.max(!1===t.marker.enabled?0:e,a);if(null!=t.line){const{stroke:e,strokeOpacity:i,lineDash:n}=t.line,l=new md;l.x1=0,l.y1=r/2,l.x2=o,l.y2=r/2,l.stroke=e,l.strokeOpacity=i,l.strokeWidth=a,l.lineDash=n,s.append(l)}if(!1!==t.marker.enabled){const{shape:i,fill:a,fillOpacity:l,stroke:c,strokeOpacity:h,lineDash:d,lineDashOffset:u}=t.marker,p=new Ig;p.shape=i??"square",p.size=e,p.fill=a,p.fillOpacity=l??1,p.stroke=c,p.strokeOpacity=h??1,p.strokeWidth=n,p.lineDash=d,p.lineDashOffset=u??0;const g=Ig.anchor(i),m=o/2+(g.x-.5)*e,f=r/2+(g.y-.5)*e,y=e/(e+n);p.x=m,p.y=f,p.scalingCenterX=m,p.scalingCenterY=f,p.scalingX=y,p.scalingY=y,s.append(p)}return Oa.toSVG(s,o,r)}var kg="ag-charts-tooltip",Ag="ag-charts-tooltip--dark";function wg(t){const e=[],i=new Map;for(const s of t)if("structured"===s.type){const{heading:t}=s,n=null==t?void 0:i.get(t),a={type:"structured",heading:t,items:[s]};null==n?(i.set(t,a),e.push(a)):n.items.push(s)}else e.push(s);return e}function Cg(t){const e=wg(t),i=[];for(const t of e)if("raw"!==t.type){null!=t.heading&&i.push(At(t.heading));for(const e of t.items)if(null!=e.title&&i.push(At(e.title)),e.data)for(const t of e.data)i.push(t.label??t.fallbackLabel,t.value)}return i.filter(t=>""!==t).join("; ")}function Ng(t,e,i){let s="";if(null==t&&!e)return"";null==t?s+=`<span class="${kg}-label">${bg(e)}</span>`:(s+=`<span class="${kg}-label">${bg(t)}</span>`,s+=" ",s+=`<span class="${kg}-value">${bg(e)}</span>`);const n=[`${kg}-row`];return i&&n.push(`${kg}-row--inline`),s=`<div class="${n.join(" ")}">${s}</div>`,s}function Lg(t){let e="";if(t.data?.length&&t.data.every(t=>null==t.value||""===t.value))return e;const i=null==t.title&&1===t.data?.length,s=null==t.symbol?void 0:Dg(t.symbol,12);if(null==s||null==t.title&&!t.data?.length||(e+=`<span class="${kg}-symbol">${s}</span>`),null!=t.title&&(e+=`<span class="${kg}-title">${bg(t.title)}</span>`,e+=" "),t.data)for(const s of t.data)e+=Ng(s.label??s.fallbackLabel,s.value,i),e+=" ";return e}function Tg(t,e){if(null==t||1===e.length)return;const i=t?.t("tooltipPaginationStatus",{index:e.index+1,count:e.length});return`<div class="${kg}-footer">${i}</div>`}function Eg(t,e,i,s){const n=1===e.items.length?e.items[0]:void 0;let a,o,r;switch(i){case"compact":a=!0,o=At(n?.title);break;case"single":a=null!=n&&(null==e.heading||null==n.title)&&1===n.data?.length&&null==n.data[0].label&&null!=n.data[0].value,r=At(e.heading??n?.title);break;case"shared":a=!1}let l="";if(a&&null!=n){if(null!=o&&(l+=Ng(void 0,o,!1)),n.data)for(const t of n.data)l+=Ng(t.label??r,t.value,!1),l+=" "}else{null!=e.heading&&(l+=`<span class="${kg}-heading">${bg(At(e.heading))}</span>`,l+=" ");for(const t of e.items)l+=Lg(t)}if(0===l.length)return;const c="compact"!==i&&null!=s?Tg(t,s):void 0;return c+null&&(l+=c),l=`<div class="${kg}-content">${l.trimEnd()}</div>`,l}function Og(t,e,i,s){const n=wg(e);if(0!==n.length){if(1===n.length&&"structured"===n[0].type)return Eg(t,n[0],i,s);{const e=n.map(e=>"structured"===e.type?Eg(t,e,i):e.rawHtmlString);return null!=s&&e.push(function(t,e){const i=null==e?void 0:Tg(t,e);return null==i?"":`<div class="${kg}-content">${i}</div>`}(t,s)??""),e.join("")}}}var Rg={left:-1,"top-left":-1,"bottom-left":-1,top:0,center:0,bottom:0,right:1,"top-right":1,"bottom-right":1},Pg={"top-left":-1,top:-1,"top-right":-1,left:0,center:0,right:0,"bottom-left":1,bottom:1,"bottom-right":1},zg={left:3,"top-left":void 0,"bottom-left":void 0,top:2,center:void 0,bottom:1,right:0,"top-right":void 0,"bottom-right":void 0},jg={top:2,bottom:2,left:1,right:1,"top-right":3,"top-left":3,"bottom-right":3,"bottom-left":3,center:0},Bg={pointer:"top",node:"top",chart:"top-left"},Fg=class extends Pn{constructor(){super(...arguments),this.xOffset=0,this.yOffset=0}};ls([ws],Fg.prototype,"xOffset",2),ls([ws],Fg.prototype,"yOffset",2),ls([ws],Fg.prototype,"anchorTo",2),ls([ws],Fg.prototype,"placement",2);var Vg=class extends Pn{constructor(){super(),this.enabled=!0,this.mode="single",this.delay=0,this.range=void 0,this.wrapping="hyphenate",this.position=new Fg,this.pagination=!1,this.darkTheme=!1,this.bounds="extended",this.cleanup=new Mi,this.springAnimation=new yg,this.enableInteraction=!1,this.wrapTypes=["always","hyphenate","on-space","never"],this.sizeMonitor=new Tr,this._elementSize=void 0,this._showTimeout=void 0,this.arrowPosition=void 0,this._visible=!1,this.positionParams=void 0,this.localeManager=void 0,this.cleanup.register(this.springAnimation.events.on("update",this.updateTooltipPosition.bind(this)))}get interactive(){return this.enableInteraction}setup(t,e){return"togglePopover"in z().HTMLElement.prototype&&(this.element=e.addChild("tooltip-container",kg),this.element.setAttribute("popover","manual"),this.element.className=kg,this.element.style.positionAnchor=e.anchorName,this.sizeMonitor.observe(this.element,t=>{this._elementSize=t,this.updateTooltipPosition()})),this.localeManager=t,()=>{e.removeChild("tooltip-container",kg),this.cleanup.flush(),this.element&&this.sizeMonitor.unobserve(this.element)}}isVisible(){return this._visible}contains(t){return this.element?.contains(t)??!1}updateTooltipPosition(){const{element:t,_elementSize:e,positionParams:i}=this;if(null==t||null==e||null==i)return;const{canvasRect:s,relativeRect:n,meta:a}=i,{x:o,y:r}=this.springAnimation,l=a.position?.anchorTo??"pointer";let c=a.position?.placement??Bg[l];Array.isArray(c)||(c=[c]);const h=a.position?.xOffset??0,d=a.position?.yOffset??0,u=n.x,p=n.y,g=n.width-e.width-1+u,m=n.height-e.height+p;let f,y,x=0,b=!1;do{f=c[x],x+=1;const t=this.getTooltipBounds({elementSize:e,placement:f,anchorTo:l,canvasX:o,canvasY:r,yOffset:d,xOffset:h,canvasRect:s});y=fg(e.width,e.height,n,t),b=!1,1&jg[f]&&(b||(b=y.x<u||y.x>g)),2&jg[f]&&(b||(b=y.y<p||y.y>m))}while(x<c.length&&b);const v=C(u,y.x,g),M=C(p,y.y,m);b||(b=v!==y.x||M!==y.y);const S="chart"!==l&&!b&&!h&&!d,I=a.showArrow??this.showArrow??S;this.arrowPosition=I?zg[f]:void 0,this.updateClassModifiers(),t.style.translate=`${v}px ${M}px`}show(t,e,i,s,n,a=!1){const{element:o}=this;if(null!=o&&null!=s&&0!==s.length){const t=Og(this.localeManager,s,this.mode,this.pagination?n:void 0);if(null==t)return void this.toggle(!1);o.innerHTML=t}else if(null==o||""===o.innerHTML)return void this.toggle(!1);const r={x:t.x-e.x,y:t.y-e.y,width:t.width,height:t.height};switch(this.positionParams={canvasRect:e,relativeRect:r,meta:i},i.position?.anchorTo??"pointer"){case"node":this.springAnimation.update(i.nodeCanvasX??i.canvasX,i.nodeCanvasY??i.canvasY);break;case"pointer":this.springAnimation.update(i.canvasX,i.canvasY);break;case"chart":this.springAnimation.reset()}i.enableInteraction?(this.enableInteraction=!0,o.style.pointerEvents="auto",o.removeAttribute("aria-hidden"),o.tabIndex=-1):(this.enableInteraction=!1,o.style.pointerEvents="none",o.setAttribute("aria-hidden","true"),o.removeAttribute("tabindex")),o.style.setProperty("--top",`${e.top}px`),o.style.setProperty("--left",`${e.left}px`),this.updateClassModifiers(),this.toggle(!0,a)}hide(){this.toggle(!1)}maybeEnterInteractiveTooltip({relatedTarget:t},e){const{interactive:i,interactiveLeave:s,enabled:n,element:a}=this;if(null==a)return!1;if(s)return!0;const o=i&&n&&this.isVisible()&&t instanceof Node&&this.contains(t);return o&&(this.interactiveLeave={callback:e,listener:t=>{(null==t.relatedTarget||t.relatedTarget instanceof Node&&!this.contains(t.relatedTarget))&&this.popInteractiveLeaveCallback()}},a.addEventListener("focusout",this.interactiveLeave.listener),a.addEventListener("mouseout",this.interactiveLeave.listener)),o}popInteractiveLeaveCallback(){const{interactiveLeave:t,element:e}=this;this.interactiveLeave=void 0,t&&(e&&(e.removeEventListener("focusout",t.listener),e.removeEventListener("mouseout",t.listener)),t.callback())}toggle(t,e=!1){const{delay:i}=this;t&&i>0&&!e?this._showTimeout??(this._showTimeout=setTimeout(()=>{this._showTimeout=void 0,this.toggleCallback(!0)},i)):(clearTimeout(this._showTimeout),this._showTimeout=void 0,this.toggleCallback(t))}toggleCallback(t){this.element?.isConnected&&this._visible!==t&&(this._visible=t,this.element.togglePopover(t),t?this.updateTooltipPosition():(this.springAnimation.reset(),this.popInteractiveLeaveCallback()))}updateClassModifiers(){if(!this.element?.isConnected)return;const{classList:t}=this.element,e=(e,i)=>t.toggle(`${kg}--${e}`,i);e("no-interaction",!this.enableInteraction),e("arrow-top",1===this.arrowPosition),e("arrow-right",3===this.arrowPosition),e("arrow-bottom",2===this.arrowPosition),e("arrow-left",0===this.arrowPosition),e("compact","compact"===this.mode),t.toggle(Ag,this.darkTheme);for(const e of this.wrapTypes)t.toggle(`${kg}--wrap-${e}`,e===this.wrapping)}getTooltipBounds(t){const{elementSize:e,anchorTo:i,placement:s,canvasX:n,canvasY:a,yOffset:o,xOffset:r,canvasRect:l}=t,{width:c,height:h}=e,d={width:c,height:h};if("node"===i||"pointer"===i){const t=Rg[s],e=Pg[s];return d.top=a+o+h*(e-1)/2+8*e,d.left=n+r+c*(t-1)/2+8*t,d}switch(s){case"top":return d.top=o,d.left=l.width/2-c/2+r,d;case"right":return d.top=l.height/2-h/2+o,d.left=l.width-c+r,d;case"left":return d.top=l.height/2-h/2+o,d.left=r,d;case"bottom":return d.top=l.height-h+o,d.left=l.width/2-c/2+r,d;case"top-left":return d.top=o,d.left=r,d;case"top-right":return d.top=o,d.left=l.width-c+r,d;case"bottom-right":return d.top=l.height-h+o,d.left=l.width-c+r,d;case"bottom-left":return d.top=l.height-h+o,d.left=r,d}return d}};function Gg(t,e){return t.series===e.series&&Rs(t.datumIndex,e.datumIndex)}ls([ws],Vg.prototype,"enabled",2),ls([ws],Vg.prototype,"mode",2),ls([ws],Vg.prototype,"showArrow",2),ls([ws],Vg.prototype,"delay",2),ls([ws],Vg.prototype,"range",2),ls([ws],Vg.prototype,"wrapping",2),ls([ws],Vg.prototype,"position",2),ls([ws],Vg.prototype,"pagination",2),ls([ws],Vg.prototype,"darkTheme",2),ls([ws],Vg.prototype,"bounds",2);var $g=class{constructor(){this.candidates=[]}get current(){return this.active}reset(){this.candidates.length=0,this.active=void 0}update(t,e){this.candidates=t;let i=null==e?-1:t.findIndex(t=>Gg(t,e));return-1===i&&(i=0),this.active=t[i],{current:this.active,index:i,length:t.length}}next(){const{candidates:t,active:e}=this,i=null==e?-1:t.findIndex(t=>Gg(t,e));if(-1===i)return;let s=i+1;return s>=t.length&&(s=0),this.active=t[s],{current:this.active,index:s,length:this.candidates.length}}},Hg=class extends gr{constructor(t){super(),this.chart=t,this.id=Oi(this),this.series=[],this.announceMode="when-changed",this.highlight={pendingHoverEvent:void 0,appliedHoverEvent:void 0,stashedHoverEvent:void 0},this.tooltip={lastHover:void 0},this.hoverDevice="pointer",this.previousInputDevice="keyboard",this.focus={sortedSeries:[],series:void 0,seriesIndex:0,datumIndex:0,datum:void 0},this.cachedTooltipContent=void 0,this.hoverScheduler=co((t,e)=>z().requestAnimationFrame(t),()=>{(this.tooltip.lastHover||this.highlight.pendingHoverEvent)&&(this.chart.getUpdateType()<=5?this.hoverScheduler.schedule():(this.highlight.pendingHoverEvent&&this.handleHoverHighlight(!1),this.tooltip.lastHover&&this.handleHoverTooltip(this.tooltip.lastHover,!1)))}),this.tooltipCandidates=new $g;const e=t.ctx.localeManager.t("ariaInitSeriesArea"),i=t.ctx.domManager.addChild("series-area","series-area-aria-label1"),s=t.ctx.domManager.addChild("series-area","series-area-aria-label2");this.swapChain=new pg(i,s,"img",e),this.swapChain.addListener("blur",t=>this.onBlur(t)),this.swapChain.addListener("focus",()=>this.onFocus()),"normal"===t.ctx.domManager.mode&&(this.focusIndicator=new ug(this.swapChain),this.focusIndicator.overrideFocusVisible("integrated"!==t.mode&&void 0));const{seriesDragInterpreter:n,seriesWidget:a,containerWidget:o}=t.ctx.widgets;a.setTabIndex(-1),this.cleanup.register(()=>t.ctx.domManager.removeChild("series-area","series-area-aria-label1"),()=>t.ctx.domManager.removeChild("series-area","series-area-aria-label2"),a.addListener("focus",()=>this.swapChain.focus({preventScroll:!0})),a.addListener("mousemove",t=>this.onHover(t,a)),a.addListener("wheel",t=>this.onWheel(t)),a.addListener("mouseleave",t=>this.onLeave(t)),a.addListener("keydown",t=>this.onKeyDown(t)),a.addListener("contextmenu",(t,e)=>this.onContextMenu(t,e)),o.addListener("contextmenu",(t,e)=>this.onContextMenu(t,e)),o.addListener("click",(t,e)=>this.onClick(t,e)),o.addListener("dblclick",(t,e)=>this.onClick(t,e)),t.ctx.animationManager.addListener("animation-start",()=>this.clearAll()),t.ctx.eventsHub.on("dom:resize",()=>this.clearAll()),t.ctx.eventsHub.on("highlight:change",t=>this.changeHighlightDatum(t)),t.ctx.eventsHub.on("layout:complete",t=>this.layoutComplete(t)),t.ctx.updateService.addListener("pre-scene-render",()=>this.preSceneRender()),t.ctx.updateService.addListener("update-complete",()=>this.updateComplete()),t.ctx.eventsHub.on("zoom:change",()=>this.clearAll()),t.ctx.eventsHub.on("zoom:pan-start",()=>this.clearAll())),n&&this.cleanup.register(n.events.on("drag-move",t=>this.onDragMove(t,a)),n.events.on("click",t=>this.onClick(t,a)),n.events.on("dblclick",t=>this.onClick(t,a)))}get bbox(){return(this.seriesRect??fs.zero).clone()}isState(t){return this.chart.ctx.interactionManager.isState(t)}isIgnoredTouch(t){return"touch"===t.device&&"click"!==t.type&&"hover"!==this.chart.ctx.chartService.touch.dragAction&&("drag"!==this.chart.ctx.chartService.touch.dragAction||!this.isState(9))}dataChanged(){var t;this.cachedTooltipContent=void 0,this.highlight.appliedHoverEvent&&((t=this.highlight).stashedHoverEvent??(t.stashedHoverEvent=this.highlight.appliedHoverEvent),this.clearHighlight()),this.chart.ctx.tooltipManager.removeTooltip(this.id),this.focusIndicator?.clear()}preSceneRender(){null!=this.highlight.stashedHoverEvent&&(this.highlight.pendingHoverEvent=this.highlight.stashedHoverEvent,this.highlight.stashedHoverEvent=void 0,this.handleHoverHighlight(!0)),null!=this.tooltip.lastHover&&this.handleHoverTooltip(this.tooltip.lastHover,!0)}updateComplete(){this.isState(34)&&this.focusIndicator?.isFocusVisible()&&("always"!==this.announceMode&&(this.announceMode="never"),this.handleFocus(0,0))}update(t,e){this.chart.ctx.updateService.update(t,e)}seriesChanged(t){this.focus.sortedSeries=[...t].sort((t,e)=>{let i=t.properties.focusPriority??1/0,s=e.properties.focusPriority??1/0;return i===s&&([i,s]=[t.declarationOrder,e.declarationOrder]),i<s?-1:i>s?1:0}),this.series=t}layoutComplete(t){this.seriesRect=t.series.rect,this.hoverRect=t.series.rect,this.chart.ctx.widgets.seriesWidget.setBounds(t.series.rect),"normal"===this.chart.ctx.domManager.mode&&this.chart.ctx.widgets.chartWidget.setBounds(t.chart)}onContextMenu(t,e){const{sourceEvent:i}=t;if(i.currentTarget!=e.getElement())return;if(i.target==this.chart.ctx.widgets.containerWidget.getElement()){if(this.isState(36)){const{currentX:e,currentY:i}=t;this.chart.ctx.contextMenuRegistry.dispatchContext("always",{widgetEvent:t,canvasX:e,canvasY:i},void 0)}return}let s,n;if(this.focusIndicator?.isFocusVisible())s=this.chart.ctx.highlightManager.getActiveHighlight(),s&&this.seriesRect&&s.midPoint&&(n=Ta.toCanvasPoint(s.series.contentGroup,s.midPoint.x,s.midPoint.y));else if(this.isState(36)){const e=this.pickNodes({x:t.currentX,y:t.currentY},"context-menu");e&&(this.chart.ctx.highlightManager.updateHighlight(this.id),s=e.matches[0].datum)}const a=s?.series;this.clearAll();const o=t.currentX+e.cssLeft(),r=t.currentY+e.cssTop(),{datumIndex:l}=s??{};a&&s&&null!=l?this.chart.ctx.contextMenuRegistry.dispatchContext("series-node",{widgetEvent:t,canvasX:o,canvasY:r},{pickedSeries:a,pickedNode:{...s,datumIndex:l}},n):this.chart.ctx.contextMenuRegistry.dispatchContext("series-area",{widgetEvent:t,canvasX:o,canvasY:r},void 0,n)}onLeave(t){if(!this.isState(41))return;const e=t.sourceEvent.relatedTarget;"ag-charts-text-input__textarea"!==e?.className&&(this.maybeEnterInteractiveTooltip(t.sourceEvent)||(this.chart.ctx.domManager.updateCursor(this.id),"keyboard"!==this.hoverDevice&&this.clearAll()))}onWheel(t){this.isState(41)&&(this.focusIndicator?.overrideFocusVisible(!1),this.previousInputDevice="pointer")}onDragMove(t,e){this.isState(41)&&(this.focusIndicator?.overrideFocusVisible(!1),this.onHoverLikeEvent(t,e))}onHover(t,e){this.isState(41)&&this.onHoverLikeEvent(t,e)}onHoverLikeEvent(t,e){if(this.isIgnoredTouch(t))return;if("touch"===t.device&&"hover"===this.chart.ctx.chartService.touch.dragAction&&t.sourceEvent.preventDefault(),e!==this.chart.ctx.widgets.seriesWidget)return;let i;if("touch"!==t.device&&"drag-move"===t.type||(this.tooltip.lastHover=t),this.hoverDevice="pointer",this.previousInputDevice="pointer",this.highlight.pendingHoverEvent=t,this.hoverScheduler.schedule(),this.isState(32)){const{currentX:e,currentY:s}=t;i=this.pickNodes({x:e,y:s},"event");const n=i?.matches,a=n?.[0];a?.series.hasEventListener("seriesNodeClick")||a?.series.hasEventListener("seriesNodeDoubleClick")||null!=n&&n.length>1&&this.chart.tooltip.pagination?this.chart.ctx.domManager.updateCursor(this.id,"pointer"):this.chart.ctx.domManager.updateCursor(this.id)}const s=Boolean(i?.matches.length);this.emitSeriesAreaHoverEvent(t,s)}onClick(t,e){if("keyboard"===t.device)return;if(e===this.chart.ctx.widgets.seriesWidget&&this.chart.ctx.animationManager.isActive()&&this.chart.ctx.animationManager.skipCurrentBatch(),"touch"===t.device&&e===this.chart.ctx.widgets.seriesWidget&&this.swapChain.focus({preventScroll:!0}),!this.isState(41))return;if(e===this.chart.ctx.widgets.seriesWidget){if(!e.getElement().contains(t.sourceEvent.target))return}else if(t.sourceEvent.target!=e.getElement())return;this.focusIndicator?.overrideFocusVisible(!1),this.onHoverLikeEvent(t,e);const i=e===this.chart.ctx.widgets.seriesWidget;if(!this.isState(32))return void(i&&this.emitSeriesAreaClickEvent(t,!1));if(i){if(Boolean(this.checkSeriesNodeClick(t)))return this.emitSeriesAreaClickEvent(t,!0),this.update(5),void t.sourceEvent.preventDefault();this.emitSeriesAreaClickEvent(t,!1)}const s={type:"click"===t.type?"click":"doubleClick",event:t.sourceEvent};this.chart.fireEvent(s)}emitSeriesAreaHoverEvent(t,e){const i=this.toCanvasCoordinates(t.currentX,t.currentY);if(null==i)return;const s={x:i.x,y:i.y,consumed:e,sourceEvent:t.sourceEvent};this.chart.ctx.eventsHub.emit("series-area:hover",s)}emitSeriesAreaClickEvent(t,e){if(!("currentX"in t))return;const i=this.toCanvasCoordinates(t.currentX,t.currentY);if(null==i)return;const s={x:i.x,y:i.y,consumed:e,sourceEvent:t.sourceEvent};this.chart.ctx.eventsHub.emit("series-area:click",s)}toCanvasCoordinates(t,e){return{x:t+(this.hoverRect?.x??this.seriesRect?.x??0),y:e+(this.hoverRect?.y??this.seriesRect?.y??0)}}onFocus(){this.isState(34)&&(this.hoverDevice=this.focusIndicator?.isFocusVisible(!0)?"keyboard":"pointer",this.handleFocus(0,0))}onBlur(t){this.isState(34)&&(this.hoverDevice="pointer",this.maybeEnterInteractiveTooltip(t)||this.clearAll(),this.focusIndicator?.overrideFocusVisible(void 0))}onKeyDown(t){if(!this.isState(43))return;const e=function(t){for(const[e,{activatesFocusIndicator:i=!0,bindings:s}]of ri(gg))if(mg(t,s))return{name:e,activatesFocusIndicator:i}}(t.sourceEvent);switch(!1===e?.activatesFocusIndicator&&this.focusIndicator?.overrideFocusVisible("keyboard"===this.previousInputDevice),e?.name){case"redo":return this.chart.ctx.eventsHub.emit("series:redo",null);case"undo":return this.chart.ctx.eventsHub.emit("series:undo",null);case"zoomin":return this.chart.ctx.eventsHub.emit("series:keynav-zoom",{delta:1,widgetEvent:t});case"zoomout":return this.chart.ctx.eventsHub.emit("series:keynav-zoom",{delta:-1,widgetEvent:t});case"arrowup":return this.onArrow(-1,0,t);case"arrowdown":return this.onArrow(1,0,t);case"arrowleft":return this.onArrow(0,-1,t);case"arrowright":return this.onArrow(0,1,t);case"submit":return this.onSubmit(t)}}onArrow(t,e,i){this.isState(34)&&(this.hoverDevice="keyboard",this.previousInputDevice="keyboard",this.focusIndicator?.overrideFocusVisible(!0),this.focus.seriesIndex+=t,this.focus.datumIndex+=e,this.handleFocus(t,e),i.sourceEvent.preventDefault(),this.chart.ctx.eventsHub.emit("series:focus-change",null))}onSubmit(t){if(!this.isState(34))return;const{series:e,datum:i}=this.focus,s=t.sourceEvent;null!=e&&null!=i?e.fireNodeClickEvent(s,i):this.chart.fireEvent({type:"click",event:s}),s.preventDefault()}checkSeriesNodeClick(t){var e;const i=this.pickNodes({x:t.currentX,y:t.currentY},"event");if(null==i||0===i.matches.length)return;const s=this.chart.tooltip.pagination?this.tooltipCandidates.update(i.matches,this.tooltipCandidates.current)?.current:void 0,{series:n,datum:a}=s??i.matches[0],o=null==s?i.distance:0;if("click"===t.type){const i=n.fireNodeClickEvent(t.sourceEvent,a)&&this.chart.tooltip.pagination?this.tooltipCandidates.next():void 0;if(null!=i){t.sourceEvent.preventDefault();const{currentX:s,currentY:n}=t,a=s+(this.hoverRect?.x??0),o=n+(this.hoverRect?.y??0);(e=this.highlight).pendingHoverEvent??(e.pendingHoverEvent=this.highlight.appliedHoverEvent),this.handleHoverHighlight(!1),this.showTooltip(i.current,a,o,{index:i.index,length:i.length})}return!0}return"dblclick"===t.type&&(t.preventZoomDblClick=0===o,n.fireNodeDoubleClickEvent(t.sourceEvent,a),!0)}handleFocus(t,e){const i=this.chart.overlays.getFocusInfo(this.chart.ctx.localeManager);null==i?0===this.handleSeriesFocus(t,e)?this.announceMode="when-changed":this.announceMode="always":(this.focusIndicator?.update(i.rect,this.seriesRect,!1),this.swapChain.update(i.text),this.announceMode="always")}handleSeriesFocus(t,e){if("standalone"===this.chart.chartType)return this.handleSoloSeriesFocus(t,e);const{focus:i}=this,s=i.sortedSeries.filter(t=>t.visible&&t.focusable);if(0===s.length)return 1;const n=i.datumIndex-e,a=i.seriesIndex-t;i.seriesIndex=C(0,i.seriesIndex,s.length-1),i.series=s[i.seriesIndex];const o=this.focus.datumIndex,r=this.focus.seriesIndex;return this.updatePickedFocus(o,e,n,r,t,a)}handleSoloSeriesFocus(t,e){this.focus.series=this.focus.sortedSeries[0];const i=this.focus.datumIndex,s=this.focus.seriesIndex,n=this.focus.datumIndex-e,a=this.focus.seriesIndex-t;return this.updatePickedFocus(i,e,n,s,t,a)}updatePickedFocus(t,e,i,s,n,a){const{focus:o,hoverRect:r,seriesRect:l}=this;if(null==o.series||null==r)return 1;const c=o?.series?.pickFocus({datumIndex:t,datumIndexDelta:e,otherIndex:s,otherIndexDelta:n,seriesRect:l});if(!c)return 2;const{datum:h}=c;if(o.datum=h,o.datumIndex=c.datumIndex,null!=c.otherIndex&&(o.seriesIndex=c.otherIndex),this.focusIndicator?.isFocusVisible()){this.chart.ctx.animationManager.reset();const t=function({bounds:t}){return t instanceof fs?t:null!=t?Ta.toCanvas(t):fs.NaN}(c),{x:e,y:i}=t.computeCenter();if(!r.containsPoint(e,i)&&this.chart.ctx.zoomManager.panToBBox(this.id,r,t))return 3;const{x1:s,x2:n,y1:a,y2:o}=Yc.from(t),l=r.containsPoint(s,a),h=r.containsPoint(n,a),d=r.containsPoint(s,o),u=r.containsPoint(n,o);if(!(l||h||d||u)){const e=Yc.from(r);c.movedBounds=t.clone(),s<e.x1&&n<e.x1?(c.movedBounds.x=e.x1-2,c.movedBounds.width=4):s>e.x2&&n>e.x2&&(c.movedBounds.x=e.x2-2,c.movedBounds.width=4),a<e.y1&&o<e.y1?(c.movedBounds.y=e.y1-2,c.movedBounds.height=4):a>e.y2&&o>e.y2&&(c.movedBounds.y=e.y2-2,c.movedBounds.height=4)}}this.focusIndicator?.update(c.movedBounds??c.bounds,this.seriesRect,c.clipFocusBox);const d=this.getTooltipContent(o.series,h.datumIndex,h,"aria-label"),u=function(t,e,i){const{x:s,y:n}=function(t,e,i){const s=Ac(t,i.datum,i.movedBounds);if(null!=s)return{x:s.canvasX,y:s.canvasY};const n=i.bounds;if(null!=n){if(n instanceof fs){const{x:t,y:i}=n.computeCenter();return{x:e.x+t,y:e.y+i}}return Ta.toCanvas(n).computeCenter()}}(t,e,i)??{};if(void 0!==s&&void 0!==n)return{type:"keyboard",canvasX:s,canvasY:n}}(o.series,r,c);if(null!=u&&"keyboard"===this.hoverDevice){this.tooltip.lastHover=void 0,this.highlight.appliedHoverEvent=void 0,this.highlight.pendingHoverEvent=void 0,this.highlight.stashedHoverEvent=void 0;const t=Lc.makeTooltipMeta(u,o.series,h,c.movedBounds);this.chart.ctx.highlightManager.updateHighlight(this.id,h),this.isTooltipEnabled(o.series)&&this.chart.ctx.tooltipManager.updateTooltip(this.id,t,d)}return this.maybeAnnouncePickedFocus(e,i,n,a,c,d),0}maybeAnnouncePickedFocus(t,e,i,s,n,a){const{focus:o}=this;let r;r="when-changed"===this.announceMode?0===t&&0===i||e!==n.datumIndex||s!==(n.otherIndex??o.seriesIndex)?"always":"never":this.announceMode,"always"===r&&this.swapChain.update(this.getDatumAriaText(n.datum,a))}getDatumAriaText(t,e){const i=null==e?"":Cg(e);return this.chart.ctx.localeManager.t("ariaAnnounceHoverDatum",{datum:t.series.getDatumAriaText?.(t,i)??i})}clearHighlight(){this.highlight.pendingHoverEvent=void 0,this.highlight.appliedHoverEvent=void 0,this.chart.ctx.highlightManager.updateHighlight(this.id)}clearTooltip(){this.chart.ctx.tooltipManager.removeTooltip(this.id),this.tooltip.lastHover=void 0}clearAll(){this.clearHighlight(),this.clearTooltip(),this.focusIndicator?.clear()}handleHoverHighlight(t){this.highlight.appliedHoverEvent=this.highlight.pendingHoverEvent,this.highlight.pendingHoverEvent=void 0;const e=this.highlight.appliedHoverEvent;if(!e||!this.isState(41))return;const{currentX:i,currentY:s}=e,n=e.currentX+(this.hoverRect?.x??0),a=e.currentY+(this.hoverRect?.y??0);if(t?this.chart.ctx.animationManager.isActive():!this.hoverRect?.containsPoint(n,a))return void this.clearHighlight();const{range:o}=this.chart.highlight,r="tooltip"===o?"highlight-tooltip":"highlight",l=this.pickNodes({x:i,y:s},r);if(!l||0===l.matches.length)return void this.chart.ctx.highlightManager.updateHighlight(this.id);const{current:c}=this.tooltipCandidates,h=null==c?void 0:l.matches.find(t=>Gg(t,c)),d=h?.datum??l.matches[0].datum;this.chart.ctx.highlightManager.updateHighlight(this.id,d),this.hoverDevice="pointer"}handleHoverTooltip(t,e){const{current:i}=this.tooltipCandidates;if(this.tooltipCandidates.reset(),!this.isState(41))return;const{currentX:s,currentY:n}=t,a=s+(this.hoverRect?.x??0),o=n+(this.hoverRect?.y??0),r=t.sourceEvent.target;if(e?this.chart.ctx.animationManager.isActive():!this.hoverRect?.containsPoint(a,o))return void("pointer"==this.hoverDevice&&this.clearTooltip());if(r&&this.chart.tooltip.interactive&&this.chart.ctx.domManager.isManagedChildDOMElement(r,"canvas-overlay",kg))return;const l=this.pickNodes({x:t.currentX,y:t.currentY},"tooltip");if(l&&0!==l.matches.length)if(this.hoverDevice="pointer",0===l.distance){const{current:t,index:e,length:s}=this.tooltipCandidates.update(l.matches,this.chart.tooltip.pagination?i:void 0);this.showTooltip(t,a,o,{index:e,length:s})}else this.showTooltip(l.matches[0],a,o);else"pointer"==this.hoverDevice&&this.clearTooltip()}showTooltip({series:t,datum:e,datumIndex:i},s,n,a){const o=this.getTooltipContent(t,i,e,"tooltip");if(null!=o){const i=Lc.makeTooltipMeta({type:"pointermove",canvasX:s,canvasY:n},t,e,void 0);this.chart.ctx.tooltipManager.updateTooltip(this.id,i,o,a)}else this.chart.ctx.tooltipManager.removeTooltip(this.id)}maybeEnterInteractiveTooltip(t){return this.chart.tooltip.maybeEnterInteractiveTooltip(t,()=>{this.tooltip.lastHover=void 0,this.chart.ctx.tooltipManager.removeTooltip(this.id),this.chart.ctx.highlightManager.updateHighlight(this.id)})}changeHighlightDatum(t){const e=t.previousHighlight?.series,i=t.currentHighlight?.series;e?.properties.cursor&&t.previousHighlight?.datum&&this.chart.ctx.domManager.updateCursor(e.id),i?.properties.cursor&&"default"!==i.properties.cursor&&t.currentHighlight?.datum&&this.chart.ctx.domManager.updateCursor(i.id,i.properties.cursor),null==i||null==e?this.update(5,{clearCallbackCache:!0}):this.update(5,{seriesToUpdate:new Set([e,i].filter(Boolean)),clearCallbackCache:!0})}pickNodes(t,e,i){const s=[...this.series].reverse();let n;for(const a of s){if(!a.visible||!a.contentGroup.visible)continue;const s=a.pickNodes(t,e,i);if(null==s||0===s.datums.length)continue;const{datums:o,distance:r}=s;if(0!==s.datums.length)if(0===r){0!==n?.distance&&(n={matches:[],distance:0});for(const t of o){const{datumIndex:e}=t;n.matches.push({series:a,datum:t,datumIndex:e})}}else if(null==n||n.distance>r){const[t]=o,{datumIndex:e}=t;n={matches:[{series:a,datum:t,datumIndex:e}],distance:r}}}return n}isTooltipEnabled(t){return t.tooltipEnabled??this.chart.tooltip.enabled}getTooltipContent(t,e,i,s){let n;if("aria-label"===s||this.isTooltipEnabled(t)){const{cachedTooltipContent:a}=this;if(null!=a&&a.series===t&&a.datumIndex===e)n=a.content;else{const a=this.chart.getTooltipContent(t,e,i,s);this.cachedTooltipContent={series:t,datumIndex:e,content:a},n=a}}else this.cachedTooltipContent=void 0;return n}},Ug=class{constructor(t){this.seriesRoot=t,this.groups=new Map,this.series=new Map,this.expectedSeriesCount=1,this.mode="normal"}setSeriesCount(t){this.expectedSeriesCount=t}getGroupIndex(t){const{internalId:e,seriesGrouping:i}=t;return i?.groupIndex??e}getGroupType(t,e){return e?"top":t.type}requestGroup(t){const{internalId:e,contentGroup:i}=t,s=t.bringToFront(),n=this.getGroupType(t,s),a=this.getGroupIndex(t),o=this.series.get(e);if(null!=o)throw new Error(`AG Charts - series already has an allocated layer: ${JSON.stringify(o)}`);0===this.series.size&&(this.mode=this.expectedSeriesCount>=30?"aggressive-grouping":"normal");let r=this.groups.get(n);null==r&&(r=new Map,this.groups.set(n,r));const l=this.lookupIdx(a);let c=r.get(l);return null==c&&(c={type:n,id:l,seriesIds:[],group:this.seriesRoot.appendChild(new Oa({name:`${t.contentGroup.name??n}-managed-layer`,zIndex:t.contentGroup.zIndex,renderToOffscreenCanvas:!1}))},r.set(l,c)),this.series.set(e,{layerState:c,seriesConfig:t,bringToFront:s}),c.seriesIds.push(e),c.group.appendChild(i),c.group}changeGroup(t){const{internalId:e,contentGroup:i}=t,s=t.bringToFront(),n=this.getGroupType(t,s),a=this.series.get(e),o=a?this.getGroupType(a.seriesConfig,a.bringToFront):void 0,r=this.getGroupIndex(t),l=this.lookupIdx(r),c=this.groups.get(n)?.get(l);if(o!==n||!0!==c?.seriesIds.includes(e))return this.series.has(e)&&this._releaseGroup({internalId:e,contentGroup:i,type:o}),this.requestGroup(t)}releaseGroup(t){const{internalId:e,contentGroup:i}=t,s=this.getGroupType(t,t.bringToFront());this._releaseGroup({internalId:e,contentGroup:i,type:s})}_releaseGroup(t){const{internalId:e,contentGroup:i,type:s}=t;if(!this.series.has(e))throw new Error(`AG Charts - series doesn't have an allocated layer: ${e}`);const n=this.series.get(e)?.layerState;n&&(n.seriesIds=n.seriesIds.filter(t=>t!==e),i.remove()),0===n?.seriesIds.length?(n.group.remove(),this.groups.get(n.type)?.delete(n.id),this.groups.get(s)?.delete(e)):null!=n&&n.seriesIds.length>0&&(n.group.zIndex=this.getLowestSeriesZIndex(n.seriesIds)),this.series.delete(e)}updateLayerCompositing(){for(const t of this.groups.values())for(const e of t.values()){const{group:t,seriesIds:i}=e;let s;if(0===i.length)s=!1;else if(i.length>1)s=!0;else{const t=this.series.get(i[0]);s=!0===t?.seriesConfig.renderToOffscreenCanvas()}t.renderToOffscreenCanvas=s,t.zIndex=this.getLowestSeriesZIndex(i)}}lookupIdx(t){return"normal"===this.mode?t:"string"!=typeof t||(t=Number(t.split("-").at(-1)),Number.isFinite(t))?Math.floor(30*C(0,t/this.expectedSeriesCount,1)):0}destroy(){for(const t of this.groups.values())for(const e of t.values())e.group.remove();this.groups.clear(),this.series.clear()}getLowestSeriesZIndex(t){let e;for(const i of t){const t=this.series.get(i),s=t?.seriesConfig.contentGroup.zIndex??1;e=null!=e&&null!=s&&sn(e,s)<=0?e:s}return e??1}},Wg=class extends Pn{constructor(){super(...arguments),this.dragAction="drag"}};ls([ws],Wg.prototype,"dragAction",2);var _g=class{constructor(t,e,i,s,n,a){this.chart=t,this.eventsHub=e,this.dataService=i,this.updateService=s,this.zoomManager=n,this.animationManager=a,this.dirtyZoom=!1,this.dirtyDataSource=!1,this.lastAxisZooms=new Map,this.cleanup=new Mi,this.cleanup.register(this.eventsHub.on("data:source-change",()=>this.onDataSourceChange()),this.eventsHub.on("data:load",()=>this.onDataLoad()),this.eventsHub.on("data:error",()=>this.onDataError()),this.updateService.addListener("update-complete",t=>this.onUpdateComplete(t)),this.eventsHub.on("zoom:change",()=>this.onZoomChange()))}destroy(){this.cleanup.flush()}onDataLoad(){this.animationManager.skip(),this.updateService.update(1)}onDataError(){this.updateService.update(4)}onDataSourceChange(){this.dirtyDataSource=!0}onUpdateComplete(t){(t.apiUpdate||this.dirtyZoom||this.dirtyDataSource)&&this.updateWindow(t)}onZoomChange(){this.dirtyZoom=!0}updateWindow(t){if(!this.dataService.isLazy())return;const e=this.getValidAxis();let i,s=!0;if(e){const n=this.zoomManager.getAxisZoom(e.id);0===n.min&&1===n.max||(i=this.getAxisWindow(e,n)),s=this.shouldRefresh(t,e,n)}this.dirtyZoom=!1,this.dirtyDataSource=!1,s&&this.dataService.load({windowStart:i?.min,windowEnd:i?.max})}getValidAxis(){return this.chart.axes.find(t=>"time"===t.type)}shouldRefresh(t,e,i){if(t.apiUpdate)return!0;if(this.dirtyDataSource)return!0;if(!this.dirtyZoom)return!1;const s=this.lastAxisZooms.get(e.id);return!(s&&i.min===s.min&&i.max===s.max||(this.lastAxisZooms.set(e.id,i),0))}getAxisWindow(t,e){const{domain:i}=t.scale;if(!e||0===i.length||Number.isNaN(Number(i[0])))return;const s=Number(i[1])-Number(i[0]);return{min:new Date(Number(i[0])+s*e.min),max:new Date(Number(i[0])+s*e.max)}}},Yg=/^((?!chrome|android).)*safari/i,Kg=/Version\/(\d+(\.\d+)?)/,Zg=/Chrome/,Xg=/Chrome\/(\d+)/,Qg=/Edg/,qg=/OPR/,Jg=new Set(["map-shape-background","map-line-background"]),tm=class{constructor(t,e,i,s,n,a,o){this.chartLike=t,this.overlays=e,this.eventsHub=i,this.dataService=s,this.localeManager=n,this.animationManager=a,this.domManager=o,this.cleanup=new Mi,this.overlayElem=this.domManager.addChild("canvas-overlay","overlay"),this.overlayElem.role="status",this.overlayElem.ariaAtomic="false",this.overlayElem.ariaLive="polite",this.overlayElem.classList.toggle(Xp),this.cleanup.register(this.eventsHub.on("layout:complete",t=>this.onLayoutComplete(t)))}destroy(){this.cleanup.flush(),this.domManager.removeChild("canvas-overlay","overlay")}onLayoutComplete({series:{rect:t}}){const e=this.dataService.isLoading(),s=this.chartLike.series.some(t=>t.hasData),n=this.chartLike.series.some(t=>t.visible&&!Jg.has(t.type));this.overlays.darkTheme?this.overlayElem.classList.add(Qp):this.overlayElem.classList.remove(Qp),this.overlayElem.style.left=`${t.x}px`,this.overlayElem.style.top=`${t.y}px`,this.overlayElem.style.width=`${t.width}px`,this.overlayElem.style.height=`${t.height}px`;const a=e,o=!e&&!s,r=s&&!n,l=this.overlays.unsupportedBrowser.enabled&&function(){const{userAgent:t}=z("navigator");if(Yg.test(t)){const e=Kg.exec(t);if(null==e)return!1;const s=Number.parseFloat(e[1]),n=Math.floor(s)>16;return n||i.warnOnce(`Unsupported Safari version: ${s}; ${t}`),!n}if(Zg.test(t)&&!Qg.test(t)&&!qg.test(t)){const e=Xg.exec(t);if(null==e)return!1;const s=Number.parseInt(e[1],10),n=s>126;return n||i.warnOnce(`Unsupported Chrome version: ${s}; ${t}`),!n}return!1}();a?this.showOverlay(this.overlays.loading,t):this.hideOverlay(this.overlays.loading),o?this.showOverlay(this.overlays.noData,t):this.hideOverlay(this.overlays.noData),r?this.showOverlay(this.overlays.noVisibleSeries,t):this.hideOverlay(this.overlays.noVisibleSeries),l?this.showOverlay(this.overlays.unsupportedBrowser,t):this.hideOverlay(this.overlays.unsupportedBrowser);const c=a||o||r||l;di(this.overlayElem,"aria-hidden",!c)}showOverlay(t,e){if(!t.enabled)return;const i=t.getElement(this.chartLike,this.animationManager,this.localeManager,e);this.overlayElem.appendChild(i)}hideOverlay(t){t.removeElement(()=>{this.overlayElem.innerText=" "},this.animationManager)}},em=bs.create(!0,"opts"),im=class t extends io{constructor(t,e){var s,n;super(),this.id=Oi(this),this.seriesRoot=new za({name:`${this.id}-series-root`,zIndex:7}),this.annotationRoot=new za({name:`${this.id}-annotation-root`,zIndex:11}),this.titleGroup=new Oa({name:"titles",zIndex:15}),this.debug=bs.create(),this.extraDebugStats={},this.data=Hh.empty(),this._firstAutoSize=!0,this._autoSizeNotify=new si,this.chartCaptions=new or,this.padding=new so(20),this.keyboard=new od,this.touch=new Wg,this.mode="standalone",this.styleNonce=void 0,this.formatter=void 0,this.suppressFieldDotNotation=!1,this.loadGoogleFonts=!1,this.destroyed=!1,this.cleanup=new Mi,this.chartAnimationPhase="initial",this.modulesManager=new Zp,this.processors=[],this.queuedUserOptions=[],this.queuedChartOptions=[],this.firstApply=!0,this.syncStatus="init",this.fireEventWrapper=t=>super.fireEvent(t),this.apiUpdate=!1,this._pendingFactoryUpdatesCount=0,this._performUpdateSkipAnimations=!1,this._performUpdateNotify=new si,this.performUpdateType=8,this.runningUpdateType=8,this.updateShortcutCount=0,this.seriesToUpdate=new Set,this.updateMutex=new eo,this.clearCallbackCacheOnUpdate=!1,this.updateRequestors={},this.performUpdateTrigger=(n=({count:t})=>{this.destroyed||this.updateMutex.acquire(async()=>{try{await this.performUpdate(t)}catch(t){i.error("update error",t,t.stack)}}).catch(t=>i.errorOnce(t))},co((t,e=0)=>{0===e?queueMicrotask(t):setTimeout(t,e)},n)),this._performUpdateSplits={},this._previousSplit=0,this.axes=[],this.series=[],this._cachedData=void 0,this.onSeriesNodeClick=t=>{this.fireEvent(t)},this.onSeriesNodeDoubleClick=t=>{this.fireEvent(t)},this.onSeriesVisibilityChange=t=>{this.fireEvent(t)},this.seriesGroupingChanged=t=>{if(!(t instanceof lg))return;const{series:e,seriesGrouping:i}=t;if(e.contentGroup.isRoot())return;const s=this.seriesLayerManager.changeGroup({internalId:e.internalId,type:e.type,contentGroup:e.contentGroup,bringToFront:()=>e.bringToFront(),renderToOffscreenCanvas:()=>e.renderToOffscreenCanvas(),seriesGrouping:i});null!=s&&e.attachSeries(s,this.seriesRoot,this.annotationRoot)},this.chartOptions=t;const a=e?.scene,o=e?.container??t.processedOptions.container??void 0,r=e?.styleContainer??t.specialOverrides.styleContainer;a&&(this._firstAutoSize=!1,this._lastAutoSize=[a.width,a.height,a.pixelRatio]);const l=new Oa({name:"root"});l.visible=!1,l.append(this.seriesRoot),l.append(this.annotationRoot),l.append(this.titleGroup),this.titleGroup.append(this.title.node),this.titleGroup.append(this.subtitle.node),this.titleGroup.append(this.footnote.node),this.tooltip=new Vg,this.seriesLayerManager=new Ug(this.seriesRoot),this.mode=t.userOptions.mode??this.mode,this.styleNonce=t.processedOptions.styleNonce;const c=this.ctx=new mh(this,{chartType:this.getChartType(),scene:a,root:l,container:o,styleContainer:r,domMode:t.optionMetadata.domMode,withDragInterpretation:t.optionMetadata.withDragInterpretation??!0,syncManager:new ad(this),fireEvent:t=>this.fireEvent(t),updateCallback:(t,e)=>this.update(t,e),updateMutex:this.updateMutex});this.cleanup.register(c.eventsHub.on("dom:resize",()=>this.parentResize(c.domManager.containerSize))),this.overlays=new Jp,(s=this.overlays.loading).renderer??(s.renderer=()=>function(t,e){const{animationDuration:i}=Kl.add,s=j("div",`${Xp}--loading`,{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",height:"100%",boxSizing:"border-box",font:"13px Verdana, sans-serif",userSelect:"none",animation:`ag-charts-loading ${i*e}ms linear 50ms both`}),n=j("span",{width:"45px",height:"40px",backgroundImage:["linear-gradient(#0000 calc(1 * 100% / 6), #ccc 0 calc(3 * 100% / 6), #0000 0), ","linear-gradient(#0000 calc(2 * 100% / 6), #ccc 0 calc(4 * 100% / 6), #0000 0), ","linear-gradient(#0000 calc(3 * 100% / 6), #ccc 0 calc(5 * 100% / 6), #0000 0)"].join(""),backgroundSize:"10px 400%",backgroundRepeat:"no-repeat",animation:"ag-charts-loading-matrix 1s infinite linear"}),a=j("p",{marginTop:"1em"});a.innerText=t;const o=j("div",`${Xp}__loading-background`,{position:"absolute",inset:"0",opacity:"0.5",zIndex:"-1"}),r=j("style");return r.innerText=["@keyframes ag-charts-loading { from { opacity: 0 } to { opacity: 1 } }","@keyframes ag-charts-loading-matrix {","0% { background-position: 0% 0%, 50% 0%, 100% 0%; }","100% { background-position: 0% 100%, 50% 100%, 100% 100%; }","}"].join(" "),s.replaceChildren(r,n,a,o),s}(this.overlays.loading.getText(c.localeManager),c.animationManager.defaultDuration)),this.processors=[new _g(this,c.eventsHub,c.dataService,c.updateService,c.zoomManager,c.animationManager),new tm(this,this.overlays,c.eventsHub,c.dataService,c.localeManager,c.animationManager,c.domManager)],this.highlight=new fh,this.container=o;const h=this.getModuleContext();c.domManager.setDataBoolean("animating",!1),c.domManager.setDataNumber("animationTimeMs",0),this.seriesAreaManager=new Hg(this.initSeriesAreaDependencies()),this.cleanup.register(c.layoutManager.registerElement(0,t=>{t.layoutBox.shrink(this.padding.toJson()),this.chartCaptions.positionCaptions(t)}),c.eventsHub.on("layout:complete",t=>this.chartCaptions.positionAbsoluteCaptions(t)),c.eventsHub.on("data:load",t=>{this.data=new Hh(t.data)}),this.title.registerInteraction(h,"beforebegin"),this.subtitle.registerInteraction(h,"beforebegin"),this.footnote.registerInteraction(h,"afterend"),wo.addWindowEvent("page-left",()=>this.destroy()),c.animationManager.addListener("animation-frame",()=>{this.update(7),c.domManager.setDataNumber("animationTimeMs",c.animationManager.getCumulativeAnimationTime())}),c.animationManager.addListener("animation-start",()=>c.domManager.setDataBoolean("animating",!0)),c.animationManager.addListener("animation-stop",()=>{c.domManager.setDataBoolean("animating",!1),c.domManager.setDataNumber("animationTimeMs",c.animationManager.getCumulativeAnimationTime())}),c.eventsHub.on("zoom:change",()=>{for(const t of this.series)t.animationState?.transition("updateData");const t="initial"!==this.chartAnimationPhase;this.update(4,{forceNodeDataRefresh:!0,skipAnimations:t})})),this.parentResize(c.domManager.containerSize)}static getInstance(e){return t.chartsInstances.get(e)}get canvasElement(){return this.ctx.scene.canvas.element}download(t,e){this.ctx.scene.download(t,e)}getCanvasDataURL(t){return this.ctx.scene.getDataURL(t)}toSVG(){return this.ctx.scene.toSVG()}get seriesAreaBoundingBox(){return this.seriesAreaManager.bbox}getOptions(){return this.queuedUserOptions.at(-1)??this.chartOptions.userOptions}getChartOptions(){return this.queuedChartOptions.at(-1)??this.chartOptions}overrideFocusVisible(t){this.seriesAreaManager.focusIndicator?.overrideFocusVisible(t)}fireEvent(t){Fa(this,this.fireEventWrapper,t)}initSeriesAreaDependencies(){const{ctx:t,tooltip:e,highlight:i,overlays:s,seriesRoot:n,mode:a}=this,o=this.getChartType();return{fireEvent:this.fireEvent.bind(this),getUpdateType:()=>this.performUpdateType,getTooltipContent:(t,e,i,s)=>this.getTooltipContent(t,e,i,s),chartType:o,ctx:t,tooltip:e,highlight:i,overlays:s,seriesRoot:n,mode:a}}getModuleContext(){return this.ctx}getTooltipContent(t,e,i,s){const n="aria-label"===s||!1!==t.properties.tooltip.enabled?t.getTooltipContent(e,i):void 0,a=null==n?[]:[n];if("shared"!==this.tooltip.mode||1===this.series.length)return a;const o=t.getCategoryValue(e);return null==o?a:this.series.flatMap(e=>{if(e===t)return a;if(!e.isEnabled()||!1===e.properties.tooltip.enabled)return[];const i=e.datumIndexForCategoryValue(o),s=null==i?void 0:e.getTooltipContent(i,void 0);return null==s?[]:[s]})}getCaptionText(){return[this.title,this.subtitle,this.footnote].filter(t=>t.enabled&&t.text).map(t=>t.text).join(". ")}getAriaLabel(){return this.ctx.localeManager.t("ariaAnnounceChart",{seriesCount:this.series.length})}resetAnimations(){this.chartAnimationPhase="initial";for(const t of this.series)t.resetAnimation(this.chartAnimationPhase);for(const t of this.axes)t.resetAnimation(this.chartAnimationPhase);this.animationRect=void 0,this.ctx.animationManager.reset()}skipAnimations(){this.ctx.animationManager.skipCurrentBatch(),this._performUpdateSkipAnimations=!0}detachAndClear(){this.container=void 0,this.ctx.scene.clearCanvas()}destroy(t){if(this.destroyed)return;const e=t?.keepTransferableResources;let i;this.performUpdateType=8,this.cleanup.flush();for(const t of this.processors)t.destroy();this.overlays.destroy(),this.modulesManager.destroy(),e?(this.ctx.scene.strip(),i={container:this.container,scene:this.ctx.scene}):(this.ctx.scene.destroy(),this.container=void 0),this.destroySeries(this.series),this.seriesLayerManager.destroy();for(const t of this.axes)t.destroy();return this.axes=[],this.animationRect=void 0,this.ctx.destroy(),this.destroyed=!0,Object.freeze(this),i}requestFactoryUpdate(t){this.destroyed||(this._pendingFactoryUpdatesCount++,this.updateMutex.acquire(async()=>{if(!this.destroyed)try{await t(this)}finally{this.destroyed||this._pendingFactoryUpdatesCount--}}).catch(t=>i.errorOnce(t)))}clearCallbackCache(){this.ctx.callbackCache.invalidateCache();for(const t of this.series)t.resetDatumCallbackCache()}update(t=0,e){if(this.destroyed)return;const{forceNodeDataRefresh:i=!1,skipAnimations:s,seriesToUpdate:n=this.series,newAnimationBatch:a,apiUpdate:o=!1,clearCallbackCache:r=!1}=e??{};if(this.apiUpdate=o,this.ctx.widgets.seriesWidget.setDragTouchEnabled("none"!==this.touch.dragAction),i)for(const t of this.series)t.markNodeDataDirty();for(const t of n)this.seriesToUpdate.add(t);if(s&&(this.ctx.animationManager.skipCurrentBatch(),this._performUpdateSkipAnimations=!0),a&&this.ctx.animationManager.isActive()&&(this._performUpdateSkipAnimations=!0),(0===t||r)&&(this.clearCallbackCacheOnUpdate=!0),this.debug.check()){let e=new Error("Stack trace for update tracking").stack??"<unknown>";e=e.replaceAll(/\([^)]*/g,""),this.updateRequestors[e]=t}t<this.performUpdateType&&(this.performUpdateType=t,this.ctx.domManager.setDataBoolean("updatePending",!0),this.performUpdateTrigger.schedule(e?.backOffMs))}updateSplits(t){const e=this._performUpdateSplits;e[t]??(e[t]=0),e[t]+=performance.now()-this._previousSplit,this._previousSplit=performance.now()}async performUpdate(t){const{performUpdateType:e,extraDebugStats:i,_performUpdateSplits:s,ctx:n}=this,a=[...this.seriesToUpdate];switch(this.clearCallbackCacheOnUpdate&&(this.clearCallbackCacheOnUpdate=!1,this.clearCallbackCache()),this.performUpdateType=8,this.seriesToUpdate.clear(),this.runningUpdateType=e,0===this.updateShortcutCount&&e<7&&(n.animationManager.startBatch(this._performUpdateSkipAnimations),n.animationManager.onBatchStop(()=>this.chartAnimationPhase="ready")),this.ctx.scene.updateDebugFlags(),this.debug("Chart.performUpdate() - start",yl[e]),this._previousSplit=performance.now(),s.start??(s.start=this._previousSplit),e){case 0:if(this.checkUpdateShortcut(0))break;this.ctx.updateService.dispatchPreDomUpdate(),this.updateDOM();case 1:if(this.checkUpdateShortcut(1))break;await this.updateData(),this.updateSplits("⬇️");case 2:if(this.checkUpdateShortcut(2))break;await this.processData(),this.seriesAreaManager.dataChanged(),this.updateSplits("📊");case 3:if(this.checkUpdateShortcut(3))break;await this.processDomains(),this.updateSplits("⛰️");case 4:if(await this.checkFirstAutoSize(),this.checkUpdateShortcut(4))break;await this.processLayout(),this.updateSplits("⌖");case 5:if(this.checkUpdateShortcut(5))break;this.seriesRoot.renderToOffscreenCanvas="cutout"===this.highlight.drawingMode,await this.updateSeries(a),this.updateAriaLabels(),this.seriesLayerManager.updateLayerCompositing(),this.updateSplits("🤔");case 6:if(this.checkUpdateShortcut(6))break;n.updateService.dispatchPreSceneRender(),this.updateSplits("↖");case 7:if(this.checkUpdateShortcut(7))break;n.animationManager.endBatch(),i.updateShortcutCount=this.updateShortcutCount,n.scene.render({debugSplitTimes:s,extraDebugStats:i,seriesRect:this.seriesRect}),this.extraDebugStats={};for(const t of Object.keys(s))delete s[t];this.ctx.domManager.incrementDataCounter("sceneRenders"),this.ctx.domManager.postRenderUpdate();case 8:this.updateShortcutCount=0,this.updateRequestors={},this._performUpdateSkipAnimations=!1,n.animationManager.endBatch()}this.destroyed||(n.updateService.dispatchUpdateComplete(this.apiUpdate),this.apiUpdate=!1,this.ctx.domManager.setDataBoolean("updatePending",!1),this.runningUpdateType=8,this.syncStatus="ready"),this._performUpdateNotify.notify();const o=performance.now();this.debug("Chart.performUpdate() - end",{chart:this,durationMs:Math.round(100*(o-s.start))/100,count:t,performUpdateType:yl[e]})}updateThemeClassName(){const t="ag-charts-theme-",e=[`${t}default`,`${t}default-dark`];let i=e[0],s=!1,{theme:n}=this.chartOptions.processedOptions;for(;"string"!=typeof n&&null!=n;)n=n.baseTheme;"string"==typeof n&&(i=n.replace("ag-",t),s=n.includes("-dark")),e.includes(i)||(i=s?e[1]:e[0]),this.ctx.domManager.setThemeClass(i)}updateDOM(){this.updateThemeClassName();const{enabled:t,tabIndex:e}=this.keyboard;this.ctx.domManager.setTabGuardIndex(t?e??0:-1),this.ctx.domManager.setThemeParameters(this.chartOptions.themeParameters)}updateAriaLabels(){this.ctx.domManager.updateCanvasLabel(this.getAriaLabel())}checkUpdateShortcut(t){return!!this.destroyed||(this.updateShortcutCount>3?(i.warn("exceeded the maximum number of simultaneous updates (4), discarding changes and rendering",this.updateRequestors),!1):this.performUpdateType<=t&&(this.updateShortcutCount++,!0))}async checkFirstAutoSize(){null!=this.width&&null!=this.height||this._lastAutoSize||await this._autoSizeNotify.await(500)||this.debug("Chart.checkFirstAutoSize() - timeout for first size update.")}onAxisChange(t,e){null==e&&0===t.length||this.ctx.axisManager.updateAxes(e??[],t)}onSeriesChange(t,e){const i=e?.filter(e=>!t.includes(e))??[];this.destroySeries(i),this.seriesLayerManager?.setSeriesCount(t.length);for(const i of t){if(e?.includes(i))continue;const t=this.seriesLayerManager.requestGroup(i);i.attachSeries(t,this.seriesRoot,this.annotationRoot),i.chart={},Object.defineProperty(i.chart,"mode",{get:()=>this.mode}),Object.defineProperty(i.chart,"isMiniChart",{get:()=>!1}),Object.defineProperty(i.chart,"seriesRect",{get:()=>this.seriesRect}),i.resetAnimation(this.chartAnimationPhase),this.addSeriesListeners(i),i.addChartEventListeners()}this.seriesAreaManager?.seriesChanged(t)}destroySeries(t){if(t)for(const e of t)e.removeEventListener("seriesNodeClick",this.onSeriesNodeClick),e.removeEventListener("seriesNodeDoubleClick",this.onSeriesNodeDoubleClick),e.removeEventListener("groupingChanged",this.seriesGroupingChanged),e.destroy(),this.seriesLayerManager.releaseGroup(e),e.detachSeries(void 0,this.seriesRoot,this.annotationRoot),e.chart=void 0}addSeriesListeners(t){this.hasEventListener("seriesNodeClick")&&t.addEventListener("seriesNodeClick",this.onSeriesNodeClick),this.hasEventListener("seriesNodeDoubleClick")&&t.addEventListener("seriesNodeDoubleClick",this.onSeriesNodeDoubleClick),this.hasEventListener("seriesVisibilityChange")&&t.addEventListener("seriesVisibilityChange",this.onSeriesVisibilityChange),t.addEventListener("groupingChanged",this.seriesGroupingChanged)}assignSeriesToAxes(){for(const t of this.axes)t.boundSeries=this.series.filter(e=>e.axes[t.direction]===t)}assignAxesToSeries(){const t=qe(this.axes,t=>t.direction);for(const e of this.series)for(const s of e.directions){const n=t[s];if(!n)return void i.warnOnce(`no available axis for direction [${s}]; check series and axes configuration.`);const a=e.getKeys(s),o=n.find(t=>!t.keys.length||a.some(e=>t.keys.includes(e)));if(!o)return void i.warnOnce(`no matching axis for direction [${s}] and keys [${a}]; check series and axes configuration.`);e.axes[s]=o}}parentResize(t){if(null==t||null!=this.width&&null!=this.height)return;let{width:e,height:i}=t;const{pixelRatio:s}=t;if(e=Math.floor(e),i=Math.floor(i),0===e&&0===i)return;const[n=0,a=0,o=1]=this._lastAutoSize??[];n===e&&a===i&&o===s||(this._lastAutoSize=[e,i,s],this.resize("SizeMonitor",{}))}resize(t,e){const{scene:i,animationManager:s}=this.ctx,{inWidth:n,inHeight:a,inMinWidth:o,inMinHeight:r,inOverrideDevicePixelRatio:l}=e;this.ctx.domManager.setSizeOptions(o??this.minWidth,r??this.minHeight,n??this.width,a??this.height);const c=n??this.width??this._lastAutoSize?.[0],h=a??this.height??this._lastAutoSize?.[1],d=l??this.overrideDevicePixelRatio??this._lastAutoSize?.[2];if(this.debug(`Chart.resize() from ${t}`,{width:c,height:h,pixelRatio:d,stack:new Error("Stack trace for resize tracking").stack}),null!=c&&null!=h&&Q(c)&&Q(h)&&i.resize(c,h,d)){s.reset();let t=!0;null!=this.width&&null!=this.height||!this._firstAutoSize||(t=!1,this._firstAutoSize=!1),this.update(4,{forceNodeDataRefresh:!0,skipAnimations:t}),this._autoSizeNotify.notify()}}async updateData(){for(const t of this.series)t.setChartData(this.data);const t=this.modulesManager.mapModules(t=>t.updateData?.(this.data));await Promise.all(t.filter(t=>null!=t&&"object"==typeof t))}async processData(){this.series.some(t=>t.canHaveAxes)&&(this.assignAxesToSeries(),this.assignSeriesToAxes());const t=new _h(this.mode,this.suppressFieldDotNotation),e=this.series.map(e=>e.processData(t)),i=this.modulesManager.mapModules(e=>e.processData?.(t));this._cachedData=t.execute(this._cachedData),this.updateSplits("🏭"),await Promise.all([...e,...i.filter(t=>null!=t)]),this.updateLegends()}async processDomains(){for(const t of this.axes)t.processData();for(const t of this.series)t.updatedDomains()}updateLegends(t){for(const{legend:e,legendType:i}of this.modulesManager.legends())"category"===i?this.setCategoryLegendData(t):this.setLegendData(i,e)}setCategoryLegendData(t){const{ctx:{legendManager:e,stateManager:s}}=this;if(t)for(const e of this.series){const i=t.find(t=>t.seriesId===e.id);e.onLegendInitialState("category",i)}const n=this.series.flatMap(t=>{const i=t.getLegendData("category");return e.updateData(t.id,i),i});if(t)s.setStateAndRestore(e,t);else{if("integrated"!==this.mode){const t={},e=new Map(this.series.map(t=>[t.id,t.type]));for(const{seriesId:s,symbol:{marker:a},label:o}of n.filter(t=>!t.hideInLegend)){if(null==a.fill)continue;const n=e.get(s),r=t[n]??(t[n]=new Map);r.has(o.text)?r.get(o.text)!==a.fill&&i.warnOnce(`legend item '${At(o.text)}' has multiple fill colors, this may cause unexpected behaviour.`):r.set(o.text,a.fill)}}e.update()}}setLegendData(t,e){e.data=this.series.filter(t=>t.properties.showInLegend).flatMap(e=>e.getLegendData(t))}async processLayout(){const t=this.animationRect,{width:e,height:i}=this.ctx.scene,s=this.ctx.layoutManager.createContext(e,i);await this.performLayout(s),t&&!this.animationRect?.equals(t)&&this.ctx.animationManager.skipCurrentBatch(),this.debug("Chart.performUpdate() - seriesRect",this.seriesRect)}async updateSeries(t){const{seriesRect:e}=this;await Promise.all(t.map(t=>t.update({seriesRect:e})).filter(t=>null!=t)),this.ctx.seriesLabelLayoutManager.updateLabels(this.series.filter(t=>t.visible&&t.usesPlacedLabels),this.padding,this.seriesRect)}async waitForUpdate(t,e){const s=z("agChartsDebugTimeout");null==s?(t??(t=1e4),e??(e=!1)):(t=s,e??(e=!0));const n=performance.now();for(;(this._pendingFactoryUpdatesCount>0||8!==this.performUpdateType||8!==this.runningUpdateType||this.ctx.scene.waitingForUpdate()||this.data.hasPendingTransactions())&&!this.destroyed;){if(this._pendingFactoryUpdatesCount>0&&await this.updateMutex.waitForClearAcquireQueue(),(8!==this.performUpdateType||8!==this.runningUpdateType||this.data.hasPendingTransactions())&&await this._performUpdateNotify.await(),performance.now()-n>t){const s=`Chart.waitForUpdate() timeout of ${t} reached - first chart update taking too long.`;if(e)throw new Error(s);i.warnOnce(s)}Ua()&&await ni(),this.ctx.scene.waitingForUpdate()&&await ni(50)}}filterMiniChartSeries(t){return t?.filter(t=>!1!==t.showInMiniChart)}applyOptions(t){const e=this.firstApply?t.processedOptions:t.diffOptions(this.chartOptions);if(null==e||0===Object.keys(e).length)return em("Chart.applyOptions() - no delta, forcing re-layout",e),void this.update(4,{apiUpdate:!0,newAnimationBatch:!0});const i=this.firstApply?{}:this.chartOptions.processedOptions,s=t.processedOptions;em("Chart.applyOptions() - applying delta",e);const n=this.applyModules(s);e.listeners&&this.registerListeners(this,e.listeners),Ja(this,e,{skip:["type","data","series","listeners","preset","theme","legend.listeners","navigator.miniChart.series","navigator.miniChart.label","locale.localeText","axes","topology","nodes","initialState","styleContainer","formatter"]});let a=!1,o="no-op";null!=e.series&&(o=this.applySeries(this,e.series,i?.series),a=!0),"replaced"===o&&this.resetAnimations(),this.applyAxes(this,s,i,o,[])&&(a=!0),e.data&&(this.data=new Hh(e.data)),e.legend?.listeners&&this.modulesManager.isEnabled("legend")&&Object.assign(this.legend.listeners,e.legend.listeners),e.locale?.localeText&&(this.modulesManager.getModule("locale").localeText=e.locale?.localeText),this.chartOptions=t;const r=this.modulesManager.getModule("navigator"),l=this.modulesManager.getModule("zoom");r?.enabled||l?.enabled||this.ctx.zoomManager.updateZoom("chart");const c=r?.miniChart,h=s.navigator?.miniChart?.series??s.series;!0===c?.enabled&&null!=h?this.applyMiniChartOptions(c,h,s,i):!1===c?.enabled&&(c.series=[],c.axes=[]),this.ctx.annotationManager.setAnnotationStyles(t.annotationThemes),a||(a=this.shouldForceNodeDataRefresh(e,o));const d=a||n?0:4;if(this.maybeResetAnimations(o),this.shouldClearLegendData(s,i,o)&&this.ctx.legendManager.clearData(),this.applyInitialState(s),this.ctx.formatManager.setFormatter(s.formatter),em("Chart.applyOptions() - update type",yl[d],{seriesStatus:o,forceNodeDataRefresh:a}),void 0!==t.optionsProcessingTime){this._performUpdateSplits["⚙️"]=t.optionsProcessingTime;const e=performance.now()-t.optionsProcessingTime;this._performUpdateSplits.start=e}this.update(d,{apiUpdate:!0,forceNodeDataRefresh:a,newAnimationBatch:!0,clearCallbackCache:!0}),this.firstApply=!1}applyInitialState(t){const{annotationManager:e,chartTypeOriginator:i,historyManager:s,stateManager:n,zoomManager:a}=this.ctx,{initialState:o}=t;if("annotations"in t&&t.annotations?.enabled&&null!=o?.annotations){const t=o.annotations.map(t=>zs(t,e.getAnnotationTypeStyles(t.type)));n.setState(e,t)}null!=o?.chartType&&n.setState(i,o.chartType),(t.navigator?.enabled||t.zoom?.enabled)&&null!=o?.zoom&&n.setState(a,o.zoom),null!=o?.legend&&this.updateLegends(o.legend),null!=o&&s.clear()}maybeResetAnimations(t){if("standalone"===this.mode)switch(t){case"series-grouping-change":case"replaced":this.resetAnimations()}}shouldForceNodeDataRefresh(t,e){const i=!!t.data||"data-change"===e||"replaced"===e,s=Qh.getKeys(),n=Object.values(s).some(e=>null!=t[e]),a=null!=t.title&&null!=t.subtitle||null!=t.formatter;return i||n||a}shouldClearLegendData(t,e,i){const s="replaced"===i||"series-grouping-change"===i||"updated"===i&&(t.series?.length!==e.series?.length||!t.series?.every((t,i)=>t.type===e.series?.[i].type)),n=null!=e.legend&&null==t.legend;return s||n}applyMiniChartOptions(t,e,i,s){const n=s?.navigator?.miniChart?.series??s?.series,a=this.applySeries(t,this.filterMiniChartSeries(e),this.filterMiniChartSeries(n));this.applyAxes(t,i,s,a,["axes[].tick","axes[].thickness","axes[].title","axes[].crosshair","axes[].gridLine","axes[].label"]);const o=t.series;for(const t of o)t.properties.id=void 0;const r=t.axes,l=r.find(t=>"x"===t.direction);for(const t of r)t.nice=!1,t.gridLine.enabled=!1,t.label.enabled=t===l,t.tick.enabled=!1,t.interactionEnabled=!1;if(null!=l){const t=i.navigator?.miniChart,e=t?.label,s=t?.label?.interval;if(l.line.enabled=!1,l.label.set(Vs(e,["interval","autoRotate","autoRotateAngle","itemStyler","minSpacing","rotation"])),"grouped-category"===l.type){l.label.enabled=!1,l.label.rotation=0;const{depthOptions:t}=l;if(0===t.length)t.set([{label:{enabled:!0}}]);else for(let e=1;e<t.length;e++)t[e].label.enabled=!1}else"time"!==l.type&&"unit-time"!==l.type&&"ordinal-time"!==l.type||(l.parentLevel.enabled=!1);l.interval.step=s?.step,l.interval.values=s?.values,l.interval.minSpacing=s?.minSpacing,l.interval.maxSpacing=s?.maxSpacing}}applyModules(t){const{type:e}=this.constructor;let i=!1;for(const s of hs.byType("root","legend")){const n=null!=t[s.optionsKey]&&s.chartTypes.includes(e);n!==this.modulesManager.isEnabled(s)&&(n?(this.modulesManager.addModule(s,t=>t.moduleFactory(this.getModuleContext())),"legend"===s.type&&this.modulesManager.getModule(s)?.attachLegend(this.ctx.scene),this[s.optionsKey]=this.modulesManager.getModule(s)):(this.modulesManager.removeModule(s),delete this[s.optionsKey]),i=!0)}return i}initSeriesDeclarationOrder(t){for(let e=0;e<t.length;e++)t[e].setSeriesIndex(e)}applySeries(t,e,i){if(!e)return"no-change";const s=function(t,e,i){const s=(t,e,i)=>{const s=[t];for(const t of Up)t in e&&null!=e[t]&&s.push(`${t}=${e[t]}`);return i?.seriesGrouping&&s.push(`seriesGrouping.groupId=${i?.seriesGrouping.groupId}`),s.join(";")},n=new Map;let a=0;for(const e of t){const t=s(e.type,e.properties,i?.[a]);n.has(t)||n.set(t,[]),n.get(t)?.push([e,a++])}const o=new Map;a=0;for(const t of e){const e=s(t.type,t,t);o.has(e)||o.set(e,[]),o.get(e)?.push([t,a++])}if(![...n.keys()].some(t=>o.has(t)))return{status:"no-overlap",oldKeys:n.keys(),newKeys:o.keys()};const r=[];for(const[t,e]of o.entries())for(const[s,a]of e){const e=n.get(t);if(null==e||e.length<1){r.push({opts:s,targetIdx:a,idx:a,status:"add"}),n.delete(t);continue}const[o,l]=e.shift(),c=Ka(i?.[l]??{},s??{}),{groupIndex:h,stackIndex:d}=c?.seriesGrouping??{};null!=h||null!=d?r.push({opts:s,series:o,diff:c,targetIdx:a,idx:l,status:"series-grouping"}):c?r.push({opts:s,series:o,diff:c,targetIdx:a,idx:l,status:"update"}):r.push({opts:s,series:o,targetIdx:a,idx:l,status:"no-op"}),0===e.length&&n.delete(t)}for(const t of n.values())for(const[e,i]of t)r.push({series:e,idx:i,targetIdx:-1,status:"remove"});return{status:"overlap",changes:r}}(t.series,e,i);if("no-overlap"===s.status){em(`Chart.applySeries() - creating new series instances, status: ${s.status}`,s);const i=e.map(t=>this.createSeries(t));return this.initSeriesDeclarationOrder(i),t.series=i,"replaced"}em("Chart.applySeries() - matchResult",s);const n=[];let a=!1,o=!1,r=!1;const l=s.changes.toSorted((t,e)=>t.targetIdx-e.targetIdx);for(const t of l)switch(o||(o="series-grouping"===t.status),a||(a=null!=t.diff?.data),r||(r="no-op"!==t.status),t.status){case"add":{const e=this.createSeries(t.opts);n.push(e),em("Chart.applySeries() - created new series",e);break}case"remove":em(`Chart.applySeries() - removing series at previous idx ${t.idx}`,t.series);break;case"no-op":n.push(t.series),em(`Chart.applySeries() - no change to series at previous idx ${t.idx}`,t.series);break;default:{const{series:e,diff:i,idx:s}=t;em(`Chart.applySeries() - applying series diff previous idx ${s}`,i,e),this.applySeriesValues(e,i),e.markNodeDataDirty(),n.push(e)}}return this.initSeriesDeclarationOrder(n),em("Chart.applySeries() - final series instances",n),t.series=n,o?"series-grouping-change":a?"data-change":r?"updated":"no-op"}applyAxes(t,e,i,s,n=[]){if(!("axes"in e)||!e.axes)return!1;n=["axes[].type",...n];const a=e.axes;if("replaced"!==s&&t.axes.length===a.length&&t.axes.every((t,e)=>t.type===a[e].type)&&_p(i)){for(const[e,s]of t.axes.entries()){const t=Ka(i.axes?.[e]??{},a[e]);em(`Chart.applyAxes() - applying axis diff idx ${e}`,t),Ja(s,t,{path:`axes[${e}]`,skip:n})}return!0}return em(`Chart.applyAxes() - creating new axes instances; seriesStatus: ${s}`),t.axes=this.createAxis(a,n),!0}createSeries(t){const e=sd.create(t.type,this.getModuleContext());return this.applySeriesOptionModules(e,t),this.applySeriesValues(e,t),e}applySeriesOptionModules(t,e){const i=t.createModuleContext(),s=t.getModuleMap();for(const n of hs.byType("series-option"))n.optionsKey in e&&n.seriesTypes.includes(t.type)&&s.addModule(n,t=>t.moduleFactory(i))}applySeriesValues(t,e){const i=t.getModuleMap(),{type:s,data:n,listeners:a,seriesGrouping:o,showInMiniChart:r,...l}=e;for(const t of Kh)if("series-option"===t.type&&t.optionsKey in l){const e=i.getModule(t.optionsKey);if(e){const i=l[t.optionsKey];delete l[t.optionsKey],e.properties.set(i)}}null!=l.visible&&(t.visible=l.visible),t.properties.set(l),"data"in e&&t.setOptionsData(null==n?void 0:Hh.wrap(n)),a&&this.registerListeners(t,a),"seriesGrouping"in e&&(t.seriesGrouping=null==o?void 0:{...t.seriesGrouping,...o})}createAxis(t,e){const i=[],s=this.getModuleContext();for(let n=0;n<t.length;n++){const a=t[n],o=Yh.create(a.type,s);this.applyAxisModules(o,a),Ja(o,a,{path:`axes[${n}]`,skip:e}),i.push(o)}return function(t){const e=[],i=[],s=[...$p];for(const s of t)s instanceof Gp&&(Hp(s.position)?i.push(s.position):e.push(s));for(const t of e){let e;do{e=s.pop()}while(e&&i.includes(e));if(null==e)break;t.position=e}}(i),i}applyAxisModules(t,e){const i=t.createModuleContext(),s=t.getModuleMap();for(const n of hs.byType("axis-option")){const a=null!=e[n.optionsKey];a!==s.isEnabled(n)&&(a?(s.addModule(n,t=>t.moduleFactory(i)),t[n.optionsKey]=s.getModule(n)):(s.removeModule(n),delete t[n.optionsKey]))}}registerListeners(t,e){t.clearEventListeners();for(const[i,s]of ri(e))t.addEventListener(i,s)}async applyTransaction(t){await this.updateMutex.acquire(()=>{this.data.addTransaction(t),this.update(1,{apiUpdate:!0,skipAnimations:!0})}),await this.waitForUpdate()}};im.chartsInstances=new WeakMap,ls([ro({newValue(t){this.destroyed||(this.ctx.domManager.setContainer(t),im.chartsInstances.set(t,this))},oldValue(t){im.chartsInstances.delete(t)}})],im.prototype,"container",2),ls([ro({newValue(t){this.resize("width option",{inWidth:t})}})],im.prototype,"width",2),ls([ro({newValue(t){this.resize("height option",{inHeight:t})}})],im.prototype,"height",2),ls([ro({newValue(t){this.resize("minWidth option",{inMinWidth:t})}})],im.prototype,"minWidth",2),ls([ro({newValue(t){this.resize("minHeight option",{inMinHeight:t})}})],im.prototype,"minHeight",2),ls([ro({newValue(t){this.resize("overrideDevicePixelRatio option",{inOverrideDevicePixelRatio:t})}})],im.prototype,"overrideDevicePixelRatio",2),ls([ws],im.prototype,"padding",2),ls([ws],im.prototype,"keyboard",2),ls([ws],im.prototype,"touch",2),ls([ws],im.prototype,"mode",2),ls([ws],im.prototype,"styleNonce",2),ls([no("chartCaptions.title")],im.prototype,"title",2),ls([no("chartCaptions.subtitle")],im.prototype,"subtitle",2),ls([no("chartCaptions.footnote")],im.prototype,"footnote",2),ls([ws],im.prototype,"formatter",2),ls([ws],im.prototype,"suppressFieldDotNotation",2),ls([ws],im.prototype,"loadGoogleFonts",2),ls([ro({changeValue(t,e){this.onAxisChange(t,e)}})],im.prototype,"axes",2),ls([ro({changeValue(t,e){this.onSeriesChange(t,e)}})],im.prototype,"series",2);var sm=im;function nm(t,e){let s=[];const n=t?.series?.[0]?.type,a="linear-gauge"===n||"radial-gauge"===n,o=n?td.get(n):"unknown";for(const e of Kh)if("unknown"===o||e.chartTypes.includes(o))if("root"===e.type||"legend"===e.type){const i=t[e.optionsKey];if(null==i)continue;e.optionsInnerKey?i[e.optionsInnerKey]&&(s.push(`${e.optionsKey}.${e.optionsInnerKey}`),delete i[e.optionsInnerKey]):(s.push(e.optionsKey),delete t[e.optionsKey])}else if("axis"===e.type){if(!("axes"in t)||!G(t.axes)||!t.axes?.some(t=>t.type===e.identifier))continue;s.push(`axis[type=${e.identifier}]`),t.axes=t.axes.filter(t=>t.type!==e.identifier)}else if("axis-option"===e.type){if(!("axes"in t)||!G(t.axes)||!t.axes?.some(t=>t[e.optionsKey]))continue;s.push(`axis.${e.optionsKey}`);for(const i of t.axes)i[e.optionsKey]&&delete i[e.optionsKey]}else if("series"===e.type){if(e.community)continue;if(!G(t.series)||!t.series?.some(t=>t.type===e.identifier))continue;s.push(`series[type=${e.identifier}]`),t.series=t.series.filter(t=>t.type!==e.identifier)}else if("series-option"===e.type){if(!G(t.series)||!t.series?.some(t=>t[e.optionsKey]))continue;s.push(`series.${e.optionsKey}`);for(const i of t.series)i[e.optionsKey]&&delete i[e.optionsKey]}if(s.length&&!e){a&&(s=["AgCharts.createGauge"]);let e="ag-charts-enterprise",n="https://www.ag-grid.com/charts/javascript/installation/";"integrated"===t.mode&&(e="ag-grid-charts-enterprise' or 'ag-grid-enterprise/charts-enterprise",n="https://www.ag-grid.com/javascript-data-grid/integrated-charts-installation/"),i.warnOnce([`unable to use these enterprise features as '${e}' has not been loaded:`,"",...s,"",`See: ${n}`].join("\n"))}}function am(t){return t?.up||t?.down||t?.neutral?"user-full":t?.fills||t?.strokes?"user-indexed":"inbuilt"}var om={BLUE:"#5090dc",ORANGE:"#ffa03a",GREEN:"#459d55",CYAN:"#34bfe1",YELLOW:"#e1cc00",VIOLET:"#9669cb",GRAY:"#b5b5b5",MAGENTA:"#bd5aa7",BROWN:"#8a6224",RED:"#ef5452"},rm={BLUE:"#2b5c95",ORANGE:"#cc6f10",GREEN:"#1e652e",CYAN:"#18859e",YELLOW:"#a69400",VIOLET:"#603c88",GRAY:"#575757",MAGENTA:"#7d2f6d",BROWN:"#4f3508",RED:"#a82529"},lm={};rs(lm,{DEFAULT_ANNOTATION_HANDLE_FILL:()=>Em,DEFAULT_ANNOTATION_STATISTICS_COLOR:()=>Pm,DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE:()=>zm,DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL:()=>jm,DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE:()=>Bm,DEFAULT_ANNOTATION_STATISTICS_FILL:()=>Om,DEFAULT_ANNOTATION_STATISTICS_STROKE:()=>Rm,DEFAULT_CAPTION_ALIGNMENT:()=>pm,DEFAULT_CAPTION_LAYOUT_STYLE:()=>um,DEFAULT_FIBONACCI_STROKES:()=>Nm,DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL:()=>Tm,DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR:()=>Cm,DEFAULT_GRIDLINE_ENABLED:()=>Hm,DEFAULT_POLAR_SERIES_STROKE:()=>Am,DEFAULT_SEPARATION_LINES_COLOUR:()=>hm,DEFAULT_SHADOW_COLOUR:()=>dm,DEFAULT_SPARKLINE_CROSSHAIR_STROKE:()=>wm,DEFAULT_TEXTBOX_COLOR:()=>Gm,DEFAULT_TEXTBOX_FILL:()=>Fm,DEFAULT_TEXTBOX_STROKE:()=>Vm,DEFAULT_TEXT_ANNOTATION_COLOR:()=>Lm,DEFAULT_TOOLBAR_POSITION:()=>$m,IS_DARK_THEME:()=>cm,PALETTE_ALT_DOWN_FILL:()=>Im,PALETTE_ALT_DOWN_STROKE:()=>Mm,PALETTE_ALT_NEUTRAL_FILL:()=>Dm,PALETTE_ALT_NEUTRAL_STROKE:()=>km,PALETTE_ALT_UP_FILL:()=>Sm,PALETTE_ALT_UP_STROKE:()=>vm,PALETTE_DOWN_FILL:()=>ym,PALETTE_DOWN_STROKE:()=>mm,PALETTE_NEUTRAL_FILL:()=>bm,PALETTE_NEUTRAL_STROKE:()=>xm,PALETTE_UP_FILL:()=>fm,PALETTE_UP_STROKE:()=>gm});var cm=Symbol("is-dark-theme"),hm=Symbol("default-separation-lines-colour"),dm=Symbol("default-shadow-colour"),um=Symbol("default-caption-layout-style"),pm=Symbol("default-caption-alignment"),gm=Symbol("palette-up-stroke"),mm=Symbol("palette-down-stroke"),fm=Symbol("palette-up-fill"),ym=Symbol("palette-down-fill"),xm=Symbol("palette-neutral-stroke"),bm=Symbol("palette-neutral-fill"),vm=Symbol("palette-alt-up-stroke"),Mm=Symbol("palette-alt-down-stroke"),Sm=Symbol("palette-alt-up-fill"),Im=Symbol("palette-alt-down-fill"),Dm=Symbol("palette-gray-fill"),km=Symbol("palette-gray-stroke"),Am=Symbol("default-polar-series-stroke"),wm=Symbol("default-sparkline-crosshair-stroke"),Cm=Symbol("default-financial-charts-annotation-stroke"),Nm=Symbol("default-hierarchy-strokes"),Lm=Symbol("default-text-annotation-color"),Tm=Symbol("default-financial-charts-annotation-background-fill"),Em=Symbol("default-annotation-handle-fill"),Om=Symbol("default-annotation-statistics-fill"),Rm=Symbol("default-annotation-statistics-stroke"),Pm=Symbol("default-annotation-statistics-color"),zm=Symbol("default-annotation-statistics-divider-stroke"),jm=Symbol("default-annotation-statistics-fill"),Bm=Symbol("default-annotation-statistics-stroke"),Fm=Symbol("default-textbox-fill"),Vm=Symbol("default-textbox-stroke"),Gm=Symbol("default-textbox-color"),$m=Symbol("default-toolbar-position"),Hm=Symbol("default-gridline-enabled"),Um=[{type:"number",position:{$if:[{$eq:[{$path:["/series/0/direction",void 0]},"horizontal"]},"bottom","left"]}},{type:"category",position:{$if:[{$eq:[{$path:["/series/0/direction",void 0]},"horizontal"]},"left","bottom"]}}],Wm={$if:[{$or:[{$isGradient:{$palette:"fill"}},{$isPattern:{$palette:"fill"}},{$isImage:{$value:"$1"}}]},{$palette:"fillFallback"},{$palette:"fill"}]},_m={$if:[{$or:[{$isGradient:{$palette:"fill"}},{$isPattern:{$palette:"fill"}},{$isImage:{$value:"$1"}}]},{$palette:"fillsFallback"},{$palette:"fills"}]},Ym={$if:[{$isGradient:{$palette:"fill"}},{$palette:"fillFallback"},{$if:[{$isPattern:{$palette:"fill"}},{$path:["/stroke",{$palette:"fillFallback"},{$palette:"fill"}]},{$palette:"fill"}]}]},Km={$if:[{$or:[{$isGradient:{$palette:"fill"}},{$isPattern:{$palette:"fill"}},{$isImage:{$value:"$1"}}]},[{$palette:"fillFallback"},{$palette:"fillFallback"}],{$palette:"range2"}]},Zm={type:"gradient",gradient:"linear",bounds:"item",colorStops:[{color:"black"}],rotation:0,reverse:!1,colorSpace:"rgb"},Xm={type:"gradient",gradient:"linear",bounds:"item",colorStops:{$shallow:{$map:[{color:{$value:"$1"}},{$palette:"gradient"}]}},rotation:0,reverse:!1,colorSpace:"rgb"},Qm={...Xm,colorStops:{$shallow:[{color:{$mix:[{$path:["/1",{$palette:"fill"},{$palette:"hierarchyColors"}]},"black",.15]}},{color:{$mix:[{$path:["/1",{$palette:"fill"},{$palette:"hierarchyColors"}]},"white",.15]}}]}},qm={...Xm,colorStops:{$map:[{color:{$value:"$1"}},{$path:["/0",void 0,{$palette:"gradients"}]}]}},Jm=t=>({...Xm,colorStops:{$shallow:{$if:[{$or:[{$isGradient:{$palette:`${t}.fill`}},{$isPattern:{$palette:`${t}.fill`}},{$isImage:{$palette:`${t}.fill`}}]},{$path:["/colorStops",void 0,{$palette:`${t}.fill`}]},[{color:{$mix:[{$palette:`${t}.fill`},"black",.15]}},{color:{$mix:[{$palette:`${t}.fill`},"white",.15]}}]]}}}),tf={type:"gradient",gradient:"radial",bounds:"item",colorStops:{$shallow:{$map:[{color:{$value:"$1"}},{$palette:"gradient"}]}},rotation:0,reverse:!1,colorSpace:"rgb"},ef={...tf,reverse:!0},sf={...tf,bounds:"series"},nf={...tf,bounds:"series",reverse:!0},af={type:"gradient",gradient:"conic",bounds:"series",colorStops:{$map:[{color:{$value:"$1"}},{$palette:"gradient"}]},rotation:0,reverse:!1,colorSpace:"rgb"},of={type:"pattern",pattern:"forward-slanted-lines",width:{$isUserOption:["./height",{$path:"./height"},10]},height:{$isUserOption:["./width",{$path:"./width"},10]},padding:2,fill:{$if:[{$or:[{$isGradient:{$palette:"fill"}},{$isImage:{$palette:"fill"}}]},{$palette:"fillFallback"},{$if:[{$isPattern:{$palette:"fill"}},{$path:["/fill",{$palette:"fillFallback"},{$palette:"fill"}]},{$palette:"fill"}]}]},fillOpacity:1,stroke:Ym,strokeOpacity:1,strokeWidth:{$switch:[{$path:"./pattern"},0,[["backward-slanted-lines","forward-slanted-lines","horizontal-lines","vertical-lines"],4]]},backgroundFill:"none",backgroundFillOpacity:1,rotation:0,scale:1},rf={...of,stroke:{$if:[{$isGradient:{$palette:"fill"}},{$path:["/0",void 0,{$palette:"fillsFallback"}]},{$if:[{$isPattern:{$palette:"fill"}},{$path:["/stroke",{$path:["/0",void 0,{$palette:"fillsFallback"}]},{$path:["/0",void 0,{$palette:"fills"}]}]},{$path:["/0",void 0,{$palette:"fills"}]}]}]},fill:{$if:[{$or:[{$isGradient:{$palette:"fill"}},{$isImage:{$palette:"fill"}}]},{$path:["/0",void 0,{$palette:"fillsFallback"}]},{$if:[{$isPattern:{$palette:"fill"}},{$path:["/fill",{$path:["/0",void 0,{$palette:"fillsFallback"}]},{$path:["/0",void 0,{$palette:"fills"}]}]},{$path:["/0",void 0,{$palette:"fills"}]}]}]}},lf={type:"pattern",pattern:"forward-slanted-lines",width:8,height:8,padding:1,fill:"black",fillOpacity:1,backgroundFill:"white",backgroundFillOpacity:1,stroke:"black",strokeOpacity:1,strokeWidth:1,rotation:0,scale:1},cf={...of,fill:{$path:["/1",{$palette:"fill"},{$palette:"hierarchyColors"}]},stroke:{$path:["/1",{$palette:"fill"},{$palette:"hierarchyColors"}]}},hf={type:"image",backgroundFill:{$palette:"fillFallback"},backgroundFillOpacity:1,repeat:"no-repeat",fit:"contain",rotation:0},df={type:"image",backgroundFill:"black",backgroundFillOpacity:1,rotation:0,repeat:"no-repeat",fit:"contain",width:8,height:8};function uf(t){return Fs(t,t=>{const e=In.fromString(t);return[In.darken(e,.15).toString(),t,In.lighten(e,.15).toString()]})}var pf={stroke:{$path:["../../highlightStyle/item/stroke","rgba(0, 0, 0, 0.4)"]},strokeWidth:{$path:["../../highlightStyle/item/strokeWidth",2]},strokeOpacity:{$path:["../../highlightStyle/item/strokeOpacity",void 0]},opacity:{$path:["../../highlightStyle/item/opacity",{$if:[{$eq:[{$path:["/highlight/drawingMode",void 0]},"cutout"]},.67,1]}]}},gf={...pf,fill:{$path:["../../highlightStyle/item/fill",{$if:[{$eq:[{$path:["/highlight/drawingMode",void 0]},"cutout"]},void 0,"rgba(255,255,255, 0.33)"]}]},fillOpacity:{$path:["../../highlightStyle/item/fillOpacity",void 0]}},mf={padding:8,cornerRadius:4,fill:{$if:[{$and:[{$eq:[{$path:"./fill/type"},"image"]},{$isUserOption:["./fill/backgroundFill",!1,!0]}]},{backgroundFill:"transparent"},void 0]},border:{enabled:{$isUserOption:["../border",!0,!1]},strokeWidth:1,stroke:{$foregroundOpacity:.08}}};function ff(t=!0){return{enabled:!0,highlightedItem:t?gf:pf,unhighlightedItem:{strokeWidth:{$path:["../../highlightStyle/series/strokeWidth",void 0]}},highlightedSeries:{strokeWidth:{$path:["../../highlightStyle/series/strokeWidth",void 0]}},unhighlightedSeries:{opacity:{$path:["../../highlightStyle/series/dimOpacity",void 0]}}}}function yf(t=!0){return{enabled:!0,highlightedItem:t?gf:pf,unhighlightedItem:{strokeWidth:{$path:["../../highlightStyle/series/strokeWidth",void 0]},opacity:{$path:["../../highlightStyle/series/dimOpacity",void 0]}}}}var xf={border:{enabled:!1,stroke:{$foregroundBackgroundMix:.25},strokeOpacity:1,strokeWidth:1},cornerRadius:4,fillOpacity:1,padding:{$if:[{$eq:[{$path:"./border/enabled"},!0]},5,{$isUserOption:["./fill",5,0]}]}},bf={enabled:!1,key:"x",segments:{$apply:[{fill:{$applySwitch:[{$path:"type"},{$path:"../../../fill"},["gradient",Xm],["image",hf],["pattern",of]]},stroke:{$path:"../../../stroke"},fillOpacity:{$path:"../../../fillOpacity"},strokeWidth:{$isUserOption:["./stroke",{$isUserOption:["../../../strokeWidth",{$path:"../../../strokeWidth"},{$if:[{$greaterThan:[{$path:"../../../strokeWidth"},0]},{$path:"../../../strokeWidth"},2]}]},{$path:"../../../strokeWidth"}]},strokeOpacity:{$path:"../../../strokeOpacity"},lineDash:{$path:"../../../lineDash"},lineDashOffset:{$path:"../../../lineDashOffset"}}]}},vf="white",Mf={get cartesian(){return{seriesTypes:td.cartesianTypes,commonOptions:["zoom","navigator"]}},get polar(){return{seriesTypes:td.polarTypes,commonOptions:[]}},get topology(){return{seriesTypes:td.topologyTypes,commonOptions:[]}},get standalone(){return{seriesTypes:td.standaloneTypes,commonOptions:[]}}},Sf={"radial-gauge":!0,"linear-gauge":!0};function If(t){return!0===Sf[t]}var Df=class t{static getDefaultColors(){return{fills:om,fillsFallback:Object.values(om),strokes:rm,sequentialColors:uf(om),divergingColors:[om.ORANGE,om.YELLOW,om.GREEN],hierarchyColors:["#fff","#e0e5ea","#c1ccd5","#a3b4c1","#859cad"],secondSequentialColors:In.interpolate([In.fromHexString(om.BLUE),In.fromHexString("#cbdef5")],8).map(t=>t.toString()),secondDivergingColors:[om.GREEN,om.YELLOW,om.RED],secondHierarchyColors:["#fff","#c5cbd1","#a4b1bd","#8498a9","#648096"],up:{fill:om.GREEN,stroke:rm.GREEN},down:{fill:om.RED,stroke:rm.RED},neutral:{fill:om.GRAY,stroke:rm.GRAY},altUp:{fill:om.BLUE,stroke:rm.BLUE},altDown:{fill:om.ORANGE,stroke:rm.ORANGE},altNeutral:{fill:om.GRAY,stroke:rm.GRAY}}}static getDefaultPublicParameters(){return{accentColor:"#2196f3",axisColor:{$foregroundBackgroundMix:.325},backgroundColor:vf,borderColor:{$foregroundOpacity:.15},borderRadius:4,chartBackgroundColor:{$ref:"backgroundColor"},chartPadding:20,focusShadow:"0 0 0 3px var(--ag-charts-accent-color)",foregroundColor:"#181d1f",fontFamily:"Verdana, sans-serif",fontSize:Qo,fontWeight:400,gridLineColor:{$foregroundBackgroundMix:.1},popupShadow:"0 0 16px rgba(0, 0, 0, 0.15)",subtleTextColor:{$mix:[{$ref:"textColor"},{$ref:"chartBackgroundColor"},.38]},textColor:{$ref:"foregroundColor"},chromeBackgroundColor:{$foregroundBackgroundMix:.02},chromeFontFamily:{$ref:"fontFamily"},chromeFontSize:{$ref:"fontSize"},chromeFontWeight:{$ref:"fontWeight"},chromeTextColor:{$ref:"foregroundColor"},chromeSubtleTextColor:{$mix:[{$ref:"chromeTextColor"},{$ref:"backgroundColor"},.38]},buttonBackgroundColor:{$ref:"backgroundColor"},buttonBorder:!0,buttonFontWeight:400,buttonTextColor:{$ref:"textColor"},inputBackgroundColor:{$ref:"backgroundColor"},inputBorder:!0,inputTextColor:{$ref:"textColor"},menuBackgroundColor:{$ref:"chromeBackgroundColor"},menuBorder:!0,menuTextColor:{$ref:"chromeTextColor"},panelBackgroundColor:{$ref:"chromeBackgroundColor"},panelSubtleTextColor:{$ref:"chromeSubtleTextColor"},tooltipBackgroundColor:{$ref:"chromeBackgroundColor"},tooltipBorder:!0,tooltipTextColor:{$ref:"chromeTextColor"},tooltipSubtleTextColor:{$ref:"chromeSubtleTextColor"},crosshairLabelBackgroundColor:{$ref:"foregroundColor"},crosshairLabelTextColor:{$ref:"chartBackgroundColor"}}}static getAxisDefaults(t,{title:e,time:i}){return zs(t,e&&{title:{enabled:!1,text:"Axis Title",spacing:25,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:qo.MEDIUM},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"}}},i&&{parentLevel:{enabled:!1,label:{enabled:{$path:"../../label/enabled"},border:{enabled:{$or:[{$isUserOption:["../border",!0,!1]},{$path:"../../../label/border/enabled"}]},strokeWidth:{$path:"../../../label/border/strokeWidth"},stroke:{$path:"../../../label/border/stroke"}},fill:{$path:"../../label/fill"},fontSize:{$path:"../../label/fontSize"},fontFamily:{$path:"../../label/fontFamily"},fontWeight:"bold",spacing:{$path:"../../label/spacing"},color:{$path:"../../label/color"},cornerRadius:{$path:"../../label/cornerRadius"},padding:{$path:"../../label/padding"},avoidCollisions:{$path:"../../label/avoidCollisions"}},tick:{enabled:{$path:"../../tick/enabled"},width:{$path:"../../tick/width"},size:{$path:"../../tick/size"},stroke:{$path:"../../tick/stroke"}}}},{label:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},spacing:11,color:{$ref:"textColor"},avoidCollisions:!0,cornerRadius:4,border:{enabled:{$isUserOption:["../border",!0,!1]},strokeWidth:1,stroke:{$foregroundOpacity:.08}},padding:{$if:[{$eq:[{$path:"./border/enabled"},!0]},{left:12,right:12,top:8,bottom:8},void 0]}},line:{enabled:!0,width:1,stroke:{$ref:"axisColor"}},tick:{enabled:!1,size:6,width:1,stroke:{$ref:"axisColor"}},gridLine:{enabled:!0,width:1,style:{$apply:[{fillOpacity:1,stroke:{$ref:"gridLineColor"},strokeWidth:{$path:"../../width"},lineDash:[]},[{fillOpacity:1,stroke:{$ref:"gridLineColor"},strokeWidth:{$path:"../../width"},lineDash:[]}]]}},crossLines:{$apply:[{enabled:!0,fill:{$ref:"foregroundColor"},stroke:{$ref:"foregroundColor"},fillOpacity:.08,strokeWidth:1,label:{fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},padding:5,color:{$ref:"textColor"}}},void 0,{$pathString:["/common/axes/$axisType/crossLines",{axisType:{$path:["/axes/$index/type"]}}]},{$pathString:["/$seriesType/axes/$axisType/crossLines",{seriesType:{$path:["/series/0/type","line"]},axisType:{$path:["/axes/$index/type"]}}]}]}})}getChartDefaults(){return{minHeight:300,minWidth:300,background:{visible:!0,fill:{$ref:"chartBackgroundColor"}},padding:{top:{$ref:"chartPadding"},right:{$ref:"chartPadding"},bottom:{$ref:"chartPadding"},left:{$ref:"chartPadding"}},seriesArea:{border:{enabled:!1,stroke:{$ref:"foregroundColor"},strokeOpacity:1,strokeWidth:1},cornerRadius:4,padding:{$if:[{$eq:[{$path:"./border/enabled"},!0]},5,0]}},keyboard:{enabled:!0},title:{enabled:!1,text:"Title",spacing:{$if:[{$path:"../subtitle/enabled"},10,20]},fontWeight:{$ref:"fontWeight"},fontSize:{$rem:qo.LARGEST},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},wrapping:"hyphenate",layoutStyle:um,textAlign:pm},subtitle:{enabled:!1,text:"Subtitle",spacing:20,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:qo.MEDIUM},fontFamily:{$ref:"fontFamily"},color:{$ref:"subtleTextColor"},wrapping:"hyphenate",layoutStyle:um,textAlign:pm},footnote:{enabled:!1,text:"Footnote",spacing:20,fontSize:{$rem:qo.MEDIUM},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"subtleTextColor"},wrapping:"hyphenate",layoutStyle:um,textAlign:pm},legend:{...xf,enabled:{$and:[{$greaterThan:[{$size:{$path:"/series"}},1]},{$or:[{$isChartType:"cartesian"},{$isChartType:"standalone"},{$and:[{$isChartType:"polar"},{$not:{$isSeriesType:"pie"}},{$not:{$isSeriesType:"donut"}}]}]}]},position:"bottom",orientation:{$if:[{$or:[{$eq:[{$path:"./position"},"left"]},{$eq:[{$path:"./position"},"left-top"]},{$eq:[{$path:"./position"},"left-bottom"]},{$eq:[{$path:"./position"},"right"]},{$eq:[{$path:"./position"},"right-top"]},{$eq:[{$path:"./position"},"right-bottom"]},{$eq:[{$path:"./position/placement"},"left"]},{$eq:[{$path:"./position/placement"},"left-top"]},{$eq:[{$path:"./position/placement"},"left-bottom"]},{$eq:[{$path:"./position/placement"},"right"]},{$eq:[{$path:"./position/placement"},"right-top"]},{$eq:[{$path:"./position/placement"},"right-bottom"]}]},"vertical","horizontal"]},spacing:30,listeners:{},toggleSeries:!0,item:{paddingX:16,paddingY:8,marker:{size:15,padding:8},showSeriesStroke:!0,label:{color:{$ref:"textColor"},fontSize:{$rem:qo.SMALL},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"}}},reverseOrder:!1,pagination:{marker:{size:12},activeStyle:{fill:{$ref:"foregroundColor"}},inactiveStyle:{fill:{$ref:"subtleTextColor"}},highlightStyle:{fill:{$ref:"foregroundColor"}},label:{color:{$ref:"textColor"}}},fill:{$if:[{$path:["./position/floating",!1]},{$ref:"chartBackgroundColor"},"transparent"]}},tooltip:{enabled:!0,darkTheme:cm,delay:0,pagination:!1,mode:{$if:[{$or:[{$and:[{$isChartType:"cartesian"},{$not:{$hasSeriesType:"bubble"}},{$not:{$hasSeriesType:"scatter"}},{$greaterThan:[{$size:{$path:"/series"}},1]},{$lessThan:[{$size:{$path:"/series"}},4]}]},{$and:[{$isChartType:"polar"},{$greaterThan:[{$size:{$path:"/series"}},1]},{$lessThan:[{$size:{$path:"/series"}},4]}]}]},"shared","single"]}},overlays:{darkTheme:cm},listeners:{},series:{tooltip:{range:{$path:["/tooltip/range","exact"]},position:{anchorTo:{$path:["/tooltip/position/anchorTo","pointer"]},placement:{$path:["/tooltip/position/placement",void 0]},xOffset:{$path:["/tooltip/position/xOffset",0]},yOffset:{$path:["/tooltip/position/yOffset",0]}}}}}}constructor(t={}){const{overrides:e,palette:i,params:s}=Xa(t),n=this.createChartConfigPerChartType(this.getDefaults()),a={};e&&this.processOverrides(a,e);const{fills:o,strokes:r,sequentialColors:l,...c}=this.getDefaultColors();this.palette=_s(zs(i,{fills:Object.values(o),strokes:Object.values(r),sequentialColors:Object.values(l),...c})),this.paletteType=am(i),this.params=zs(s,this.getPublicParameters()),this.config=_s(Xa(n)),this.overrides=_s(e),this.presets=_s(a)}processOverrides(t,e){for(const i of td.seriesTypes){const s=i,n=e[s];If(s)&&(t[s]=n,delete e[s])}}createChartConfigPerChartType(t){for(const[e,{seriesTypes:i}]of ri(Mf)){const s=id.get(e);for(const e of i)t[e]??(t[e]=s)}return t}getDefaults(){const e=(e,i)=>{const s={},n={axes:{},...Qh.getThemeTemplates(),...this.getChartDefaults(),...id.get(e)};for(const e of i){s[e]=zs(sd.getThemeTemplate(e),s[e]??n);const{axes:i}=s[e];for(const e of Yh.keys())i[e]=zs(i[e],Yh.getThemeTemplate(e),t.axisDefault[e]);"map-shape-background"!==e&&"map-line-background"!==e||delete s[e].series.tooltip}return s};return zs(e("cartesian",td.cartesianTypes),e("polar",td.polarTypes),e("topology",td.topologyTypes),e("standalone",td.standaloneTypes))}static applyTemplateTheme(t,e,i){if(G(t))for(let e=0;e<t.length;e++){const s=t[e];"symbol"==typeof s&&i?.has(s)&&(t[e]=i.get(s))}else for(const e of Object.keys(t)){const s=t[e];"symbol"==typeof s&&i?.has(s)&&(t[e]=i.get(s))}}templateTheme(e,i=!0){const s=i?Xa(e):e,n=this.getTemplateParameters();return qa(s,t.applyTemplateTheme,void 0,void 0,n),s}getDefaultColors(){return t.getDefaultColors()}getPublicParameters(){return t.getDefaultPublicParameters()}getTemplateParameters(){const t=new Map;t.set(cm,!1),t.set(hm,"#d9d9d9"),t.set(dm,"#00000080"),t.set(wm,"#aaa"),t.set(um,"block"),t.set(pm,"center"),t.set(Nm,["#797b86","#e24c4a","#f49d2d","#65ab58","#409682","#4db9d2","#5090dc","#3068f9","#e24c4a","#913aac","#d93e64"]),t.set(Am,vf),t.set(Cm,om.BLUE),t.set(Tm,om.BLUE),t.set(Lm,om.BLUE),t.set(Em,vf),t.set(Om,"#fafafa"),t.set(Rm,"#ddd"),t.set(Pm,"#000"),t.set(zm,"#181d1f"),t.set(jm,"#e35c5c"),t.set(Bm,"#e35c5c"),t.set(Fm,"#fafafa"),t.set(Vm,"#ddd"),t.set(Gm,"#000"),t.set($m,"top"),t.set(Hm,!1);const e=this.getDefaultColors();return t.set(gm,this.palette.up?.stroke??e.up.stroke),t.set(fm,this.palette.up?.fill??e.up.fill),t.set(mm,this.palette.down?.stroke??e.down.stroke),t.set(ym,this.palette.down?.fill??e.down.fill),t.set(xm,this.palette.neutral?.stroke??e.neutral.stroke),t.set(bm,this.palette.neutral?.fill??e.neutral.fill),t.set(vm,this.palette.altUp?.stroke??e.up.stroke),t.set(Sm,this.palette.altUp?.fill??e.up.fill),t.set(Mm,this.palette.altDown?.stroke??e.down.stroke),t.set(Im,this.palette.altDown?.fill??e.down.fill),t.set(Dm,this.palette.altNeutral?.fill??e.altNeutral.fill),t.set(km,this.palette.altNeutral?.stroke??e.altNeutral.stroke),t}};Df.axisDefault={number:Df.getAxisDefaults({keys:[],line:{enabled:!1},crosshair:{enabled:!0}},{title:!0,time:!1}),log:Df.getAxisDefaults({keys:[],base:10,line:{enabled:!1},crosshair:{enabled:!0}},{title:!0,time:!1}),category:Df.getAxisDefaults({keys:[],groupPaddingInner:.1,label:{autoRotate:!0,wrapping:"on-space"},gridLine:{enabled:Hm},crosshair:{enabled:!1}},{title:!0,time:!1}),"grouped-category":Df.getAxisDefaults({keys:[],tick:{enabled:!0,stroke:hm},label:{spacing:10,rotation:270,wrapping:"on-space"},maxThicknessRatio:.5,paddingInner:.4,groupPaddingInner:.2,crosshair:{enabled:!1}},{title:!0,time:!1}),time:Df.getAxisDefaults({keys:[],gridLine:{enabled:Hm},crosshair:{enabled:!0}},{title:!0,time:!0}),"unit-time":Df.getAxisDefaults({keys:[],groupPaddingInner:.1,label:{autoRotate:!1},gridLine:{enabled:Hm},crosshair:{enabled:!0},parentLevel:{enabled:!0}},{title:!0,time:!0}),"ordinal-time":Df.getAxisDefaults({keys:[],groupPaddingInner:0,label:{autoRotate:!1},gridLine:{enabled:Hm},crosshair:{enabled:!0}},{title:!0,time:!0}),"angle-category":Df.getAxisDefaults({label:{spacing:5},gridLine:{enabled:Hm},shape:{$findFirstSiblingNotOperation:void 0}},{title:!1,time:!1}),"angle-number":Df.getAxisDefaults({label:{spacing:5},gridLine:{enabled:Hm}},{title:!1,time:!1}),"radius-category":Df.getAxisDefaults({positionAngle:0,line:{enabled:!1},label:{minSpacing:5}},{title:!0,time:!1}),"radius-number":Df.getAxisDefaults({positionAngle:0,line:{enabled:!1},shape:{$findFirstSiblingNotOperation:void 0},label:{minSpacing:5}},{title:!0,time:!1})};var kf=Df,Af="#192232",wf={BLUE:"#5090dc",ORANGE:"#ffa03a",GREEN:"#459d55",CYAN:"#34bfe1",YELLOW:"#e1cc00",VIOLET:"#9669cb",GRAY:"#b5b5b5",MAGENTA:"#bd5aa7",BROWN:"#8a6224",RED:"#ef5452"},Cf={BLUE:"#74a8e6",ORANGE:"#ffbe70",GREEN:"#6cb176",CYAN:"#75d4ef",YELLOW:"#f6e559",VIOLET:"#aa86d8",GRAY:"#a1a1a1",MAGENTA:"#ce7ab9",BROWN:"#997b52",RED:"#ff7872"},Nf=class extends kf{getDefaultColors(){return{fills:wf,fillsFallback:Object.values(wf),strokes:Cf,sequentialColors:uf(wf),divergingColors:[wf.ORANGE,wf.YELLOW,wf.GREEN],hierarchyColors:["#192834","#253746","#324859","#3f596c","#4d6a80"],secondSequentialColors:["#5090dc","#4882c6","#4073b0","#38659a","#305684","#28486e","#203a58","#182b42"],secondDivergingColors:[wf.GREEN,wf.YELLOW,wf.RED],secondHierarchyColors:["#192834","#3b5164","#496275","#577287","#668399"],up:{fill:wf.GREEN,stroke:Cf.GREEN},down:{fill:wf.RED,stroke:Cf.RED},neutral:{fill:wf.GRAY,stroke:Cf.GRAY},altUp:{fill:wf.BLUE,stroke:Cf.BLUE},altDown:{fill:wf.ORANGE,stroke:Cf.ORANGE},altNeutral:{fill:wf.GRAY,stroke:Cf.GRAY}}}getPublicParameters(){return{...super.getPublicParameters(),axisColor:{$foregroundBackgroundMix:.737},backgroundColor:Af,borderColor:{$foregroundBackgroundMix:.216},chromeBackgroundColor:{$foregroundBackgroundMix:.07},foregroundColor:"#fff",gridLineColor:{$foregroundBackgroundMix:.257},popupShadow:"0 0 16px rgba(0, 0, 0, 0.33)",subtleTextColor:{$mix:[{$ref:"textColor"},{$ref:"chartBackgroundColor"},.57]},crosshairLabelBackgroundColor:{$foregroundBackgroundMix:.65}}}getTemplateParameters(){const t=super.getTemplateParameters();return t.set(cm,!0),t.set(Am,Af),t.set(hm,"#7f8389"),t.set(Cm,wf.BLUE),t.set(Lm,"#fff"),t.set(Tm,wf.BLUE),t.set(Em,Af),t.set(Om,"#28313e"),t.set(Rm,"#4b525d"),t.set(Pm,"#fff"),t.set(zm,"#fff"),t.set(Fm,"#28313e"),t.set(Vm,"#4b525d"),t.set(Gm,"#fff"),t}constructor(t){super(t)}},Lf={GREEN:"#089981",RED:"#F23645",BLUE:"#5090dc",GRAY:"#A9A9A9"},Tf={GREEN:"#089981",RED:"#F23645",BLUE:"#5090dc",GRAY:"#909090"},Ef=class extends Nf{getDefaultColors(){return{...super.getDefaultColors(),fills:{...Lf},fillsFallback:Object.values({...Lf}),strokes:{...Tf},sequentialColors:uf(Lf),divergingColors:[Lf.GREEN,Lf.BLUE,Lf.RED],secondSequentialColors:["#5090dc","#4882c6","#4073b0","#38659a","#305684","#28486e","#203a58","#182b42"],up:{fill:Lf.GREEN,stroke:Tf.GREEN},down:{fill:Lf.RED,stroke:Tf.RED},neutral:{fill:Lf.BLUE,stroke:Tf.BLUE},altUp:{fill:Lf.GREEN,stroke:Tf.GREEN},altDown:{fill:Lf.RED,stroke:Tf.RED},altNeutral:{fill:Lf.GRAY,stroke:Tf.GRAY}}}getPublicParameters(){return{...super.getPublicParameters(),chartPadding:0,gridLineColor:{$foregroundBackgroundMix:.12}}}getTemplateParameters(){const t=super.getTemplateParameters();return t.set(Cm,Lf.BLUE),t.set(Tm,Lf.BLUE),t.set(um,"overlay"),t.set(pm,"left"),t.set($m,"bottom"),t.set(Hm,!0),t}},Of={GREEN:"#089981",RED:"#F23645",BLUE:"#5090dc",GRAY:"#A9A9A9"},Rf={GREEN:"#089981",RED:"#F23645",BLUE:"#5090dc",GRAY:"#909090"},Pf=class extends kf{getDefaultColors(){return{...super.getDefaultColors(),fills:{...Of},fillsFallback:Object.values({...Of}),strokes:{...Rf},sequentialColors:uf(Of),divergingColors:[Of.GREEN,Of.BLUE,Of.RED],up:{fill:Of.GREEN,stroke:Rf.GREEN},down:{fill:Of.RED,stroke:Rf.RED},neutral:{fill:Of.BLUE,stroke:Rf.BLUE},altUp:{fill:Of.GREEN,stroke:Rf.GREEN},altDown:{fill:Of.RED,stroke:Rf.RED},altNeutral:{fill:Of.GRAY,stroke:Rf.GRAY}}}getPublicParameters(){return{...super.getPublicParameters(),chartPadding:0,gridLineColor:{$foregroundBackgroundMix:.06}}}getTemplateParameters(){const t=super.getTemplateParameters();return t.set(Cm,Of.BLUE),t.set(Tm,Of.BLUE),t.set(um,"overlay"),t.set(pm,"left"),t.set($m,"bottom"),t.set(Hm,!0),t}},zf={BLUE:"#2196F3",ORANGE:"#FF9800",GREEN:"#4CAF50",CYAN:"#00BCD4",YELLOW:"#FFEB3B",VIOLET:"#7E57C2",GRAY:"#9E9E9E",MAGENTA:"#F06292",BROWN:"#795548",RED:"#F44336"},jf={BLUE:"#90CAF9",ORANGE:"#FFCC80",GREEN:"#A5D6A7",CYAN:"#80DEEA",YELLOW:"#FFF9C4",VIOLET:"#B39DDB",GRAY:"#E0E0E0",MAGENTA:"#F48FB1",BROWN:"#A1887F",RED:"#EF9A9A"},Bf=class extends Nf{getDefaultColors(){return{...super.getDefaultColors(),fills:zf,fillsFallback:Object.values(zf),strokes:jf,sequentialColors:uf(zf),divergingColors:[zf.ORANGE,zf.YELLOW,zf.GREEN],secondSequentialColors:["#2196f3","#208FEC","#1E88E5","#1C7FDC","#1976d2","#176EC9","#1565c0"],secondDivergingColors:[zf.GREEN,zf.YELLOW,zf.RED],up:{fill:zf.GREEN,stroke:jf.GREEN},down:{fill:zf.RED,stroke:jf.RED},neutral:{fill:zf.GRAY,stroke:jf.GRAY},altUp:{fill:zf.BLUE,stroke:jf.BLUE},altDown:{fill:zf.RED,stroke:jf.RED},altNeutral:{fill:zf.GRAY,stroke:jf.GRAY}}}getTemplateParameters(){const t=super.getTemplateParameters();return t.set(Cm,zf.BLUE),t.set(Tm,zf.BLUE),t}},Ff={BLUE:"#2196F3",ORANGE:"#FF9800",GREEN:"#4CAF50",CYAN:"#00BCD4",YELLOW:"#FFEB3B",VIOLET:"#7E57C2",GRAY:"#9E9E9E",MAGENTA:"#F06292",BROWN:"#795548",RED:"#F44336"},Vf={BLUE:"#1565C0",ORANGE:"#E65100",GREEN:"#2E7D32",CYAN:"#00838F",YELLOW:"#F9A825",VIOLET:"#4527A0",GRAY:"#616161",MAGENTA:"#C2185B",BROWN:"#4E342E",RED:"#B71C1C"},Gf=class extends kf{getDefaultColors(){return{...super.getDefaultColors(),fills:Ff,fillsFallback:Object.values(Ff),strokes:Vf,sequentialColors:uf(Ff),divergingColors:[Ff.ORANGE,Ff.YELLOW,Ff.GREEN],secondSequentialColors:["#2196f3","#329EF4","#42a5f5","#53ADF6","#64b5f6","#7AC0F8","#90caf9"],secondDivergingColors:[Ff.GREEN,Ff.YELLOW,Ff.RED],up:{fill:Ff.GREEN,stroke:Vf.GREEN},down:{fill:Ff.RED,stroke:Vf.RED},neutral:{fill:Ff.GRAY,stroke:Vf.GRAY},altUp:{fill:Ff.BLUE,stroke:Vf.BLUE},altDown:{fill:Ff.RED,stroke:Vf.RED},altNeutral:{fill:Ff.GRAY,stroke:Vf.GRAY}}}getTemplateParameters(){const t=super.getTemplateParameters();return t.set(Cm,Ff.BLUE),t.set(Tm,Ff.BLUE),t}},$f={BLUE:"#436ff4",PURPLE:"#9a7bff",MAGENTA:"#d165d2",PINK:"#f0598b",RED:"#f47348",ORANGE:"#f2a602",YELLOW:"#e9e201",GREEN:"#21b448",CYAN:"#00b9a2",MODERATE_BLUE:"#00aee4",GRAY:"#bbbbbb"},Hf={BLUE:"#6698ff",PURPLE:"#c0a3ff",MAGENTA:"#fc8dfc",PINK:"#ff82b1",RED:"#ff9b70",ORANGE:"#ffcf4e",YELLOW:"#ffff58",GREEN:"#58dd70",CYAN:"#51e2c9",MODERATE_BLUE:"#4fd7ff",GRAY:"#eeeeee"},Uf=class extends Nf{getDefaultColors(){return{fills:$f,fillsFallback:Object.values($f),strokes:Hf,sequentialColors:uf($f),divergingColors:[$f.BLUE,$f.RED],hierarchyColors:[],secondSequentialColors:[$f.BLUE,$f.PURPLE,$f.MAGENTA,$f.PINK,$f.RED,$f.ORANGE,$f.YELLOW,$f.GREEN],secondDivergingColors:[$f.BLUE,$f.RED],secondHierarchyColors:[],up:{fill:$f.GREEN,stroke:Hf.GREEN},down:{fill:$f.RED,stroke:Hf.RED},neutral:{fill:$f.GRAY,stroke:Hf.GRAY},altUp:{fill:$f.BLUE,stroke:Hf.BLUE},altDown:{fill:$f.RED,stroke:Hf.RED},altNeutral:{fill:$f.GRAY,stroke:Hf.GRAY}}}getTemplateParameters(){const t=super.getTemplateParameters();return t.set(Cm,$f.BLUE),t.set(Tm,$f.BLUE),t}},Wf={BLUE:"#436ff4",PURPLE:"#9a7bff",MAGENTA:"#d165d2",PINK:"#f0598b",RED:"#f47348",ORANGE:"#f2a602",YELLOW:"#e9e201",GREEN:"#21b448",CYAN:"#00b9a2",MODERATE_BLUE:"#00aee4",GRAY:"#bbbbbb"},_f={BLUE:"#2346c9",PURPLE:"#7653d4",MAGENTA:"#a73da9",PINK:"#c32d66",RED:"#c84b1c",ORANGE:"#c87f00",YELLOW:"#c1b900",GREEN:"#008c1c",CYAN:"#00927c",MODERATE_BLUE:"#0087bb",GRAY:"#888888"},Yf=class extends kf{getDefaultColors(){return{...super.getDefaultColors(),fills:Wf,fillsFallback:Object.values(Wf),strokes:_f,sequentialColors:uf(Wf),divergingColors:[Wf.BLUE,Wf.RED],hierarchyColors:[],secondSequentialColors:[Wf.BLUE,Wf.PURPLE,Wf.MAGENTA,Wf.PINK,Wf.RED,Wf.ORANGE,Wf.YELLOW,Wf.GREEN],secondDivergingColors:[Wf.BLUE,Wf.RED],secondHierarchyColors:[],up:{fill:Wf.GREEN,stroke:_f.GREEN},down:{fill:Wf.RED,stroke:_f.RED},neutral:{fill:Wf.GRAY,stroke:_f.GRAY},altUp:{fill:Wf.BLUE,stroke:_f.BLUE},altDown:{fill:Wf.RED,stroke:_f.RED},altNeutral:{fill:Wf.GRAY,stroke:_f.GRAY}}}getTemplateParameters(){const t=super.getTemplateParameters();return t.set(Cm,Wf.BLUE),t.set(Tm,Wf.BLUE),t}},Kf={BLUE:"#4472C4",ORANGE:"#ED7D31",GRAY:"#A5A5A5",YELLOW:"#FFC000",MODERATE_BLUE:"#5B9BD5",GREEN:"#70AD47",DARK_GRAY:"#7B7B7B",DARK_BLUE:"#264478",VERY_DARK_GRAY:"#636363",DARK_YELLOW:"#997300"},Zf={BLUE:"#6899ee",ORANGE:"#ffa55d",GRAY:"#cdcdcd",YELLOW:"#ffea53",MODERATE_BLUE:"#82c3ff",GREEN:"#96d56f",DARK_GRAY:"#a1a1a1",DARK_BLUE:"#47689f",VERY_DARK_GRAY:"#878787",DARK_YELLOW:"#c0993d"},Xf=class extends Nf{getDefaultColors(){return{...super.getDefaultColors(),fills:{...Kf,RED:Kf.ORANGE},fillsFallback:Object.values({...Kf,RED:Kf.ORANGE}),strokes:{...Zf,RED:Zf.ORANGE},sequentialColors:uf({...Kf,RED:Kf.ORANGE}),divergingColors:[Kf.ORANGE,Kf.YELLOW,Kf.GREEN],secondSequentialColors:["#5090dc","#4882c6","#4073b0","#38659a","#305684","#28486e","#203a58","#182b42"],secondDivergingColors:[Kf.GREEN,Kf.YELLOW,Kf.ORANGE],up:{fill:Kf.GREEN,stroke:Zf.GREEN},down:{fill:Kf.ORANGE,stroke:Zf.ORANGE},neutral:{fill:Kf.GRAY,stroke:Zf.GRAY},altUp:{fill:Kf.BLUE,stroke:Zf.BLUE},altDown:{fill:Kf.ORANGE,stroke:Zf.ORANGE},altNeutral:{fill:Kf.GRAY,stroke:Zf.GRAY}}}getTemplateParameters(){const t=super.getTemplateParameters();return t.set(Cm,Kf.BLUE),t.set(Tm,Kf.BLUE),t}},Qf={BLUE:"#5281d5",ORANGE:"#ff8d44",GRAY:"#b5b5b5",YELLOW:"#ffd02f",MODERATE_BLUE:"#6aabe6",GREEN:"#7fbd57",DARK_GRAY:"#8a8a8a",DARK_BLUE:"#335287",VERY_DARK_GRAY:"#717171",DARK_YELLOW:"#a98220"},qf={BLUE:"#214d9b",ORANGE:"#c25600",GRAY:"#7f7f7f",YELLOW:"#d59800",MODERATE_BLUE:"#3575ac",GREEN:"#4b861a",DARK_GRAY:"#575757",DARK_BLUE:"#062253",VERY_DARK_GRAY:"#414141",DARK_YELLOW:"#734f00"},Jf=class extends kf{getDefaultColors(){return{...super.getDefaultColors(),fills:{...Qf,RED:Qf.ORANGE},fillsFallback:Object.values({...Qf,RED:Qf.ORANGE}),strokes:{...qf,RED:qf.ORANGE},sequentialColors:uf({...Qf,RED:Qf.ORANGE}),divergingColors:[Qf.ORANGE,Qf.YELLOW,Qf.GREEN],secondSequentialColors:["#5090dc","#629be0","#73a6e3","#85b1e7","#96bcea","#a8c8ee","#b9d3f1","#cbdef5"],secondDivergingColors:[Qf.GREEN,Qf.YELLOW,Qf.ORANGE],secondHierarchyColors:[],up:{fill:Qf.GREEN,stroke:qf.GREEN},down:{fill:Qf.ORANGE,stroke:qf.ORANGE},neutral:{fill:qf.GRAY,stroke:qf.GRAY},altUp:{fill:Qf.BLUE,stroke:qf.BLUE},altDown:{fill:Qf.ORANGE,stroke:qf.ORANGE},altNeutral:{fill:Qf.GRAY,stroke:qf.GRAY}}}getTemplateParameters(){const t=super.getTemplateParameters();return t.set(Cm,Qf.BLUE),t.set(Tm,Qf.BLUE),t}},ty=["top","top-right","top-left","bottom","bottom-right","bottom-left","right","right-top","right-bottom","left","left-top","left-bottom"],ey={floating:Zt,placement:ue(...ty),xOffset:te,yOffset:te},iy=Bt((t,e)=>{let i;if("string"==typeof t)ty.includes(t)?i=!0:(i={valid:!1,invalid:[],cleared:null},i.invalid.push(new Pt(Ot.Invalid,`a legend placement string: ["${ty.join('", "')}"]`,t,e.path)));else{const{cleared:e,invalid:s}=jt(t,ey);i={valid:0===s.length,cleared:e,invalid:s}}return i},"a legend position object or placement string"),sy=_t(ue("circle","cross","diamond","heart","plus","pin","square","star","triangle"),Xt),ny=ue("never","always","hyphenate","on-space"),ay=ue("top","right","bottom","left","top-right","bottom-right","bottom-left","top-left","center"),oy=_t(re,ue("exact","nearest")),ry=_t(ie,Vt(te),Vt(qt),me({text:Ft(ie),...We},"text segments array")),ly=ue("pointer","start","middle","end"),cy={enabled:Zt,text:ry,textAlign:ue("left","center","right"),wrapping:ue("never","always","hyphenate","on-space"),spacing:re,maxWidth:re,maxHeight:re,...We};cy.padding=Vt(re);var hy={enabled:Zt,text:ry,renderer:fe(_t(ie,se))},dy=["defaults","download","zoom-to-cursor","pan-to-cursor","reset-zoom","toggle-series-visibility","toggle-other-series","separator"],uy={type:ue("action","separator"),showOn:ue("always","series-area","series-node","legend-item"),label:Ft(ie),enabled:Zt,action:Xt,items:(t,e)=>my(t,e)};uy.iconUrl=Vt(ie);var py=Ht(uy),gy=Bt((t,e)=>{let i;return"string"==typeof t?dy.includes(t)?i=!0:(i={valid:!1,invalid:[],cleared:null},i.invalid.push(new Pt(Ot.Invalid,`a context menu item string alias: ["${dy.join('", "')}"]`,t,e.path))):i=py(t,e),i},`a context menu item object or string alias: [${dy.join(", ")}]`),my=ge(gy,"a menu items array",!1),fy={label:ie,ariaLabel:ie,tooltip:ie,icon:ue("align-center","align-left","align-right","arrow-drawing","arrow-down-drawing","arrow-up-drawing","callout-annotation","candlestick-series","close","comment-annotation","date-range-drawing","date-price-range-drawing","delete","disjoint-channel-drawing","drag-handle","fill-color","line-style-solid","line-style-dashed","line-style-dotted","high-low-series","hlc-series","hollow-candlestick-series","horizontal-line-drawing","line-color","line-series","line-with-markers-series","locked","measurer-drawing","note-annotation","ohlc-series","pan-end","pan-left","pan-right","pan-start","parallel-channel-drawing","position-bottom","position-center","position-top","price-label-annotation","price-range-drawing","reset","settings","step-line-series","text-annotation","trend-line-drawing","fibonacci-retracement-drawing","fibonacci-retracement-trend-based-drawing","unlocked","vertical-line-drawing","zoom-in","zoom-out")},yy=_t(ie,fe(ry)),xy=Ht({x:yy,y:yy,angle:yy,radius:yy,size:yy,color:yy,label:yy,secondaryLabel:yy,sectorLabel:yy,calloutLabel:yy,legendItem:yy}),by=Bt(function(t){if(!Z(t))return!1;const e=tt.exec(t);return J.test(e?e[2]:t)},"a valid number format string"),vy={width:re,height:re,minWidth:re,minHeight:re,suppressFieldDotNotation:Zt,title:cy,subtitle:cy,footnote:cy,padding:{top:re,right:re,bottom:re,left:re},seriesArea:{border:Ke,clip:Zt,cornerRadius:te,padding:Ye},legend:{enabled:Zt,position:iy,orientation:ue("horizontal","vertical"),maxWidth:re,maxHeight:re,spacing:re,border:Ke,cornerRadius:te,padding:Ye,fill:Te,fillOpacity:ce,preventHidingAll:Zt,reverseOrder:Zt,toggleSeries:Zt,item:{marker:{size:re,shape:sy,padding:re,strokeWidth:re},line:{length:re,strokeWidth:re},label:{maxLength:re,formatter:Xt,...We},maxWidth:re,paddingX:re,paddingY:re,showSeriesStroke:Zt},pagination:{marker:{size:re,shape:sy,padding:re},activeStyle:{...Ee,...Ae},inactiveStyle:{...Ee,...Ae},highlightStyle:{...Ee,...Ae},label:We},listeners:{legendItemClick:Xt,legendItemDoubleClick:Xt}},gradientLegend:{enabled:Zt,position:iy,spacing:re,reverseOrder:Zt,border:Ke,cornerRadius:te,padding:Ye,fill:Te,fillOpacity:ce,gradient:{preferredLength:re,thickness:re},scale:{label:{...We,minSpacing:re,format:by,formatter:Xt},padding:re,interval:{step:te,values:Kt,minSpacing:Wt(re,he("maxSpacing")),maxSpacing:Wt(re,de("minSpacing"))}}},listeners:{seriesNodeClick:Xt,seriesNodeDoubleClick:Xt,seriesVisibilityChange:Xt,click:Xt,doubleClick:Xt,annotations:Xt,zoom:Xt},loadGoogleFonts:Zt,highlight:{drawingMode:ue("overlay","cutout"),range:ue("tooltip","node")},overlays:{loading:hy,noData:hy,noVisibleSeries:hy,unsupportedBrowser:hy},tooltip:{enabled:Zt,showArrow:Zt,pagination:Zt,delay:re,range:oy,wrapping:ny,mode:ue("single","shared","compact"),position:{anchorTo:ue("pointer","node","chart"),placement:_t(ay,ge(ay)),xOffset:te,yOffset:te}},animation:{enabled:Zt,duration:re},contextMenu:{enabled:Zt,items:my},context:()=>!0,dataSource:{getData:Xt},keyboard:{enabled:Zt,tabIndex:te},touch:{dragAction:ue("none","drag","hover")},ranges:{enabled:Zt,buttons:me({...fy,value:_t(te,Wt(ge(_t(te,qt)),ne(2,2)),Xt)},"range button options array")},locale:{localeText:ee,getLocaleText:fe(ie)},background:{visible:Zt,fill:Qt,image:{url:Ft(ie),top:te,right:te,bottom:te,left:te,width:re,height:re,opacity:ce}},styleNonce:ie,sync:{enabled:Zt,groupId:ie,axes:ue("x","y","xy"),nodeInteraction:Zt,zoom:Zt},zoom:{enabled:Zt,enableAxisDragging:Zt,enableAxisScrolling:Zt,enableDoubleClickToReset:Zt,enablePanning:Zt,enableScrolling:Zt,enableSelecting:Zt,enableTwoFingerZoom:Zt,keepAspectRatio:Zt,anchorPointX:ly,anchorPointY:ly,axisDraggingMode:ue("pan","zoom"),axes:ue("x","y","xy"),deceleration:_t(ue("off","short","long"),ce),minVisibleItems:re,panKey:ue("alt","ctrl","meta","shift"),scrollingStep:ce,autoScaling:{enabled:Zt,padding:ce},buttons:{enabled:Zt,buttons:me({...fy,value:ue("reset","zoom-in","zoom-out","pan-left","pan-right","pan-start","pan-end"),section:ie},"zoom button options array"),visible:ue("always","zoomed","hover")}},formatter:_t(fe(ry),xy)};vy.dataSource.requestThrottle=Vt(re),vy.dataSource.updateThrottle=Vt(re),vy.dataSource.updateDuringInteraction=Vt(Zt),vy.zoom.enableIndependentAxes=Vt(Zt),vy.statusBar=Vt(Jt),vy.foreground=Vt({visible:Zt,text:ie,image:{url:ie,top:te,right:te,bottom:te,left:te,width:re,height:re,opacity:ce},...Ee}),vy.overrideDevicePixelRatio=Vt(te),vy.sync.domainMode=Vt(ue("direction","position","key"));var My={cursor:ie,context:()=>!0,showInLegend:Zt,nodeClickRange:oy,listeners:{seriesNodeClick:Xt,seriesNodeDoubleClick:Xt},highlightStyle:{item:{...Ee,...Ae},series:{enabled:Zt,dimOpacity:ce,strokeWidth:re}},highlight:je(ze)},Sy={...My,id:ie,visible:Zt,context:()=>!0,data:Kt};Sy.seriesGrouping=Vt(Jt);var Iy={shape:sy,size:re,...Ee,...Ae,...Oe},Dy={enabled:Zt,itemStyler:ye({...Ee,...Ae,...Oe,shape:sy,size:re}),...Iy},ky={enabled:Zt,formatter:fe(ry),format:by,itemStyler:ye({enabled:Zt,...Ze,...We}),...Ze,...We},Ay={...ky,lineHeight:re,minimumFontSize:re,wrapping:ny,overflowStrategy:ue("ellipsis","hide")},wy={visible:Zt,cap:{visible:Zt,length:re,lengthRatio:ce,...Ae,...Oe},...Ae,...Oe},Cy={...wy,xLowerKey:ie,xUpperKey:ie,yLowerKey:ie,yUpperKey:ie,xLowerName:ie,xUpperName:ie,yLowerName:ie,yUpperName:ie,itemStyler:ye({visible:Zt,...Ae,...Oe,cap:{visible:Zt,length:re,lengthRatio:ce,...Ae,...Oe}})},Ny={enabled:Zt,showArrow:Zt,range:oy,renderer:fe(_t(ie,Ht({heading:ie,title:ie,data:me({label:Ft(ie),value:Ft(ie)})},"tooltip renderer result object"))),position:{anchorTo:ue("node","pointer","chart"),placement:_t(ay,ge(ay)),xOffset:te,yOffset:te},interaction:{enabled:Zt}},Ly={enabled:Zt,xOffset:te,yOffset:te,blur:re,color:Qt},Ty=Ut({linear:{},smooth:{tension:ce},step:{position:ue("start","middle","end")}},"interpolation line options"),Ey={fills:Wt(ne(2),ge(Ht({color:Qt,stop:te},"")),Se),fillMode:ue("continuous","discrete")},Oy={value:Ft(te),text:ie,shape:_t(ue("circle","cross","diamond","heart","plus","pin","square","star","triangle","line"),Xt),placement:ue("before","after","middle"),spacing:re,size:re,rotation:te,...Ee,...Ae,...Oe},Ry={value:Ft(te),text:ie,shape:_t(ue("circle","cross","diamond","heart","plus","pin","square","star","triangle","line"),Xt),placement:ue("inside","outside","middle"),spacing:re,size:re,rotation:te,label:{...ky,spacing:re},...Ee,...Ae,...Oe},Py={direction:ue("horizontal","vertical"),cornerMode:ue("container","item"),cornerRadius:re,thickness:re,segmentation:{enabled:Zt,spacing:re,interval:{values:ge(te),step:te,count:te}},bar:{enabled:Zt,thickness:re,thicknessRatio:ce,...Ey,...Ee,...Ae,...Oe},label:{...Ay,text:ie,spacing:re,avoidCollisions:Zt,placement:ue("inside-start","outside-start","inside-end","outside-end","inside-center","bar-inside","bar-inside-end","bar-outside-end","bar-end")},tooltip:Ny,...Vs(My,["listeners"])},zy={...Py,...Vs(Sy,["listeners"]),type:Ft(pe("linear-gauge")),value:Ft(te),scale:{min:Wt(te,he("max")),max:Wt(te,de("min")),label:{enabled:Zt,formatter:Xt,rotation:te,spacing:re,minSpacing:re,placement:ue("before","after"),avoidCollisions:Zt,format:by,...We},interval:{values:ge(te),step:te},...Ey,...Ee,...Ae,...Oe},targets:me(Oy,"target options array")};zy.margin=Vt(te),zy.defaultColorRange=Vt(ge(Qt)),zy.defaultTarget=Vt({...Oy,value:te,label:{...ky,spacing:te}}),zy.defaultScale=Vt(zy.scale),zy.scale.defaultFill=Vt(Qt);var jy={outerRadius:re,innerRadius:re,outerRadiusRatio:ce,innerRadiusRatio:ce,startAngle:te,endAngle:te,spacing:re,cornerMode:ue("container","item"),cornerRadius:re,scale:{min:Wt(te,he("max")),max:Wt(te,de("min")),label:{enabled:Zt,formatter:Xt,rotation:te,spacing:re,minSpacing:re,avoidCollisions:Zt,format:by,...We},interval:{values:ge(te),step:te},...Ey,...Ee,...Ae,...Oe},segmentation:{enabled:Zt,spacing:re,interval:{values:ge(te),step:te,count:te}},bar:{enabled:Zt,...Ey,...Ee,...Ae,...Oe},needle:{enabled:Zt,spacing:re,radiusRatio:ce,...Ee,...Ae,...Oe},label:{text:ie,spacing:re,...Ay},secondaryLabel:{text:ie,...Ay},tooltip:Ny,...My},By={...jy,...Sy,type:Ft(pe("radial-gauge")),value:Ft(te),targets:me(Ry,"target options array")};By.defaultColorRange=Vt(ge(Qt)),By.defaultTarget=Vt({...Ry,value:te,label:{...ky,spacing:te}}),By.scale.defaultFill=Vt(Qt);var Fy=ue("millisecond","second","minute","hour","day","month","year"),Vy={unit:Ft(Fy),step:le,epoch:qt,utc:Zt};Vy.every=Xt;var Gy=Ht(Vy,"a time interval object"),$y={enabled:Zt,text:ie,padding:te,...We},Hy=Bt({enabled:Zt,type:Ft(ue("line","range")),range:Wt(Bt((t,{options:e})=>"range"===e.type,"crossLine type to be 'range'"),ge(Jt),ne(2,2)),value:Wt(Bt((t,{options:e})=>"line"===e.type,"crossLine type to be 'line'"),Jt),label:$y,fill:Qt,fillOpacity:ce,...Ae,...Oe},"cross-line options"),Uy={...Hy,label:{...$y,position:ue("top","left","right","bottom","top-left","top-right","bottom-left","bottom-right","inside","inside-left","inside-right","inside-top","inside-bottom","inside-top-left","inside-bottom-left","inside-top-right","inside-bottom-right"),rotation:te}},Wy={enabled:Zt,rotation:te,avoidCollisions:Zt,minSpacing:re,spacing:re,formatter:fe(ry),itemStyler:ye({...We,...Ze,spacing:te}),...We,...Ze},_y={autoRotate:Zt,autoRotateAngle:te,wrapping:ue("never","always","hyphenate","on-space"),truncate:Zt,...Wy},Yy={format:by,..._y},Ky={format:_t(ie,ee),..._y},Zy={enabled:Zt,width:re,size:re,stroke:Qt},Xy={enabled:Zt,label:Ky,tick:Zy},Qy={values:ge(Jt),minSpacing:re},qy={reverse:Zt,gridLine:{enabled:Zt,width:re,style:me({fill:Qt,fillOpacity:re,stroke:_t(Qt,ve),strokeWidth:re,lineDash:ge(re)},"a grid-line style object array")},interval:Qy,label:Wy,line:{enabled:Zt,width:re,stroke:Qt},tick:Zy,context:()=>!0};qy.layoutConstraints=Vt({stacked:Ft(Zt),align:Ft(ue("start","end")),unit:Ft(ue("percent","px")),width:Ft(re)});var Jy={...qy,crossAt:{value:Ft(_t(te,qt,ie,ge(ie))),sticky:Zt},keys:ge(ie),crossLines:me(Uy,"a cross-line options array"),position:ue("top","right","bottom","left"),thickness:re,maxThicknessRatio:ce,title:{enabled:Zt,text:ry,spacing:re,formatter:fe(ry),...We}};Jy.title._enabledFromTheme=Vt(Zt);var tx={enabled:Zt,...Ee,...Ae,...Oe};function ex(t,e){const i={enabled:Zt,xOffset:te,yOffset:te,formatter:fe(ie),renderer:fe(_t(ie,Ht({text:ie,color:Qt,backgroundColor:Qt,opacity:ce},"crosshair label renderer result object")))};let s;return t&&(s={...i,format:e?_t(ie,Ht({millisecond:ie,second:ie,hour:ie,day:ie,month:ie,year:ie})):ie}),{enabled:Zt,snap:Zt,label:s??i,...Ae,...Oe}}function ix(t,e){return{min:Wt(t,he("max")),max:Wt(t,de("min")),nice:Zt,interval:{step:e?_t(le,Fy,Gy):le,values:ge(t),minSpacing:Wt(re,he("maxSpacing")),maxSpacing:Wt(re,de("minSpacing"))}}}var sx={step:_t(le,Fy,Gy),values:ge(_t(te,qt)),minSpacing:Wt(re,he("maxSpacing")),maxSpacing:Wt(re,de("minSpacing")),placement:ue("on","between")},nx=class t extends Gp{constructor(t,e=new Vu,i=!0){super(t,e),this.groupPaddingInner=.1,this.includeInvisibleDomains=i,this.nice=!1}static is(e){return e instanceof t}isCategoryLike(){return!0}hasDefinedDomain(){return!1}normaliseDataDomain(t){return{domain:t,clipped:!1}}updateScale(){super.updateScale();let{paddingInner:t,paddingOuter:e}=this;if(!Q(t)||!Q(e)){const i=this.reduceBandScalePadding();t??(t=i.inner),e??(e=i.outer)}this.scale.paddingInner=t??0,this.scale.paddingOuter=e??0}calculateGridLines(t,e,i){const s=super.calculateGridLines(t,e,i);return"between"===this.interval.placement&&t.length>0&&s.push(super.calculateGridLine({index:t.at(-1).index+1,tickId:`after:${t.at(-1).tickId}`,translation:this.range[1]},t.length,e,i,t)),s}calculateGridLine({index:t,tickId:e,translation:i},s,n,a,o){const{gridLine:r,horizontal:l,interval:c,scale:h}=this;if("between"!==c.placement)return super.calculateGridLine({index:t,tickId:e,translation:i},s,n,a,o);const d=i-(i<h.step?Math.floor(h.step/2):h.step/2),[u,p,g,m]=l?[d,Math.max(n,a),d,Math.min(n,a)]:[Math.min(n,a),d,Math.max(n,a),d],{style:f}=r,{stroke:y,strokeWidth:x=0,lineDash:b}=f[t%f.length]??{};return{tickId:e,offset:d,x1:u,y1:p,x2:g,y2:m,stroke:y,strokeWidth:x,lineDash:b}}calculateGridFills(t,e,i){const{horizontal:s,range:n,scale:a}=this;if("between"!==this.interval.placement)return super.calculateGridFills(t,e,i);const o=[];if(0==t.length)return o;const r=t[0],l=r.translation>n[0]+a.step/2,c=t.at(-1),h=s&&c.translation<n[1]-a.step/2;if(l){const s={tickId:`before:${r.tickId}`,translation:r.translation-a.step};o.push(this.calculateGridFill(s,-1,r.index-1,e,i,t))}if(o.push(...t.map((s,n)=>this.calculateGridFill(s,n,s.index,e,i,t))),h){const s={tickId:`after:${c.tickId}`,translation:c.translation+a.step};o.push(this.calculateGridFill(s,t.length,c.index+1,e,i,t))}return o}calculateGridFill({tickId:t,translation:e},i,s,n,a,o){const{gridLine:r,horizontal:l,interval:c,scale:h}=this;if("between"!==c.placement)return super.calculateGridFill({tickId:t,translation:e},i,s,n,a,o);const d=e-h.step/2,u=e+h.step/2,[p,g,m,f]=l?[d,Math.max(n,a),u,Math.min(n,a)]:[Math.min(n,a),d,Math.max(n,a),u],{fill:y,fillOpacity:x}=r.style[s%r.style.length]??{};return{tickId:t,x1:p,y1:g,x2:m,y2:f,fill:y,fillOpacity:x}}calculateTickLines(t,e){const i=super.calculateTickLines(t,e);return"between"===this.interval.placement&&t.length>0&&i.push(super.calculateTickLine({isPrimary:!1,tickId:`after:${t.at(-1)?.tickId}`,translation:this.range[1]},t.length,e,t)),i}calculateTickLine({isPrimary:t,tickId:e,translation:i},s,n,a){const{horizontal:o,interval:r,primaryTick:l,scale:c,tick:h}=this;if("between"!==r.placement)return super.calculateTickLine({isPrimary:t,tickId:e,translation:i},s,n,a);const d=t&&l?.enabled?l:h,u=-n*this.getTickSize(d),p=i-(i<c.step?Math.floor(c.step/2):c.step/2),[g,m,f,y]=o?[p,0,p,u]:[0,p,u,p],{stroke:x,width:b}=d;return{tickId:e,offset:p,x1:g,y1:m,x2:f,y2:y,stroke:x,strokeWidth:b,lineDash:void 0}}reduceBandScalePadding(){return this.boundSeries.reduce((t,e)=>{const i=e.getBandScalePadding?.();return i&&(t.inner>i.inner&&(t.inner=i.inner),t.outer<i.outer&&(t.outer=i.outer)),t},{inner:1/0,outer:-1/0})}tickFormatParams(t,e,i,s){return{type:"category"}}datumFormatParams(t,e,i,s,n){const{datum:a,seriesId:o,legendItemName:r,key:l,source:c,property:h,domain:d,boundSeries:u}=e;return Array.isArray(t)&&t.some(t=>"string"!=typeof t)?t=t.map(String):Array.isArray(t)||"string"==typeof t||"number"==typeof t||t instanceof Date||(t=String(t)),{type:"category",value:t,datum:a,seriesId:o,legendItemName:r,key:l,source:c,property:h,domain:d,boundSeries:u}}};nx.className="CategoryAxis",nx.type="category",ls([ws],nx.prototype,"groupPaddingInner",2),ls([ws],nx.prototype,"paddingInner",2),ls([ws],nx.prototype,"paddingOuter",2);var ax=nx,ox=class t extends Vu{static is(e){return e instanceof t}normalizeDomains(...t){const{domain:e}=super.normalizeDomains(...t);return{domain:e,animatable:!1}}findIndex(t){return super.findIndex(t)??this.getMatchIndex(t)}getMatchIndex(t){const e=JSON.stringify(t),i=this._domain.find(t=>JSON.stringify(t)===e);if(null!=i)return super.findIndex(i)}};function rx(t){if(0===t.length)return null;let e=1/0,i=-1/0;for(const s of t){const t=s instanceof Date?s.getTime():s;"number"==typeof t&&(t<e&&(e=t),t>i&&(i=t))}const s=[e,i];return s.every(Number.isFinite)?s:null}function lx(t,e,i){let s=!1;const n=rx(t);if(null==n)return{extent:null!=e&&null!=i&&e<=i?[e,i]:[],clipped:!1};let[a,o]=n;return null!=e&&(s||(s=e>a),a=e),null!=i&&(s||(s=i<o),o=i),a>o?{extent:[],clipped:!1}:{extent:[a,o],clipped:s}}function cx(t,e=[0,0]){for(const i of t)"number"==typeof i&&(i<0&&(e[0]+=i),i>0&&(e[1]+=i));return e}function hx(t,e){return{id:t,matchGroupIds:[e],type:"aggregate",aggregateFunction:t=>cx(t)}}function dx(t,e){const i=e?.visible??!0;return{id:t,type:"aggregate",matchGroupIds:e?.matchGroupId?[e?.matchGroupId]:void 0,aggregateFunction:t=>cx(t),groupAggregateFunction:(t,e=[0,0])=>(i&&(e[0]+=t?.[0]??0,e[1]+=t?.[1]??0),e)}}function ux(t,e){const i=e?.visible??!0;return{id:t,type:"aggregate",aggregateFunction:()=>[0,1],groupAggregateFunction:(t,e=[0,0])=>(i&&(e[0]+=t?.[0]??0,e[1]+=t?.[1]??0),e)}}function px(t,e){const i=e?.visible??!0;return{id:t,matchGroupIds:e?.matchGroupId?[e?.matchGroupId]:void 0,type:"aggregate",aggregateFunction:t=>cx(t),groupAggregateFunction:(t,e=[0,0,-1])=>(i&&(e[0]+=t?.[0]??0,e[2]++,e[1]+=t?.[1]??0),e),finalFunction:(t=[0,0,0])=>{const e=t[0]+t[1];return e>=0?[0,e/t[2]]:[e/t[2],0]}}}function gx(t,e,i){const s={id:t,matchGroupIds:i?[i]:void 0,type:"aggregate",aggregateFunction:(t,i=[])=>{const s=i[1]-i[0];return e.aggregateFunction(t).map(t=>t/s)}};return e.groupAggregateFunction&&(s.groupAggregateFunction=e.groupAggregateFunction),s}function mx(t){return()=>{let e=0;return i=>Q(i)?(e+=t?Math.max(0,i):i,e):i}}function fx(){return()=>{let t=0;return e=>{if(!Q(e))return e;const i=t;return t+=e,i}}}function yx(t){return t.input.count<=1e3}function xx(t){return null!=t&&Nd(t)}function bx(t){return null!=t}function vx(t){switch(t){case"number":case"log":case"time":case"unit-time":case"ordinal-time":case"color":return xx;default:return bx}}function Mx(t){switch(t){case"number":case"log":case"time":case"color":return"range";default:return"category"}}function Sx(t,e,i={}){return{property:t,type:"key",valueType:Mx(e),validation:vx(e),...i}}function Ix(t,e,i={}){return{property:t,type:"value",valueType:Mx(e),validation:vx(e),...i}}function Dx(t,e={}){return{property:t,type:"value",valueType:"range",missingValue:1,processor:()=>()=>1,...e}}var kx=function(t){return t};function Ax(...t){const e=t.filter(t=>null!=t);return 0===e.length?()=>kx:1===e.length?e[0]:()=>{const t=e.map(t=>t());return(e,i)=>t.reduce((t,e)=>e(t,i),e)}}function wx(t,e={}){const{min:i=-1/0,max:s=1/0,processor:n,...a}=e;return{type:"value",property:t,valueType:"range",validation:xx,processor:Ax(n,()=>t=>Q(t)?C(i,t,s):t),...a}}function Cx(t,e,i={}){const{onlyPositive:s,processor:n,...a}=i;return{...Ix(t,e,a),processor:Ax(n,mx(s))}}function Nx(t,e,i={}){return{...Ix(t,e,i),processor:fx()}}function Lx(t,e,i,s){return[Ix(t,s,i),Gx(i.groupId,e,i.separateNegative),...null==i.rangeId?[]:[(n=i.rangeId,a=i.groupId,{id:n,matchGroupIds:[a],type:"aggregate",aggregateFunction:t=>kh.extendDomain(t)})]];var n,a}var Tx={type:"reducer",property:"smallestKeyInterval",initialValue:1/0,reducer:()=>{let t=Number.NaN;return(e,i)=>{const s="number"==typeof i[0]?i[0]:Number(i[0]),n=Math.abs(s-t);t=s;const a=e??1/0;return!Number.isNaN(n)&&n>0&&n<a?n:a}}},Ex={type:"reducer",property:"largestKeyInterval",initialValue:-1/0,reducer:()=>{let t=Number.NaN;return(e,i)=>{const s="number"==typeof i[0]?i[0]:Number(i[0]),n=Math.abs(s-t);t=s;const a=e??-1/0;return!Number.isNaN(n)&&n>0&&n>a?n:a}}},Ox={type:"processor",property:"sortedGroupDomain",calculate:({domain:{groups:t}})=>t?.slice().sort((t,e)=>{for(let i=0;i<t.length;i++){const s=t[i]-e[i];if(0!==s)return s}return 0})};function Rx({normaliseTo:t}){const e=(e,i)=>{if(0===i)return 0;const s=(e??0)*t/i;return s>=0?Math.min(t,s):Math.max(-t,s)};return()=>()=>(t,i,s,n)=>{const a=function(t,e,i,s){const n=[0,0];for(const a of e){const e=t[a],o=i.datumIndices[a];if(null!=o)for(const t of o){const i=e[s+t];if(null==i)continue;const a="number"==typeof i?i:Math.max(...i.map(t=>t??0)),o=a<0?0:1;n[o]=0===o?Math.min(n[o],a):Math.max(n[o],a)}}return Math.max(Math.abs(n[0]),n[1])}(t,i,s,n);for(const o of i){const i=s.datumIndices[o];if(null!=i)for(const s of i){const i=n+s,r=t[o],l=r[i];r[i]=null!=l?e(l,a):void 0}}}}function Px(t,e){return{type:"group-value-processor",matchGroupIds:t,adjust:Sl({normaliseTo:e},Rx)}}function zx({normaliseTo:t,zeroDomain:e,rangeMin:i,rangeMax:s}){const n=t[1]-t[0],a=(i,s,a)=>{const o=t[0]+(i-s)/a*n;return 0===a?e:o>=t[1]?t[1]:o<t[0]?t[0]:o};return()=>(e,n)=>{let[o,r]=e.domain.values[n];null!=i&&(o=i),null!=s&&(r=s);const l=r-o;e.domain.values[n]=[t[0],t[1]];const c=e.columns[n];for(let t=0;t<c.length;t+=1)c[t]=a(c[t],o,l)}}function jx(t,e,i,s,n){return{type:"property-value-processor",property:t,adjust:Sl({normaliseTo:e,rangeMin:s,rangeMax:n,zeroDomain:i},zx)}}function Bx(t,e,i,s){let n=3;if("category"===e.valueType)return i.length<t&&(n&=-2),n;let a=s[0]?.valueOf();for(let t=1;0!==n&&t<s.length;t++){const e=s[t]?.valueOf();(!Number.isFinite(e)||a>e)&&(n&=-3),Number.isFinite(e)&&a===e&&(n&=-2),a=e}return n}function Fx(t){return{type:"processor",property:"animationValidation",calculate(e){if(!yx(e))return;const{keys:i,values:s}=e.defs,{input:n,domain:{keys:a,values:o},keys:r,columns:l,invalidKeyCount:c}=e;let h=3;if(0!==n.count){for(let t=0;0!==h&&t<i.length;t++)for(const e of i[t].scopes){const s=r[t].get(e),n=c?.get(e)??0;h&=Bx(s.length-n,i[t],a[t],s)}for(let e=0;0!==h&&e<s.length;e++){const i=s[e];t?.includes(i.id)&&(h&=Bx(0,i,o[e],l[e]))}}return{uniqueKeys:!!(1&h),orderedKeys:!!(2&h)}}}}function Vx({mode:t,separateNegative:e}){return()=>()=>(i,s,n,a)=>{const o=[0,0];for(const r of s){const s=n.datumIndices[r];if(null==s)continue;const l=o[0],c=o[1],h=i[r];let d=!1;for(const i of s){const s=a+i,n=h[s];if(!Q(n))continue;const r=e&&L(n),u=r?l:c;h[s]="normal"===t?u+n:u,d||(o[r?0:1]=u+n,d=!0)}}}}function Gx(t,e,i=!1){return{type:"group-value-processor",matchGroupIds:[t],adjust:Sl({mode:e,separateNegative:i},Vx),supportsReprocessing:!0}}function $x(t){return t.id??t.property}function Hx(t,e,i,s,n){for(const{previousIndex:a,nextIndex:o}of i){const i=t[a],r=e[o];if(i[s]!==r[n])return!1}return!0}function Ux(t,e,i=!0){return{type:"processor",property:"diff",calculate(s,n){if(!yx(s))return;const a=new Map,o=new Map,r=new Map,l=new Map,c=e.keys.map(e=>e.get(t)),h=s.keys.map(e=>e.get(t)),d=e.columns,u=s.columns,p=function(t,e,i){const s=new Map,n=e.defs.values;for(let e=0;e<n.length;e+=1){const i=n[e];if(!1===i.scopes?.includes(t))continue;const a=$x(i);if(s.has(a))return;s.set(a,e)}const a=[],o=i.defs.values;for(let e=0;e<o.length;e+=1){const i=o[e];if(!1===i.scopes?.includes(t))continue;const n=$x(i),r=s.get(n);if(null==r)return;s.delete(n),a.push({previousIndex:r,nextIndex:e})}if(0===s.size)return a}(t,e,s);if(null==p)return n;const g=Math.max(e.input.count,s.input.count);for(let t=0;t<g;t++){const n=t<e.input.count,g=t<s.input.count,m=n?Fh(c,t):void 0,f=null==m?"":Wx(...m),y=g?Fh(h,t):void 0,x=null==y?"":Wx(...y);if(g&&n&&f===x){Hx(d,u,p,t,t)||r.set(x,t);continue}const b=l.get(x);null!=b?(!i&&Hx(d,u,p,b,t)||(r.set(x,t),a.set(x,t)),l.delete(x)):g&&o.set(x,t);const v=o.get(f);null!=v?(!i&&Hx(d,u,p,v,t)||(r.set(f,t),a.set(f,t)),o.delete(f)):n&&(r.delete(f),l.set(f,t))}const m={changed:o.size>0||r.size>0||l.size>0,added:new Set(o.keys()),updated:new Set(r.keys()),removed:new Set(l.keys()),moved:new Set(a.keys())};return{...n,[t]:m}}}}function Wx(...t){if(1===t.length){const e=Ld(t[0]);if("boolean"==typeof e||"number"==typeof e||"string"==typeof e)return e}return t.map(t=>Ld(t)).join("___")}var _x=class{constructor(){this.top=1/0,this.right=-1/0,this.bottom=-1/0,this.left=1/0}update(t,e){t>this.right&&(this.right=t),t<this.left&&(this.left=t),e>this.bottom&&(this.bottom=e),e<this.top&&(this.top=e)}},Yx=class t{constructor(t="",e,i){this.label=t,this.parent=e,this.refId=i,this.position=0,this.subtreeLeft=Number.NaN,this.subtreeRight=Number.NaN,this.children=[],this.leafCount=0,this.prelim=0,this.mod=0,this.ancestor=this,this.change=0,this.shift=0,this.index=0,this.screen=0,this.depth=e?e.depth+1:0}insertTick(e,i){let s,n=this;for(let a=0;a<e.length;a++){const o=e[a],r=a!==e.length-1,{children:l}=n,c=l.find(t=>t.label===o);if(c&&r)n=c,s=c;else{const e=new t(o,n,i);e.index=l.length,l.push(e),r&&(n=e),s=e}}return s}getLeftSibling(){return this.index>0?this.parent?.children[this.index-1]:void 0}getLeftmostSibling(){return this.index>0?this.parent?.children[0]:void 0}nextLeft(){return this.children[0]}nextRight(){return this.children.at(-1)}getSiblings(){return this.parent?.children.filter((t,e)=>e!==this.index)??[]}};function Kx(t,e,i){const s=i/(e.index-t.index);e.change-=s,e.shift+=i,t.change+=s,e.prelim+=i,e.mod+=i}function Zx(t,e,i){return e.getSiblings().includes(t.ancestor)?t.ancestor:i}function Xx(t,e){const i=t.getLeftSibling();if(i){let s=t,n=t,a=i,o=n.getLeftmostSibling(),r=n.mod,l=s.mod,c=a.mod,h=o.mod;for(;a.nextRight()&&n.nextLeft();){a=a.nextRight(),n=n.nextLeft(),o=o.nextLeft(),s=s.nextRight(),s.ancestor=t;const i=a.prelim+c-(n.prelim+r)+1;i>0&&(Kx(Zx(a,t,e),t,i),r+=i,l+=i),c+=a.mod,r+=n.mod,h+=o.mod,l+=s.mod}a.nextRight()&&!s.nextRight()?s.mod+=c-l:(n.nextLeft()&&!o.nextLeft()&&(o.mod+=r-h),e=t)}return e}function Qx(t){const{children:e}=t;if(e.length){let[i]=e;for(const t of e)Qx(t),i=Xx(t,i);!function({children:t}){let e=0,i=0;for(let s=t.length-1;s>=0;s--){const n=t[s];n.prelim+=e,n.mod+=e,i+=n.change,e+=n.shift+i}}(t);const s=(e[0].prelim+e.at(-1).prelim)/2,n=t.getLeftSibling();n?(t.prelim=n.prelim+1,t.mod=t.prelim-s):t.prelim=s}else{const e=t.getLeftSibling();t.prelim=e?e.prelim+1:0}}function qx(t,e,i){t.position=t.prelim+e,i.insertNode(t);for(const s of t.children)qx(s,e+t.mod,i)}function Jx(t){const{children:e}=t;let i=0;for(const t of e)Jx(t),t.children.length?i+=t.leafCount:i++;t.leafCount=i,e.length?(t.subtreeLeft=e[0].subtreeLeft,t.subtreeRight=e.at(-1).subtreeRight,t.position=(t.subtreeLeft+t.subtreeRight)/2):(t.subtreeLeft=t.position,t.subtreeRight=t.position)}function tb(t){const e=new eb,{root:i,tickNodes:s}=function(t){const e=t.reduce((t,e)=>Math.max(t,e.length),0),i=new Yx,s=new Map;for(let n=0;n<t.length;n++){const a=t[n];for(;a.length<e;)a.push("");const o=i.insertTick(a,n);null!=o&&s.set(a,o)}return{root:i,tickNodes:s}}(t);return Qx(i),qx(i,-i.prelim,e),Jx(i),{layout:e,tickNodes:s}}var eb=class{constructor(){this.dimensions=new _x,this.nodes=[],this.depth=0}insertNode(t){this.depth<t.depth&&(this.depth=t.depth),this.dimensions.update(t.position,t.depth),this.nodes.push(t)}scaling(t,e){let i=1;if(t>0){const{left:e,right:s}=this.dimensions;s!==e&&(i=t/(s-e))}return e&&(i*=-1),i}},ib=class extends Pn{constructor(){super(...arguments),this.enabled=!0,this.border=new Dd}};ls([ws],ib.prototype,"enabled",2),ls([ws],ib.prototype,"avoidCollisions",2),ls([ws],ib.prototype,"border",2),ls([ws],ib.prototype,"color",2),ls([ws],ib.prototype,"cornerRadius",2),ls([ws],ib.prototype,"spacing",2),ls([ws],ib.prototype,"rotation",2),ls([ws],ib.prototype,"wrapping",2),ls([ws],ib.prototype,"truncate",2),ls([ws],ib.prototype,"fill",2),ls([ws],ib.prototype,"fontStyle",2),ls([ws],ib.prototype,"fontWeight",2),ls([ws],ib.prototype,"fontSize",2),ls([ws],ib.prototype,"fontFamily",2),ls([ws],ib.prototype,"padding",2);var sb=class extends Pn{constructor(){super(...arguments),this.enabled=!0}};ls([ws],sb.prototype,"enabled",2),ls([ws],sb.prototype,"width",2),ls([ws],sb.prototype,"stroke",2);var nb=class extends Pn{constructor(){super(...arguments),this.label=new ib,this.tick=new sb}};ls([ws],nb.prototype,"label",2),ls([ws],nb.prototype,"tick",2);var ab=class extends ax{constructor(t){super(t,new ox),this.tickScale=new ox,this.computedLayout=void 0,this.tickTreeLayout=void 0,this.tickNodes=void 0,this.depthOptions=new zn(nb),this.includeInvisibleDomains=!0,this.tickScale.paddingInner=1,this.tickScale.paddingOuter=0}resizeTickTree(){if(!this.tickTreeLayout)return;const{nodes:t}=this.tickTreeLayout,{range:e,step:i,inset:s,bandwidth:n}=this.scale,a=Math.abs(e[1]-e[0])-i,o=this.tickTreeLayout.scaling(a,e[0]>e[1]),r=s+n/2;let l=0;for(const e of t){const t=e.position*o;l>t&&(l=t),e.screen=t+r}for(const e of t)e.screen-=l}getDepthOptionsMap(t){const e=[],{depthOptions:i,label:s}=this,n=this.horizontal?0:-90;for(let a=0;a<t;a++)e.push(i[a]?.label.enabled??s.enabled?{enabled:!0,spacing:i[a]?.label.spacing??s.spacing,wrapping:i[a]?.label.wrapping??s.wrapping,truncate:i[a]?.label.truncate??s.truncate,rotation:i[a]?.label.rotation??(a?n:s.rotation),avoidCollisions:i[a]?.label.avoidCollisions??s.avoidCollisions}:{enabled:!1,spacing:0,rotation:0,avoidCollisions:!1});return e}updateCategoryLabels(){this.computedLayout&&this.tickLabelGroupSelection.update(this.computedLayout.tickLabelLayout).each((t,e)=>{t.fill=e.color,t.text=e.text,t.textBaseline=e.textBaseline,t.textAlign=e.textAlign??"center",t.setFont(e),t.setBoxing(e)})}updateAxisLine(){this.computedLayout&&(this.lineNode.visible=this.line.enabled,this.lineNode.stroke=this.line.stroke,this.lineNode.strokeWidth=this.line.width)}computeLayout(){this.updateDirection(),this.updateScale();const{step:t}=this.scale,{title:e,label:i,range:s,depthOptions:n,horizontal:a,line:o}=this;if(this.lineNode.datum=a?{x1:s[0],x2:s[1],y1:0,y2:0}:{x1:0,x2:0,y1:s[0],y2:s[1]},this.lineNode.setProperties({stroke:o.stroke,strokeWidth:o.enabled?o.width:0}),this.resizeTickTree(),!this.tickTreeLayout?.depth)return{bbox:fs.zero,spacing:0,depthLabelMaxSize:{},tickLabelLayout:[]};const{depth:r,nodes:l}=this.tickTreeLayout,c=a?-i.getSideFlag():i.getSideFlag(),h=[],d=new Map,u=new Ko,p=this.getDepthOptionsMap(r),g=c*p[0].spacing,m=this.tickFormatter(this.scale.domain,this.scale.domain,!1),f=(e,o)=>{const l=r-e.depth;if(!p[l]?.enabled||!function(t,e,i=1e-10){return t>=e[0]-i&&t<=e[1]+i}(e.screen,s))return!1;let c=(e.leafCount||1)*t;if(c<5)return!1;let h=m(e.label,o-1);const d=this.getLabelStyles({value:e.index,formattedValue:h,depth:l},n[l]?.label);if(i.avoidCollisions){const t=p[l].rotation;let e=this.thickness;if(null!=t){const i=function(t,e,i=1/0){const s=e,n=i,a=t%180*(Math.PI/180),o=Math.abs(Math.sin(a)),r=Math.abs(Math.cos(a));if(0===o)return{width:s,height:n};if(0===r)return{width:n,height:s};if(!Number.isFinite(n)){const t=r/o,e=s/(r+t*o);return{width:e,height:t*e}}const l=r*r-o*o;if(0===l){const t=Math.min(s,n)/Math.SQRT2;return{width:t,height:t}}return{width:Math.abs((s*r-n*o)/l),height:Math.abs((n*r-s*o)/l)}}(t,c,e);c=i.width,e=i.height}h=Ji(h,{font:d,textWrap:p[l].wrapping,overflow:p[l].truncate?"ellipsis":"hide",maxWidth:c,maxHeight:e})||h}return u.x=a?e.screen:g,u.y=a?g:e.screen,u.rotation=0,u.fill=d.color,u.text=h,u.textAlign="center",u.textBaseline=i.parallel?"top":"bottom",u.setFont(d),u.setBoxing(d),!0},y={};for(const[e,i]of l.entries()){const s=r-i.depth;if(y[s]??(y[s]=0),!i.children.length&&t<5)continue;if(!f(i,e)||!u.getBBox())continue;d.set(e,u.getBBox()),u.rotation=xn(p[s]?.rotation);const{width:n,height:o}=u.getBBox(),l=a?o:n;y[s]<l&&(y[s]=l)}const x=Mp(),b=t=>{if(0===t)return 0;let e=y[0];for(let i=1;i<=t;i++)e+=p[i].spacing,i!==t&&(e+=y[i]);return e};for(const[e,s]of l.entries()){if(0===e)continue;const n=f(s,e),o=!s.children.length,l=r-s.depth;if(o&&t<5)continue;if(!n)continue;const g=xn(p[l].rotation),m=d.get(e);if(!m)continue;const{width:y,height:v}=m,M=b(l);if(u.textAlign="center",u.textBaseline="middle",u.rotation=g,a?(u.y+=(M+yn(y/2,v/2,g))*c,u.rotationCenterX=s.screen,u.rotationCenterY=u.y):(u.x+=M*c+yn((p[l].spacing*c+y)/2,i.mirrored?y:0,g)-y/2,u.rotationCenterX=u.x,u.rotationCenterY=s.screen),p[l].avoidCollisions){const{width:i,height:n}=u.getBBox();if((a?i:n)>(o?t:s.leafCount*t)){d.delete(e);continue}}const S=u.getPlainText(),I=u.getBoxingProperties();h.push({text:S,visible:!0,tickId:x(S),range:this.scale.range,border:I.border,color:u.fill,cornerRadius:I.cornerRadius,fill:I.fill,fontFamily:u.fontFamily,fontSize:u.fontSize,fontStyle:u.fontStyle,fontWeight:u.fontWeight,padding:I.padding,rotation:u.rotation,rotationCenterX:u.rotationCenterX,rotationCenterY:u.rotationCenterY,textAlign:u.textAlign,textBaseline:u.textBaseline,x:u.x,y:u.y}),d.set(e,Ta.toCanvas(u))}let v=y[0];for(let t=0;t<r;t++)v+=p[t].spacing,0!==t&&(v+=y[t]);const M=[this.lineNodeBBox(),fs.merge(d.values()),new fs(0,0,v*c,0)];let S=0;if(e.enabled){const t=fs.merge(M);S=a?t.height:t.width,M.push(this.titleBBox(this.scale.domain,S))}const I=fs.merge(M);return this.layoutCrossLines(),{bbox:I,spacing:S,depthLabelMaxSize:y,tickLabelLayout:h}}update(){if(!this.computedLayout)return;this.moduleCtx.animationManager.skipCurrentBatch();const{tickScale:t,tick:e,gridLine:i,gridLength:s,visibleRange:n,tickTreeLayout:a}=this;if(!a)return;const{depthLabelMaxSize:o,spacing:r}=this.computedLayout,{depth:l}=a,c=this.getDepthOptionsMap(l),{position:h,horizontal:d,gridPadding:u}=this,p="bottom"===h||"right"===h?-1:1,g=u,m=p*s-u;let f;if(t.step>5){const e={nice:!1,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0};f=t.ticks(e,void 0,n).ticks}else f=[];const y=f.map((e,i)=>({index:t.findIndex(e),tickId:Wx(i,...e),translation:Math.round(t.convert(e))}));this.gridLineGroupSelection.update(i.enabled&&s?this.calculateGridLines(y,g,m):[]),this.gridFillGroupSelection.update(i.enabled&&s?this.calculateGridFills(y,g,m):[]),this.tickLineGroupSelection.update(e.enabled?f.map((t,i)=>{const{tickId:s,translation:n}=y[i],a=this.tickNodes?.get(t),r=null==a?l-1:Math.min(function(t){let e=0,i=t;for(;0===i?.index;)e+=1,i=i.parent;return e}(a),l-1),h=this.depthOptions[r]?.tick;let u=o[0];for(let t=0;t<=r;t++)u+=c[t].spacing,0!==t&&(u+=o[t]);const g=h?.stroke??e.stroke,m=!1===h?.enabled?0:h?.width??e.width,f=-p*u,[x,b,v,M]=d?[n,n,0,f]:[0,f,n,n];return{tickId:s,offset:n,x1:x,y1:v,x2:b,y2:M,stroke:g,strokeWidth:m,lineDash:void 0}}):[]),this.updatePosition(),this.updateCategoryLabels(),this.updateAxisLine(),this.updateGridLines(),this.updateGridFills(),this.updateTickLines(),this.updateTitle(this.scale.domain,r),this.updateCrossLines(),this.resetSelectionNodes()}calculateLayout(){const{depthLabelMaxSize:t,tickLabelLayout:e,spacing:i,bbox:s}=this.computeLayout();return this.computedLayout={depthLabelMaxSize:t,tickLabelLayout:e,spacing:i},{bbox:s,niceDomain:this.scale.domain}}onGridVisibilityChange(){super.onGridVisibilityChange(),this.tickLabelGroupSelection.clear()}updateScale(){super.updateScale(),this.tickScale.range=this.scale.range,this.scale.paddingOuter=this.scale.paddingInner/2}processData(){const{direction:t}=this,e=this.boundSeries.filter(t=>t.visible).flatMap(e=>e.getDomain(t));this.dataDomain={domain:rx(e)??this.filterDuplicateArrays(e),clipped:!1},this.isReversed()&&this.dataDomain.domain.reverse();const i=this.dataDomain.domain.map(ob),{layout:s,tickNodes:n}=tb(i);this.tickTreeLayout=s,this.tickNodes=n;const a=[];for(const t of this.tickTreeLayout.nodes)t.leafCount||null==t.refId||a.push(this.dataDomain.domain[t.refId]);const o=function(t,e){const i=new Map;for(const[t,s]of e.entries())i.set(s,t);return t.sort((t,e)=>(i.get(t)??1/0)-(i.get(e)??1/0))}(this.dataDomain.domain,a);this.scale.domain=o;const r=o.map(ob);r.push([""]),this.tickScale.domain=r}filterDuplicateArrays(t){const e=new Set;return t.filter(t=>{const i=G(t)?JSON.stringify(t):t;return!e.has(i)&&(e.add(i),!0)})}};function ob(t){return Qe(W(t)&&"value"in t?t.value:t)}ab.className="GroupedCategoryAxis",ab.type="grouped-category",ls([ws],ab.prototype,"depthOptions",2);var rb={2:(t,e)=>Math.log2(e),[Math.E]:(t,e)=>Math.log(e),10:(t,e)=>Math.log10(e)},lb=(t,e)=>Math.log(e)/Math.log(t);function cb(t,e,i){const s=Math.min(...e),n=rb[t]??lb;return s>=0?n(t,i):-n(t,-i)}var hb={[Math.E]:(t,e)=>Math.exp(e),10:(t,e)=>e>=0?10**e:1/10**-e},db=(t,e)=>t**e;function ub(t,e,i){const s=Math.min(...e),n=hb[t]??db;return s>=0?n(t,i):-n(t,-i)}var pb=class t extends $c{constructor(t=[1,10],e=[0,1]){super(t,e),this.type="log",this.defaultClamp=!0,this.base=10,this.log=t=>cb(this.base,this.domain,t),this.pow=t=>ub(this.base,this.domain,t)}static is(e){return e instanceof t}transform(t){const[e,i]=jc(this.domain);return e>=0!=i>=0?Number.NaN:e>=0?Math.log(t):-Math.log(-t)}transformInvert(t){const[e,i]=jc(this.domain);return e>=0!=i>=0?Number.NaN:e>=0?Math.exp(t):-Math.exp(-t)}toDomain(t){return t}niceDomain(t,e=this.domain){if(e.length<2)return[];const{base:i}=this,[s,n]=e,a=s>n?Math.ceil:Math.floor,o=s>n?Math.floor:Math.ceil;return[ub(i,e,a(cb(i,e,s))),ub(i,e,o(cb(i,e,n)))]}ticks({interval:t,tickCount:e=$c.defaultTickCount},i=this.domain,s){if(!i||i.length<2||e<1)return;const n=this.base,[a,o]=i,r=Math.min(a,o),l=Math.max(a,o);let c=this.log(r),h=this.log(l);if(t){const e=t=>t>=r&&t<=l,i=Math.min(Math.abs(t),Math.abs(h-c)),{ticks:n,count:a,firstTickIndex:o}=op(c,h,i,s),d=n.map(this.pow).filter(e);if(!rp(d.length,this.getPixelRange()))return{ticks:d,count:a,firstTickIndex:o}}if(n%1!=0||h-c>=e){const t=Math.min(h-c,e),{ticks:i,count:n,firstTickIndex:a}=qu(c,h,t,void 0,void 0,s);return{ticks:i.map(this.pow),count:n,firstTickIndex:a}}const d=[],u=r>0;c=Math.floor(c)-1,h=Math.round(h)+1;const p=Bc(this.range)/e;let g=1/0;for(let t=c;t<=h;t++){const e=this.convert(this.pow(t+1));for(let i=1;i<n;i++){const s=u?i:n-i+1,a=this.pow(t)*s,o=this.convert(a),c=Math.abs(g-o),h=Math.abs(o-e);a>=r&&a<=l&&(1===i||c>=p&&h>=p||0===d.length)&&(d.push(a),g=o)}}return Fu(d,u,s)}},gb=class t extends $c{constructor(){super([0,1],[0,1]),this.type="number"}static is(e){return e instanceof t}static getTickStep(t,e,i){const{interval:s,tickCount:n=$c.defaultTickCount,minTickCount:a,maxTickCount:o}=i;return s??sp(t,e,n,a,o)}toDomain(t){return t}ticks({interval:t,tickCount:e=$c.defaultTickCount,minTickCount:i,maxTickCount:s},n=this.domain,a){if(!n||n.length<2||e<1||!n.every(Number.isFinite))return{ticks:[],count:0,firstTickIndex:0};const[o,r]=n;if(t){const e=Math.abs(t);if(!rp((r-o)/e,this.getPixelRange()))return op(o,r,e,a)}return qu(o,r,e,i,s,a)}niceDomain(e,i=this.domain){if(i.length<2)return[];const{tickCount:s=$c.defaultTickCount}=e;let[n,a]=i;if(1===s)[n,a]=lp(n,a);else if(s>1){const s=n>a?Math.ceil:Math.floor,o=n>a?Math.floor:Math.ceil,r=4;for(let l=0;l<r;l++){const r=n,l=a,c=t.getTickStep(n,a,e),[h,d]=i;if(n=s(h/c)*c,a=o(d/c)*c,n===r&&a===l)break}}return[n,a]}},mb=class extends Gp{constructor(t,e=new gb){super(t,e)}hasDefinedDomain(){const{min:t,max:e}=this;return null!=t&&null!=e&&t<e}normaliseDataDomain(t){const{min:e,max:i}=this,{extent:s,clipped:n}=lx(t,e,i);return{domain:s,clipped:n}}tickFormatParams(t,e,i){return{type:"number",fractionDigits:i}}datumFormatParams(t,e,i){const{datum:s,seriesId:n,legendItemName:a,key:o,source:r,property:l,domain:c,boundSeries:h}=e;return{type:"number",value:t,datum:s,seriesId:n,legendItemName:a,key:o,source:r,property:l,domain:c,boundSeries:h,fractionDigits:i}}};mb.className="NumberAxis",mb.type="number",ls([ws],mb.prototype,"min",2),ls([ws],mb.prototype,"max",2);var fb=class extends mb{normaliseDataDomain(t){const{min:e,max:s}=this,{extent:n,clipped:a}=lx(t,e,s);return n[0]<0&&n[1]>0||t[0]<0&&t[1]>0?(i.warn("The log axis domain crosses zero, the chart data cannot be rendered. See log axis documentation for more information."),{domain:[],clipped:a}):0===n[0]||0===n[1]||0===t[0]||0===t[1]?(i.warn("The log axis domain contains a value of 0, the chart data cannot be rendered. See log axis documentation for more information."),{domain:[],clipped:a}):{domain:n,clipped:a}}set base(t){this.scale.base=t}get base(){return this.scale.base}constructor(t){super(t,new pb)}};fb.className="LogAxis",fb.type="log";var yb=class extends Pn{constructor(){super(...arguments),this.enabled=!1,this.label=new Gd,this.tick=new Hd}};ls([ws],yb.prototype,"enabled",2),ls([ws],yb.prototype,"label",2),ls([ws],yb.prototype,"tick",2);var xb=class extends Gp{constructor(t){super(t,new dp),this.parentLevel=new yb,this.min=void 0,this.max=void 0}get _unit(){}set _unit(t){i.warnOnce("To use 'unit', use an axis with type 'unit-time' instead of 'time'.")}hasDefinedDomain(){const{min:t,max:e}=this;return null!=t&&null!=e&&t<e}isCategoryLike(){return!1}get primaryLabel(){return this.parentLevel.enabled?this.parentLevel.label:void 0}get primaryTick(){return this.parentLevel.enabled?this.parentLevel.tick:void 0}normaliseDataDomain(t){return Mb(t,this.min,this.max)}processData(){super.processData();const{boundSeries:t,direction:e,min:i,max:s}=this;this.minimumTimeGranularity=bb(t,e,i,s)}tickFormatParams(t,e,i,s){s??(s=Pu(e));const n=ju(t);return{type:"date",unit:Cu(s),step:Nu(s),epoch:Lu(s),truncateDate:n}}datumFormatParams(t,e,i,s,n){if("number"==typeof t&&(t=new Date(t)),null==s){const{minimumTimeGranularity:e}=this,i=zu(t);s=null!=e&&Eu(e)<Eu(i)?e:i}const{datum:a,seriesId:o,legendItemName:r,key:l,source:c,property:h,domain:d,boundSeries:u}=e;return{type:"date",value:t,datum:a,seriesId:o,legendItemName:r,key:l,source:c,property:h,domain:d,boundSeries:u,unit:Cu(s),step:Nu(s),epoch:Lu(s),style:n}}};function bb(t,e,i,s){const n=t.reduce((t,e)=>Math.min(e.minTimeInterval()??1/0,t),1/0);return Number.isFinite(n)?Ru(n):vb(t,e,i,s)?.unit}function vb(t,e,i,s){let n,a=1/0,o=-1/0,r=0;const l=[];for(const i of t){if(!i.visible)continue;const{domain:t}=Mb(i.getDomain(e),void 0,void 0);if(0===t.length)continue;const s=t[0].valueOf(),c=t.at(-1).valueOf();l.push(s,c),a=Math.min(a??1/0,s,c),o=Math.max(o??-1/0,s,c);const h=Math.abs(c-s);if(0===h)continue;const d=i.dataCount();if(r=Math.max(r,d),d<=1)continue;const u=h/(d-1);n=Math.min(n??1/0,u)}if(a=Math.min(a,i?.valueOf()??1/0,s?.valueOf()??1/0),o=Math.max(o,i?.valueOf()??-1/0,s?.valueOf()??-1/0),!Number.isFinite(a)||!Number.isFinite(o))return;n??(n=Math.abs(o-a)),n=Math.min(n,function(t){t.sort((t,e)=>t-e);let e=1/0;for(let i=1;i<t.length;i++){const s=t[i-1],n=t[i];n-s>0&&(e=Math.min(e,Math.abs(n-s)))}return e}(l));const c=Ru(n);let h=n/Eu(c);return h=r<=2?Math.floor(h):Math.round(h),h=Math.max(h,1),{unit:c,step:h,epoch:1===h?void 0:bu(c,a)}}function Mb(t,e,i){let s=!1;"number"==typeof e&&(e=new Date(e)),"number"==typeof i&&(i=new Date(i));const n=rx(t)?.map(t=>new Date(t));if(null==n)return{domain:null!=e&&null!=i&&e.valueOf()<=i.valueOf()?[e,i]:[],clipped:!1};let[a,o]=n;return e instanceof Date&&(s||(s=e>a),a=e),i instanceof Date&&(s||(s=i<o),o=i),a>o?{domain:[],clipped:!1}:{domain:[a,o],clipped:s}}xb.className="TimeAxis",xb.type="time",ls([ws],xb.prototype,"parentLevel",2),ls([ws],xb.prototype,"min",2),ls([ws],xb.prototype,"max",2),ls([ws,oo("_unit")],xb.prototype,"unit",2);var Sb=class extends ax{calculateGridLine({index:t,tickId:e,translation:i},s,n,a,o){const{gridLine:r,horizontal:l,interval:c,range:h}=this;if("between"!==c.placement)return super.calculateGridLine({index:t,tickId:e,translation:i},s,n,a,o);const d=o[s-1],u=d?i-(i-d.translation)/2:h[0],[p,g,m,f]=l?[u,Math.max(n,a),u,Math.min(n,a)]:[Math.min(n,a),u,Math.max(n,a),u],{style:y}=r,{stroke:x,strokeWidth:b=0,lineDash:v}=y[t%y.length]??{};return{tickId:e,offset:u,x1:p,y1:g,x2:m,y2:f,stroke:x,strokeWidth:b,lineDash:v}}calculateGridFills(t,e,i){return"between"!==this.interval.placement?super.calculateGridFills(t,e,i):t.map((s,n)=>this.calculateGridFill(s,n,s.index,e,i,t))}calculateGridFill({tickId:t,translation:e},i,s,n,a,o){const{gridLine:r,horizontal:l,interval:c,range:h}=this;if("between"!==c.placement)return super.calculateGridFill({tickId:t,translation:e},i,s,n,a,o);const d=o[i-1],u=o[i+1],p=d?e-(e-d.translation)/2:h[0],g=u?e+(u.translation-e)/2:h[1],[m,f,y,x]=l?[p,Math.max(n,a),g,Math.min(n,a)]:[Math.min(n,a),p,Math.max(n,a),g],{fill:b,fillOpacity:v}=r.style[s%r.style.length]??{};return{tickId:t,x1:m,y1:f,x2:y,y2:x,fill:b,fillOpacity:v}}calculateTickLine({isPrimary:t,tickId:e,translation:i},s,n,a){const{horizontal:o,interval:r,primaryTick:l,range:c,tick:h}=this;if("between"!==r.placement)return super.calculateTickLine({isPrimary:t,tickId:e,translation:i},s,n,a);const d=t&&l?.enabled?l:h,u=-n*this.getTickSize(d),p=a[s-1],g=p?i-(i-p.translation)/2:c[0],[m,f,y,x]=o?[g,0,g,u]:[0,g,u,g],{stroke:b,width:v}=d;return{tickId:e,offset:g,x1:m,y1:f,x2:y,y2:x,stroke:b,strokeWidth:v,lineDash:void 0}}},Ib=class extends Sb{constructor(t){super(t,new xp,!1),this.parentLevel=new yb,this.min=void 0,this.max=void 0,this.unit=void 0,this.defaultUnit=void 0}get primaryLabel(){return this.parentLevel.enabled?this.parentLevel.label:void 0}get primaryTick(){return this.parentLevel.enabled?this.parentLevel.tick:void 0}hasDefinedDomain(){const{min:t,max:e}=this;return null!=t&&null!=e&&t<e}isCategoryLike(){return!0}processData(){let t;super.processData();const{domain:e}=this.dataDomain;if(2===e.length&&e[0].valueOf()===e[1].valueOf())t=zu(e[0]);else{const{boundSeries:e,direction:i,min:s,max:n}=this;t=vb(e,i,s,n)}Rs(this.defaultUnit,t)||(this.defaultUnit=t)}updateScale(){super.updateScale(),this.scale.interval=this.unit??this.defaultUnit}normaliseDataDomain(t){return Mb(t,this.min,this.max)}tickFormatParams(t,e,i,s){s??(s=Pu(e));const n=ju(t);return{type:"date",unit:Cu(s),step:Nu(s),epoch:Lu(s),truncateDate:n}}datumFormatParams(t,e,i,s,n){const a=this.unit??this.defaultUnit??"millisecond";s??(s=a);const{datum:o,seriesId:r,legendItemName:l,key:c,source:h,property:d,domain:u,boundSeries:p}=e,g=Cu(s),m=Nu(s),f=Lu(s);return{type:"date",value:bu(a,t),datum:o,seriesId:r,legendItemName:l,key:c,source:h,property:d,domain:u,boundSeries:p,unit:g,step:m,epoch:f,style:n}}};Ib.className="UnitTimeAxis",Ib.type="unit-time",ls([ws],Ib.prototype,"parentLevel",2),ls([ws],Ib.prototype,"min",2),ls([ws],Ib.prototype,"max",2),ls([ws],Ib.prototype,"unit",2);var Db={...Jy,...ix(te),type:Ft(pe("number")),label:Yy,crosshair:ex(!0)},kb={...Jy,...ix(te),type:Ft(pe("log")),base:Wt(le,Bt(t=>1!==t,"not equal to 1")),label:Yy,crosshair:ex(!0)},Ab={...Jy,...ix(_t(te,qt),!0),type:Ft(pe("time")),label:Ky,parentLevel:Xy,crosshair:ex(!0,!0)},wb={...Jy,type:Ft(pe("category")),label:_y,paddingInner:ce,paddingOuter:ce,groupPaddingInner:ce,crosshair:ex(),bandHighlight:tx,interval:{...Qy,placement:ue("on","between")}},Cb={...Jy,type:Ft(pe("grouped-category")),label:_y,crosshair:ex(),bandHighlight:tx,paddingInner:ce,groupPaddingInner:ce,depthOptions:me({label:{enabled:Zt,avoidCollisions:Zt,wrapping:ue("never","always","hyphenate","on-space"),truncate:Zt,rotation:te,spacing:te,...We,...Ze},tick:{enabled:Zt,stroke:Qt,width:re}},"depth options objects array")},Nb={...Jy,type:Ft(pe("unit-time")),unit:_t(Gy,Fy),label:Ky,parentLevel:Xy,paddingInner:ce,paddingOuter:ce,groupPaddingInner:ce,crosshair:ex(!0,!0),bandHighlight:tx,min:Wt(_t(te,qt),he("max")),max:Wt(_t(te,qt),de("min")),interval:sx},Lb={type:"axis",name:"number",chartType:"cartesian",options:Db,create:t=>new mb(t)},Tb={type:"axis",name:"log",chartType:"cartesian",options:kb,create:t=>new fb(t)},Eb={type:"axis",name:"time",chartType:"cartesian",options:Ab,create:t=>new xb(t)},Ob={type:"axis",name:"category",chartType:"cartesian",options:wb,create:t=>new ax(t)},Rb={type:"axis",name:"grouped-category",chartType:"cartesian",options:Cb,create:t=>new ab(t)},Pb={type:"axis",name:"unit-time",chartType:"cartesian",options:Nb,create:t=>new Ib(t)},zb={...Jy,type:Ft(pe("ordinal-time")),paddingInner:ce,paddingOuter:ce,groupPaddingInner:ce,label:Ky,parentLevel:Xy,interval:sx,crosshair:ex(!0,!0),bandHighlight:tx},jb={...qy,...ix(te),type:Ft(pe("angle-number")),crossLines:me(Hy),startAngle:te,endAngle:te,label:{...Wy,orientation:ue("fixed","parallel","perpendicular"),format:by}},Bb={...qy,type:Ft(pe("angle-category")),shape:ue("polygon","circle"),crossLines:me(Hy),startAngle:te,endAngle:te,paddingInner:ce,groupPaddingInner:ce,label:{...Wy,orientation:ue("fixed","parallel","perpendicular")}};Bb.innerRadiusRatio=ce;var Fb={...qy,...ix(te),type:Ft(pe("radius-number")),shape:ue("polygon","circle"),positionAngle:te,innerRadiusRatio:ce,crossLines:me({...Hy,label:{...$y,positionAngle:te}},"cross-line options"),title:{enabled:Zt,text:ry,spacing:re,formatter:fe(ry),...We},label:{...Wy,format:by}},Vb={...qy,type:Ft(pe("radius-category")),positionAngle:te,innerRadiusRatio:ce,paddingInner:ce,paddingOuter:ce,groupPaddingInner:ce,label:Wy,crossLines:me({...Hy,label:{...$y,positionAngle:te}},"cross-line options"),title:{enabled:Zt,text:ry,spacing:re,formatter:fe(ry),...We}},Gb=Be(ze,ze),$b=ye({...Ae,...Ee,...Oe,marker:Iy}),Hb={showInMiniChart:Zt,connectMissingData:Zt,interpolation:Ty,label:ky,styler:$b,marker:Dy,tooltip:Ny,shadow:Ly,...My,...Ee,...Ae,...Oe,highlight:Gb,segmentation:Ge},Ub={...Hb,...Sy,highlight:Gb,type:Ft(pe("area")),xKey:Ft(ie),yKey:Ft(ie),xName:ie,yName:ie,legendItemName:ie,stacked:Zt,stackGroup:ie,normalizedTo:te},Wb=Be(Re,Re),_b=ye({...Ee,...Ae,...Oe,cornerRadius:re}),Yb={direction:ue("horizontal","vertical"),showInMiniChart:Zt,cornerRadius:re,styler:_b,itemStyler:_b,crisp:Zt,label:{...ky,placement:ue("inside-center","inside-start","inside-end","outside-start","outside-end"),spacing:re},errorBar:wy,shadow:Ly,tooltip:Ny,...My,highlight:Wb,...Ee,...Ae,...Oe,segmentation:Ge};Yb.sparklineMode=Vt(Zt);var Kb={...Yb,...Sy,highlight:Wb,type:Ft(pe("bar")),xKey:Ft(ie),yKey:Ft(ie),xName:ie,yName:ie,direction:ue("horizontal","vertical"),grouped:Zt,stacked:Zt,stackGroup:ie,normalizedTo:te,legendItemName:ie,errorBar:Cy};Kb.pickOutsideVisibleMinorAxis=Vt(Zt),Kb.focusPriority=Vt(te);var Zb={title:ie,domain:ge(te),maxSize:re,showInMiniChart:Zt,label:{placement:ue("top","right","bottom","left"),...ky},tooltip:Ny,styler:ye({...Dy,maxSize:re}),maxRenderedItems:te,...My,...Vs(Dy,["enabled"]),highlight:Be(ze,ze)},Xb={...Zb,...Sy,type:Ft(pe("bubble")),xKey:Ft(ie),yKey:Ft(ie),sizeKey:Ft(ie),labelKey:ie,xName:ie,yName:ie,sizeName:ie,labelName:ie,legendItemName:ie,highlight:Be(ze,ze)},Qb={showInMiniChart:Zt,cornerRadius:re,label:ky,tooltip:Ny,shadow:Ly,...My,...Ee,...Ae,...Oe,highlight:Be(ze,ze),areaPlot:Zt,aggregation:ue("count","sum","mean"),bins:ge(ge(te)),binCount:re},qb={...Sy,...Qb,type:Ft(pe("histogram")),xKey:Ft(ie),yKey:ie,xName:ie,yName:ie},Jb=Be(ze,Pe),tv=ye({...Ae,...Oe,marker:Iy}),ev={title:ie,showInMiniChart:Zt,connectMissingData:Zt,interpolation:Ty,label:ky,styler:tv,marker:Dy,tooltip:Ny,errorBar:wy,...My,...Ae,...Oe,highlight:Jb,segmentation:$e};ev.sparklineMode=Vt(Zt);var iv={...ev,...Sy,highlight:Jb,type:Ft(pe("line")),xKey:Ft(ie),yKey:Ft(ie),xName:ie,yName:ie,stacked:Zt,stackGroup:ie,normalizedTo:te,legendItemName:ie,errorBar:Cy};iv.pickOutsideVisibleMinorAxis=Vt(Zt),iv.focusPriority=Vt(te);var sv={title:ie,showInMiniChart:Zt,label:{placement:ue("top","right","bottom","left"),...ky},tooltip:Ny,errorBar:wy,styler:ye(Dy),maxRenderedItems:te,...My,...Vs(Dy,["enabled"]),highlight:Be(ze,ze)},nv={...sv,...Sy,type:Ft(pe("scatter")),xKey:Ft(ie),yKey:Ft(ie),labelKey:ie,xName:ie,yName:ie,labelName:ie,legendItemName:ie,errorBar:Cy,highlight:Be(ze,ze)},av=Be(ze,ze),ov={...My,radiusMin:re,radiusMax:re,rotation:te,outerRadiusOffset:te,outerRadiusRatio:ce,hideZeroValueSectorsInLegend:Zt,sectorSpacing:re,cornerRadius:re,itemStyler:ye({...Ee,...Ae,...Oe,cornerRadius:re}),title:{enabled:Zt,text:ie,showInLegend:Zt,spacing:re,...We},calloutLabel:{enabled:Zt,offset:te,minAngle:re,avoidCollisions:Zt,formatter:fe(ry),format:ie,itemStyler:ye({enabled:Zt,...Ze,...We}),...Ze,...We},sectorLabel:{enabled:Zt,positionOffset:te,positionRatio:ce,formatter:fe(ry),format:ie,itemStyler:ye({enabled:Zt,...Ze,...We}),...Ze,...We},calloutLine:{colors:ge(Qt),length:re,strokeWidth:re,itemStyler:ye({color:Qt,length:re,strokeWidth:re})},fills:ge(Te),strokes:ge(Qt),tooltip:Ny,shadow:Ly,highlight:av,...Oe,...Vs(Ee,["fill"]),...Vs(Ae,["stroke"])},rv={...ov,...Sy,type:Ft(pe("pie")),angleKey:Ft(ie),radiusKey:ie,calloutLabelKey:ie,sectorLabelKey:ie,legendItemKey:ie,angleName:ie,radiusName:ie,calloutLabelName:ie,sectorLabelName:ie,highlight:av};rv.defaultColorRange=Vt(ge(ge(Qt))),rv.defaultPatternFills=Vt(ge(Qt)),rv.title._enabledFromTheme=Vt(Zt),rv.calloutLabel._enabledFromTheme=Vt(Zt),rv.sectorLabel._enabledFromTheme=Vt(Zt);var lv={...ov,innerRadiusOffset:te,innerRadiusRatio:ce,innerCircle:{fill:ie,fillOpacity:ce},innerLabels:{spacing:re,...We,...Ze}},cv={...lv,...rv,type:Ft(pe("donut")),innerLabels:me({text:Ft(ie),spacing:re,...We,...Ze},"inner label options array")},hv={lineStyle:ue("solid","dashed","dotted"),...Oe},dv={...Ee,...Ae,...Oe},uv={visible:Zt,locked:Zt,readOnly:Zt,handle:dv,...We},pv={position:ue("top","center","bottom"),alignment:ue("left","center","right"),...We},gv={position:ue("top","inside","bottom"),alignment:ue("left","center","right"),...We},mv={enabled:Zt,cornerRadius:re,formatter:Xt,...We,...Ee,...Ae,...Oe},fv={visible:Zt,...hv,...Ae},yv={divider:Ae,...Ee,...Ae,...We},xv={handle:dv,statistics:yv,...hv,...Ee,...Ae},bv={visible:Zt,locked:Zt,readOnly:Zt,extendStart:Zt,extendEnd:Zt,handle:dv,text:pv,...hv,...Ae},vv={visible:Zt,locked:Zt,readOnly:Zt,axisLabel:mv,handle:dv,text:pv,...hv,...Ae},Mv={visible:Zt,locked:Zt,readOnly:Zt,extendStart:Zt,extendEnd:Zt,handle:dv,text:gv,background:Ee,...hv,...Ae},Sv={...Mv},Iv={...Mv,middle:fv},Dv={label:We,showFill:Zt,isMultiColor:Zt,strokes:ge(Qt),rangeStroke:Qt,bands:ue(4,6,10),...bv},kv={...Ee,...Ae,...uv},Av={...Ee,...Ae,...uv},wv={...Ee,...Ae,...uv,background:{...Ee,...Ae}},Cv={visible:Zt,locked:Zt,readOnly:Zt,handle:dv,...Ee},Nv={visible:Zt,locked:Zt,readOnly:Zt,extendStart:Zt,extendEnd:Zt,handle:dv,text:pv,background:Ee,statistics:yv,...hv,...Ae},Lv={visible:Zt,up:xv,down:xv},Tv={enabled:Zt,axesButtons:{enabled:Zt,axes:ue("x","y","xy")},toolbar:{enabled:Zt,padding:re,buttons:me({...fy,value:ue("line-menu","fibonacci-menu","text-menu","shape-menu","measurer-menu","line","horizontal-line","vertical-line","parallel-channel","disjoint-channel","fibonacci-retracement","fibonacci-retracement-trend-based","text","comment","callout","note","clear")},"annotation toolbar buttons array")},optionsToolbar:{enabled:Zt,buttons:ge(_t(Ht({...fy,value:Ft(ue("line-stroke-width","line-style-type","line-color","fill-color","text-color","text-size","delete","settings"))}),Ht({...fy,value:Ft(ue("lock")),checkedOverrides:fy})))}};Tv.data=Vt(Kt),Tv.xKey=Vt(ie),Tv.volumeKey=Vt(ie),Tv.snap=Vt(Zt);var Ev,Ov={...Ee,...Ae,...Oe,cornerRadius:re,whisker:{...Ae,...Oe},cap:{lengthRatio:ce}},Rv={...Ov,opacity:ce},Pv=ye({...Ee,...Ae,...Oe,cornerRadius:re,whisker:{...Ae,...Oe},cap:{lengthRatio:ce}}),zv={direction:ue("horizontal","vertical"),showInMiniChart:Zt,styler:Pv,itemStyler:Pv,tooltip:Ny,...My,...Ov,highlight:Be(Rv,Rv),segmentation:Ge},jv={cornerRadius:re,wick:{...Ae,...Oe},...Ee,...Ae,...Oe},Bv={...jv,opacity:ce},Fv={item:{up:jv,down:jv},itemStyler:ye({...Ee,...Ae,...Oe,cornerRadius:re,wick:{...Ae,...Oe}}),showInMiniChart:Zt,tooltip:Ny,...My,highlight:Be(Bv,Bv)},Vv={fills:ge(Te),strokes:ge(Qt),label:{spacing:re,maxWidth:re,...ky},link:{tension:ce,itemStyler:ye({...Ee,...Ae,...Oe,tension:ce}),...Ee,...Ae,...Oe},node:{width:re,spacing:re,itemStyler:ye({...Ee,...Ae,...Oe}),...Ee,...Ae,...Oe},tooltip:Ny,...My},Gv={direction:ue("horizontal","vertical"),fills:ge(Te),strokes:ge(Qt),label:{spacing:re,placement:ue("before","middle","after"),...ky},stageLabel:{placement:ue("before","after"),format:by,...Wy},tooltip:Ny,...Vs(My,["showInLegend"]),...Vs(Ee,["fill"]),...Vs(Ae,["stroke"]),...Oe,highlight:je(Pe)},$v={direction:ue("horizontal","vertical"),fills:ge(Te),strokes:ge(Qt),itemStyler:ye({...Ee,...Ae,...Oe}),spacingRatio:ce,crisp:Zt,dropOff:{enabled:Zt,...Ee,...Ae,...Oe},stageLabel:{placement:ue("before","after"),format:by,...Wy},label:ky,tooltip:Ny,shadow:Ly,...Vs(My,["showInLegend"]),...Vs(Ee,["fill"]),...Vs(Ae,["stroke"]),...Oe},Hv={title:ie,textAlign:ue("left","center","right"),verticalAlign:ue("top","middle","bottom"),itemPadding:re,itemStyler:ye({...Ee,...Ae}),showInMiniChart:Zt,label:Ay,tooltip:Ny,...My,...Ae},Uv={showInMiniChart:Zt,itemStyler:ye({...Ae,...Oe}),item:{up:{...Ae,...Oe},down:{...Ae,...Oe}},tooltip:Ny,...My,highlight:Be(Pe,Pe)},Wv={maxStrokeWidth:re,itemStyler:ye({...Ae,...Oe}),sizeDomain:ge(re),label:ky,tooltip:Ny,...My,...Ae,...Oe,highlightStyle:{...My.highlightStyle,...Ae},highlight:Be(Pe,Pe)},_v={...Ae,...Oe},Yv={colorRange:ge(Qt),maxSize:re,sizeDomain:ge(re),label:{placement:ue("top","bottom","left","right"),...ky},tooltip:Ny,...My,...Vs(Dy,["enabled"]),highlightStyle:{...My.highlightStyle,...Ee,...Ae},highlight:Be(ze,ze)},Kv={colorRange:ge(Qt),padding:re,itemStyler:ye({...Ee,...Ae,...Oe}),label:Ay,tooltip:Ny,...My,...Ee,...Ae,...Oe,highlightStyle:{...My.highlightStyle,...Ee,...Ae},highlight:Be(ze,ze)},Zv={...My,...Ee,...Ae,...Oe},Xv=ye({...Ee,...Ae,...Oe,cornerRadius:re}),Qv={cornerRadius:re,styler:Xv,itemStyler:Xv,label:ky,tooltip:Ny,...My,...Ee,...Ae,...Oe,highlight:Be(Re,Re)},qv={direction:ue("horizontal","vertical"),aspectRatio:re,spacing:re,reverse:Zt,itemStyler:ye({...Ee,...Ae,...Oe}),fills:ge(Te),strokes:ge(Qt),label:ky,stageLabel:{spacing:re,placement:ue("before","after"),...ky},tooltip:Ny,shadow:Ly,...My,...Vs(Ee,["fill"]),...Vs(Ae,["stroke"]),...Oe},Jv={connectMissingData:Zt,marker:Dy,styler:ye({marker:Iy,...Ee,...Ae,...Oe}),label:ky,tooltip:Ny,...My,...Ee,...Ae,...Oe,highlight:Be(ze,ze)},tM={connectMissingData:Zt,marker:Dy,styler:ye({marker:Iy,...Ae,...Oe}),label:ky,tooltip:Ny,...My,...Ae,...Oe,highlight:Be(ze,Pe)},eM={cornerRadius:re,styler:Xv,itemStyler:Xv,label:ky,tooltip:Ny,...My,...Ee,...Ae,...Oe,highlight:Be(Re,Re)},iM={cornerRadius:re,columnWidthRatio:ce,maxColumnWidthRatio:ce,styler:Xv,itemStyler:Xv,label:ky,tooltip:Ny,...My,...Ee,...Ae,...Oe,highlight:Be(Re,Re)},sM={marker:Dy,...Ae,...Oe},nM={marker:{enabled:Zt,...Iy},...Ae,...Oe},aM={marker:Iy,...Ae,...Oe},oM={showInMiniChart:Zt,connectMissingData:Zt,interpolation:Ty,label:{...ky,placement:ue("inside","outside"),spacing:re},tooltip:Ny,shadow:Ly,...My,...Ee,...sM,item:{low:{...nM},high:{...nM}},styler:ye({...Ee,item:{low:{...aM},high:{...aM}}}),highlight:Be(ze,ze),segmentation:Ge,invertedStyle:{enabled:Zt,...Ee}},rM=ye({...Ee,...Ae,...Oe,cornerRadius:re}),lM={direction:ue("horizontal","vertical"),grouped:Zt,showInMiniChart:Zt,cornerRadius:re,styler:rM,itemStyler:rM,label:{...ky,placement:ue("inside","outside"),spacing:re},tooltip:Ny,shadow:Ly,...My,...Ee,...Ae,...Oe,highlight:Be(Re,Re),segmentation:Ge},cM={fills:ge(Te),strokes:ge(Qt),label:{...ky,spacing:re,placement:ue("left","right","center"),edgePlacement:ue("inside","outside")},link:{itemStyler:ye({...Ee,...Ae,...Oe}),...Ee,...Ae,...Oe},node:{width:re,spacing:re,minSpacing:Wt(re,(Ev="spacing",Bt((t,{options:e})=>!Yt(t)||!Yt(e[Ev])||t<=e[Ev],`the value to be less than or equal to \`${Ev}\``))),alignment:ue("left","center","right","justify"),verticalAlignment:ue("top","bottom","center"),sort:ue("data","ascending","descending","auto"),itemStyler:ye({...Ee,...Ae,...Oe}),...Ee,...Ae,...Oe},tooltip:Ny,...My},hM={fills:ge(Te),strokes:ge(Qt),colorRange:ge(Qt),sectorSpacing:re,cornerRadius:re,padding:re,itemStyler:ye({...Ee,...Ae}),label:{spacing:re,...Ay},secondaryLabel:Ay,tooltip:Ny,...Vs(My,["highlight","showInLegend"]),...Vs(Ee,["fill"]),...Vs(Ae,["stroke"]),highlightStyle:{label:{color:Qt},secondaryLabel:{color:Qt},...Ee,...Ae}},dM={fills:ge(Te),strokes:ge(Qt),colorRange:ge(Qt),itemStyler:ye({...Ee,...Ae}),group:{gap:re,padding:re,cornerRadius:re,textAlign:ue("left","center","right"),interactive:Zt,label:{...ky,spacing:re},...Ee,...Ae},tile:{gap:re,padding:re,cornerRadius:re,textAlign:ue("left","center","right"),verticalAlign:ue("top","middle","bottom"),label:{...ky,spacing:re,lineHeight:re,minimumFontSize:re,wrapping:ue("never","always","hyphenate","on-space"),overflowStrategy:ue("ellipsis","hide")},secondaryLabel:{...ky,lineHeight:re,minimumFontSize:re,wrapping:ue("never","always","hyphenate","on-space"),overflowStrategy:ue("ellipsis","hide")},...Ee,...Ae},tooltip:Ny,...Vs(My,["highlight","showInLegend"]),highlightStyle:{group:{label:{color:Qt},...Ee,...Ae},tile:{label:{color:Qt},secondaryLabel:{color:Qt},...Ee,...Ae}}},uM={name:ie,cornerRadius:re,itemStyler:ye({...Ee,...Ae,...Oe,cornerRadius:re}),label:{...ky,placement:ue("inside-start","inside-center","inside-end","outside-start","outside-end"),spacing:re},tooltip:Ny,shadow:Ly,...Ee,...Ae,...Oe},pM={direction:ue("horizontal","vertical"),showInMiniChart:Zt,item:{positive:uM,negative:uM,total:uM},line:{enabled:Zt,...Ae,...Oe},tooltip:Ny,...My},gM=Ht({__type:Ft(pe("date")),value:_t(ie,te)},"a serializable date object"),mM={width:re,height:re,grip:Zt,fill:Qt,stroke:Qt,strokeWidth:re,cornerRadius:re},fM={enabled:Zt,height:re,spacing:re,cornerRadius:te,mask:{fill:Qt,fillOpacity:ce,stroke:Qt,strokeWidth:re},minHandle:mM,maxHandle:mM,miniChart:{enabled:Zt,padding:{top:re,bottom:re},label:{enabled:Zt,avoidCollisions:Zt,spacing:re,format:by,formatter:fe(ry),interval:{minSpacing:re,maxSpacing:re,values:Kt,step:te},...We},series:Jt}},yM={number:{...Vs(Db,["type","crossLines"]),top:Vs(Db,["type","crossLines","position"]),right:Vs(Db,["type","crossLines","position"]),bottom:Vs(Db,["type","crossLines","position"]),left:Vs(Db,["type","crossLines","position"]),crossLines:Vs(Uy,["type"])},log:{...Vs(kb,["type","crossLines"]),top:Vs(kb,["type","crossLines","position"]),right:Vs(kb,["type","crossLines","position"]),bottom:Vs(kb,["type","crossLines","position"]),left:Vs(kb,["type","crossLines","position"]),crossLines:Vs(Uy,["type"])},category:{...Vs(wb,["type","crossLines"]),top:Vs(wb,["type","crossLines","position"]),right:Vs(wb,["type","crossLines","position"]),bottom:Vs(wb,["type","crossLines","position"]),left:Vs(wb,["type","crossLines","position"]),crossLines:Vs(Uy,["type"])},time:{...Vs(Ab,["type","crossLines"]),top:Vs(Ab,["type","crossLines","position"]),right:Vs(Ab,["type","crossLines","position"]),bottom:Vs(Ab,["type","crossLines","position"]),left:Vs(Ab,["type","crossLines","position"]),crossLines:Vs(Uy,["type"])},"unit-time":{...Vs(Nb,["type","crossLines"]),top:Vs(Nb,["type","crossLines","position"]),right:Vs(Nb,["type","crossLines","position"]),bottom:Vs(Nb,["type","crossLines","position"]),left:Vs(Nb,["type","crossLines","position"]),crossLines:Vs(Uy,["type"])},"grouped-category":{...Vs(Cb,["type"]),top:Vs(Cb,["type","position"]),right:Vs(Cb,["type","position"]),bottom:Vs(Cb,["type","position"]),left:Vs(Cb,["type","position"]),crossLines:Vs(Uy,["type"])},"ordinal-time":{...Vs(zb,["type","crossLines"]),top:Vs(zb,["type","crossLines","position"]),right:Vs(zb,["type","crossLines","position"]),bottom:Vs(zb,["type","crossLines","position"]),left:Vs(zb,["type","crossLines","position"]),crossLines:Vs(Uy,["type"])}},xM={"angle-category":{...Vs(Bb,["type","crossLines"]),crossLines:Vs(Hy,["type"])},"angle-number":{...Vs(jb,["type","crossLines"]),crossLines:Vs(Hy,["type"])},"radius-category":{...Vs(Vb,["type","crossLines"]),crossLines:{...Vs(Hy,["type"]),label:{...$y,positionAngle:te}}},"radius-number":{...Vs(Fb,["type","crossLines"]),crossLines:{...Vs(Hy,["type"]),label:{...$y,positionAngle:te}}}},bM={visible:Vt(Zt)};function vM(t,e){const i={};for(const s of Reflect.ownKeys(t))i[s]=e(t[s],s,t);return i}var MM=vM({common:{...vy,navigator:fM,axes:{...yM,...xM},annotations:{...Tv,line:bv,"horizontal-line":vv,"vertical-line":vv,"disjoint-channel":Sv,"parallel-channel":Iv,"fibonacci-retracement":Dv,"fibonacci-retracement-trend-based":Dv,callout:kv,comment:Av,note:wv,text:uv,arrow:bv,"arrow-up":Cv,"arrow-down":Cv,"date-range":Nv,"price-range":Nv,"date-price-range":Nv,"quick-date-price-range":Lv},chartToolbar:{enabled:Zt},initialState:{legend:me({visible:Zt,seriesId:ie,itemId:ie,legendItemName:ie},"legend state array"),zoom:{rangeX:{start:_t(te,gM),end:_t(te,gM)},rangeY:{start:_t(te,gM),end:_t(te,gM)},ratioX:{start:ce,end:ce},ratioY:{start:ce,end:ce},autoScaledAxes:ge(pe("y"))}}},line:{...vy,axes:yM,series:ev,navigator:fM,...bM},scatter:{...vy,axes:yM,series:sv,navigator:fM,...bM,paired:Vt(Zt)},bubble:{...vy,axes:yM,series:Zb,navigator:fM,...bM},area:{...vy,axes:yM,series:Hb,navigator:fM,...bM},bar:{...vy,axes:yM,series:Yb,navigator:fM,...bM},"box-plot":{...vy,axes:yM,series:zv,navigator:fM,...bM},candlestick:{...vy,axes:yM,series:Fv,navigator:fM,...bM},"cone-funnel":{...vy,axes:yM,series:Gv,navigator:fM,...bM},funnel:{...vy,axes:yM,series:$v,navigator:fM,...bM},ohlc:{...vy,axes:yM,series:Uv,navigator:fM,...bM},histogram:{...vy,axes:Vs(yM,["category","grouped-category","unit-time","ordinal-time"]),series:Qb,navigator:fM,...bM},heatmap:{...vy,axes:yM,series:Hv,navigator:fM,...bM},waterfall:{...vy,axes:yM,series:pM,navigator:fM,...bM},"range-bar":{...vy,axes:yM,series:lM,navigator:fM,...bM},"range-area":{...vy,axes:yM,series:oM,navigator:fM,...bM},donut:{...vy,series:lv,navigator:fM,...bM},pie:{...vy,series:ov,navigator:fM,...bM},"radar-line":{...vy,axes:xM,series:tM,navigator:fM,...bM},"radar-area":{...vy,axes:xM,series:Jv,navigator:fM,...bM},"radial-bar":{...vy,axes:xM,series:eM,navigator:fM,...bM},"radial-column":{...vy,axes:xM,series:iM,navigator:fM,...bM},nightingale:{...vy,axes:xM,series:Qv,navigator:fM,...bM},sunburst:{...vy,series:hM,navigator:fM,...bM},treemap:{...vy,series:dM,navigator:fM,...bM},"map-shape":{...vy,series:Kv,navigator:fM,...bM},"map-line":{...vy,series:Wv,navigator:fM,...bM},"map-marker":{...vy,series:Yv,navigator:fM,...bM},"map-shape-background":{...vy,series:Zv,navigator:fM,...bM},"map-line-background":{...vy,series:_v,navigator:fM,...bM},sankey:{...vy,series:cM,navigator:fM,...bM},chord:{...vy,series:Vv,navigator:fM,...bM},pyramid:{...vy,series:qv,navigator:fM,...bM},"radial-gauge":{...vy,...jy,targets:Vs(Ry,["value"]),tooltip:{...jy.tooltip,...vy.tooltip}},"linear-gauge":{...vy,...Py,targets:Vs(Oy,["value"]),tooltip:{...Py.tooltip,...vy.tooltip}}},function t(e,i){if(q(i))return e;if(U(e))return _t(e,ve,q);if(W(e))return _t(Ht(vM(e,Tt in e?e=>W(e)?vM(e,t):e:t)),ve,q);throw new Error(`Invalid theme override value: ${String(e)}`)}),SM={BLUE:"#0083ff",ORANGE:"#ff6600",GREEN:"#00af00",CYAN:"#00ccff",YELLOW:"#f7c700",VIOLET:"#ac26ff",GRAY:"#a7a7b7",MAGENTA:"#e800c5",BROWN:"#b54300",RED:"#ff0000"},IM={BLUE:"#67b7ff",ORANGE:"#ffc24d",GREEN:"#5cc86f",CYAN:"#54ebff",VIOLET:"#fff653",YELLOW:"#c18aff",GRAY:"#aeaeae",MAGENTA:"#f078d4",BROWN:"#ba8438",RED:"#ff726e"},DM=class extends Nf{getDefaultColors(){return{fills:SM,fillsFallback:Object.values(SM),strokes:IM,sequentialColors:uf(SM),divergingColors:[SM.ORANGE,SM.YELLOW,SM.GREEN],hierarchyColors:[],secondSequentialColors:["#0083ff","#0076e6","#0069cc","#005cb3","#004f99","#004280","#003466","#00274c"],secondDivergingColors:[SM.GREEN,SM.YELLOW,SM.RED],secondHierarchyColors:[],up:{fill:SM.GREEN,stroke:IM.GREEN},down:{fill:SM.RED,stroke:IM.RED},neutral:{fill:SM.GRAY,stroke:IM.GRAY},altUp:{fill:SM.BLUE,stroke:IM.BLUE},altDown:{fill:SM.ORANGE,stroke:IM.ORANGE},altNeutral:{fill:SM.GRAY,stroke:IM.GRAY}}}getTemplateParameters(){const t=super.getTemplateParameters();return t.set(Cm,SM.BLUE),t.set(Tm,SM.BLUE),t}},kM={BLUE:"#0083ff",ORANGE:"#ff6600",GREEN:"#00af00",CYAN:"#00ccff",YELLOW:"#f7c700",VIOLET:"#ac26ff",GRAY:"#a7a7b7",MAGENTA:"#e800c5",BROWN:"#b54300",RED:"#ff0000"},AM={BLUE:"#0f68c0",ORANGE:"#d47100",GREEN:"#007922",CYAN:"#009ac2",VIOLET:"#bca400",YELLOW:"#753cac",GRAY:"#646464",MAGENTA:"#9b2685",BROWN:"#6c3b00",RED:"#cb0021"},wM=class extends kf{getDefaultColors(){return{...super.getDefaultColors(),fills:kM,fillsFallback:Object.values(kM),strokes:AM,sequentialColors:uf(kM),divergingColors:[kM.ORANGE,kM.YELLOW,kM.GREEN],hierarchyColors:[],secondSequentialColors:["#0083ff","#1a8fff","#339cff","#4da8ff","#66b5ff","#80c1ff","#99cdff","#b3daff"],secondDivergingColors:[kM.GREEN,kM.YELLOW,kM.RED],secondHierarchyColors:[],up:{fill:kM.GREEN,stroke:AM.GREEN},down:{fill:kM.RED,stroke:AM.RED},neutral:{fill:kM.GRAY,stroke:AM.GRAY},altUp:{fill:kM.BLUE,stroke:AM.BLUE},altDown:{fill:kM.ORANGE,stroke:AM.ORANGE},altNeutral:{fill:kM.GRAY,stroke:AM.GRAY}}}getTemplateParameters(){const t=super.getTemplateParameters();return t.set(Cm,kM.BLUE),t.set(Tm,kM.BLUE),t}},CM=kl(()=>new kf),NM=bs.create(!0,"perf"),LM=(t,e,i)=>{NM("[CACHE] ChartTheme",t,e.name,i)},TM={"ag-default-dark":kl(()=>new Nf),"ag-sheets-dark":kl(()=>new Xf,LM),"ag-polychroma-dark":kl(()=>new Uf,LM),"ag-vivid-dark":kl(()=>new DM,LM),"ag-material-dark":kl(()=>new Bf,LM),"ag-financial-dark":kl(()=>new Ef,LM),"ag-default":CM,"ag-sheets":kl(()=>new Jf,LM),"ag-polychroma":kl(()=>new Yf,LM),"ag-vivid":kl(()=>new wM,LM),"ag-material":kl(()=>new Gf,LM),"ag-financial":kl(()=>new Pf,LM)},EM=kl(function(t){if(t instanceof kf)return t;if(!function(t){const{invalid:e}=jt({theme:t},{theme:_t(RM,ee)});for(const t of e)i.warnOnce(String(t));return 0===e.length}(t))return CM();if(null==t||"string"==typeof t){const e=TM[t??"ag-default"];if(e)return e();throw new Error(`Cannot find theme \`${t}\`.`)}const{cleared:e,invalid:s}=jt(function(t){if(!W(t)||!W(t.baseTheme))return t;let e,i,s=t;const n=[];for(;"object"==typeof s;)e??(e=s.palette),i??(i=s.params),s.overrides&&n.push(s.overrides),s=s.baseTheme;return{baseTheme:s,overrides:zs(...n),params:i,palette:e}}(t),OM,"theme");for(const t of s)i.warnOnce(String(t));const n=e?.baseTheme?EM(e.baseTheme):CM();return e?new n.constructor(e):n},LM),OM={baseTheme:_t(ie,ee),overrides:MM,params:{accentColor:Qt,axisColor:Qt,backgroundColor:Qt,borderColor:Qt,borderRadius:te,chartBackgroundColor:Qt,chartPadding:te,focusShadow:ie,foregroundColor:Qt,fontFamily:Ue,fontSize:te,fontWeight:_t(ie,te),gridLineColor:Qt,popupShadow:ie,subtleTextColor:Qt,textColor:Qt,chromeBackgroundColor:Qt,chromeFontFamily:Ue,chromeFontSize:te,chromeFontWeight:_t(ie,te),chromeSubtleTextColor:Qt,chromeTextColor:Qt,buttonBackgroundColor:Qt,buttonBorder:Zt,buttonFontWeight:te,buttonTextColor:Qt,inputBackgroundColor:Qt,inputBorder:Zt,inputTextColor:Qt,menuBackgroundColor:Qt,menuBorder:Zt,menuTextColor:Qt,panelBackgroundColor:Qt,panelSubtleTextColor:Qt,tooltipBackgroundColor:Qt,tooltipBorder:Zt,tooltipTextColor:Qt,tooltipSubtleTextColor:Qt,crosshairLabelBackgroundColor:Qt,crosshairLabelTextColor:Qt},palette:{fills:ge(Te),strokes:ge(Qt),up:{fill:_t(Qt,ke),stroke:Qt},down:{fill:_t(Qt,ke),stroke:Qt},neutral:{fill:_t(Qt,ke),stroke:Qt}}},RM=ue("ag-default","ag-default-dark","ag-sheets","ag-sheets-dark","ag-polychroma","ag-polychroma-dark","ag-vivid","ag-vivid-dark","ag-material","ag-material-dark","ag-financial","ag-financial-dark"),PM={isEnterprise:!1},zM="path",jM="pathArray",BM="default",FM="override",VM="user",GM="userPartial",$M="operation",HM="operationValue",UM="dependency",WM="autoEnable",_M="autoEnableValue",YM="prune",KM="childrenSource";function ZM(t){return X(t)&&t>=0&&t<=1}function XM(t,e){let i=t;for(const t of e){if("string"!=typeof t||null==i||"object"!=typeof i&&!Array.isArray(i)||!(t in i))return!1;i=i[t]}return!0}function QM(t,e){let i=t;for(const t of e){if("string"!=typeof t||null==i||"object"!=typeof i&&!Array.isArray(i)||!(t in i))return;i=i[t]}return i}function qM(t,e,i){const s=e.length;if(0===s)return;let n=t;const a=s-1,o=e[a];for(let t=0;t<a;t++){const i=e[t],s=e[t+1];let a=n[i];null!=a&&_(a)||(a=Number.isNaN(Number(s))?{}:[],n[i]=a),n=a}n[o]=i}var JM=/^\d+$/;function tS(t,e=0){let i=0;for(let s=t.length-1;s>=0;s--){const n=t[s];if(JM.test(n)&&(i++,i>e))return s}return-1}function eS(t,e=0){const i=tS(t,e);return Number(t[i])}function iS(t,e,i){const s=e.split("/");let n=[...t];e.startsWith("/")&&(n=[],s.shift());let a=!1;for(const e of s){if(".."===e)n.pop(),a||n.pop();else if("."===e)n.pop();else if("$index"===e){const e=eS(t);if(Number.isNaN(e))return sS;n.push(`${e}`)}else if("$prevIndex"===e){const e=eS(t);if(Number.isNaN(e)||Number(e)<=0)return sS;n.push(""+(Number(e)-1))}else if(e.startsWith("$")){const t=i?.[e.slice(1)];if(null==t)return sS;n.push(t)}else 0!==e.length&&n.push(e);a=".."===e}return n}var sS=Symbol("unresolvable-path"),nS=Symbol("resolved-to-branch");function aS(t,e){if(null==t||"object"!=typeof t||Array.isArray(t))return;if(e??(e=Object.keys(t)),0===e.length)return;const i=e[0];return yS.has(i)?{operation:i,values:Array.isArray(t[i])?t[i]:[t[i]]}:void 0}var oS={$cacheMax:function(t,e,i){const[s]=i,n=t.getPathArray(e),a=t.getCachedValue(n,"$cacheMax"),o=t.resolveVertexValue(e,s);if("number"!=typeof o)return a;if("number"!=typeof a)return t.setCachedValue(n,"$cacheMax",o),o;const r=Math.max(a,o);return t.setCachedValue(n,"$cacheMax",r),r}},rS={$hasSeriesType:{dependencies:lS,resolve:function(t,e,i){const[s]=i,n=t.resolveVertexValue(e,s),a=t.getResolvedPath(["series"]);if(!Array.isArray(a))return!1;for(const t of a)if(t.type===n)return!0;return!1}},$isChartType:{dependencies:lS,resolve:function(t,e,i){const[s]=i,n=t.resolveVertexValue(e,s),a=t.getResolvedPath(["series","0","type"]);if("string"!=typeof a)return!1;switch(n){case"cartesian":return td.isCartesian(a);case"polar":return td.isPolar(a);case"standalone":return td.isStandalone(a)}return!1}},$isSeriesType:{dependencies:lS,resolve:function(t,e,i){const[s]=i,n=t.resolveVertexValue(e,s);return t.getResolvedPath(["series","0","type"])===n}}};function lS(t,e,i){const s=t.findVertexAtPath(["series","0","type"]);s&&t.addEdge(e,s,UM)}var cS={$foregroundBackgroundMix:function(t,e,s){const[n]=s,a=t.resolveVertexValue(e,n),o=t.getParamValue("foregroundColor"),r=t.getParamValue("backgroundColor");if("string"==typeof o&&"string"==typeof r&&ZM(a))return In.mix(In.fromString(o),In.fromString(r),1-a).toString();bs.inDevelopmentMode(()=>i.warnOnce(`\`$foregroundBackgroundMix\` json operation failed on [${String(a)}}}] at [${t.getPathArray(e).join(".")}], expecting a number between 0 and 1.`))},$foregroundOpacity:function(t,e,s){const[n]=s,a=t.resolveVertexValue(e,n),o=t.getParamValue("foregroundColor");if("string"==typeof o&&ZM(a)){const t=In.fromString(o);return new In(t.r,t.g,t.b,a).toString()}bs.inDevelopmentMode(()=>i.warnOnce(`\`$foregroundOpacity\` json operation failed on [${String(a)}}}] at [${t.getPathArray(e).join(".")}], expecting a number between 0 and 1.`))},$interpolate:function(t,e,i){const[s,n]=i,a=t.resolveVertexValue(e,s),o=t.resolveVertexValue(e,n);if(G(a)&&X(o))return In.interpolate(a.map(t=>In.fromString(t)),o).map(t=>t.toString())},$isGradient:function(t,e,i){const[s]=i;return pa(t.resolveVertexValue(e,s))},$isImage:function(t,e,i){const[s]=i;return fa(t.resolveVertexValue(e,s))},$isPattern:function(t,e,i){const[s]=i;return ma(t.resolveVertexValue(e,s))},$mix:function(t,e,s){const[n,a,o]=s,r=t.resolveVertexValue(e,n),l=t.resolveVertexValue(e,a),c=t.resolveVertexValue(e,o),h=t.getPathArray(e),d=`\`$mix\` json operation failed on [${String(r)}, ${String(l)}, ${String(c)}] at [${h.join(".")}], expecting`,u=`${d} two colors and a number between 0 and 1.`;if("string"!=typeof l||!ZM(c))return void bs.inDevelopmentMode(()=>i.warnOnce(u));if("string"==typeof r)try{return In.mix(In.fromString(r),In.fromString(l),c).toString()}catch{return void bs.inDevelopmentMode(()=>i.warnOnce(u))}if(!pa(r))return void bs.inDevelopmentMode(()=>i.warnOnce(u));let p=r.colorStops;try{p=p?.map(t=>{let e;return"string"==typeof t.color&&(e=In.mix(In.fromString(t.color),In.fromString(l),c).toString()),{...t,color:e}})}catch{return void bs.inDevelopmentMode(()=>i.warnOnce(`${d} a gradient, a color and a number between 0 and 1.`))}return{...r,colorStops:p}}},hS={$rem:function(t,e,s){const[n]=s,a=t.getVertexValue(n),o=t.getParamValue("fontSize");if("number"==typeof o&&"number"==typeof a)return Math.round(a*o);bs.inDevelopmentMode(()=>i.warnOnce(`\`$rem\` json operation failed on [${String(a)}] at [${t.getPathArray(e).join(".")}], expecting a number.`))}},dS={$and:function(t,e,i){for(const s of i)if(!t.resolveVertexValue(e,s))return!1;return!0},$eq:function(t,e,i){let s,n=!0;for(const a of i){const i=t.resolveVertexValue(e,a);if(n)s=i,n=!1;else if(i!==s)return!1}return!0},$greaterThan:function(t,e,i){const[s,n]=i;return t.resolveVertexValue(e,s)>t.resolveVertexValue(e,n)},$if:function(t,e,i){const[s,n,a]=i,o=t.resolveVertexValue(e,s)?n:a,r=t.neighboursWithEdgeValue(o,zM);if(r)for(const i of r)t.addEdge(e,i,zM);return t.resolveVertexValue(e,o)},$lessThan:function(t,e,i){const[s,n]=i;return t.resolveVertexValue(e,s)<t.resolveVertexValue(e,n)},$not:function(t,e,i){const[s]=i;if(s)return!t.resolveVertexValue(e,s)},$or:function(t,e,i){for(const s of i)if(t.resolveVertexValue(e,s))return!0;return!1},$switch:function(t,e,i){const[s,n,...a]=i,o=t.resolveVertexValue(e,s);for(const e of a){const i=t.getVertexValue(e);if(!Array.isArray(i))continue;const[s,n]=i;if(o===s||Array.isArray(s)&&s.includes(o))return n}return t.resolveVertexValue(e,n)}},uS={$isUserOption:function(t,e,i){const[s,n,a]=i,o=t.neighboursWithEdgeValue(s,zM);if(o)for(const i of o){const s=t.findNeighbour(i,BM);if(s&&pS(t,e,s))return t.resolveVertexValue(e,n)}else if(pS(t,e,s))return t.resolveVertexValue(e,n);return t.resolveVertexValue(e,a)},$isThemeOverride:function(t,e,i){const[s,n,a]=i,o=t.resolveVertexValue(e,s);if(!Z(o))throw new Error(`\`$isThemeOverride\` json operation failed on [${String(o)}], expecting a string.`);const r=iS(t.getPathArray(e),o);if(r!==sS)return t.hasThemeOverride(r)?t.resolveVertexValue(e,n):t.resolveVertexValue(e,a)},$palette:function(t,e,i){const[s]=i,n=t.resolveVertexValue(e,s);if(!Z(n))return;if(gS.has(n)){const i=eS(t.getPathArray(e));if(Number.isNaN(i))return;switch(n){case"fill":return ti(t.palette.fills,1,i)[0];case"fillFallback":return ti(t.palette.fillsFallback,1,i)[0];case"stroke":return ti(t.palette.strokes,1,i)[0];case"gradient":return ti(t.palette.sequentialColors,1,i)[0];case"range2":return ti(t.palette.fills,2,i)}return}if("gradients"===n)return t.palette.sequentialColors;if("type"===n)return t.paletteType;const a=QM(t.palette,n.split("."));return Array.isArray(a)?[...a]:"object"==typeof a?{...a}:a},$mapPalette:function(t,e,i){const[s]=i,n=t.resolveVertexValue(e,s);if(!Z(n))return;if(gS.has(n)){let i=eS(t.getPathArray(e)),s=0;const a=["series","0","type"];for(let e=0;e<i;e++){a[1]=`${e}`;const i=t.getResolvedPath(a);"map-shape-background"!==i&&"map-line-background"!==i||s++}if(i-=s,Number.isNaN(i))return;switch(n){case"fill":return ti(t.palette.fills,1,i)[0];case"fillFallback":return ti(t.palette.fillsFallback,1,i)[0];case"stroke":return ti(t.palette.strokes,1,i)[0];case"gradient":return ti(t.palette.sequentialColors,1,i)[0];case"range2":return ti(t.palette.fills,2,i)}return}if("gradients"===n)return t.palette.sequentialColors;if("type"===n)return t.paletteType;const a=QM(t.palette,n.split("."));return Array.isArray(a)?[...a]:"object"==typeof a?{...a}:a},$path:{dependencies:mS,resolve:function(t,e,i){const s=i.length>1,n=i.length>2,[a,o,r]=i,l=t.resolveVertexValue(e,a),c=n?t.resolveVertexValue(e,r):null;if(!Z(l))throw new Error(`\`$path\` json operation failed on [${String(l)}], expecting a string.`);const h=iS(t.getPathArray(e),l);if(h===sS)return;const d=c?QM(c,h):t.getResolvedPath(h);return null!=d?d:s?t.resolveVertexValue(e,o):void 0}},$pathString:{dependencies:mS,resolve:function(t,e,i){const[s,n]=i,a=t.resolveVertexValue(e,s);if(!Z(a))throw new Error(`\`$path\` json operation failed on [${String(a)}], expecting a string.`);let o;n&&(o=t.graftAndResolveOrphan(e,n));const r=t.getPathArray(e),l=iS(r,a,o);if(l===sS)throw new Error(`Unresolvable path [${a}] at [${r.join(".")}]`);return l}},$ref:function(t,e,i){const[s]=i,n=t.getVertexValue(s);return t.getParamValue(n)}};function pS(t,e,i){const s=t.resolveVertexValue(e,i);if(!Z(s))throw new Error(`\`$isUserOption\` json operation failed on [${String(s)}], expecting a string.`);const n=iS(t.getPathArray(e),s);return n!==sS&&t.hasUserOption(n)}var gS=new Set(["fill","fillFallback","stroke","gradient","range2"]);function mS(t,e,i){const[s]=i,n=t.getVertexValue(s);if(Z(n)){const i=iS(t.getPathArray(e),n);if(i===sS)return;const s=t.findVertexAtPath(i);s&&t.addEdge(e,s,UM)}}var fS={...oS,...rS,...cS,...hS,...uS,...dS,$isEven:function(t,e,i){const[s]=i,n=t.resolveVertexValue(e,s);return!Number.isNaN(Number(n))&&Number(n)%2==0},$mul:function(t,e,i){let s;for(const n of i){const i=t.resolveVertexValue(e,n);null==s?s=Number(i):s*=Number(i)}return s},$round:function(t,e,i){const[s]=i;if(s)return Math.round(Number(t.resolveVertexValue(e,s)))},$apply:function(t,e,i){const[s,n,a,o]=i,r=t.getVertexValue(s);if(!Y(r))return;const l=n?t.getVertexValue(n):void 0,c=t.neighboursWithEdgeValue(e,zM),h=c&&c.length>0;if(!h&&null==l)return nS;const d=a?t.resolveVertexValue(e,a):void 0,u=o?t.resolveVertexValue(e,o):void 0;if(!h&&null!=l)if(aS(l)){const i=t.resolveVertexValue(e,n);Y(i)&&t.graftObject(e,i,[d,u])}else t.graftObject(e,l,[d,u]);if(!h)return nS;for(const e of c){const i=t.neighboursWithEdgeValue(e,zM);if(i&&0!==i.length)t.graftObject(e,r,[d,u]);else{const i=t.addVertex({});t.addEdge(e,i,BM)}}return nS},$applyCycle:function(t,e,i){const[s,n,a]=i,o=t.resolveVertexValue(e,s);if("number"!=typeof o)return;const r=t.getPathArray(e),l=t.dangerouslyGetUserOption(r),c=t.hasThemeOverride(r),h=null==l?void 0:VM,d=l??t.resolveVertexValue(e,n);if(!Array.isArray(d))return;const u=a?t.getVertexValue(a):void 0;for(let i=0;i<o;i++){const s=d[i%d.length];null!=s&&(!l&&c||t.graftValue(e,`${i}`,s,void 0,h),u&&t.graftValue(e,`${i}`,u,s,h))}return nS},$applySwitch:function(t,e,i){const[s,n,...a]=i,o=t.resolveVertexValue(e,s);for(const i of a){const s=t.getVertexValue(i);if(!Array.isArray(s))continue;const[n,a]=s;if(o===n||Array.isArray(n)&&n.includes(o))return t.graftObject(e,a,[],BM),nS}return t.resolveVertexValue(e,n)},$applyTheme:function(t,e,i){const[s,n,a]=i;let o=t.getVertexValue(s);if("string"==typeof o&&(o=[o]),!Array.isArray(o))return;const r=t.neighboursWithEdgeValue(e,zM),l=a?t.getVertexValue(a):[],c=Array.isArray(l)?new Set(l):new Set;if(!r)return nS;for(const e of r){const i=t.graftAndResolveOrphan(e,n);for(const s of o){const n=iS([],s,i);n!==sS&&t.graftConfig(e,n,c)}}return nS},$findFirstSiblingNotOperation:function(t,e,i){const[s]=i,n=t.getPathArray(e),a=tS(n);if(a<0)return t.resolveVertexValue(e,s);const o=n.slice(0,a),r=t.findVertexAtPath(o);if(!r)return t.resolveVertexValue(e,s);const l=t.neighboursWithEdgeValue(r,zM);if(l)for(let e=0;e<l.length;e++){if(`${e}`===n[a])continue;const i=o.concat([`${e}`,...n.slice(a+1)]),s=t.findVertexAtPath(i);if(!s)continue;const r=t.findNeighbourValue(s,VM);if(null!=r)return r;const l=t.findNeighbourValue(s,FM);if(null!=l)return l}return t.resolveVertexValue(e,s)},$map:function(t,e,i){const[s,n]=i,a=t.getVertexValue(s),o=t.resolveVertexValue(e,n);if(!Array.isArray(o))return;const r=t.neighboursWithEdgeValue(e,zM);if(r&&r.length>0)return;let l=0;for(const i of o)t.graftValue(e,`${l}`,a,i),l++;return nS},$merge:function(t,e,i){for(const s of i){const i=t.resolveVertexValue(e,s);Y(i)&&t.graftObject(e,i)}return nS},$omit:function(t,e,i){const[s,n]=i;let a=t.getVertexValue(s);if(!Array.isArray(a)){const i=function(t,e,i){const s=aS(t.getVertexValue(i));switch(s?.operation){case"$path":{const[i]=s.values,n=iS(t.getPathArray(e),i);if(n===sS)return;return t.findVertexAtPath(n)}case"$value":return e}}(t,e,n);if(!i)return;a=t.resolveVertexValue(i,s)}const o=t.resolveVertexValue(e,n);if(Array.isArray(a)&&Y(o))return Vs(o,a)},$size:function(t,e,i){const[s]=i,n=t.resolveVertexValue(e,s);return _(n)?"length"in n?n.length:Object.keys(n).length:0},$shallow:function(t,e,i){const s=t.getPathArray(e),n=t.hasUserOption(s);if(!n&&1===i.length)return t.resolveVertexValue(e,i[0]);const a=[];for(const e of i)a.push(t.getVertexValue(e));return n?(t.prune(e,[FM,BM]),nS):(t.graftObject(e,a),nS)},$shallowSimple:function(t,e,i){const s=[];for(const e of i)s.push(t.getVertexValue(e));return s},$value:function(t,e,i){const[s]=i,n=t.getVertexValue(s),a=t.getPathArray(e);return"$index"===n?eS(a):"$parentIndex"===n?eS(a,1):"$1"===n?t.resolveValue$1(a):void 0}},yS=new Set(Object.keys(fS));function xS(t){return yS.has(t)}var bS=bs.create("opts","options-graph"),vS=kl(function(t,e){return bS.group("OptionsGraph.constructor()",()=>new SS(t.config,e,t.params,t.palette,t.overrides,t.getTemplateParameters()))}),MS=class t extends Ni{constructor(e={},i={},s=void 0,n={},a=void 0,o=new Map){super(zM,$M,new Set([GM,VM])),this.config=e,this.userOptions=i,this.palette=n,this.overrides=a,this.internalParams=o,this.edgePriority=[...t.EDGE_PRIORITY],this.graftEdge=t.GRAFT_EDGE,this.resolvedParams={},this.resolvedAnnotations={},this.value$1=new Map,this.cachedPathVertices=new Map,this.hasUnsafeClearKeys=!1,this.rollbackVertices=[],this.rollbackEdgesFrom=[],this.rollbackEdgesTo=[],this.rollbackEdgesValue=[],this.isRollingBack=!1,this.EMPTY_PATH_ARRAY_VERTEX=this.addVertex([]),this.root=this.addVertex("root"),this.params=this.addVertex("params"),this.annotations=this.addVertex("annotations"),this.paletteType=W(i?.theme)?am(i.theme?.palette):"inbuilt";const r=i.series?.[0]?.type??"line";i.axes??(i.axes=sd.predictAxes(r,i.series?.[0],i.data)??sd.cloneDefaultAxes(r)??[]),bS("build user"),this.buildGraphFromObject(this.root,VM,Vs(i,["theme"])),bS("build defaults"),this.buildGraphFromObject(this.root,BM,Vs(e[r],t.COMPLEX_KEYS));const l=a?Vs(a[r],t.COMPLEX_KEYS):{};Object.keys(l).length>0&&(bS("build series overrides"),this.buildGraphFromObject(this.root,FM,l));const c=a?Vs(a.common,t.COMPLEX_KEYS):{};Object.keys(c).length>0&&(bS("build common overrides"),this.buildGraphFromObject(this.root,FM,td.isCartesian(r)?c:Vs(c,["zoom","navigator"]))),s&&(bS("build params"),this.buildGraphFromObject(this.params,BM,s));const h=this.findNeighbourWithValue(this.root,"axes",zM),d=this.findNeighbourWithValue(this.root,"series",zM);h&&(bS("build axes"),this.buildGraphFromObject(h,BM,{$applyTheme:[["/$seriesType/axes/$axisType/$position","/$seriesType/axes/$axisType"],{seriesType:{$path:["/series/0/type","line"]},axisType:{$path:["./type","category"]},position:{$path:["./position"]}},["top","right","bottom","left"]]})),d&&(bS("build series"),this.buildGraphFromObject(d,BM,{$applyTheme:["/$seriesType/series",{seriesType:{$path:["./type","line"]}}]}));const u=Vs(e[r]?.annotations??{},t.ANNOTATIONS_OPTIONS_KEYS);Object.keys(u).length>0&&(bS("build annotations type config"),this.buildGraphFromObject(this.annotations,BM,u));const p=Vs(a?.common?.annotations??{},t.ANNOTATIONS_OPTIONS_KEYS);Object.keys(p).length>0&&(bS("build annotations type overrides"),this.buildGraphFromObject(this.annotations,FM,p));const g=Gs(e[r]?.annotations??{},t.ANNOTATIONS_OPTIONS_KEYS);Object.keys(g).length>0&&(bS("build annotations config"),this.buildGraphFromObject(this.root,BM,{annotations:g}));const m=Gs(a?.common?.annotations??{},t.ANNOTATIONS_OPTIONS_KEYS);Object.keys(m).length>0&&(bS("build annotations overrides"),this.buildGraphFromObject(this.root,FM,{annotations:m})),this.buildDependencyGraph()}clear(){bS.group("OptionsGraph.clear()",()=>{super.clear(),this.cachedPathVertices.clear(),this.root=void 0,this.params=void 0,this.annotations=void 0,bS("cleared")})}clearSafe(){this.hasUnsafeClearKeys||this.clear()}resolve(){return bS.group("OptionsGraph.resolve()",()=>(this.resolved={},this.resolvedParams={},this.resolvedAnnotations={},bS("resolve params"),this.resolveVertex(this.params,this.resolvedParams),bS("resolve annotations"),this.resolveVertex(this.annotations,this.resolvedAnnotations),bS("resolve root"),this.resolveVertex(this.root),bS("resolved root",this.resolved),bS("vertex count",this.getVertexCount()),bS("edge count",this.getEdgeCount()),this.resolved))}resolveParams(){return this.resolvedParams}resolveAnnotationThemes(){return this.resolvedAnnotations}addVertex(t){const e=super.addVertex(t);return this.isRollingBack&&this.rollbackVertices.push(e),e}addEdge(t,e,i){const s=-1!==(this.neighboursWithEdgeValue(t,i)?.indexOf(e)??-1);this.isRollingBack&&!s&&(this.rollbackEdgesFrom.push(t),this.rollbackEdgesTo.push(e),this.rollbackEdgesValue.push(i)),super.addEdge(t,e,i)}resolvePartial(e,i,s){if(!i)return;if(!this.root)return;const{permissivePath:n,proxyPaths:a}=s??{},o=Object.keys(i);if(bS.check()&&console.groupCollapsed(`OptionsGraph.resolvePartial() - ${e.join(".")} [${o}]`),0===o.length)return{};const r=this.findVertexAtPath(e);if(!r){if(n)return;throw new Error(`Could not find vertex in OptionsGraph at path [${e.join(".")}].`)}const l=this.findNeighbour(r,jM);if(this.userPartialOptions={},qM(this.userPartialOptions,e,i),a)for(const t of Object.keys(a)){const s=a[t],n=QM(i,[t]);null!=n&&(qM(i,s,n),qM(this.userPartialOptions,[...e,...s],n),delete i[t],delete this.userPartialOptions[t])}this.graftEdge=GM,this.edgePriority=[GM,...t.EDGE_PRIORITY],this.snapshot(),this.buildGraphFromObject(r,GM,i,l);for(const t of o){const i=a?.[t]?this.findVertexAtPath([...e,...a[t]]):this.findNeighbourWithValue(r,t,zM);i&&this.refreshPendingProcessingEdges(i)}this.buildDependencyGraph();const c={};if(this.resolveVertex(r,c),this.rollback(),this.graftEdge=t.GRAFT_EDGE,this.edgePriority=t.EDGE_PRIORITY,this.userPartialOptions=void 0,a)for(const t of Object.keys(a)){const i=a[t],s=QM(c,[...e,...i]);qM(c,[...e,t],s)}const h=QM(c,e),d=s?.pick??1?Gs(QM(c,e),o):h;return bS("vertex count",this.getVertexCount()),bS("edge count",this.getEdgeCount()),bS("resolved partial",d),bS.check()&&console.groupEnd(),d}findVertexAtPath(t){const e=t.join(".");if(this.cachedPathVertices.has(e))return this.cachedPathVertices.get(e);const i=this.findVertexAlongEdge(this.root,t,zM);return i?(this.cachedPathVertices.set(e,i),i):void 0}hasUserOption(t){if(XM(this.userOptions,t))return!0;const e=this.findVertexAtPath(t);if(e){if(null!=this.findNeighbour(e,VM))return!0;if(null!=this.findNeighbour(e,GM))return!0;const t=this.findNeighbourValue(e,KM);return t===VM||t===GM}return!1}dangerouslyGetUserOption(t){if(this.userPartialOptions){const e=QM(this.userPartialOptions,t);if(null!=e)return e}return QM(this.userOptions,t)}hasThemeOverride(t){if(null==this.overrides)return!1;if("axes"===t[0]&&t.length>1){const e=this.getResolvedPath(["axes",t[1],"type"]);if(XM(this.overrides,["common","axes",e,...t.slice(2)]))return!0;const i=this.getResolvedPath(["series","0","type"]);return XM(this.overrides,[i,"axes",e,...t.slice(2)])}if("series"===t[0]&&t.length>1){const e=this.getResolvedPath(["series",t[1],"type"]);return XM(this.overrides,[e,"series",...t.slice(2)])}return XM(this.overrides,t)}getParamValue(t){if(null!=this.resolvedParams[t])return this.resolvedParams[t];const e=this.findVertexAlongEdge(this.params,[t],zM);if(!e)return;const i=this.findNeighbour(e,BM);if(!i)return;const s=this.resolveVertexValue(e,i);return this.resolvedParams[t]=s,s}getPathArray(t){return this.findNeighbourValue(t,jM)??[]}getResolvedPath(t){return QM(this.resolved,t)}getCachedValue(e,i){const s=[...e,i].join(".");return t.valueCache.get(s)}setCachedValue(e,i,s){const n=[...e,i].join(".");t.valueCache.set(n,s)}prune(t,e){this.addEdge(t,this.addVertex(e),YM)}resolveVertexValue(t,e){this.resolveVertexDependencies(e);const i=this.findNeighbourValue(e,$M);if(i&&xS(i)){const s=this.neighboursWithEdgeValue(e,HM),n=fS[i],a="function"==typeof n?n:n.resolve,o=a?.(this,t,s??[]);return o===nS?void 0:o}let s=this.getVertexValue(e);if(Array.isArray(s)){const i={};this.resolveVertexChildren(e,i),s=QM(i,this.getPathArray(t))}return this.resolveValueOrSymbol(s)}resolveValue$1(t){for(let e=t.length;e>=0;e--){const i=t.slice(0,e).join("."),s=this.value$1.get(i);if(null!=s)return s}}graftConfig(t,e,i){const s=QM(this.config,e),n=this.findNeighbour(t,jM);if(W(s)&&this.buildGraphFromObject(t,BM,s,n,void 0,i),this.overrides){const s=QM(this.overrides,e);W(s)&&this.buildGraphFromObject(t,FM,s,n,void 0,i);const a=QM(this.overrides,["common",...e.slice(1)]);W(a)&&this.buildGraphFromObject(t,FM,a,n,void 0,i)}this.buildDependencyGraph()}graftObject(t,e,i,s=this.graftEdge){const n=this.findNeighbour(t,jM);if(this.buildGraphFromObject(t,s,e,n),this.overrides&&i)for(const e of i){if(null==e)continue;const i=QM(this.overrides,e);i&&this.buildGraphFromObject(t,FM,i,n)}this.buildDependencyGraph()}graftValue(t,e,i,s,n=this.graftEdge){const a=[...this.getPathArray(t),e];this.value$1.set(a.join("."),s);const o=this.findVertexAtPath(a)??this.addVertex(e);this.buildGraphFromValue(t,o,n,a,i),this.buildDependencyGraph()}graftAndResolveOrphan(t,e){const i={},s=this.addVertex(i),n=this.getPathArray(t);return this.graftAndResolveChildren(e,s,n,[]),this.resolveVertex(s,i),QM(i,n)}buildGraphFromObject(e,i,s,n,a=t.SHALLOW_KEYS,o){const r=Object.keys(s),l=aS(s,r);if(l){const t=this.addVertex(s);return this.addEdge(e,t,i),void this.buildGraphFromOperation(t,i,l,n)}if(0===r.length)return this.addEdge(e,this.addVertex(Array.isArray(s)?[]:{}),i),void this.buildGraphAutoEnable(e,i,s,void 0);const c=this.getVertexChildrenByKey(e),h=n?this.getVertexValue(n):[];let d;Array.isArray(s)&&this.addEdge(e,this.addVertex(i),KM);const u=[...h],p=h.length;for(const t of r){if(o?.has(t))continue;const n=c?.get(t)??this.addVertex(t);u[p]=t,a?.has(t)?this.buildShallowGraphFromValue(e,n,i,u,s[t]):this.buildGraphFromValue(e,n,i,u,s[t],a),"enabled"===t&&(d=n)}this.buildGraphAutoEnable(e,i,s,d)}buildGraphAutoEnable(t,e,i,s){if(e===BM&&!s)return;if(e===VM&&s)return;if(e!==BM&&e!==VM&&e!==GM&&e!==FM)return;let n=this.findNeighbour(t,WM);n||(n=this.addVertex(WM),this.addEdge(t,n,WM)),s&&this.addEdge(s,n,_M);const{enabled:a,_enabledFromTheme:o}=i;this.addEdge(n,this.addVertex({enabled:a,_enabledFromTheme:o,keys:Object.keys(i).length}),e)}getVertexChildrenByKey(t){const e=this.neighboursWithEdgeValue(t,zM);if(!e)return;const i=new Map;for(const t of e)i.set(this.getVertexValue(t),t);return i}buildGraphFromValue(t,e,i,s,n,a){this.addEdge(t,e,zM);let o=this.findNeighbour(e,jM);o||(o=this.addVertex([...s]),this.addEdge(e,o,jM));const r=aS(n);if(r){const t=this.addVertex(n);this.addEdge(e,t,i),this.addEdge(t,o,jM),this.buildGraphFromOperation(t,i,r,o)}else if(_(n))this.buildGraphFromObject(e,i,n,o,a);else{const t=this.findNeighbour(e,i);if(t&&this.getVertexValue(t)===n)return;const s=this.addVertex(n);this.addEdge(e,s,i)}}buildShallowGraphFromValue(t,e,i,s,n){this.addEdge(t,e,zM);let a=this.findNeighbour(e,jM);a||(a=this.addVertex([...s]),this.addEdge(e,a,jM));const o=this.addVertex(n);this.addEdge(e,o,i)}buildGraphFromOperation(t,e,i,s){const n=this.addVertex(i.operation);this.addEdge(t,n,$M);for(const n of i.values)this.buildGraphFromOperationValue(t,n,e,s)}buildGraphFromOperationValue(t,e,i,s=this.EMPTY_PATH_ARRAY_VERTEX){const n=this.addVertex(e);this.addEdge(t,s,jM),this.addEdge(t,n,HM);const a=aS(e);a?this.buildGraphFromOperation(n,i,a,s):_(e)&&this.buildGraphFromObject(n,i,e,s)}buildDependencyGraph(){for(let t=0;t<this.pendingProcessingEdgesFrom.length;t++){const e=this.pendingProcessingEdgesFrom[t],i=this.pendingProcessingEdgesTo[t],s=this.getVertexValue(i);if(!xS(s))continue;const n=this.neighboursWithEdgeValue(e,HM),a=fS[s],o="function"==typeof a?void 0:a.dependencies;o?.(this,e,n??[])}this.pendingProcessingEdgesFrom=[],this.pendingProcessingEdgesTo=[]}refreshPendingProcessingEdges(t){const e=this.findNeighbour(t,BM)??t,i=this.findNeighbour(e,$M);if(i){this.pendingProcessingEdgesFrom.push(e),this.pendingProcessingEdgesTo.push(i);const t=this.neighboursWithEdgeValue(e,HM);if(t)for(const e of t)this.refreshPendingProcessingEdges(e)}const s=this.neighboursWithEdgeValue(t,zM);if(s)for(const t of s)this.refreshPendingProcessingEdges(t)}resolveVertex(t,e=this.resolved,i){const s=this.getPathArray(t);this.resolveVertexInEdgePriority(t,e,s,i),this.resolveVertexAutoEnable(t,e,s),this.resolveVertexChildren(t,e,i)}resolveVertexInEdgePriority(e,i,s,n){const a=this.neighboursWithEdgeValue(e,zM),[o]=this.edgePriority;for(const r of this.edgePriority){const l=this.findNeighbour(e,r);if(null==l)continue;const c=this.resolveVertexValueInternal(e,l);if((null!=c||r===o)&&!(a&&a.length>0&&r!==o||Array.isArray(n)&&n.includes(r))){if(this.hasUnsafeClearKeys||(this.hasUnsafeClearKeys=null!=c&&t.UNSAFE_CLEAR_KEYS.has(s.at(-1))),0===s.length){if(null==c)continue;this.resolved=c}else qM(i,s,c);break}}}resolveVertexValueInternal(t,e){this.resolveVertexDependencies(e);const i=this.findNeighbourValue(e,$M);if(i&&xS(i)){const s=this.neighboursWithEdgeValue(e,HM),n=fS[i],a="function"==typeof n?n:n.resolve,o=a?.(this,t,s??[]);return o===nS?void 0:o}return this.resolveValueOrSymbol(this.getVertexValue(e))}resolveVertexAutoEnable(t,e,i){const s=this.neighboursWithEdgeValue(t,_M)?.[0];if(!s)return;const n=this.findVertexAtPath(i),a=this.findNeighbourValue(s,BM),o=this.findNeighbourValue(s,FM),r=this.findNeighbourValue(s,VM),l=n&&null!=this.findNeighbour(n,VM)?void 0:this.findNeighbourValue(s,GM);!(null!=r&&null==r.enabled||null!=l&&null==l.enabled)||a?._enabledFromTheme||o?._enabledFromTheme||qM(e,i,!0)}resolveVertexChildren(t,e,i){const s=this.neighboursWithEdgeValue(t,zM);if(s){i??(i=this.findNeighbourValue(t,YM));for(const t of s){const n=this.getVertexValue(t);s.length>1&&xS(n)||"_enabledFromTheme"!==n&&this.resolveVertex(t,e,i)}}}resolveVertexDependencies(t){const e=this.neighboursWithEdgeValue(t,UM);if(e)for(const t of e)this.resolveVertex(t)}graftAndResolveChildren(t,e,i,s){const n=this.neighboursWithEdgeValue(t,zM);if(n)for(const t of n){const n=this.getVertexValue(t),a=[...i,n],o=[...s,n],r=this.addVertex(n),l=this.findNeighbourValue(t,BM);this.addEdge(e,r,zM);const c=this.addVertex(a);if(this.addEdge(r,c,jM),W(l)){this.buildGraphFromObject(r,BM,l,c);const t=this.findNeighbour(r,BM);this.addEdge(t,this.addVertex(a),jM);const e=this.findNeighbourValue(t,$M);if(xS(e)){const i=this.neighboursWithEdgeValue(t,HM),s=fS[e],n="function"==typeof s?void 0:s.dependencies;n?.(this,t,i??[])}}this.graftAndResolveChildren(t,r,a,o)}}resolveValueOrSymbol(t){return"symbol"==typeof t&&this.internalParams?.has(t)?this.internalParams.get(t):t}snapshot(){bS("snapshot"),this.isRollingBack=!0}rollback(){bS(`rollback ${this.rollbackEdgesFrom.length} edges and ${this.rollbackVertices.length} vertices`);for(let t=0;t<this.rollbackEdgesFrom.length;t++){const e=this.rollbackEdgesFrom[t],i=this.rollbackEdgesTo[t],s=this.rollbackEdgesValue[t];this.removeEdge(e,i,s)}for(const t of this.rollbackVertices)this.removeVertex(t);this.cachedPathVertices.clear(),this.rollbackVertices=[],this.rollbackEdgesFrom=[],this.rollbackEdgesTo=[],this.rollbackEdgesValue=[],this.isRollingBack=!1}};MS.EDGE_PRIORITY=[VM,FM,BM],MS.GRAFT_EDGE=BM,MS.SHALLOW_KEYS=new Set(["context","data","topology"]),MS.COMPLEX_KEYS=["annotations","axes","series"],MS.ANNOTATIONS_OPTIONS_KEYS=["axesButtons","data","enabled","optionsToolbar","snap","toolbar","xKey","volumeKey"],MS.UNSAFE_CLEAR_KEYS=new Set(["itemStyler","styler"]),MS.valueCache=new Map;var SS=MS,IS=t=>`'${t}'`,DS=class t{constructor(e,i,s,n,a,o,r=!1,l){this.themeParameters={},this.optionMetadata=a??{},this.processedOverrides=s??{};let c=null;e instanceof t?(c=e,this.specialOverrides=c.specialOverrides,void 0===o&&(o=Ka(c.userOptions,i,t.JSON_DIFF_OPTS)),this.userOptions=Xa(js(o,c.userOptions),{...t.OPTIONS_CLONE_OPTS_SLOW,seen:[]})):(this.userOptions=Xa(e??i,{...t.OPTIONS_CLONE_OPTS_SLOW,seen:[]}),this.specialOverrides=this.specialOverridesDefaults({...n})),r&&this.removeLeftoverSymbols(this.userOptions);const h=e instanceof t&&void 0!==o?.data&&o?.data?.length!==e.userOptions.data?.length;let d,u,p,g,m,f,y;if(r||void 0===o||!t.isFastPathDelta(o)||null==c||h?(t.perfDebug("ChartOptions.slowSetup()"),({activeTheme:d,processedOptions:u,themeParameters:g,annotationThemes:m,googleFonts:f,optionsGraph:y}=this.slowSetup(s,o,r))):(({activeTheme:d,processedOptions:u,fastDelta:p}=this.fastSetup(o,c)),g=c.themeParameters,m=c.annotationThemes),this.activeTheme=d,this.processedOptions=u,this.fastDelta=p??void 0,this.themeParameters=g,this.annotationThemes=m,this.googleFonts=f,this.optionsGraph=y,void 0!==l&&"number"==typeof l&&!Number.isNaN(l)){const t=performance.now();this.optionsProcessingTime=t-l}bs.inDevelopmentMode(()=>_s(this))}static isFastPathDelta(e){for(const i of Object.keys(e??{}))if(!this.FAST_PATH_OPTIONS.has(i))return t.perfDebug("ChartOptions.isFastPathDelta() - slow path required due to presence of: ",i),!1;return t.perfDebug("ChartOptions.isFastPathDelta() - fast path possible."),!0}fastSetup(e,i){const{activeTheme:s,processedOptions:n}=i,{presetType:a}=this.optionMetadata;if(null!=a&&null!=e?.data){const t=p.getPresetModule(a);if(t?.processData){const{series:i,data:s}=t.processData(e.data);e=zs({series:i,data:s},e)}}this.fastSeriesSetup(e,n);const o=zs(e,n);return t.debug("ChartOptions.fastSetup() - processed options",o),{activeTheme:s,processedOptions:o,fastDelta:e}}fastSeriesSetup(t,e){t?.series&&(t.series?.every((t,i)=>Za(t,e.series?.[i]??{}))?delete t.series:t.series=t.series.map((t,i)=>js(t,e.series?.[i]??{})))}slowSetup(e,s,n=!1){let a=Xa(this.userOptions,t.OPTIONS_CLONE_OPTS_FAST);s&&(a=zs(s,a),n&&this.removeLeftoverSymbols(a));const{presetType:o}=this.optionMetadata;if(null!=o){const e=p.getPresetModule(o);if(e){const{validate:s=jt}=e,n=a,o=a.type,r=null==o?void 0:EM(a.theme).presets[o],{cleared:l,invalid:c}=s(n,e.options,"");for(const t of c)i.warn(t);xe(c,"")?a={}:(t.debug(">>> AgCharts.createOrUpdate() - applying preset",l),a=e.create(l,r,()=>this.activeTheme))}}this.soloSeriesIntegrity(a),PM.isEnterprise||nm(a);const r=EM(a.theme);if(null!=o&&r.templateTheme(a,!1),this.validateSeriesOptions(a),this.chartDef=p.detectChartDefinition(a),!this.chartDef.placeholder){const{validate:t=jt}=this.chartDef,{cleared:e,invalid:s}=t(a,this.chartDef.options,"");for(const t of s)i.warn(t);a=e}this.validateAxesOptions(a),this.removeDisabledOptions(a);let l=this.processFonts(r.params);l=this.processFonts(a,l),this.processSeriesOptions(a);const c=vS(r,a),h=c.resolve(),d=c.resolveParams(),u=c.resolveAnnotationThemes();c.clearSafe();const g=zs(e,h);return function(t){const e="mode"in t&&"integrated"===t.mode;for(const i of hs.byType("root","legend")){const s=t[i.optionsKey],n=null!=s&&!1===s.enabled,a=!("removable"in i)||!0===i.removable||"standalone-only"===i.removable&&!e;n&&a&&delete t[i.optionsKey]}}(g),PM.isEnterprise||nm(g,!0),this.validateSeriesOptions(g),this.validateAxesOptions(g),this.validatePluginOptions(g),this.processMiniChartSeriesOptions(g),g.loadGoogleFonts||l.clear(),t.debug(()=>["ChartOptions.slowSetup() - processed options",Xa(g)]),{activeTheme:r,processedOptions:g,themeParameters:d,annotationThemes:u,googleFonts:l,optionsGraph:c}}validatePluginOptions(t){for(const e of p.listModulesByType(g.Plugin)){const s=e.name;if(s in t&&(!e.chartType||e.chartType===this.chartDef?.name)){const{cleared:n,invalid:a}=jt(t[s],e.options,e.name);for(const t of a)i.warn(t);t[s]=n}}}validateSeriesOptions(t){const e=this.chartDef?.name,s=[],n=t.series?.length??0;let a;for(let o=0;o<n;o++){const n=`series[${o}]`,r=t.series[o],l=p.getSeriesModule(r.type);if(null==l){a??(a=Mt(Array.from(p.listModulesByType(g.Series)).filter(t=>!e||t.chartType===e).map(t=>t.name),"or",IS)),i.warn(null==r.type?`Option \`${n}.type\` is required and has not been provided; expecting ${a}, ignoring.`:`Unknown type \`${r.type}\` at \`${n}.type\`; expecting ${a}, ignoring.`);continue}if(e&&l.chartType!==e){i.warn(`Series type \`${l.name}\` at \`${n}.type\` is not supported by chart type \`${e}\`, ignoring.`);continue}const{validate:c=jt}=l,{cleared:h,invalid:d}=c(r,l.options,n);for(const t of d)i.warn(t);xe(d,n)||s.push(h)}t.series=s}validateAxesOptions(t){if(!("axes"in t)||!t.axes)return;const e=this.chartDef?.name,s=[],n=t.axes.length??0;let a;for(let o=0;o<n;o++){const n=`axes[${o}]`,r=t.axes[o],l=p.getAxisModule(r.type);if(null==l){a??(a=Mt(Array.from(p.listModulesByType(g.Axis)).filter(t=>t.chartType===e).map(t=>t.name),"or",IS)),i.warn(`Unknown type \`${r.type}\` at  \`${n}.type\`; expecting one of ${a}, ignoring all axes options.`),delete t.axes;break}if(l.chartType!==e){i.warn(`Axis type \`${l.name}\` at  \`${n}.type\` is not supported by chart type \`${e}\`, ignoring.`);break}const{validate:c=jt}=l,{cleared:h,invalid:d}=c(r,l.options,n);for(const t of d)i.warn(t);xe(d,n)||s.push(h)}t.axes=s}diffOptions(e){return this===e?{}:null==e?this.processedOptions:this.fastDelta??Ka(e.processedOptions,this.processedOptions,t.JSON_DIFF_OPTS)}optionsType(t){return t.series?.[0]?.type??"line"}processSeriesOptions(t){const e=t.series?.map(t=>{t.type??(t.type="line");const e=p.getSeriesModule(t.type),i=Boolean(e?.options.visible);return zs(this.getSeriesGroupingOptions(t),t,i&&{visible:!0})});t.series=this.setSeriesGroupingOptions(e??[])}processMiniChartSeriesOptions(t){const e=t.navigator?.miniChart?.series;null!=e&&(t.navigator.miniChart.series=this.setSeriesGroupingOptions(e))}getSeriesGroupingOptions(t){const e=sd.isGroupable(t.type),s=sd.isStackable(t.type),n=sd.isStackedByDefault(t.type);t.grouped&&!e&&i.warnOnce(`unsupported grouping of series type "${t.type}".`),!t.stacked&&!t.stackGroup||s||i.warnOnce(`unsupported stacking of series type "${t.type}".`);let{grouped:a,stacked:o}=t;return o??(o=(n||null!=t.stackGroup)&&!(e&&a)),a??(a=!0),{stacked:s&&o,grouped:e&&a&&!(s&&o)}}setSeriesGroupingOptions(e){const i=this.getSeriesGrouping(e);t.debug("ChartOptions.setSeriesGroupingOptions() - series grouping: ",i);const s={},n=i.reduce((t,e)=>{var i;return"default"===e.groupType||(t[i=e.seriesType]??(t[i]=0),t[e.seriesType]+="stack"===e.groupType?1:e.series.length),t},{});return i.flatMap(t=>{var e;switch(s[e=t.seriesType]??(s[e]=0),t.groupType){case"stack":{const e=s[t.seriesType]++;return t.series.map((i,s)=>Object.assign(i,{seriesGrouping:{groupId:t.groupId,groupIndex:e,groupCount:n[t.seriesType],stackIndex:s,stackCount:t.series.length}}))}case"group":return t.series.map(e=>Object.assign(e,{seriesGrouping:{groupId:t.groupId,groupIndex:s[t.seriesType]++,groupCount:n[t.seriesType],stackIndex:0,stackCount:0}}))}return t.series}).map(({stacked:t,grouped:e,...i})=>i)}getSeriesGroupId(t){return[t.type,t.xKey,t.stacked?t.stackGroup??"stacked":"grouped"].filter(Boolean).join("-")}getSeriesGrouping(t){const e=new Map;return t.reduce((t,i)=>{const s=i.type;if(i.stacked||i.grouped){const n=this.getSeriesGroupId(i);if(!e.has(n)){const a={groupType:i.stacked?"stack":"group",seriesType:s,series:[],groupId:n};e.set(n,a),t.push(a)}e.get(n).series.push(i)}else t.push({groupType:"default",seriesType:s,series:[i],groupId:"__default__"});return t},[])}soloSeriesIntegrity(t){if(!G(t.series))return;const e=t.series;if(e&&e.length>1&&e.some(t=>sd.isSolo(t.type))){const n=this.optionsType(t);if(sd.isSolo(n))i.warn(`series[0] of type '${n}' is incompatible with other series types. Only processing series[0]`),t.series=e.slice(0,1);else{const{solo:n,nonSolo:a}=qe(e,t=>sd.isSolo(t.type)?"solo":"nonSolo"),o=(s=n.map(t=>t.type),Array.from(new Set(s))).join(", ");i.warn(`Unable to mix these series types with the lead series type: ${o}`),t.series=a}}var s}static processFontOptions(t,e,i,s=new Set){if("object"==typeof t&&"fontFamily"in t)if(Array.isArray(t.fontFamily)){const e=[];for(const i of t.fontFamily)"object"==typeof i&&"googleFont"in i?(e.push(i.googleFont),s?.add(i.googleFont)):e.push(i);t.fontFamily=e.join(", ")}else"object"==typeof t.fontFamily&&"googleFont"in t.fontFamily&&(t.fontFamily=t.fontFamily.googleFont,s?.add(t.fontFamily));return s}processFonts(e,i=new Set){return qa(e,t.processFontOptions,new Set(["data","theme"]),void 0,void 0,i)}static removeDisabledOptionJson(t){if("enabled"in t&&!1===t.enabled)for(const e of Object.keys(t))"enabled"!==e&&delete t[e]}removeDisabledOptions(e){qa(e,t.removeDisabledOptionJson,new Set(["data","theme","contextMenu"]))}static removeLeftoverSymbolsJson(t){if(t&&W(t))for(const e of Object.keys(t))q(t[e])&&delete t[e]}removeLeftoverSymbols(e){qa(e,t.removeLeftoverSymbolsJson,new Set(["data"]))}specialOverridesDefaults(t){var e,i;if(null==t.window?t.window=z():(e=t.window,R.window=e),null==t.document?t.document=P():(i=t.document,R.document=i),null==t.window)throw new Error("AG Charts - unable to resolve global window");if(null==t.document)throw new Error("AG Charts - unable to resolve global document");return t}};DS.OPTIONS_CLONE_OPTS_SLOW={shallow:new Set(["data","container"]),assign:new Set(["context","theme"])},DS.OPTIONS_CLONE_OPTS_FAST={shallow:new Set(["container"]),assign:new Set(["data","context","theme"])},DS.JSON_DIFF_OPTS=new Set(["data"]),DS.perfDebug=bs.create(!0,"perf"),DS.FAST_PATH_OPTIONS=new Set(["data","width","height","container"]),DS.debug=bs.create(!0,"opts");var kS=DS,AS=bs.create(!0,"opts"),wS="AG Charts - Chart was destroyed, cannot perform request.",CS=class{constructor(t,e,i){this.factoryApi=e,this.licenseManager=i,this.chart=t}async update(t){if(!this.chart)throw new Error(wS);return AS.group("AgChartInstance.update()",async()=>{const e=bs.check("scene:stats","scene:stats:verbose")?performance.now():void 0;this.factoryApi.update(t,this,void 0,e),await(this.chart?.waitForUpdate())})}async updateDelta(t){if(!this.chart)throw new Error(wS);return AS.group("AgChartInstance.updateDelta()",async()=>{const e=bs.check("scene:stats","scene:stats:verbose")?performance.now():void 0;this.factoryApi.updateUserDelta(this,t,e),await(this.chart?.waitForUpdate())})}getOptions(){if(!this.chart)throw new Error(wS);const t=Xa(this.chart.getOptions(),kS.OPTIONS_CLONE_OPTS_FAST);for(const e of Object.keys(t))e.startsWith("_")&&delete t[e];return t}waitForUpdate(){if(!this.chart)throw new Error(wS);return this.chart.waitForUpdate()}async applyTransaction(t){if(!this.chart)throw new Error(wS);if(null==t||"object"!=typeof t)throw new Error("AG Charts - applyTransaction expects a transaction object.");const{append:e,prepend:i,remove:s}=t;if(null!=e&&!Array.isArray(e))throw new Error('AG Charts - transaction "append" must be an array.');if(null!=i&&!Array.isArray(i))throw new Error('AG Charts - transaction "prepend" must be an array.');if(null!=s&&!Array.isArray(s))throw new Error('AG Charts - transaction "remove" must be an array or single value.');return this.chart.applyTransaction(t)}async download(t){if(!this.chart)throw new Error(wS);const e=await this.prepareResizedChart(this,this.chart,t);try{e.chart?.download(t?.fileName,t?.fileFormat)}finally{e.destroy()}}async __toSVG(t){if(!this.chart)throw new Error(wS);const e=await this.prepareResizedChart(this,this.chart,{width:600,height:300,...t});try{return e?.chart?.toSVG()}finally{e?.destroy()}}async getImageDataURL(t){if(!this.chart)throw new Error(wS);const e=await this.prepareResizedChart(this,this.chart,t);try{return e.chart.getCanvasDataURL(t?.fileFormat)}finally{e.destroy()}}getState(){return this.factoryApi.caretaker.save(...this.getEnabledOriginators())}async setState(t){const{chart:e}=this;if(!e)return;const i=this.getEnabledOriginators();i.includes(e.ctx.legendManager)?(await this.setStateOriginators(t,i.filter(t=>t!==e.ctx.zoomManager)),await this.setStateOriginators(t,[e.ctx.zoomManager])):await this.setStateOriginators(t,i)}resetAnimations(){this.chart?.resetAnimations()}skipAnimations(){this.chart?.skipAnimations()}destroy(){this.releaseChart?(this.releaseChart(),this.releaseChart=void 0):this.chart&&(this.chart.publicApi=void 0,this.chart.destroy()),this.chart=void 0}async prepareResizedChart(t,e,i={}){const s=i.width??e.width??e.ctx.scene.canvas.width,n=i.height??e.height??e.ctx.scene.canvas.height,a=t.getState(),o=hs.hasEnterpriseModules(),r={...e.chartOptions.processedOverrides,container:document.createElement("div"),width:s,height:n};null!=i.width&&null!=i.height&&(r.overrideDevicePixelRatio=1);const l=e.getOptions();o&&(r.animation={enabled:!1},this.licenseManager?.isDisplayWatermark()&&(r.foreground={text:this.licenseManager.getWatermarkMessage(),image:{url:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU4IiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMjU4IDQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMjUuNzc5IDI4LjY1N0gxMy4zNTlMMTEuMTczIDM0LjAxMkg1LjY3Mjk3TDE3LjE4MiA3LjA1OTk5SDIxLjk1M0wzMy40NjIgMzQuMDEySDI3Ljk2MkwyNS43NzYgMjguNjU3SDI1Ljc3OVpNMjQuMDY4IDI0LjM5N0wxOS41ODggMTMuNDM0TDE1LjEwNyAyNC4zOTdIMjQuMDY4Wk02Mi4wOTIgMTguODIzSDQ5LjgxN1YyMy4wODZINTYuNzc1QzU2LjU1NSAyNS4yMjIgNTUuNzU1IDI2LjkyNyA1NC4zNzIgMjguMjAyQzUyLjk4OSAyOS40NzYgNTEuMTY2IDMwLjExNSA0OC45MDkgMzAuMTE1QzQ3LjYyMiAzMC4xMTUgNDYuNDUgMjkuODg1IDQ1LjM5MyAyOS40MjNDNDQuMzU4MyAyOC45NzgxIDQzLjQzMjYgMjguMzEzOCA0Mi42OCAyNy40NzZDNDEuOTI3IDI2LjYzOSA0MS4zNDQgMjUuNjMxIDQwLjkzMSAyNC40NTNDNDAuNTE5IDIzLjI3NSA0MC4zMTEgMjEuOTcgNDAuMzExIDIwLjUzN0M0MC4zMTEgMTkuMTA1IDQwLjUxNiAxNy44IDQwLjkzMSAxNi42MjFDNDEuMzQ0IDE1LjQ0MyA0MS45MjcgMTQuNDM2IDQyLjY4IDEzLjU5OEM0My40Mzc2IDEyLjc1NzcgNDQuMzY5NiAxMi4wOTMyIDQ1LjQxMSAxMS42NTFDNDYuNDc4IDExLjE4OSA0Ny42NTYgMTAuOTYgNDguOTQ2IDEwLjk2QzUxLjYxMiAxMC45NiA1My42MzcgMTEuNjAyIDU1LjAyIDEyLjg4NUw1OC4zIDkuNjA0OTlDNTUuODE3IDcuNjY5OTkgNTIuNjc2IDYuNjk5OTkgNDguODcyIDYuNjk5OTlDNDYuNzYgNi42OTk5OSA0NC44NTMgNy4wMzQ5OSA0My4xNTQgNy43MDA5OUM0MS40NTUgOC4zNjc5OSAzOS45OTggOS4zMDM5OSAzOC43ODMgMTAuNTA0QzM3LjU2NyAxMS43MDcgMzYuNjM0IDEzLjE1OCAzNS45NzcgMTQuODU3QzM1LjMxOSAxNi41NTYgMzQuOTk0IDE4LjQ1MSAzNC45OTQgMjAuNTRDMzQuOTk0IDIyLjYzIDM1LjMyOSAyNC40OTQgMzUuOTk1IDI2LjIwNUMzNi42NjIgMjcuOTE2IDM3LjYwNSAyOS4zNzQgMzguODE3IDMwLjU3N0M0MC4wMzIgMzEuNzggNDEuNDg2IDMyLjcxMyA0My4xODggMzMuMzgzQzQ0Ljg4OCAzNC4wNDkgNDYuNzgyIDM0LjM4NCA0OC44NzIgMzQuMzg0QzUwLjk2MSAzNC4zODQgNTIuNzUgMzQuMDQ5IDU0LjM5IDMzLjM4M0M1Ni4wMzEgMzIuNzE2IDU3LjQyNiAzMS43OCA1OC41NzkgMzAuNTc3QzU5LjczMyAyOS4zNzQgNjAuNjE5IDI3LjkxNiA2MS4yMzkgMjYuMjA1QzYxLjg2IDI0LjQ5NCA2Mi4xNyAyMi42MDUgNjIuMTcgMjAuNTRDNjIuMTY5NiAxOS45Njg4IDYyLjE0NDUgMTkuMzk4IDYyLjA5NSAxOC44MjlMNjIuMDkyIDE4LjgyM1pNMTUxLjgxIDE2Ljk4MUMxNTMuNDEgMTQuNjA5IDE1Ny40MTkgMTQuMzU4IDE1OS4wMjIgMTQuMzU4VjE4LjkxQzE1Ni45NTcgMTguOTEgMTU0Ljk4NSAxOC45OTYgMTUzLjc1NyAxOS44OTJDMTUyLjUyOSAyMC43OTIgMTUxLjkxOSAyMS45ODIgMTUxLjkxOSAyMy40NjRWMzMuOTlIMTQ2Ljk2NFYxNC4zNThIMTUxLjczNkwxNTEuODEgMTYuOTgxWk0xNDMuMDExIDE0LjM2MVYzNC4wMzFIMTM4LjI0TDEzOC4xMzEgMzEuMDQ1QzEzNy40NjYgMzIuMDc2IDEzNi41NTEgMzIuOTIxOSAxMzUuNDcxIDMzLjUwNEMxMzQuMzc2IDM0LjA5OSAxMzMuMDY4IDM0LjM5NiAxMzEuNTM2IDM0LjM5NkMxMzAuMiAzNC4zOTYgMTI4Ljk2MyAzNC4xNTIgMTI3LjgyMiAzMy42NjhDMTI2LjcgMzMuMTk2NCAxMjUuNjg5IDMyLjQ5NSAxMjQuODU1IDMxLjYwOUMxMjQuMDE4IDMwLjcyMiAxMjMuMzU0IDI5LjY2MiAxMjIuODcxIDI4LjQyMkMxMjIuMzg0IDI3LjE4NSAxMjIuMTQyIDI1LjgxMSAxMjIuMTQyIDI0LjMwNEMxMjIuMTQyIDIyLjc5OCAxMjIuMzg0IDIxLjM3OCAxMjIuODcxIDIwLjExNkMxMjMuMzU3IDE4Ljg1NCAxMjQuMDE4IDE3Ljc3MiAxMjQuODU1IDE2Ljg3M0MxMjUuNjg4IDE1Ljk3NjQgMTI2LjY5OCAxNS4yNjM2IDEyNy44MjIgMTQuNzhDMTI4Ljk2MyAxNC4yODEgMTMwLjIwMyAxNC4wMzMgMTMxLjUzNiAxNC4wMzNDMTMzLjA0MyAxNC4wMzMgMTM0LjMzIDE0LjMxOCAxMzUuMzk3IDE0Ljg4OEMxMzYuNDYyIDE1LjQ1ODkgMTM3LjM3NSAxNi4yNzggMTM4LjA1NyAxNy4yNzZWMTQuMzYxSDE0My4wMTFaTTEzMi42MzEgMzAuMTMzQzEzNC4yNTYgMzAuMTMzIDEzNS41NjcgMjkuNTk0IDEzNi41NjUgMjguNTEyQzEzNy41NjEgMjcuNDMgMTM4LjA2IDI1Ljk5MSAxMzguMDYgMjQuMTk2QzEzOC4wNiAyMi40MDEgMTM3LjU2MSAyMC45OSAxMzYuNTY1IDE5Ljg5OUMxMzUuNTcgMTguODA3IDEzNC4yNTkgMTguMjU4IDEzMi42MzEgMTguMjU4QzEzMS4wMDMgMTguMjU4IDEyOS43MjkgMTguODA0IDEyOC43MzQgMTkuODk5QzEyNy43MzggMjAuOTkzIDEyNy4yMzkgMjIuNDM4IDEyNy4yMzkgMjQuMjMzQzEyNy4yMzkgMjYuMDI4IDEyNy43MzUgMjcuNDMzIDEyOC43MzQgMjguNTE1QzEyOS43MjkgMjkuNTk0IDEzMS4wMjggMzAuMTM2IDEzMi42MzEgMzAuMTM2VjMwLjEzM1pNOTMuNjk4IDI3Ljg3NkM5My41Nzk1IDI4LjAwMjUgOTMuNDU2NCAyOC4xMjQ2IDkzLjMyOSAyOC4yNDJDOTEuOTQ3IDI5LjUxNiA5MC4xMjMgMzAuMTU1IDg3Ljg2NiAzMC4xNTVDODYuNTggMzAuMTU1IDg1LjQwOCAyOS45MjYgODQuMzUgMjkuNDY0QzgzLjMxNTUgMjkuMDE4OSA4Mi4zODk4IDI4LjM1NDYgODEuNjM3IDI3LjUxN0M4MC44ODQgMjYuNjc5IDgwLjMwMSAyNS42NzIgNzkuODg5IDI0LjQ5NEM3OS40NzYgMjMuMzE1IDc5LjI2OSAyMi4wMSA3OS4yNjkgMjAuNTc4Qzc5LjI2OSAxOS4xNDUgNzkuNDczIDE3Ljg0IDc5Ljg4OSAxNi42NjJDODAuMzAxIDE1LjQ4NCA4MC44ODQgMTQuNDc2IDgxLjYzNyAxMy42MzlDODIuMzk0OSAxMi43OTg3IDgzLjMyNzMgMTIuMTM0MiA4NC4zNjkgMTEuNjkyQzg1LjQzNiAxMS4yMyA4Ni42MTQgMTEgODcuOTAzIDExQzkwLjU3IDExIDkyLjU5NSAxMS42NDIgOTMuOTc3IDEyLjkyNkw5Ny4yNTggOS42NDQ5OUM5NC43NzQgNy43MTA5OSA5MS42MzMgNi43Mzk5OSA4Ny44MjkgNi43Mzk5OUM4NS43MTggNi43Mzk5OSA4My44MTEgNy4wNzQ5OSA4Mi4xMTIgNy43NDE5OUM4MC40MTMgOC40MDc5OSA3OC45NTYgOS4zNDQ5OSA3Ny43NCAxMC41NDVDNzYuNTI1IDExLjc0NyA3NS41OTIgMTMuMTk5IDc0LjkzNCAxNC44OThDNzQuMjc3IDE2LjU5NyA3My45NTEgMTguNDkxIDczLjk1MSAyMC41ODFDNzMuOTUxIDIyLjY3IDc0LjI4NiAyNC41MzQgNzQuOTUzIDI2LjI0NUM3NS42MTkgMjcuOTU3IDc2LjU2MiAyOS40MTQgNzcuNzc0IDMwLjYxN0M3OC45OSAzMS44MiA4MC40NDQgMzIuNzUzIDgyLjE0NiAzMy40MjNDODMuODQ1IDM0LjA5IDg1LjczOSAzNC40MjQgODcuODI5IDM0LjQyNEM4OS45MTkgMzQuNDI0IDkxLjcwOCAzNC4wOSA5My4zNDggMzMuNDIzQzk0LjcxOCAzMi44NjUgOTUuOTE4IDMyLjEyMSA5Ni45NDggMzEuMTkxQzk3LjE0OSAzMS4wMDggOTcuMzQ4IDMwLjgxNSA5Ny41MzcgMzAuNjJMOTMuNzAxIDI3Ljg4NUw5My42OTggMjcuODc2Wk0xMTAuODAyIDE0LjAxNUMxMDkuMTk5IDE0LjAxNSAxMDYuODM2IDE0LjQ3MSAxMDUuNjExIDE2LjE1OEwxMDUuNTM3IDYuMDE1OTlIMTAwLjc2NVYzMy45MzlIMTA1LjcyVjIyLjY0MUMxMDUuNzcxIDIxLjQ2MDcgMTA2LjI4OCAyMC4zNDg4IDEwNy4xNTcgMTkuNTQ4OUMxMDguMDI3IDE4Ljc0OTEgMTA5LjE3OCAxOC4zMjY2IDExMC4zNTggMTguMzc0QzExMy4zOTcgMTguMzc0IDExNC4yNjggMjEuMTU5IDExNC4yNjggMjIuNjQxVjMzLjkzOUgxMTkuMjIzVjIxLjA1OUMxMTkuMjIzIDIxLjA1OSAxMTkuMTQyIDE0LjAxNSAxMTAuODAyIDE0LjAxNVpNMTczLjc2MyAxNC4zNThIMTY5Ljk5OVY4LjcxNDk5SDE2NS4wNDhWMTQuMzU4SDE2MS4yODRWMTguOTE2SDE2NS4wNDhWMzQuMDAzSDE2OS45OTlWMTguOTE2SDE3My43NjNWMTQuMzU4Wk0xOTAuNzg3IDI1LjI2MkMxOTAuMTI5IDI0LjUwMTQgMTg5LjMwNyAyMy44OTk0IDE4OC4zODQgMjMuNTAxQzE4Ny40ODggMjMuMTE3IDE4Ni4zMzEgMjIuNzMyIDE4NC45NDggMjIuMzY0QzE4NC4xNjUgMjIuMTQzOSAxODMuMzkgMjEuODk3OCAxODIuNjIzIDIxLjYyNkMxODIuMTYzIDIxLjQ2MjEgMTgxLjc0MSAyMS4yMDY2IDE4MS4zODMgMjAuODc1QzE4MS4yMzUgMjAuNzQyMSAxODEuMTE4IDIwLjU3ODkgMTgxLjAzOSAyMC4zOTY0QzE4MC45NjEgMjAuMjE0IDE4MC45MjIgMjAuMDE2NiAxODAuOTI3IDE5LjgxOEMxODAuOTI3IDE5LjI3MiAxODEuMTU2IDE4Ljg0NCAxODEuNjI1IDE4LjUxQzE4Mi4xMjEgMTguMTU2IDE4Mi44NjIgMTcuOTc2IDE4My44MjYgMTcuOTc2QzE4NC43OSAxNy45NzYgMTg1LjU4NyAxOC4yMDkgMTg2LjE0OCAxOC42NjhDMTg2LjcwNiAxOS4xMjQgMTg3LjAwNyAxOS43MjUgMTg3LjA3MiAyMC41TDE4Ny4wOTQgMjAuNzgySDE5MS42MzNMMTkxLjYxNyAyMC40NkMxOTEuNTIxIDE4LjQ4NSAxOTAuNzcxIDE2LjkgMTg5LjM4NSAxNS43NUMxODguMDEyIDE0LjYxMiAxODYuMTg1IDE0LjAzMyAxODMuOTYyIDE0LjAzM0MxODIuNDc3IDE0LjAzMyAxODEuMTQxIDE0LjI4NyAxNzkuOTk0IDE0Ljc4NkMxNzguODMxIDE1LjI5MSAxNzcuOTI2IDE1Ljk5NSAxNzcuMjk2IDE2Ljg4MkMxNzYuNjczIDE3Ljc0NTUgMTc2LjMzOCAxOC43ODQgMTc2LjM0MSAxOS44NDlDMTc2LjM0MSAyMS4xNjcgMTc2LjY5OCAyMi4yNDkgMTc3LjM5OSAyMy4wNjRDMTc4LjA2IDIzLjg0MzIgMTc4Ljg5OCAyNC40NTM0IDE3OS44NDIgMjQuODQ0QzE4MC43NDQgMjUuMjE2IDE4MS45MjggMjUuNjA3IDE4My4zNjEgMjZDMTg0LjgwNiAyNi40MSAxODUuODcyIDI2Ljc4NSAxODYuNTMgMjcuMTIzQzE4Ny4xIDI3LjQxNCAxODcuMzc5IDI3Ljg0NSAxODcuMzc5IDI4LjQ0NEMxODcuMzc5IDI5LjA0MiAxODcuMTIyIDI5LjQ2NyAxODYuNTk1IDI5LjgzOUMxODYuMDQzIDMwLjIyNiAxODUuMjM3IDMwLjQyNSAxODQuMjAxIDMwLjQyNUMxODMuMTY2IDMwLjQyNSAxODIuMzk0IDMwLjE3NCAxODEuNzQ5IDI5LjY3NEMxODEuMTEzIDI5LjE4MSAxODAuNzcyIDI4LjU4OSAxODAuNzEgMjcuODY0TDE4MC42ODUgMjcuNTgySDE3Ni4wMTNMMTc2LjAyNSAyNy45MDFDMTc2LjA2NyAyOS4wOTU1IDE3Ni40NzIgMzAuMjQ4NyAxNzcuMTg4IDMxLjIwNkMxNzcuOTA3IDMyLjE4IDE3OC44OTMgMzIuOTU4IDE4MC4xMTggMzMuNTE5QzE4MS4zMzYgMzQuMDc3IDE4Mi43MzIgMzQuMzYyIDE4NC4yNjYgMzQuMzYyQzE4NS44MDEgMzQuMzYyIDE4Ny4xMDkgMzQuMTA4IDE4OC4yMzggMzMuNjA5QzE4OS4zNzYgMzMuMTA0IDE5MC4yNzIgMzIuMzk0IDE5MC45MDEgMzEuNDk0QzE5MS41MzQgMzAuNTkyIDE5MS44NTMgMjkuNTU0IDE5MS44NTMgMjguNDAzQzE5MS44MjggMjcuMTEgMTkxLjQ2NiAyNi4wNTMgMTkwLjc3NyAyNS4yNjJIMTkwLjc4N1oiIGZpbGw9IiM5QjlCOUIiLz4KPHBhdGggZD0iTTI0MS45ODIgMjUuNjU4MlYxNy43MTE3SDIyOC40NDFMMjIwLjQ5NCAyNS42NTgySDI0MS45ODJaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNTcuMjM5IDUuOTUwODFIMjQwLjI2NUwyMzIuMjU1IDEzLjg5NzNIMjU3LjIzOVY1Ljk1MDgxWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjEyLjYxMSAzMy42MDQ4TDIxNi42OCAyOS41MzYxSDIzMC40MTJWMzcuNDgyN0gyMTIuNjExVjMzLjYwNDhaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yMTUuNTk5IDIxLjc4MDNIMjI0LjM3MkwyMzIuMzgyIDEzLjgzMzdIMjE1LjU5OVYyMS43ODAzWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjA2IDMzLjYwNDdIMjEyLjYxMUwyMjAuNDk0IDI1LjY1ODJIMjA2VjMzLjYwNDdaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNDAuMjY1IDUuOTUwODFMMjM2LjE5NyAxMC4wMTk0SDIxMC4yNTlWMi4wNzI4OEgyNDAuMjY1VjUuOTUwODFaIiBmaWxsPSIjOUI5QjlCIi8+Cjwvc3ZnPgo=",width:170,height:25,right:25,bottom:50,opacity:.7}}));const c={...e.chartOptions.specialOverrides},h={...e.chartOptions.optionMetadata},d=await(this.chart?.ctx.dataService.getData()),u=this.factoryApi.create(l,r,c,h,d);await u.setState(a),u.chart?.ctx.zoomManager.updateZoom("chartProxy",e.ctx.zoomManager.getZoom()),u.chart?.ctx.legendManager.clearData(),u.chart?.ctx.legendManager.update(e.ctx.legendManager.getData());for(const[t,i]of e.series.entries())u.chart.series[t].visible=i.visible;const p=[];for(const t of e.modulesManager.legends())p.push(t.legend.pagination?.currentPage??0);for(const t of u.chart.modulesManager.legends()){const e=p.shift()??0;t.legend.pagination&&t.legend.pagination.setPage(e)}return u.chart?.update(0,{forceNodeDataRefresh:!0}),await u.waitForUpdate(),u}getEnabledOriginators(){if(!this.chart)return[];const{chartOptions:{processedOptions:t,optionMetadata:e},ctx:{annotationManager:i,chartTypeOriginator:s,zoomManager:n,legendManager:a}}=this.chart,o=[];return"annotations"in t&&t.annotations?.enabled&&o.push(i),"price-volume"===e.presetType&&o.push(s),(t.navigator?.enabled||t.zoom?.enabled)&&o.push(n),"legend"in this.chart&&o.push(a),o}async setStateOriginators(t,e){this.factoryApi.caretaker.restore(t,...e),this.chart?.ctx.updateService.update(2,{forceNodeDataRefresh:!0}),await(this.chart?.waitForUpdate())}};CS.chartInstances=new WeakMap,ls([ro({oldValue(t){t.destroyed||(t.publicApi=void 0),CS.chartInstances.delete(t)},newValue(t){t&&(t.publicApi=this,CS.chartInstances.set(t,this))}})],CS.prototype,"chart",2);var NS=CS,LS=class extends cs{constructor(t){super(),this.ctx=t,this.localeText=void 0}};ls([lo(t=>{t.ctx.localeManager.setLocaleText(t.localeText)}),ws],LS.prototype,"localeText",2),ls([lo(t=>{t.ctx.localeManager.setLocaleTextFormatter(t.getLocaleText)}),ws],LS.prototype,"getLocaleText",2);var TS={type:"root",optionsKey:"locale",packageType:"community",chartTypes:["cartesian","polar","topology","standalone"],moduleFactory:t=>new LS(t)},ES=class extends cs{constructor(t){super(),this.ctx=t,this.rectNode=new Uo,this.textNode=new _o,this.fill="white",this.node=this.createNode(),this.node.append([this.rectNode,this.textNode]),this.visible=!0,this.cleanup.register(t.scene.attachNode(this.node),t.eventsHub.on("layout:complete",t=>this.onLayoutComplete(t)))}createNode(){return new Oa({name:"background",zIndex:0})}onLayoutComplete(t){const{width:e,height:i}=t.chart;this.rectNode.width=e,this.rectNode.height=i}};ls([ws,oo("node","visible")],ES.prototype,"visible",2),ls([ws,oo("rectNode","fill")],ES.prototype,"fill",2),ls([ws],ES.prototype,"image",2),ls([ws,oo("textNode")],ES.prototype,"text",2);var OS={type:"root",optionsKey:"background",packageType:"community",chartTypes:["cartesian","polar","topology","standalone"],moduleFactory:t=>new ES(t)},RS=class extends Pn{constructor(t){super(),this.node=t,this.enabled=!1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=1}};function PS({orientation:t,bboxes:e,maxHeight:i,maxWidth:s,itemPaddingY:n=0,itemPaddingX:a=0,forceResult:o=!1}){const r="horizontal"===t,l={max:r?s:i,fn:r?t=>t.width:t=>t.height,padding:r?a:n},c={max:r?i:s,fn:r?t=>t.height:t=>t.width,padding:r?n:a};let h=0;const d=[];for(;h<e.length;){const t=zS(e.slice(h),h,l,c,o);if(!t)return;h+=t.processedBBoxCount,d.push(t.pageIndices)}return function(t,e,i,s,n){let a=0,o=0;return{pages:t.map(t=>{"horizontal"===e&&(t=function(t){const e=[];for(const i of t[0])e.push([]);for(const[i,s]of t.entries())for(const[t,n]of s.entries())e[t][i]=n;return e}(t));let r=0;const l=t.map(t=>{const e=t.map(t=>(r=Math.max(t,r),i[t]));let a=0,o=0;for(const t of e)a+=t.height+s,o=Math.max(o,t.width+n);return{indices:t,bboxes:e,columnHeight:Math.ceil(a),columnWidth:Math.ceil(o)}});let c=0,h=0;for(const t of l)c+=t.columnWidth,h=Math.max(h,t.columnHeight);return a=Math.max(c,a),o=Math.max(h,o),{columns:l,startIndex:t[0][0],endIndex:r,pageWidth:c,pageHeight:h}}),maxPageWidth:a,maxPageHeight:o}}(d,t,e,n,a)}function zS(t,e,i,s,n){let a=function(t,e){const i=t.length;let s=0;for(let n=0;n<i;n++)if(s+=e.fn(t[n])+e.padding,s>e.max)return i/n<2?Math.ceil(i/2):n;return i}(t,i);if(a<1){if(!n)return;a=1}let o=a;for(;o>=1;){const a=jS(t,e,o,i,s,n);if(null==a&&o<=1)return;if(null!=a){if("number"!=typeof a)return{processedBBoxCount:a.length*a[0].length,pageIndices:a};if(a<=1)return;o=a<o&&a>1?a:o,o--}else o--}}function jS(t,e,i,s,n,a){const o=[];let r=0,l=0,c=[];const h=[];for(let d=0;d<t.length;d++){const u=(d+i)%i;0===u&&(r+=l,l=0,c.length>0&&o.push(c),c=[]);const p=s.fn(t[d])+s.padding;h[u]=Math.max(h[u]??0,p),l=Math.max(l,n.fn(t[d])+n.padding);const g=r+l,m=!a||o.length>0;if(g>n.max&&m){c=[];break}if(h.reduce((t,e)=>t+e,0)>s.max&&!a)return h.length<i?h.length:void 0;c.push(d+e)}return c.length>0&&o.push(c),o.length>0?o:void 0}ls([ro({changeValue(t){this.node.strokeWidth=t?this.strokeWidth:0}}),ws],RS.prototype,"enabled",2),ls([oo("node","stroke"),ws],RS.prototype,"stroke",2),ls([oo("node","strokeOpacity"),ws],RS.prototype,"strokeOpacity",2),ls([ro({changeValue(t){this.enabled?this.node.strokeWidth=t:this.node.strokeWidth=0}}),ws],RS.prototype,"strokeWidth",2);var BS=class extends Pn{constructor(){super(...arguments),this.color="black",this.fontStyle=void 0,this.fontWeight=void 0,this.fontSize=12,this.fontFamily="Verdana, sans-serif"}};ls([ws],BS.prototype,"color",2),ls([ws],BS.prototype,"fontStyle",2),ls([ws],BS.prototype,"fontWeight",2),ls([ws],BS.prototype,"fontSize",2),ls([ws],BS.prototype,"fontFamily",2);var FS=class extends Pn{constructor(){super(...arguments),this.size=15,this.fill=void 0,this.fillOpacity=void 0,this.stroke=void 0,this.strokeWidth=1,this.strokeOpacity=1}};ls([ws],FS.prototype,"size",2),ls([ws],FS.prototype,"fill",2),ls([ws],FS.prototype,"fillOpacity",2),ls([ws],FS.prototype,"stroke",2),ls([ws],FS.prototype,"strokeWidth",2),ls([ws],FS.prototype,"strokeOpacity",2);var VS=class extends Pn{constructor(t){super(),this.parent=t,this.shape="triangle",this.size=15,this.padding=8}};ls([ro({changeValue(){this.parent.marker===this&&this.parent.onMarkerShapeChange()}})],VS.prototype,"shape",2),ls([ws],VS.prototype,"size",2),ls([ws],VS.prototype,"padding",2);var GS=class extends Pn{constructor(t,e){super(),this.chartUpdateCallback=t,this.pageUpdateCallback=e,this.id=Oi(this),this.marker=new VS(this),this.activeStyle=new FS,this.inactiveStyle=new FS,this.highlightStyle=new FS,this.label=new BS,this.group=new za({name:"pagination"}),this.labelNode=new _o,this.totalPages=0,this.currentPage=0,this.translationX=0,this.translationY=0,this.nextButtonDisabled=!1,this.previousButtonDisabled=!1,this._visible=!0,this._enabled=!0,this._orientation="vertical",this.nextButton=new Ig,this.previousButton=new Ig,this.labelNode.setProperties({textBaseline:"middle",fontSize:12,fontFamily:"Verdana, sans-serif",fill:"black",y:1}),this.group.append([this.nextButton,this.previousButton,this.labelNode]),this.update(),this.updateMarkers()}set visible(t){this._visible=t,this.updateGroupVisibility()}get visible(){return this._visible}set enabled(t){this._enabled=t,this.updateGroupVisibility()}get enabled(){return this._enabled}updateGroupVisibility(){this.group.visible=this.enabled&&this.visible}set orientation(t){this._orientation=t,"horizontal"===t?(this.previousButton.rotation=-Math.PI/2,this.nextButton.rotation=Math.PI/2):(this.previousButton.rotation=0,this.nextButton.rotation=Math.PI)}get orientation(){return this._orientation}update(){this.updateLabel(),this.updatePositions(),this.enableOrDisableButtons()}updatePositions(){this.group.translationX=this.translationX,this.group.translationY=this.translationY,this.updateLabelPosition(),this.updateNextButtonPosition()}updateLabelPosition(){const{size:t,padding:e}=this.marker;this.nextButton.size=t,this.previousButton.size=t,this.labelNode.x=t/2+e}updateNextButtonPosition(){const t=this.labelNode.getBBox();this.nextButton.translationX=t.width+2*(this.marker.size/2+this.marker.padding)}updateLabel(){const{currentPage:t,totalPages:e,labelNode:i,label:{color:s,fontStyle:n,fontWeight:a,fontSize:o,fontFamily:r}}=this;i.text=`${t+1} / ${e}`,i.fill=s,i.fontStyle=n,i.fontWeight=a,i.fontSize=o,i.fontFamily=r}updateMarkers(){const{nextButton:t,previousButton:e,nextButtonDisabled:i,previousButtonDisabled:s,activeStyle:n,inactiveStyle:a,highlightStyle:o,highlightActive:r}=this,l=(t,e)=>e?a:t===r?o:n;this.updateMarker(t,l("next",i)),this.updateMarker(e,l("previous",s))}updateMarker(t,e){const{shape:i,size:s}=this.marker;t.shape=i,t.size=s,t.fill=e.fill,t.fillOpacity=e.fillOpacity??1,t.stroke=e.stroke,t.strokeWidth=e.strokeWidth,t.strokeOpacity=e.strokeOpacity}enableOrDisableButtons(){const{currentPage:t,totalPages:e}=this,i=0===e,s=t===e-1,n=0===t;this.nextButtonDisabled=s||i,this.previousButtonDisabled=n||i}setPage(t){t=C(0,t,Math.max(0,this.totalPages-1)),this.currentPage!==t&&(this.currentPage=t,this.onPaginationChanged())}getCursor(t){return{previous:this.previousButtonDisabled,next:this.nextButtonDisabled}[t]?void 0:"pointer"}onClick(t,e){t.preventDefault(),"next"!==e||this.nextButtonDisabled?"previous"!==e||this.previousButtonDisabled||(this.decrementPage(),this.onPaginationChanged()):(this.incrementPage(),this.onPaginationChanged())}onMouseHover(t){this.highlightActive=t,this.updateMarkers(),this.chartUpdateCallback(7)}onPaginationChanged(){this.pageUpdateCallback(this.currentPage)}incrementPage(){this.currentPage=Math.min(this.currentPage+1,this.totalPages-1)}decrementPage(){this.currentPage=Math.max(this.currentPage-1,0)}onMarkerShapeChange(){this.updatePositions(),this.updateMarkers(),this.chartUpdateCallback(7)}attachPagination(t){t.append(this.group)}getBBox(){return this.group.getBBox()}computeCSSBounds(){return{prev:Ta.toCanvas(this.previousButton),next:Ta.toCanvas(this.nextButton)}}};GS.className="Pagination",ls([ws],GS.prototype,"marker",2),ls([ws],GS.prototype,"activeStyle",2),ls([ws],GS.prototype,"inactiveStyle",2),ls([ws],GS.prototype,"highlightStyle",2),ls([ws],GS.prototype,"label",2);var $S=class{constructor(t,e){this.dirty=!0,this.itemList=t.proxyInteractionService.createProxyContainer({type:"list",domManagerId:`${e}-toolbar`,classList:["ag-charts-proxy-legend-toolbar"],ariaLabel:{id:"ariaLabelLegend"}}),this.paginationGroup=t.proxyInteractionService.createProxyContainer({type:"group",domManagerId:`${e}-pagination`,classList:["ag-charts-proxy-legend-pagination"],ariaLabel:{id:"ariaLabelLegendPagination"}}),this.itemDescription=j("p"),this.itemDescription.style.display="none",this.itemDescription.id=Ri(),this.itemDescription.textContent=this.getItemAriaDescription(t.localeManager),this.itemList.getElement().append(this.itemDescription)}initLegendList(t){if(!this.dirty)return;const{ctx:e,itemSelection:i,datumReader:s,itemListener:n}=t,a=e.localeManager,o=i.length;i.each((t,i,r)=>{t.proxyButton?.destroy(),t.proxyButton=e.proxyInteractionService.createProxyElement({type:"listswitch",textContent:this.getItemAriaText(a,At(s.getItemLabel(i)),r,o),ariaChecked:!!t.datum.enabled,ariaDescribedBy:this.itemDescription.id,parent:this.itemList});const l=t.proxyButton;l.addListener("click",e=>n.onClick(e.sourceEvent,t.datum,l)),l.addListener("dblclick",e=>n.onDoubleClick(e.sourceEvent,t.datum)),l.addListener("mouseenter",e=>n.onHover(e.sourceEvent,t)),l.addListener("mouseleave",()=>n.onLeave()),l.addListener("contextmenu",e=>n.onContextClick(e,t)),l.addListener("blur",()=>n.onLeave()),l.addListener("focus",e=>n.onHover(e.sourceEvent,t)),l.addListener("drag-start",()=>{})}),this.dirty=!1}update(t){t.visible&&(this.initLegendList(t),this.updateItemProxyButtons(t),this.updatePaginationProxyButtons(t,!0)),this.updateVisibility(t.visible)}updateVisibility(t){this.itemList.setHidden(!t),this.paginationGroup.setHidden(!t)}updateItemProxyButtons({itemSelection:t,group:e,pagination:i,interactive:s}){const n=Ta.toCanvas(e);this.itemList.setBounds(n);const a=Math.max(...t.nodes().map(t=>t.getBBox().height));t.each((t,e)=>{if(t.proxyButton){const e=t.pageIndex===i.currentPage,{x:o,y:r,height:l,width:c}=Ta.toCanvas(t),h=(a-l)/2,d={x:o-n.x,y:r-h-n.y,height:a,width:c},u=s&&e;t.proxyButton.setCursor("pointer"),t.proxyButton.setEnabled(u),t.proxyButton.setPointerEvents(u?void 0:"none"),t.proxyButton.setBounds(d)}})}updatePaginationProxyButtons(t,e){const{pagination:i}=t;if(this.paginationGroup.setHidden(!i.visible),e&&"ctx"in t){const{oldPages:e,newPages:i}=t,s=(e?.length??i.length)>1,n=i.length>1;s!==n&&(n?this.createPaginationButtons(t):this.destroyPaginationButtons()),this.paginationGroup.setAriaHidden(!n||void 0)}if(this.prevButton&&this.nextButton){const{prev:t,next:e}=i.computeCSSBounds(),s=fs.merge([t,e]);t.x-=s.x,t.y-=s.y,e.x-=s.x,e.y-=s.y,this.paginationGroup.setBounds(s),this.prevButton.setBounds(t),this.nextButton.setBounds(e),this.prevButton.setEnabled(0!==i.currentPage),this.nextButton.setEnabled(i.currentPage!==i.totalPages-1),this.nextButton.setCursor(i.getCursor("next")),this.prevButton.setCursor(i.getCursor("previous"))}}createPaginationButtons(t){const{ctx:e,pagination:i}=t;this.prevButton||(this.prevButton=e.proxyInteractionService.createProxyElement({type:"button",textContent:{id:"ariaLabelLegendPagePrevious"},tabIndex:0,parent:this.paginationGroup}),this.prevButton.addListener("click",e=>this.onPageButton(t,e,"previous")),this.prevButton.addListener("mouseenter",()=>i.onMouseHover("previous")),this.prevButton.addListener("mouseleave",()=>i.onMouseHover(void 0))),this.nextButton||(this.nextButton=e.proxyInteractionService.createProxyElement({type:"button",textContent:{id:"ariaLabelLegendPageNext"},tabIndex:0,parent:this.paginationGroup}),this.nextButton.addListener("click",e=>this.onPageButton(t,e,"next")),this.nextButton.addListener("mouseenter",()=>i.onMouseHover("next")),this.nextButton.addListener("mouseleave",()=>i.onMouseHover(void 0)))}destroyPaginationButtons(){this.nextButton?.destroy(),this.prevButton?.destroy(),this.nextButton=void 0,this.prevButton=void 0}onPageButton(t,e,i){t.pagination.onClick(e.sourceEvent,i),this.updatePaginationProxyButtons(t,!1)}onDataUpdate(t,e){this.dirty=t.length!==e.length||t.some((i,s,n)=>{const[a,o]=[e[s],t[s]];return a.id!==o.id})}onLocaleChanged(t,e,i){const s=e.length;e.each(({proxyButton:e},n,a)=>{const o=e?.getElement();if(null!=o){const e=At(i.getItemLabel(n));o.textContent=this.getItemAriaText(t,e,a,s)}}),this.itemDescription.textContent=this.getItemAriaDescription(t)}onPageChange(t){this.updateItemProxyButtons(t),this.updatePaginationProxyButtons(t,!1)}getItemAriaText(t,e,i,s){return i>=0&&e?(i++,t.t("ariaLabelLegendItem",{label:e,index:i,count:s})):t.t("ariaLabelLegendItemUnknown")}getItemAriaDescription(t){return t.t("ariaDescriptionLegendItem")}};function HS(t,{itemId:e,seriesId:i,label:{text:s}},n){const a={defaultPrevented:!1,apiEvent:{type:t,itemId:e,seriesId:i,event:n,text:At(s),preventDefault:()=>a.defaultPrevented=!0}};return a}var US=class extends za{constructor(){super({name:"markerLabelGroup"}),this.symbolsGroup=this.appendChild(new Oa({name:"legend-markerLabel-symbols",renderToOffscreenCanvas:!0,optimizeForInfrequentRedraws:!0})),this.label=this.appendChild(new _o),this.enabled=!0,this.pageIndex=Number.NaN,this.spacing=0,this.length=0,this.isCustomMarker=!1,this.marker=this.symbolsGroup.appendChild(new Ig({zIndex:1})),this.line=this.symbolsGroup.appendChild(new md({zIndex:0})),this.line.visible=!1,this.label.textBaseline="middle",this.label.y=1}destroy(){super.destroy(),this.proxyButton?.destroy()}setEnabled(t){this.enabled=t,this.refreshVisibilities()}getTextMeasureBBox(){return this.layout(),fs.merge([this.symbolsGroup.getBBox(),this.label.getTextMeasureBBox()])}refreshVisibilities(){const t=this.enabled?1:.5;this.label.opacity=t,this.opacity=t}layout(){const{marker:t,line:e,length:i,isCustomMarker:s}=this;let n=0,a=0;if(t.visible){const{size:e}=t,o=Ig.anchor(t.shape);n=(o.x-.5)*e+i/2,a=(o.y-.5)*e,s?(t.x=0,t.y=0,t.translationX=n,t.translationY=a):(t.x=n,t.y=a,t.translationX=0,t.translationY=0)}e.visible&&(e.x1=0,e.x2=i,e.y1=0,e.y2=0)}preRender(t){const e=super.preRender(t);return this.layout(),e}layoutLabel(){const{length:t,spacing:e}=this;this.label.x=t+e}computeBBox(){return this.layout(),super.computeBBox()}};function WS(t){const{placement:e="bottom",floating:i=!1,xOffset:s=0,yOffset:n=0}="string"==typeof t?{placement:t,floating:!1}:t;return{placement:e,floating:i,xOffset:s,yOffset:n}}US.className="MarkerLabel",ls([oo("label")],US.prototype,"text",2),ls([oo("label")],US.prototype,"fontStyle",2),ls([oo("label")],US.prototype,"fontWeight",2),ls([oo("label")],US.prototype,"fontSize",2),ls([oo("label")],US.prototype,"fontFamily",2),ls([oo("label","fill")],US.prototype,"color",2),ls([lo(t=>t.layoutLabel())],US.prototype,"spacing",2),ls([lo(t=>t.layoutLabel())],US.prototype,"length",2),ls([Xs()],US.prototype,"isCustomMarker",2);var _S=class extends Pn{constructor(){super(...arguments),this.maxLength=void 0,this.color="black",this.fontStyle=void 0,this.fontWeight=void 0,this.fontSize=12,this.fontFamily="Verdana, sans-serif"}};ls([ws],_S.prototype,"maxLength",2),ls([ws],_S.prototype,"color",2),ls([ws],_S.prototype,"fontStyle",2),ls([ws],_S.prototype,"fontWeight",2),ls([ws],_S.prototype,"fontSize",2),ls([ws],_S.prototype,"fontFamily",2),ls([ws],_S.prototype,"formatter",2);var YS=class extends Pn{constructor(){super(...arguments),this.shape=void 0,this.size=15,this.padding=8}};ls([ws],YS.prototype,"shape",2),ls([ws],YS.prototype,"size",2),ls([ws],YS.prototype,"padding",2),ls([ws],YS.prototype,"strokeWidth",2),ls([ws],YS.prototype,"enabled",2);var KS=class extends Pn{};ls([ws],KS.prototype,"strokeWidth",2),ls([ws],KS.prototype,"length",2);var ZS=class extends Pn{constructor(){super(...arguments),this.paddingX=16,this.paddingY=8,this.showSeriesStroke=!1,this.marker=new YS,this.label=new _S,this.line=new KS}};ls([ws],ZS.prototype,"maxWidth",2),ls([ws],ZS.prototype,"paddingX",2),ls([ws],ZS.prototype,"paddingY",2),ls([ws],ZS.prototype,"showSeriesStroke",2),ls([ws],ZS.prototype,"marker",2),ls([ws],ZS.prototype,"label",2),ls([ws],ZS.prototype,"line",2);var XS=class extends Pn{};ls([ws],XS.prototype,"legendItemClick",2),ls([ws],XS.prototype,"legendItemDoubleClick",2);var QS={type:"gradient",bounds:"item",gradient:"linear",colorStops:[{color:"black"}],rotation:0,reverse:!1,colorSpace:"rgb"},qS={type:"pattern",pattern:"forward-slanted-lines",width:8,height:8,padding:1,fill:"black",fillOpacity:1,backgroundFill:"white",backgroundFillOpacity:1,stroke:"black",strokeOpacity:1,strokeWidth:1,rotation:0,scale:1},JS={type:"image",backgroundFill:"black",backgroundFillOpacity:1,rotation:0,repeat:"no-repeat",fit:"contain",width:8,height:8},tI=class extends Pn{constructor(t){super(),this.ctx=t,this.id=Oi(this),this.group=new za({name:"legend",zIndex:16}),this.itemSelection=gd.select(this.group,US),this.containerNode=this.group.appendChild(new Uo({name:"legend-container"})),this.oldSize=[0,0],this.pages=[],this.maxPageSize=[0,0],this.paginationTrackingIndex=0,this.truncatedItems=new Set,this._data=[],this.toggleSeries=!0,this.item=new ZS,this.listeners=new XS,this.enabled=!0,this.position="bottom",this.border=new RS(this.containerNode),this.cornerRadius=0,this.fillOpacity=1,this.padding=4,this.spacing=0,this.cleanup=new Mi,this.size=[0,0],this._visible=!0,this.pagination=new GS(e=>t.updateService.update(e),t=>this.updatePageNumber(t)),this.pagination.attachPagination(this.group);const{items:e}=t.contextMenuRegistry.builtins;e["toggle-series-visibility"].action=t=>this.contextToggleVisibility(t),e["toggle-other-series"].action=t=>this.contextToggleOtherSeries(t),this.cleanup.register(t.eventsHub.on("legend:change",this.onLegendDataChange.bind(this)),t.eventsHub.on("legend:change-partial",this.onLegendDataChangePartial.bind(this)),t.layoutManager.registerElement(1,t=>this.positionLegend(t)),t.eventsHub.on("locale:change",()=>this.onLocaleChanged()),()=>delete e["toggle-series-visibility"].action,()=>delete e["toggle-other-series"].action,()=>this.group.remove()),this.domProxy=new $S(this.ctx,this.id),this.ctx.historyManager.addMementoOriginator(t.legendManager)}set data(t){Rs(t,this._data)||(this.domProxy.onDataUpdate(this._data,t),this._data=t,this.updateGroupVisibility())}get data(){return this._data}onLegendDataChange({legendData:t=[]}){this.enabled&&(this.data=t.filter(t=>!t.hideInLegend))}onLegendDataChangePartial(t){this.itemSelection.each(({proxyButton:e},{itemId:i})=>{if(null!=e)for(const s of t.legendData)s.itemId===i&&e.setChecked(s.enabled)})}destroy(){this.ctx.domManager.removeChild("canvas-overlay",`${this.id}-toolbar`),this.ctx.domManager.removeChild("canvas-overlay",`${this.id}-pagination`),this.cleanup.flush(),this.itemSelection.clear()}getOrientation(){return this.orientation??"horizontal"}set visible(t){this._visible=t,this.updateGroupVisibility()}get visible(){return this._visible}updateGroupVisibility(){this.group.visible=this.enabled&&this.visible&&this.data.length>0}isInteractive(){const{toggleSeries:t,listeners:{legendItemClick:e,legendItemDoubleClick:i}}=this;return t||null!=i||null!=e}attachLegend(t){t.appendChild(this.group)}getItemLabel(t){const{formatter:e}=this.item.label;if(e){const i=t.datum;return this.cachedCallWithContext(e,{itemId:t.itemId,value:t.label.text,seriesId:t.seriesId,...i&&{datum:i}})}return t.label.text}calcLayout(t,e){const{paddingX:i,paddingY:s,label:n,maxWidth:a,label:{maxLength:o=1/0,fontStyle:r,fontWeight:l,fontSize:c,fontFamily:h}}=this.item,d=[...this.data];this.reverseOrder&&d.reverse(),this.itemSelection.update(d);const u=[],p=Xi(n),g=a??.8*t,{markerWidth:m,anyLineEnabled:f}=this.calculateMarkerWidth();if(this.itemSelection.each((t,e)=>{t.fontStyle=r,t.fontWeight=l,t.fontSize=c,t.fontFamily=h;const i=this.updateMarkerLabel(t,e,m,f),s=e.itemId??e.id,n=At(this.getItemLabel(e),"<unknown>").replace(Bi," ");t.text=this.truncate(n,o,g,i,p,s),u.push(t.getTextMeasureBBox())}),t=Math.max(1,t),e=Math.max(1,e),!Number.isFinite(t))return{};[t,e]=this.updateContainer(t,e);const y=this.size,x=this.oldSize;y[0]=t,y[1]=e,y[0]===x[0]&&y[1]===x[1]||(x[0]=y[0],x[1]=y[1]);const{pages:b,maxPageHeight:v,maxPageWidth:M}=this.updatePagination(u,t,e),S=this.pages;this.pages=b,this.maxPageSize=[M-i,v-s];const I=this.pagination.currentPage,D=this.pages[I];return this.pages.length<1||!D?(this.visible=!1,{oldPages:S}):(this.visible=!0,this.updatePositions(I),this.update(),{oldPages:S})}isCustomMarker(t,e){return t&&void 0!==e&&"string"!=typeof e}calcSymbolsEnabled(t){const{showSeriesStroke:e,marker:i}=this.item,s=!!i.enabled||!e||(t.marker.enabled??!0);return{markerEnabled:s,lineEnabled:!(!t.line||!e),isCustomMarker:this.isCustomMarker(s,t.marker.shape)}}calcSymbolsLengths(t,e,i){const{marker:s,line:n}=this.item;let a;const{shape:o}=t.marker;if(this.isCustomMarker(e,o)){const t=new Ig;t.shape=o,t.updatePath();const e=t.getBBox();a=Math.max(e.width,e.height)}return{markerLength:e?s.size:0,lineLength:i?n.length??25:0,customMarkerSize:a}}calculateMarkerWidth(){let t=0,e=!1;return this.itemSelection.each((i,s)=>{const{symbol:n}=s,{lineEnabled:a,markerEnabled:o}=this.calcSymbolsEnabled(n),{markerLength:r,lineLength:l,customMarkerSize:c=-1/0}=this.calcSymbolsLengths(n,o,a);t=Math.max(t,l,c,r),e||(e=a)}),{markerWidth:t,anyLineEnabled:e}}updateMarkerLabel(t,e,i,s){const{marker:n,paddingX:a}=this.item,{symbol:o}=e;let r=a;const{markerEnabled:l,isCustomMarker:c}=this.calcSymbolsEnabled(o),h=n.padding;(l||s)&&(r+=h+i);const{marker:d,line:u}=t;return d.visible=l,d.visible&&(d.shape=n.shape??o.marker.shape??"square",d.size=n.size,ag(d,this.getMarkerStyles(Xa(o)))),u.visible=s,u.visible&&ag(u,this.getLineStyles(o)),t.length=i,t.spacing=h,t.isCustomMarker=c,r}updateContainer(t,e){const i=this.getContainerStyles();return this.containerNode.width=0,this.containerNode.height=0,ag(this.containerNode,i),this.containerNode.cornerRadius=i.cornerRadius,[t-=2*i.strokeWidth+i.padding.left+i.padding.right,e-=2*i.strokeWidth+i.padding.top+i.padding.bottom]}truncate(t,e,i,s,n,a){let o=!1;t.length>e&&(t=t.substring(0,e),o=!0);const r=es(t,n,i-s,o);return _i(r)?this.truncatedItems.add(a):this.truncatedItems.delete(a),r}updatePagination(t,e,i){const s=this.getOrientation(),n=Math.min(this.paginationTrackingIndex,t.length);this.pagination.orientation=s,this.pagination.translationX=0,this.pagination.translationY=0;const{pages:a,maxPageHeight:o,maxPageWidth:r,paginationBBox:l,paginationVertical:c}=this.calculatePagination(t,e,i),h=a.findIndex(t=>t.endIndex>=n);this.pagination.currentPage=C(0,h,a.length-1);const{paddingX:d,paddingY:u}=this.item,p=r-d,g=o-u;let m=0,f=-l.y-this.item.marker.size/2;c?f+=g+8:(m+=-l.x+p+8,f+=(g-l.height)/2),this.pagination.translationX=m,this.pagination.translationY=f,this.pagination.update(),this.pagination.updateMarkers();let y=0;return this.itemSelection.each((t,e,i)=>{i>(a[y]?.endIndex??1/0)&&y++,t.pageIndex=y}),{maxPageHeight:o,maxPageWidth:r,pages:a}}calculatePagination(t,e,s){const{paddingX:n,paddingY:a}=this.item,{placement:o}=WS(this.position),r=this.getOrientation(),l=["left","left-top","left-bottom","right","right-top","right-bottom"].includes(o);let c=this.pagination.getBBox(),h=new fs(0,0,0,0),d=[],u=0,p=0,g=0;const m=t=>t.width===c.width&&t.height===c.height,f=void 0!==this.maxWidth&&void 0!==this.maxHeight;do{if(g++>10){i.warn("unable to find stable legend layout.");break}c=h;const o=e-(l?0:c.width),m=PS({orientation:r,bboxes:t,maxHeight:s-(l?c.height:0),maxWidth:o,itemPaddingY:a,itemPaddingX:n,forceResult:f});d=m?.pages??[],u=m?.maxPageWidth??0,p=m?.maxPageHeight??0;const y=d.length;if(this.pagination.visible=y>1,this.pagination.totalPages=y,this.pagination.update(),this.pagination.updateMarkers(),h=this.pagination.getBBox(),!this.pagination.visible)break}while(!m(h));return{maxPageWidth:u,maxPageHeight:p,pages:d,paginationBBox:h,paginationVertical:l}}updatePositions(t=0){const{item:{paddingY:e},itemSelection:i,pages:s}=this;if(s.length<1||!s[t])return;const{columns:n,startIndex:a,endIndex:o}=s[t];let r=0,l=0;const c=n.length,h=n[0].indices.length,d="horizontal"===this.getOrientation(),u=n[0].bboxes[0].height+e,p=[];i.each((t,e,i)=>{if(i<a||i>o)return void(t.visible=!1);const s=i-a;let g,m;d?(g=s%c,m=Math.floor(s/c)):(g=Math.floor(s/h),m=s%h),t.visible=!0;const f=n[g];f&&(l=Math.floor(u*m),r=Math.floor(p[m]??0),p[m]=(p[m]??0)+f.columnWidth,t.translationX=r,t.translationY=l)})}updatePageNumber(t){const{itemSelection:e,group:i,pagination:s,pages:n}=this,{startIndex:a,endIndex:o}=n[t];0===a?this.paginationTrackingIndex=0:t===n.length-1?this.paginationTrackingIndex=o:this.paginationTrackingIndex=Math.floor((a+o)/2),this.pagination.update(),this.pagination.updateMarkers(),this.updatePositions(t),this.domProxy.onPageChange({itemSelection:e,group:i,pagination:s,interactive:this.isInteractive()}),this.ctx.updateService.update(7)}update(){const{label:{color:t}}=this.item;this.itemSelection.each((e,i)=>{e.setEnabled(i.enabled),e.color=t}),this.updateContextMenu()}updateContextMenu(){const t=this.toggleSeries?"show":"hide";this.ctx.contextMenuRegistry.toggle("toggle-series-visibility",t),this.ctx.contextMenuRegistry.toggle("toggle-other-series",t)}getLineStyles(t){const{stroke:e,strokeOpacity:i=1,strokeWidth:s,lineDash:n}=t.line??{},a=Math.min(2,s??1);return{stroke:e,strokeOpacity:i,strokeWidth:this.item.line.strokeWidth??a,lineDash:n}}getMarkerStyles({marker:t}){const{fill:e,stroke:i,strokeOpacity:s=1,fillOpacity:n=1,strokeWidth:a,lineDash:o,lineDashOffset:r}=t,l=Math.min(2,a??1);return ma(e)&&(e.width=8,e.height=8,e.padding=1,e.strokeWidth=Math.min(2,e.strokeWidth??2)),fa(e)&&(e.fit="contain",e.width=void 0,e.height=void 0,e.repeat="no-repeat"),sg({fill:e,stroke:i,strokeOpacity:s,fillOpacity:n,strokeWidth:this.item.marker.strokeWidth??l,lineDash:o,lineDashOffset:r},QS,qS,JS)}getContainerStyles(){const{stroke:t,strokeOpacity:e,strokeWidth:i}=this.border,{cornerRadius:s,fill:n,fillOpacity:a,padding:o}=this,r="number"==typeof o;return sg({cornerRadius:s,fill:n,fillOpacity:a,padding:{top:r?o:o.top??0,right:r?o:o.right??0,bottom:r?o:o.bottom??0,left:r?o:o.left??0},stroke:t,strokeOpacity:e,strokeWidth:this.border.enabled?i:0},QS,qS,JS)}computePagedBBox(){const t=Oa.computeChildrenBBox(this.group.excludeChildren({name:"legend-container"}));if(this.pages.length>1){const[e,i]=this.maxPageSize;t.height=Math.max(i,t.height),t.width=Math.max(e,t.width)}const{strokeWidth:e,padding:i}=this.getContainerStyles();return t.grow(i).grow(e),t}findNode(t){const{datum:e,proxyButton:i}=this.itemSelection.select(e=>e.datum?.itemId===t.itemId)[0]??{};if(void 0===e||void 0===i)throw new Error(`AG Charts - Missing required properties { datum: ${e}, proxyButton: ${JSON.stringify(i)} }`);return{datum:e,proxyButton:i}}contextToggleVisibility(t){const{datum:e,proxyButton:i}=this.findNode(t);this.doClick(t.event,e,i)}contextToggleOtherSeries(t){this.doDoubleClick(t.event,this.findNode(t).datum)}onContextClick(t,e){const{sourceEvent:i}=t,s=e.datum;this.preventHidingAll&&this.contextMenuDatum?.enabled&&this.getVisibleItemCount()<=1?this.ctx.contextMenuRegistry.builtins.items["toggle-series-visibility"].enabled=!1:this.ctx.contextMenuRegistry.builtins.items["toggle-series-visibility"].enabled=!0;const n=this.ctx.chartService.series.length>1&&!0!==this.ctx.chartService.series[0]?.getLegendData("category")[0]?.hideToggleOtherSeries?"show":"hide";this.ctx.contextMenuRegistry.toggle("toggle-other-series",n);const{offsetX:a,offsetY:o}=i,{x:r,y:l}=Ta.toCanvasPoint(e,a,o);this.ctx.contextMenuRegistry.dispatchContext("legend-item",{widgetEvent:t,canvasX:r,canvasY:l},{legendItem:s})}onClick(t,e,i){this.doClick(t,e,i)&&t.preventDefault()}getVisibleItemCount(){return this.ctx.chartService.series.flatMap(t=>t.getLegendData("category")).filter(t=>t.enabled).length}doClick(t,e,i){const{listeners:{legendItemClick:s},ctx:{chartService:n,highlightManager:a},preventHidingAll:o,toggleSeries:r}=this;if(!e)return!1;const{legendType:l,seriesId:c,itemId:h,enabled:d,legendItemName:u}=e,p=n.series.find(t=>t.id===c);if(!p)return!1;let g=d;const m=HS("click",e,t);return s&&Fa([p.properties,this.ctx.chartService],s,m.apiEvent),m.defaultPrevented||(r&&(g=!d,o&&!g&&this.getVisibleItemCount()<2&&(g=!0),i.setChecked(g),this.ctx.eventsHub.emit("legend:item-click",{legendType:l,series:p,itemId:h,enabled:g,legendItemName:u})),g?a.updateHighlight(this.id,{series:p,itemId:h,datum:void 0,datumIndex:void 0,legendItemName:u}):a.updateHighlight(this.id),this.ctx.legendManager.update(),this.ctx.updateService.update(2,{forceNodeDataRefresh:!0,skipAnimations:e.skipAnimations??!1})),!0}onDoubleClick(t,e){this.doDoubleClick(t,e)&&t.preventDefault()}doDoubleClick(t,e){const{listeners:{legendItemDoubleClick:i},ctx:{chartService:s},toggleSeries:n}=this;if(!e)return!1;const{legendType:a,id:o,itemId:r,seriesId:l}=e,c=s.series.find(t=>t.id===o);if(!c)return!1;const h=HS("dblclick",e,t);if(i&&Fa([c.properties,this.ctx.chartService],i,h.apiEvent),h.defaultPrevented)return!0;if(n){const t=s.series.flatMap(t=>t.getLegendData("category"));let e=0;const i=new Set;for(const s of t)s.enabled&&(e+=1,null!=s.legendItemName&&i.add(s.legendItemName));i.size>0&&(e=i.size);const n=t.find(t=>t.itemId===r&&t.seriesId===l);this.ctx.eventsHub.emit("legend:item-double-click",{legendType:a,series:c,itemId:r,numVisibleItems:e,enabled:n?.enabled??!1,legendItemName:n?.legendItemName})}return this.ctx.legendManager.update(),this.ctx.updateService.update(2,{forceNodeDataRefresh:!0}),!0}toTooltipMeta(t,e){let i;return t instanceof FocusEvent?i=Ta.toCanvas(e).computeCenter():(t.preventDefault(),i=Ta.toCanvasPoint(e,t.offsetX,t.offsetY)),{canvasX:i.x,canvasY:i.y,showArrow:!1}}onHover(t,e){if(!this.enabled)throw new Error("AG Charts - onHover handler called on disabled legend");this.pagination.setPage(e.pageIndex);const i=e.datum,s=i?this.ctx.chartService.series.find(t=>t.id===i?.id):void 0;if(i&&this.truncatedItems.has(i.itemId??i.id)){const s=this.toTooltipMeta(t,e);this.ctx.tooltipManager.updateTooltip(this.id,s,[{type:"structured",title:this.getItemLabel(i)}])}else this.ctx.tooltipManager.removeTooltip(this.id);i?.enabled&&s?this.updateHighlight({series:s,itemId:i?.itemId,datum:void 0,datumIndex:void 0,legendItemName:i?.legendItemName}):this.updateHighlight()}onLeave(){this.ctx.tooltipManager.removeTooltip(this.id),this.updateHighlight()}updateHighlight(t){this.ctx.interactionManager.isState(32)?this.ctx.highlightManager.updateHighlight(this.id,t):this.ctx.interactionManager.isState(2)&&(this.pendingHighlightDatum=t,this.ctx.animationManager.onBatchStop(()=>{this.ctx.highlightManager.updateHighlight(this.id,this.pendingHighlightDatum)}))}onLocaleChanged(){this.domProxy.onLocaleChanged(this.ctx.localeManager,this.itemSelection,this)}positionLegend(t){const e=this.positionLegendScene(t);this.positionLegendDOM(e)}positionLegendScene(t){if(!this.enabled||!this.data.length)return;const{placement:e,floating:i,xOffset:s,yOffset:n}=WS(this.position),a=i?new fs(0,0,t.width,t.height):t.layoutBox,{x:o,y:r,width:l,height:c}=a,[h,d]=this.calculateLegendDimensions(a),{oldPages:u}=this.calcLayout(h,d),p=this.computePagedBBox();if(this.visible){let t=function(t){};const h=this.spacing;let d,u;switch(e){case"top":d=(l-p.width)/2,u=0;break;case"bottom":d=(l-p.width)/2,u=c-p.height;break;case"right":d=l-p.width,u=(c-p.height)/2;break;case"left":d=0,u=(c-p.height)/2;break;case"top-right":case"right-top":d=l-p.width,u=0;break;case"top-left":case"left-top":d=0,u=0;break;case"bottom-right":case"right-bottom":d=l-p.width,u=c-p.height;break;case"bottom-left":case"left-bottom":d=0,u=c-p.height;break;default:t(e)}if(!i){let i,s;switch(e){case"top":case"top-right":case"top-left":i=p.height+h,s="top";break;case"bottom":case"bottom-right":case"bottom-left":i=p.height+h,s="bottom";break;case"left":case"left-top":case"left-bottom":i=p.width+h,s="left";break;case"right":case"right-top":case"right-bottom":i=p.width+h,s="right";break;default:t(e)}a.shrink(i,s)}d+=s,u+=n,this.group.translationX=Math.floor(o+d-p.x),this.group.translationY=Math.floor(r+u-p.y),this.containerNode.x=p.x,this.containerNode.y=p.y,this.containerNode.width=p.width,this.containerNode.height=p.height}return u}positionLegendDOM(t){const{ctx:e,itemSelection:i,pagination:s,pages:n,group:a}=this,o=this.visible&&this.enabled,r=this.isInteractive();this.domProxy.update({visible:o,interactive:r,ctx:e,itemSelection:i,group:a,pagination:s,oldPages:t,newPages:n,datumReader:this,itemListener:this})}calculateLegendDimensions(t){const{width:e,height:i}=t,{placement:s}=WS(this.position),n=e/i;let a,o;switch(s){case"top":case"top-left":case"top-right":case"bottom":case"bottom-left":case"bottom-right":{const t=n<1?Math.min(.5,1/n*.2):.2;a=this.maxWidth?Math.min(this.maxWidth,e):e,o=this.maxHeight?Math.min(this.maxHeight,i):Math.round(i*t);break}case"left":case"left-top":case"left-bottom":case"right":case"right-top":case"right-bottom":{const t=n>1?Math.min(.5,.25*n):.25;a=this.maxWidth?Math.min(this.maxWidth,e):Math.round(e*t),o=this.maxHeight?Math.min(this.maxHeight,i):i;break}}return[a,o]}cachedCallWithContext(t,e){const{callbackCache:i,chartService:s}=this.ctx;return i.call([this,s],t,e)}};tI.className="Legend",ls([ws],tI.prototype,"toggleSeries",2),ls([ws],tI.prototype,"pagination",2),ls([ws],tI.prototype,"item",2),ls([ws],tI.prototype,"listeners",2),ls([lo((t,e,i)=>{if(t.updateGroupVisibility(),e===i)return;const{ctx:{legendManager:s,stateManager:n}}=t;!1===i&&!0===e&&n.restoreState(s)}),ws],tI.prototype,"enabled",2),ls([ws],tI.prototype,"position",2),ls([ws],tI.prototype,"maxWidth",2),ls([ws],tI.prototype,"maxHeight",2),ls([ws],tI.prototype,"reverseOrder",2),ls([ws],tI.prototype,"orientation",2),ls([ws],tI.prototype,"preventHidingAll",2),ls([ws],tI.prototype,"border",2),ls([ws],tI.prototype,"cornerRadius",2),ls([ws],tI.prototype,"fill",2),ls([ws],tI.prototype,"fillOpacity",2),ls([ws],tI.prototype,"padding",2),ls([ws],tI.prototype,"spacing",2),ls([ws],tI.prototype,"xOffset",2),ls([ws],tI.prototype,"yOffset",2);var eI={type:"legend",optionsKey:"legend",identifier:"category",chartTypes:["cartesian","polar","topology","standalone"],moduleFactory:t=>new tI(t),packageType:"community",removable:"standalone-only"},iI=class extends Pn{constructor(t){super(),this.ctx=t,this.rectNode=new Uo,this.border=new RS(this.rectNode),this.cornerRadius=0,this.padding=0,this.cleanup=new Mi,this.node=this.createNode(),this.node.append([this.rectNode]),this.rectNode.fill=void 0,this.cleanup.register(t.scene.attachNode(this.node),t.eventsHub.on("layout:complete",t=>this.onLayoutComplete(t)))}destroy(){this.cleanup.flush()}getPadding(){const{border:t,padding:e}=this,i=t.enabled?t.strokeWidth:0;if("number"==typeof e){const t=e+i;return{top:t,right:t,bottom:t,left:t}}return{top:(e.top??0)+i,right:(e.right??0)+i,bottom:(e.bottom??0)+i,left:(e.left??0)+i}}createNode(){return new Oa({name:"series-area-container",zIndex:4})}onLayoutComplete(t){const{x:e,y:i,width:s,height:n}=t.series.paddedRect;this.rectNode.x=e,this.rectNode.y=i,this.rectNode.width=s,this.rectNode.height=n}};ls([ws],iI.prototype,"border",2),ls([ws],iI.prototype,"clip",2),ls([oo("rectNode","cornerRadius"),ws],iI.prototype,"cornerRadius",2),ls([ws],iI.prototype,"padding",2);var sI={type:"root",optionsKey:"seriesArea",packageType:"community",chartTypes:["cartesian","polar","topology","standalone"],moduleFactory:t=>new iI(t)};function nI(t,e,i,s,n){const a=(s,n,a,o)=>{i.animate({id:`${t}_${e}_${n.id}_${s}`,groupId:t,from:a?1:0,to:1,ease:Gl,collapsable:a,onUpdate(t,e){e&&"removed"!==s||(n.path.clear(!0),o(t,n),n.checkPathDirty())},onStop(){"added"===s&&(n.path.clear(!0),o(1,n),n.checkPathDirty())},phase:ld[s]})},o=new Go,r=t=>(o.resetPathDirty(),t(0,o),o.resetPathDirty(),t(1,o),o.checkPathDirty(),o.isPathDirty()),{addPhaseFn:l,updatePhaseFn:c,removePhaseFn:h}=n;for(const t of s)i.isSkipped()||(a("removed",t,!r(h),h),a("updated",t,!r(c),c)),a("added",t,!r(l),l)}function aI(t,e,i,s,n,a){if(t.visible&&s.itemStyler){const o=n||t.isSeriesHighlighted(a),r=t.getHighlightStateString(a,n||null!=e&&a?.series===e.series&&a?.datumIndex===e.datumIndex,e?.datumIndex),l={border:s.border,color:s.color,cornerRadius:s.cornerRadius,datum:e?.datum,enabled:s.enabled,fill:s.fill,fillOpacity:s.fillOpacity,fontFamily:s.fontFamily,fontSize:s.fontSize,fontStyle:s.fontStyle,fontWeight:s.fontWeight,itemId:e?.itemId,seriesId:t.id,padding:s.padding,highlighted:o,highlightState:r};return zs(t.ctx.optionsGraphService.resolvePartial(["series",`${t.declarationOrder}`,"label"],t.cachedCallWithContext(s.itemStyler,{...i,...l}),{pick:!1})??{},l)}return s}function oI(t,e,i,s,n,a,o){if(t.visible&&s.enabled&&n){const r=aI(t,e.datum,i,s,a,o);e.visible=!0,e.x=n.x,e.y=n.y,e.text=n.text,e.fill=r.color,e.setAlign(n),e.setFont(r),e.setBoxing(r)}else e.visible=!1}var rI={"inside-start":{inside:!0,direction:-1,textAlignment:1},"inside-end":{inside:!0,direction:1,textAlignment:-1},"outside-start":{inside:!1,direction:-1,textAlignment:-1},"outside-end":{inside:!1,direction:1,textAlignment:1}};function lI({isUpward:t,isVertical:e,placement:i,spacing:s=0,rect:n}){let a=n.x+n.width/2,o=n.y+n.height/2,r="center",l="middle";if("inside-center"!==i){const c=(t?1:-1)*(e?-1:1),{direction:h,textAlignment:d}=rI[i],u=.5*(h+1);e?(o=(t?n.y+n.height:n.y)+n.height*c*u+s*d*c,l=d===c?"top":"bottom"):(a=(t?n.x:n.x+n.width)+n.width*c*u+s*d*c,r=d===c?"left":"right")}return{x:a,y:o,textAlign:r,textBaseline:l}}function cI({id:t},e,i,...s){for(const t of s)t.cleanup();hd(t,e,i,s,{opacity:0},{opacity:1},{phase:"trailing"})}function hI({id:t},e,i,...s){hd(t,e,i,s,{opacity:1},{opacity:0},{phase:"remove"})}function dI(t){return{opacity:1}}function uI(t,e,i,s,n,a,o,r){let l=0;for(;l<100&&null==t[s]&&s<n;)s+=1,l+=1;for(;l<100&&null==t[n]&&n>s;)n-=1,l+=1;if(l>=100||s>=n)return a;const c=Number.isFinite(e)?yI(t[n],e,i,r)-yI(t[s],e,i,r):fI(n,t.length)-fI(s,t.length);if(0===c||!Number.isFinite(c))return a;const h=Math.abs(c)/(n-s);let d;if(d=o<3||!(o>20)&&h<=a,a=Math.min(a,h),!d)return a;const u=Math.floor((s+n)/2),p=uI(t,e,i,s,u,a,o+1,r),g=uI(t,e,i,u+1,n,a,o+1,r);return Math.min(p,g,a)}function pI(t,e,i,s){return uI(t,e,i,0,t.length-1,1/(t.length-1),0,s)}function gI(t,e,i,s){if(Number.isFinite(e)){const n=s?.smallestKeyInterval,a=null==n?pI(t,e,i,s?.xNeedsValueOf??!0):n/(i-e);return Fc(Math.trunc(1/a))>>3}{let e=Math.ceil(Math.log2(t.length))-1;return e=Math.min(Math.max(e,0),24),Math.trunc(2**e)}}function mI(t,e){switch(t){case"category":return[Number.NaN,Number.NaN];case"number":case"time":case"ordinal-time":case"unit-time":{let t=1/0,i=-1/0;for(const s of e){const e=Number(s);t=Math.min(t,e),i=Math.max(i,e)}return[t,i]}case"color":case"log":case"mercator":return[0,0]}}function fI(t,e){return t/e}function yI(t,e,i,s){return s?(t.valueOf()-e)/(i-e):(t-e)/(i-e)}function xI(t,e){return Math.trunc(4*Math.min(Math.floor(t*e),e-1))}function bI(t,e,i,s,n,a,{positive:o,xNeedsValueOf:r=!0,yNeedsValueOf:l=!0}={}){const c=new Int32Array(4*a).fill(-1),h=new Float64Array(4*a).fill(Number.NaN),d=Number.isFinite(s)&&Number.isFinite(n),u=d?n-s:0,p=1/t.length;let g=-1,m=-1,f=Number.NaN,y=-1,x=Number.NaN,b=-1,v=Number.NaN,M=-1,S=Number.NaN;const I=t=>{const e=t;c[e+0]=m,c[e+1]=y,c[e+2]=b,c[e+3]=M,h[e+0]=f,h[e+1]=x,h[e+2]=v,h[e+3]=S},D=t=>{const e=t;m=c[e+0],y=c[e+1],b=c[e+2],M=c[e+3],f=h[e+0],x=h[e+1],v=h[e+2],S=h[e+3]},k=t.length,A=e===i;for(let n=0;n<k;n++){const c=t[n];if(null==c)continue;const h=e[n],k=A?h:i[n];let w,C,N;if(l?(w=null==h?Number.NaN:h.valueOf(),C=null==k?Number.NaN:k.valueOf()):(w=h??Number.NaN,C=k??Number.NaN),null!=o&&w>=0!==o)continue;N=d?r?(c.valueOf()-s)/u:(c-s)/u:n*p;const L=Math.trunc(4*Math.min(Math.floor(N*a),a-1));L!==g&&(-1!==g&&I(g),g=L,D(L));const T=!Number.isNaN(C),E=!Number.isNaN(w);-1===m?(m=n,f=N,y=n,x=N,T&&(b=n,v=C),E&&(M=n,S=w)):(N<f&&(m=n,f=N),N>x&&(y=n,x=N),T&&C<v&&(b=n,v=C),E&&w>S&&(M=n,S=w))}return-1!==g&&I(g),{indexData:c,valueData:h}}function vI(t,e,i,{inPlace:s=!1}={}){const n=Math.trunc(i/2),a=s?t:new Int32Array(4*n),o=s?e:new Float64Array(4*n);for(let i=0;i<n;i+=1){const s=Math.trunc(4*i),n=Math.trunc(2*s),r=Math.trunc(n+4),l=-1===t[r+0],c=l||e[n+0]<e[r+0]?n:r;a[s+0]=t[c+0],o[s+0]=e[c+0];const h=l||e[n+1]>e[r+1]?n:r;a[s+1]=t[h+1],o[s+1]=e[h+1];const d=l||e[n+2]<e[r+2]?n:r;a[s+2]=t[d+2],o[s+2]=e[d+2];const u=l||e[n+3]>e[r+3]?n:r;a[s+3]=t[u+3],o[s+3]=e[u+3]}return{maxRange:n,indexData:a,valueData:o}}function MI(t,e,i,s,n,a,o){const r=t[a];if(null==r)return-1;const l=xI(Number.isFinite(e)?yI(r,e,i,o):fI(a,t.length),n);return a===s[l+0]||a===s[l+1]||a===s[l+2]||a===s[l+3]?l:-1}var SI=class extends Pn{constructor(){super(...arguments),this._dirty=!0}markDirty(){this._dirty=!0}markClean(t){this._dirty=!1}isDirty(){return this._dirty}onChangeDetection(t){this.markDirty()}},II=class extends SI{constructor(){super(...arguments),this.enabled=!0,this.color="rgba(0, 0, 0, 0.5)",this.xOffset=0,this.yOffset=0,this.blur=5}};ls([ws,Xs()],II.prototype,"enabled",2),ls([ws,Xs()],II.prototype,"color",2),ls([ws,Xs()],II.prototype,"xOffset",2),ls([ws,Xs()],II.prototype,"yOffset",2),ls([ws,Xs()],II.prototype,"blur",2);var DI=class extends SI{constructor(){super(...arguments),this.enabled=!0,this.shape="circle",this.size=0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}getStyle(){const{size:t,shape:e,fill:i,fillOpacity:s,stroke:n,strokeWidth:a,strokeOpacity:o,lineDash:r,lineDashOffset:l}=this;return{size:t,shape:e,fill:i,fillOpacity:s,stroke:n,strokeWidth:a,strokeOpacity:o,lineDash:r,lineDashOffset:l}}getDiameter(){return this.size+this.strokeWidth}};ls([ws,Xs()],DI.prototype,"enabled",2),ls([ws,qs({equals:Zs})],DI.prototype,"shape",2),ls([ws,Xs()],DI.prototype,"size",2),ls([ws,qs({equals:Rs})],DI.prototype,"fill",2),ls([ws,Xs()],DI.prototype,"fillOpacity",2),ls([ws,Xs()],DI.prototype,"stroke",2),ls([ws,Xs()],DI.prototype,"strokeWidth",2),ls([ws,Xs()],DI.prototype,"strokeOpacity",2),ls([ws],DI.prototype,"lineDash",2),ls([ws],DI.prototype,"lineDashOffset",2),ls([ws,qs({equals:Zs})],DI.prototype,"itemStyler",2);var kI=class extends Pn{constructor(){super(...arguments),this.enabled=!1}};ls([ws],kI.prototype,"enabled",2);var AI=class extends Pn{constructor(){super(...arguments),this.interaction=new kI,this.position=new Fg,this.range=void 0,this.class=void 0}formatTooltip(t,e,i){const s=null==this.renderer?void 0:Fa(t,this.renderer,i);return"string"==typeof s?{type:"raw",rawHtmlString:s}:null!=s?{type:"structured",...e,...s}:{type:"structured",...e}}};function wI(){return new AI}ls([ws],AI.prototype,"enabled",2),ls([ws],AI.prototype,"showArrow",2),ls([ws],AI.prototype,"renderer",2),ls([ws],AI.prototype,"interaction",2),ls([ws],AI.prototype,"position",2),ls([ws],AI.prototype,"range",2),ls([ws],AI.prototype,"class",2);var CI=class extends Go{constructor(){super(...arguments),this.segmentPath=new Go}drawPath(t){if(!this.segments||0===this.segments.length)return void super.drawPath(t);t.save();const e=new Path2D;NI(e,{x0:0,y0:0,x1:t.canvas.width,y1:t.canvas.height},!1);for(const t of this.segments)NI(e,t.clipRect);t.clip(e),super.drawPath(t),t.restore();const{segmentPath:i}=this;i.setProperties({opacity:this.opacity,visible:this.visible,lineCap:this.lineCap,lineJoin:this.lineJoin,pointerEvents:this.pointerEvents});for(const{clipRect:e,fill:s,stroke:n,...a}of this.segments){t.save(),i.path=this.path,i.setProperties(a),i.fill=null==this.fill?"none":s,i.stroke=null==this.stroke?"none":n;const o=new Path2D;NI(o,e),t.clip(o),i.drawPath(t),t.restore()}}};function NI(t,{x0:e,y0:i,x1:s,y1:n},a=!0){const o=Math.min(e,s),r=Math.min(i,n),l=Math.max(e,s),c=Math.max(i,n);t.moveTo(o,r),a?(t.lineTo(l,r),t.lineTo(l,c),t.lineTo(o,c)):(t.lineTo(o,c),t.lineTo(l,c),t.lineTo(l,r)),t.closePath()}ls([Qs()],CI.prototype,"segments",2);var LI=class extends za{constructor(){super(...arguments),this.segments=[],this.scalablePath=new(Ca(Go))}renderInContext(t){if(!this.visible)return;const{ctx:e}=t;if(!this.segments||0===this.segments?.length)return super.renderInContext(t);e.save();const i=new Path2D;NI(i,{x0:0,y0:0,x1:e.canvas.width,y1:e.canvas.height},!1);for(const t of this.segments)NI(i,t.clipRect);e.clip(i);for(const e of this.children())e.visible&&e.render(t);e.restore();const{scalablePath:s}=this;for(const{clipRect:i,...n}of this.segments){e.save();const a=new Path2D;NI(a,i),e.clip(a),s.setProperties(n);for(const e of this.children())e.visible&&e instanceof Go&&(s.path=e.path,s.setProperties({opacity:e.opacity,lineCap:e.lineCap,lineJoin:e.lineJoin,...wa(e)&&{scalingX:e.scalingX,scalingY:e.scalingY,scalingCenterX:e.scalingCenterX,scalingCenterY:e.scalingCenterY}}),s.render(t));e.restore()}}};ls([Qs()],LI.prototype,"segments",2);var TI=class{constructor(t,e,i){this.root=new RI(t,e,i)}clear(t){this.root.clear(t)}addValue(t,e){const i={hitTester:t,value:e,distanceSquared:(e,i)=>t.distanceSquared(e,i)};this.root.addElem(i)}find(t,e){const i={best:{nearest:void 0,distanceSquared:1/0}};return this.root.find(t,e,i),i.best}},EI=class{constructor(t,e,i,s){this.nw=t,this.ne=e,this.sw=i,this.se=s}addElem(t){this.nw.addElem(t),this.ne.addElem(t),this.sw.addElem(t),this.se.addElem(t)}find(t,e,i){this.nw.find(t,e,i),this.ne.find(t,e,i),this.sw.find(t,e,i),this.se.find(t,e,i)}},OI=class{constructor(t,e,i){this.capacity=t,this.maxdepth=e,this.boundary=i??fs.NaN,this.elems=[],this.subdivisions=void 0}clear(t){this.elems.length=0,this.boundary=t,this.subdivisions=void 0}addElem(t){this.addCondition(t)&&(void 0===this.subdivisions?0===this.maxdepth||this.elems.length<this.capacity?this.elems.push(t):this.subdivide(t):this.subdivisions.addElem(t))}find(t,e,i){this.findCondition(t,e,i)&&(void 0===this.subdivisions?this.findAction(t,e,i):this.subdivisions.find(t,e,i))}subdivide(t){this.subdivisions=this.makeSubdivisions();for(const t of this.elems)this.subdivisions.addElem(t);this.subdivisions.addElem(t),this.elems.length=0}makeSubdivisions(){const{x:t,y:e,width:i,height:s}=this.boundary,{capacity:n}=this,a=this.maxdepth-1,o=i/2,r=s/2,l=new fs(t,e,o,r),c=new fs(t+o,e,o,r),h=new fs(t,e+r,o,r),d=new fs(t+o,e+r,o,r);return new EI(this.child(n,a,l),this.child(n,a,c),this.child(n,a,h),this.child(n,a,d))}},RI=class t extends OI{addCondition(t){const{x:e,y:i}=t.hitTester.midPoint;return this.boundary.containsPoint(e,i)}findCondition(t,e,i){const{best:s}=i;return 0!==s.distanceSquared&&this.boundary.distanceSquared(t,e)<s.distanceSquared}findAction(t,e,i){const s=ps(t,e,this.elems,i.best.distanceSquared);void 0!==s.nearest&&s.distanceSquared<i.best.distanceSquared&&(i.best=s)}child(e,i,s){return new t(e,i,s)}},PI=class extends dg{constructor({clipFocusBox:t,categoryKey:e,...i}){super(i),this.categoryKey=e,this.clipFocusBox=t??!0}dataCount(){return this.processedData?.dataSources?.get(this.id)?.data?.length??0}getHasData(t){const{dataModel:e,processedData:i}=this;if(!e||!i)return super.hasData;const s=e.resolveColumnById(this,t,i);for(const t of s)if(null!=t&&("number"!=typeof t||!Number.isNaN(t)))return!0;return!1}getScaleInformation({xScale:t,yScale:e}){return{isContinuousX:$c.is(t),isContinuousY:$c.is(e),xScaleType:t?.type,yScaleType:e?.type}}getModulePropertyDefinitions(){const t=this.axes.x?.scale,e=this.axes.y?.scale;return this.moduleMap.mapModules(i=>i.getPropertyDefinitions(this.getScaleInformation({xScale:t,yScale:e}))).flat()}async requestDataModel(t,e,i){i.props.push(...this.getModulePropertyDefinitions());const{dataModel:s,processedData:n}=await t.request(this.id,e??Hh.empty(),i);return this.dataModel=s,this.processedData=n,this.events.emit("data-processed",{dataModel:s,processedData:n}),{dataModel:s,processedData:n}}isProcessedDataAnimatable(){const{processedData:t,ctx:e}=this;if(!t)return!1;const i=this.getNodeData();if(null!=i&&i.length>e.animationManager.maxAnimatableItems)return!1;const s=t.reduced?.animationValidation;if(!s)return!0;const{orderedKeys:n,uniqueKeys:a}=s;return n&&a}checkProcessedDataAnimatable(){this.isProcessedDataAnimatable()||this.ctx.animationManager.skipCurrentBatch()}pickFocus(t){const e=this.getNodeData();if(void 0===e||0===e.length)return;const i=this.computeFocusDatumIndex(t,e);if(void 0===i)return;const{clipFocusBox:s}=this,n=e[i],a={...t,datumIndex:i},o=this.computeFocusBounds(a);return void 0!==o?{bounds:o,clipFocusBox:s,datum:n,datumIndex:i}:void 0}pickNodesExactShape(t){const e=super.pickNodesExactShape(t);return e.sort((t,e)=>t.datumIndex-e.datumIndex),e}isDatumEnabled(t,e){const{missing:i=!1,enabled:s=!0,focusable:n=!0}=t[e];return!i&&s&&n}computeFocusDatumIndex(t,e){const i=(t,i)=>{for(;t>=0&&!this.isDatumEnabled(e,t);)t+=i;return-1===t?void 0:t},s=(t,i)=>{for(;t<e.length&&!this.isDatumEnabled(e,t);)t+=i;return t===e.length?void 0:t};let n;const a=C(0,t.datumIndex,e.length-1);return n=t.datumIndexDelta<0?i(a,t.datumIndexDelta):t.datumIndexDelta>0?s(a,t.datumIndexDelta):s(a,1)??i(a,-1),void 0===n?0===t.datumIndexDelta?void 0:t.datumIndex-t.datumIndexDelta:n}dataModelPropertyIsKey(t){const{processedData:e}=this;return!!e&&e.defs.keys.some(e=>e.id===t&&!0===e.idsMap?.get(this.id)?.has(t))}keysOrValues(t){const{dataModel:e,processedData:i}=this;return e&&i?this.dataModelPropertyIsKey(t)?e.resolveKeysById(this,t,i):e.resolveColumnById(this,t,i):[]}sortOrder(t){const{dataModel:e,processedData:i}=this;if(e&&i)return this.dataModelPropertyIsKey(t)?e.getKeySortOrder(this,t,i):e.getColumnSortOrder(this,t,i)}getCategoryKey(){return this.categoryKey}getCategoryValue(t){const{processedData:e,dataModel:i}=this,s=this.getCategoryKey();if(e&&i&&s)return e.invalidData?.get(this.id)?.[t]?void 0:this.keysOrValues(s)[t]}datumIndexForCategoryValue(t){const{processedData:e,dataModel:i}=this,s=this.getCategoryKey();if(!e||!i||!s)return;t=t.valueOf();const n=e.invalidData?.get(this.id),a=this.keysOrValues(s);for(let e=0;e<a.length;e+=1){if(!0===n?.[e])continue;const i=a[e]?.valueOf();if(Rs(t,i))return e}}},zI={x:["xKey"],y:["yKey"]},jI={x:["xName"],y:["yName"]},BI=class extends rg{constructor(t,e,i,s){super(t,e,i,s),this.xKey=s.properties.xKey,this.yKey=s.properties.yKey}},FI=class extends Sc{constructor(){super(...arguments),this.pickOutsideVisibleMinorAxis=!1,this.segmentation=new yc}};ls([ws],FI.prototype,"legendItemName",2),ls([ws],FI.prototype,"pickOutsideVisibleMinorAxis",2),ls([ws],FI.prototype,"segmentation",2);var VI=100,GI=class extends PI{constructor({pathsPerSeries:t=["path"],pathsZIndexSubOrderOffset:e=[],datumSelectionGarbageCollection:i=!0,animationAlwaysUpdateSelections:s=!1,segmentedDataNodes:n=!0,animationResetFns:a,propertyKeys:o,propertyNames:r,...l}){if(super({propertyKeys:o,propertyNames:r,canHaveAxes:!0,...l}),this.NodeEvent=BI,this.dataNodeGroup=this.contentGroup.appendChild(new LI({name:`${this.id}-series-dataNodes`,zIndex:1})),this.labelGroup=this.contentGroup.appendChild(new za({name:`${this.id}-series-labels`})),this.labelSelection=gd.select(this.labelGroup,_o),this.highlightSelection=gd.select(this.highlightGroup,()=>this.nodeFactory()),this.annotationSelections=new Set,this.seriesBelowStackContext=void 0,this.debug=bs.create(),!o||!r)throw new Error(`Unable to initialise series type ${this.type}`);this.opts={pathsPerSeries:t,pathsZIndexSubOrderOffset:e,propertyKeys:o,propertyNames:r,animationResetFns:a,animationAlwaysUpdateSelections:s,datumSelectionGarbageCollection:i,segmentedDataNodes:n},this.paths=t.map(t=>new CI({name:`${this.id}-${t}`})),this.datumSelection=gd.select(this.dataNodeGroup,()=>this.nodeFactory(),i),this.animationState=new Sd("empty",{empty:{update:{target:"ready",action:t=>this.animateEmptyUpdateReady(t)},reset:"empty",skip:"ready",disable:"disabled"},ready:{updateData:"waiting",clear:"clearing",highlight:t=>this.animateReadyHighlight(t),resize:t=>this.animateReadyResize(t),reset:"empty",skip:"ready",disable:"disabled"},waiting:{update:{target:"ready",action:t=>{this.ctx.animationManager.isSkipped()?this.resetAllAnimation(t):this.animateWaitingUpdateReady(t)}},reset:"empty",skip:"ready",disable:"disabled"},disabled:{update:t=>this.resetAllAnimation(t),reset:"empty"},clearing:{update:{target:"empty",action:t=>this.animateClearingUpdateEmpty(t)},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}get contextNodeData(){return this._contextNodeData}getNodeData(){return this.contextNodeData?.nodeData}attachSeries(t,e,i){super.attachSeries(t,e,i),this.attachPaths(this.paths)}detachSeries(t,e,i){super.detachSeries(t,e,i),this.detachPaths(this.paths)}updatedDomains(){this.animationState.transition("updateData")}attachPaths(t){for(const e of t)this.contentGroup.appendChild(e)}detachPaths(t){for(const e of t)e.remove()}renderToOffscreenCanvas(){const t=this.getNodeData();return null!=t&&t.length>VI}resetAnimation(t){"initial"===t?this.animationState.transition("reset"):"ready"===t?this.animationState.transition("skip"):"disabled"===t&&this.animationState.transition("disable")}addChartEventListeners(){this.cleanup.register(this.ctx.eventsHub.on("legend:item-click",t=>this.onLegendItemClick(t)),this.ctx.eventsHub.on("legend:item-double-click",t=>this.onLegendItemDoubleClick(t)))}destroy(){super.destroy(),this._contextNodeData=void 0}isSeriesHighlighted(t){const{series:e,legendItemName:i}=t??{},{legendItemName:s}=this.properties;return e===this||null!=s&&s===i}strokewidthChange(){const t=("strokeWidth"in this.properties&&this.properties.strokeWidth)??0,e=this.properties.highlight.highlightedSeries.strokeWidth??t,i=this.properties.highlight.highlightedItem?.strokeWidth??t;return t>i||e>i}update({seriesRect:t}){const{_contextNodeData:e}=this,i=this.checkResize(t),s=this.updateHighlightSelection();this.contentGroup.batchedUpdate(()=>{const t=this.updateSelections(),e=this.contextNodeData?.segments;this.opts.segmentedDataNodes?this.dataNodeGroup.segments=e??this.dataNodeGroup.segments:this.dataNodeGroup.segments=void 0,this.updateNodes(s,i||t)});const n=this.getAnimationData(t,e);n&&(i&&this.animationState.transition("resize",n),this.animationState.transition("update",n),this.processedDataUpdated=!1)}createStackContext(){}updateSelections(){var t;const e=!this.opts.animationAlwaysUpdateSelections&&this.ctx.animationManager.isSkipped();if(!this.visible&&e)return!1;const{nodeDataRefresh:i}=this;if(!i&&!this.isPathOrSelectionDirty())return!1;if(i){this.nodeDataRefresh=!1,this.debug("CartesianSeries.updateSelections() - calling createNodeData() for",this.id),this.markQuadtreeDirty(),this._contextNodeData=this.createNodeData();const e=this.isProcessedDataAnimatable();this._contextNodeData&&((t=this._contextNodeData).animationValid??(t.animationValid=e));const{dataModel:i,processedData:s}=this;void 0!==i&&void 0!==s&&this.events.emit("data-update",{dataModel:i,processedData:s}),this.updateSeriesSelections()}return i}updateSeriesSelections(){const{datumSelection:t,labelSelection:e,paths:i}=this,s=this._contextNodeData;if(!s)return;const{nodeData:n,labelData:a,itemId:o}=s;this.updatePaths({itemId:o,contextData:s,paths:i}),this.datumSelection=this.updateDatumSelection({nodeData:n,datumSelection:t}),this.labelGroup.batchedUpdate(()=>{this.labelSelection=this.updateLabelSelection({labelData:a,labelSelection:e})??e})}getShapeFillBBox(){const{axes:t}=this,e=t.x,i=t.y,[s,n]=jc(e?.range??[0,1]),[a,o]=jc(i?.range??[0,1]),r=this.getSeriesDomain("x"),l=[e?.scale.convert(r.at(0)),e?.scale.convert(r.at(-1))],c=this.getSeriesDomain("y"),h=[i?.scale.convert(c.at(0)),i?.scale.convert(c.at(-1))],[d,u]=jc(l),[p,g]=jc(h);return{axis:new fs(s,a,n-s,o-a),series:new fs(d,p,u-d,g-p)}}updateNodes(t,e){const{highlightSelection:i,datumSelection:s}=this,n=!this.ctx.animationManager.isSkipped(),a=this.visible&&null!=this._contextNodeData;this.contentGroup.visible=n||a,this.highlightGroup.visible=(n||a)&&t,this.updateDatumStyles({datumSelection:i,isHighlight:!0});const o=this.ctx.chartService.highlight?.drawingMode??"overlay";this.updateDatumNodes({datumSelection:i,isHighlight:!0,drawingMode:o}),this.animationState.transition("highlight",i);const{dataNodeGroup:r,labelSelection:l,paths:c,labelGroup:h}=this,{itemId:d}=this.contextNodeData??{};if(this.updatePathNodes({itemId:d,paths:c,visible:a,animationEnabled:n}),r.visible=n||a,h.visible=a,!r.visible)return;this.hasItemStylers()&&this.updateDatumStyles({datumSelection:s,isHighlight:!1});const u=this.strokewidthChange()||this.hasChangesOnHighlight;(e||u)&&(this.updateDatumNodes({datumSelection:s,isHighlight:!1,drawingMode:"overlay"}),this.usesPlacedLabels||this.labelGroup.batchedUpdate(()=>{this.updateLabelNodes({labelSelection:l,isHighlight:!1})}))}getHighlightData(t,e){return e?[{...e}]:void 0}updateHighlightSelection(){const{highlightSelection:t,_contextNodeData:e}=this;if(!e)return!1;const i=this.ctx.highlightManager?.getActiveHighlight(),s=this.isSeriesHighlighted(i)&&i?.datum?i:void 0;if(null==s)return!1;const{nodeData:n}=e,a=this.getHighlightData(n,s);return this.highlightSelection=this.updateHighlightSelectionItem({items:a,highlightSelection:t}),!0}markQuadtreeDirty(){this.quadtree=void 0}*datumNodesIter(){for(const{node:t}of this.datumSelection)!0!==t.datum.missing&&(yield t)}getQuadTree(){if(void 0===this.quadtree){const{width:t,height:e}=this.ctx.scene.canvas,i=new fs(0,0,t,e);this.quadtree=new TI(100,10,i),this.initQuadTree(this.quadtree)}return this.quadtree}initQuadTree(t){}pickNodeDataExactShape(t){const{x:e,y:i}=t,{dataNodeGroup:s}=this,n=s.pickNodes(e,i).filter(t=>!0!==t.datum.missing);if(0!==n.length)return n.map(t=>t.datum)}pickModulesExactShape(t){for(const e of this.moduleMap.modules()){const{datum:i}=e.pickNodeExact(t)??{};if(null!=i&&!0!==i?.missing)return[i]}}pickNodesExactShape(t){const e=super.pickNodesExactShape(t);return 0!==e.length?e:this.pickNodeDataExactShape(t)??this.pickModulesExactShape(t)??[]}pickNodeDataClosestDatum(t){const{x:e,y:i}=t,{axes:s,_contextNodeData:n}=this;if(!n)return;const a=s.x,o=s.y,r=e,l=i;let c,h=1/0;for(const t of n.nodeData){const{point:{x:e=Number.NaN,y:i=Number.NaN}={}}=t;if(Number.isNaN(e)||Number.isNaN(i))continue;if(!a?.inRange(e)||!o?.inRange(i))continue;const s=Math.max((r-e)**2+(l-i)**2,0);s<h&&(h=s,c=t)}return null!=h?{datum:c,distance:Math.sqrt(h)}:void 0}pickModulesClosestDatum(t){let e,i=1/0;for(const s of this.moduleMap.modules()){const n=s.pickNodeNearest(t);void 0!==n&&n.distanceSquared<i&&(i=n.distanceSquared,e=n.datum)}if(null!=i)return{datum:e,distance:Math.sqrt(i)}}pickNodeClosestDatum(t){let e,i=1/0;const s=this.pickNodeDataClosestDatum(t);null!=s&&s.distance<i&&(i=s.distance,e=s.datum);const n=this.pickModulesClosestDatum(t);if(null!=n&&n.distance<i&&(i=n.distance,e=n.datum),e)return{datum:e,distance:Math.max(i-(e.point?.size??0)/2,0)}}pickNodeMainAxisFirst(t,e){const{x:i,y:s}=t,{axes:n,_contextNodeData:a}=this,{pickOutsideVisibleMinorAxis:o}=this.properties;if(!a)return;const r=n.x,l=n.y;if(null==r||null==l)return;const c=[r,l].filter(t=>t.isCategoryLike()).map(t=>t.direction);if(e&&0===c.length)return;const[h="x"]=c,d=[i,s];"x"!==h&&d.reverse();const u=[1/0,1/0];let p;for(const t of a.nodeData){const{x:e=Number.NaN,y:i=Number.NaN}=t.point??t.midPoint??{};if(Number.isNaN(e)||Number.isNaN(i)||!0===t.missing)continue;const s=[r?.inRange(e,1),l?.inRange(i,1)];if("x"!==h&&s.reverse(),!s[0]||!o&&!s[1])continue;const n=[e,i];"x"!==h&&n.reverse();let a=!0;for(let t=0;t<n.length;t++){const e=Math.abs(n[t]-d[t]);if(e>u[t]){a=!1;break}e<u[t]&&(u[t]=e,u.fill(1/0,t+1,u.length))}a&&(p=t)}if(p){let e=Math.max(u[0]**2+u[1]**2-(p.point?.size??0),0);for(const i of this.moduleMap.modules()){const s=i.pickNodeMainAxisFirst(t,h);if(void 0!==s&&s.distanceSquared<e){p=s.datum,e=s.distanceSquared;break}}return{datum:p,distance:Math.sqrt(e)}}}isPathOrSelectionDirty(){return!1}shouldFlipXY(){return!1}visibleRangeIndices(t,e,i,s){let n;if(null==s){const{processedData:e,dataModel:i}=this;n=i.getColumnSortOrder(this,t,e)??1}else n=s.sortOrder;const a=this.keysOrValues(t),[o,r]=kc(n,i?.length??a.length,e,t=>{const e=i?.[t]??t;return this.xCoordinateRange(a[e],0,e)});return o<r?[o,r]:[r,o]}domainForVisibleRange(t,e,i,s,n){const{processedData:a,dataModel:o}=this,[r,l]=s,c=this.keysOrValues(i),h=this.sortOrder(i);if(null!=h){const t=this.visibleRangeIndices(i,s,n,{sortOrder:h});return o.getDomainBetweenRange(this,e,t,a)}const d=e.map(t=>this.keysOrValues(t));let u=1/0,p=-1/0;for(const[t,i]of c.entries()){const[s,n]=this.xCoordinateRange(i,0,t);if(!(n<r||s>l))for(let i=0;i<e.length;i++){const e=d[i][t];u=Math.min(u,e),p=Math.max(p,e)}}return u>p?[Number.NaN,Number.NaN]:[u,p]}domainForClippedRange(t,e,i){const{processedData:s,dataModel:n,axes:a}=this,o=function(t){let e,i;if((t instanceof mb||t instanceof xb)&&({min:e,max:i}=t),null!=e||null!=i)return e??(e=-1/0),i??(i=1/0),[e,i]}(a["x"===t?"y":"x"]);if(!o)return e.flatMap(t=>n.getDomain(this,t,"value",s));const r=this.keysOrValues(i),l=n.getColumnSortOrder(this,i,s);if(null!=l){const t=function(t,e,i,s){const n=i[0].valueOf(),a=i[1].valueOf();let o=bi(0,e-1,i=>{const a=1===t?i:e-i,o=s(a)?.valueOf();return!Number.isFinite(o)||o>=n}),r=xi(0,e-1,i=>{const n=1===t?i:e-i,o=s(n)?.valueOf();return!Number.isFinite(o)||o<=a});return null==o||null==r?[0,0]:(-1===t&&([o,r]=[e-r,e-o]),o=Math.max(o,0),r=Math.min(r+1,e),[o,r])}(l,r.length,o,t=>r[t]);return n.getDomainBetweenRange(this,e,t,s)}const c=e.map(t=>this.keysOrValues(t)),h=o[0].valueOf(),d=o[1].valueOf(),u=[];for(const[t,e]of r.entries()){const i=e.valueOf();if(i<h||i>d)continue;const s=c.map(e=>e[t]);i>=h&&u.push(...s),i<=d&&u.push(...s)}return u}zoomFittingVisibleItems(t,e,i,s,n){const{dataModel:a,processedData:o}=this;if(!a||!o)return;const r=this.axes.x;if(null!=s)return;const l=this.sortOrder(t);if(null==l)return;const c=this.keysOrValues(t);if(n>c.length)return{x:[0,1],y:void 0};const h=r.scale,d=h.range;h.range=[0,1];let u,[p,g]=this.visibleRangeIndices(t,i,void 0,{sortOrder:l});if(g-=1,this.xCoordinateRange(c[p],0,p)[0]<i[0]&&(p+=1),this.xCoordinateRange(c[g],0,g)[1]>i[1]&&(g-=1),Math.abs(g-p)>=n-1)u=i;else{const t=(i[0]+i[1])/2;for(;Math.abs(g-p)<n-1&&(p>0||g<c.length-1);)if(0===p)g+=1;else if(g===c.length-1)p-=1;else{const e=this.xCoordinateRange(c[p-1],0,p-1)[0],i=this.xCoordinateRange(c[g+1],0,g+1)[1];Math.abs(e-t)<Math.abs(i-t)?p-=1:g+=1}const e=this.xCoordinateRange(c[p],0,p)[0],s=this.xCoordinateRange(c[g],0,g)[1];u=[Math.min(i[0],e),Math.max(i[1],s)]}return h.range=d,{x:u,y:void 0}}countVisibleItems(t,e,i,s,n){const{dataModel:a,processedData:o}=this;if(!a||!o)return 1/0;const r=this.keysOrValues(t),l=e.map(t=>a.resolveColumnById(this,t,o)),c=this.shouldFlipXY(),h=c?this.axes.y:this.axes.x,d=c?this.axes.x:this.axes.y,u=c?s??[0,1]:i,p=c?i:s??[0,1];if(null==s){const e=this.sortOrder(t);if(null!=e){const i=h.scale,s=i.range;i.range=[0,1];const n=this.keysOrValues(t);let[a,o]=this.visibleRangeIndices(t,u,void 0,{sortOrder:e});o-=1;const r=0;this.xCoordinateRange(n[a],r,a)[0]<u[0]&&(a+=1),this.xCoordinateRange(n[o],r,o)[1]>u[1]&&(o-=1);const l=Math.abs(o-a)+1;return i.range=s,l}}const g=(t,e,i)=>t[0]+(i-e[0])/(e[1]-e[0])*(t[1]-t[0]),m=h.range.toSorted(),f=d.range.toSorted(),y=g(m,h.visibleRange,u[0]),x=g(m,h.visibleRange,u[1]),b=g(f,d.visibleRange,Math.min(...p)),v=g(f,d.visibleRange,Math.max(...p)),M=Math.round((u[0]+(u[1]-u[0])/2)*r.length);return wc(0,r.length-1,M,n,t=>{const[e,i]=this.xCoordinateRange(r[t],0,t),[s,n]=this.yCoordinateRange(l.map(e=>e[t]),0,t);return!!(Q(e)&&Q(i)&&Q(s)&&Q(n))&&e>=y&&i<=x&&s>=b&&n<=v})}minTimeInterval(){let t;try{t=this.keysOrValues("xValue")}catch{}if(null==t||t.length>1e3)return;let e,i=1/0,s=t[0];for(let n=1;n<t.length;n++){const a=t[n];if(null!=a&&null!=s){const t=a.valueOf()-s.valueOf(),n=Math.sign(t);if(0===n)continue;if(void 0!==e&&n!==e)return;i=Math.min(i,Math.abs(t)),e=n}s=a}return Number.isFinite(i)?i:void 0}updateHighlightSelectionItem(t){const{items:e,highlightSelection:i}=t,s=e??[];return this.updateDatumSelection({nodeData:s,datumSelection:i})}updateDatumSelection(t){return t.datumSelection}updateDatumNodes(t){}updateDatumStyles(t){}updatePaths(t){for(const e of t.paths)e.visible=!1}updatePathNodes(t){const{paths:e,visible:i}=t;for(const t of e)t.visible=i}resetPathAnimation(t){const{path:e}=this.opts?.animationResetFns??{};if(e)for(const i of t.paths)pd([i],e)}resetDatumAnimation(t){const{datum:e}=this.opts?.animationResetFns??{};e&&pd([t.datumSelection],e)}resetLabelAnimation(t){const{label:e}=this.opts?.animationResetFns??{};e&&pd([t.labelSelection],e)}resetAllAnimation(t){this.ctx.animationManager.stopByAnimationGroupId(this.id),this.resetPathAnimation(t),this.resetDatumAnimation(t),this.resetLabelAnimation(t),!1===t.contextData?.animationValid&&this.ctx.animationManager.skipCurrentBatch()}animateEmptyUpdateReady(t){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(t)}animateWaitingUpdateReady(t){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(t)}animateReadyHighlight(t){const{datum:e}=this.opts?.animationResetFns??{};e&&pd([t],e)}animateReadyResize(t){this.resetAllAnimation(t)}animateClearingUpdateEmpty(t){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(t)}getAnimationData(t,e){const{_contextNodeData:i}=this;if(i)return{datumSelection:this.datumSelection,labelSelection:this.labelSelection,annotationSelections:[...this.annotationSelections],contextData:i,previousContextData:e,paths:this.paths,seriesRect:t}}updateLabelSelection(t){return t.labelSelection}getScaling(t){if(t instanceof pb){const{range:e,domain:i}=t;return{type:"log",convert:e=>t.convert(e),domain:[i[0],i[1]],range:[e[0],e[1]]}}if(t instanceof $c){const{range:e,domain:i}=t;return{type:"continuous",domain:[i[0],i[1]],range:[e[0],e[1]]}}if(t instanceof Wc)return{type:"category",domain:t instanceof xp?t.bands:t.domain,inset:t.inset,step:t.step}}calculateScaling(){const t={};for(const e of Object.values(nr)){const i=this.axes[e];if(!i)continue;const s=this.getScaling(i.scale);null!=s&&(t[e]=s)}return t}},$I=class extends Pn{constructor(){super(...arguments),this.type="linear",this.tension=1,this.position="end"}};ls([ws],$I.prototype,"type",2),ls([ws],$I.prototype,"tension",2),ls([ws],$I.prototype,"position",2);var HI=class extends FI{constructor(){super(...arguments),this.xName=void 0,this.fill="#c16068",this.fillOpacity=1,this.stroke="#874349",this.strokeWidth=2,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.interpolation=new $I,this.shadow=new II,this.marker=new DI,this.label=new kd,this.tooltip=wI(),this.connectMissingData=!1}};function UI(t){switch(t.type){case"linear":case"step":case"multi-line":return[{x:t.x0,y:t.y0},{x:t.x1,y:t.y1}];case"cubic":return[{x:t.cp0x,y:t.cp0y},{x:t.cp3x,y:t.cp3y}]}}function WI(t,e){const{x:i,y:s}=e;switch(t.type){case"linear":return{type:"linear",moveTo:t.moveTo,x0:i,y0:s,x1:i,y1:s};case"step":return{type:"step",moveTo:t.moveTo,x0:i,y0:s,x1:i,y1:s,stepX:i};case"cubic":return{type:"cubic",moveTo:t.moveTo,cp0x:i,cp0y:s,cp1x:i,cp1y:s,cp2x:i,cp2y:s,cp3x:i,cp3y:s};case"multi-line":return{type:"multi-line",moveTo:t.moveTo,x0:i,y0:s,x1:i,y1:s,midPoints:t.midPoints.map(()=>({x:i,y:s}))}}}function _I(t,e,i){const[s,n]=UI(t),a=n.x===s.x?0:(i.x-e.x)/(n.x-s.x),o=n.y===s.y?0:(i.y-e.y)/(n.y-s.y);switch(t.type){case"linear":return{type:"linear",moveTo:t.moveTo,x0:e.x,y0:e.y,x1:i.x,y1:i.y};case"cubic":return{type:"cubic",moveTo:t.moveTo,cp0x:e.x,cp0y:e.y,cp1x:i.x-(t.cp2x-s.x)*a,cp1y:i.y-(t.cp2y-s.y)*o,cp2x:i.x-(t.cp1x-s.x)*a,cp2y:i.y-(t.cp1y-s.y)*o,cp3x:i.x,cp3y:i.y};case"step":return{type:"step",moveTo:t.moveTo,x0:e.x,y0:e.y,x1:i.x,y1:i.y,stepX:i.x-(t.stepX-s.x)*a};case"multi-line":return{type:"multi-line",moveTo:t.moveTo,x0:e.x,y0:e.y,x1:i.x,y1:i.y,midPoints:t.midPoints.map(t=>({x:e.x+(t.x-s.x)*a,y:e.y+(t.y-s.y)*o}))}}}function YI(t,e,i){const{moveTo:s}=t,[n,a]=function(t){const e=UI(t);return e[0].x>e[1].x&&e.reverse(),e}(t),{x:o,y:r}=n,{x:l,y:c}=a;if(i<o)return _I(t,n,n);if(e>l)return _I(t,a,a);switch(t.type){case"linear":{const t=r===c?void 0:(c-r)/(l-o);return{type:"linear",moveTo:s,x0:e,y0:null==t?r:t*(e-o)+r,x1:i,y1:null==t?r:t*(i-o)+r}}case"step":if(i<=t.stepX){const n=t.y0;return{type:"step",moveTo:s,x0:e,y0:n,x1:i,y1:n,stepX:i}}if(e>=t.stepX){const n=t.y1;return{type:"step",moveTo:s,x0:e,y0:n,x1:i,y1:n,stepX:e}}{const{y0:n,y1:a,stepX:o}=t;return{type:"step",moveTo:s,x0:e,y0:n,x1:i,y1:a,stepX:o}}case"cubic":{const n=ta(t.cp0x,t.cp1x,t.cp2x,t.cp3x,e);let[a,o]=ea(t.cp0x,t.cp0y,t.cp1x,t.cp1y,t.cp2x,t.cp2y,t.cp3x,t.cp3y,n);const r=ta(o[0].x,o[1].x,o[2].x,o[3].x,i);return[o,a]=ea(o[0].x,o[0].y,o[1].x,o[1].y,o[2].x,o[2].y,o[3].x,o[3].y,r),{type:"cubic",moveTo:s,cp0x:o[0].x,cp0y:o[0].y,cp1x:o[1].x,cp1y:o[1].y,cp2x:o[2].x,cp2y:o[2].y,cp3x:o[3].x,cp3y:o[3].y}}case"multi-line":{const{midPoints:n}=t,a=n.findLastIndex(t=>t.x<=e);let h=n.findIndex(t=>t.x>=i);-1===h&&(h=n.length);const d=a>=0?n[a]:void 0,u=d?.x??o,p=d?.y??r,g=h<n.length?n[h]:void 0,m=g?.x??l,f=g?.y??c,y=p===f?void 0:(f-p)/(m-u);return{type:"multi-line",moveTo:s,x0:e,y0:null==y?p:y*(u-o)+p,x1:i,y1:null==y?p:y*(m-o)+p,midPoints:n.slice(Math.max(a,0),h)}}}}ls([ws],HI.prototype,"xKey",2),ls([ws],HI.prototype,"xName",2),ls([ws],HI.prototype,"yKey",2),ls([ws],HI.prototype,"yName",2),ls([ws],HI.prototype,"yFilterKey",2),ls([ws],HI.prototype,"normalizedTo",2),ls([ws],HI.prototype,"fill",2),ls([ws],HI.prototype,"fillOpacity",2),ls([ws],HI.prototype,"stroke",2),ls([ws],HI.prototype,"strokeWidth",2),ls([ws],HI.prototype,"strokeOpacity",2),ls([ws],HI.prototype,"lineDash",2),ls([ws],HI.prototype,"lineDashOffset",2),ls([ws],HI.prototype,"interpolation",2),ls([ws],HI.prototype,"styler",2),ls([ws],HI.prototype,"shadow",2),ls([ws],HI.prototype,"marker",2),ls([ws],HI.prototype,"label",2),ls([ws],HI.prototype,"tooltip",2),ls([ws],HI.prototype,"connectMissingData",2);var KI=(t=>(t[t.MoveTo=0]="MoveTo",t[t.LineTo=1]="LineTo",t[t.Skip=2]="Skip",t))(KI||{});function ZI(t){const e=[];let i=0,s=Number.NaN,n=Number.NaN;for(const{x:a,y:o}of t){if(i>0){const t=1===i;e.push({type:"linear",moveTo:t,x0:s,y0:n,x1:a,y1:o})}i+=1,s=a,n=o}return e}var XI={start:0,middle:.5,end:1};function QI(t,e){const i=[];let s=0,n=Number.NaN,a=Number.NaN;const o="number"==typeof e?e:XI[e];for(const{x:e,y:r}of t){if(s>0){const t=1===s,l=n+(e-n)*o;i.push({type:"step",moveTo:t,x0:n,y0:a,x1:e,y1:r,stepX:l})}s+=1,n=e,a=r}return i}var qI=.05;function JI(t,e){const i=Array.isArray(t)?t:Array.from(t);if(i.length<=1)return[];const s=i.map((t,e)=>{const s=0===e?t:i[e-1],n=e===i.length-1?t:i[e+1],a=0===e||e===i.length-1;if(Math.sign(s.y-t.y)===Math.sign(n.y-t.y))return 0;if(!a){const e=Math.abs(s.y-n.y),i=Math.abs(t.y-s.y)/e,a=Math.abs(t.y-n.y)/e;if(i<=qI||1-i<=qI||a<=qI||1-a<=qI)return 0}return(n.y-s.y)/(n.x-s.x)});0===s[1]&&(s[0]*=2),0===s.at(-2)&&(s[s.length-1]*=2);const n=[];for(let t=1;t<i.length;t+=1){const a=i[t-1],o=s[t-1],r=i[t],l=s[t],c=r.x-a.x,h=r.y-a.y;let d=c*e/3,u=c*o*e/3,p=c*e/3,g=c*l*e/3;0===l&&Math.abs(u)>Math.abs(h)&&(d*=Math.abs(h/u),u=Math.sign(u)*Math.abs(h)),0===o&&Math.abs(g)>Math.abs(h)&&(p*=Math.abs(h/g),g=Math.sign(g)*Math.abs(h)),n.push({type:"cubic",moveTo:1===t,cp0x:a.x,cp0y:a.y,cp1x:a.x+d,cp1y:a.y+u,cp2x:r.x-p,cp2y:r.y-g,cp3x:r.x,cp3y:r.y})}return n}function tD(t,e,i){return(e-t)*i+t}function eD(t,e){const{x0:i,y0:s,x1:n,y1:a}=t,o=(a-s)/(n-i)*(e-i)+s;return{leftCp1x:i,leftCp1y:s,leftCp2x:e,leftCp2y:o,stepX:e,stepY0:o,stepY1:o,rightCp1x:e,rightCp1y:o,rightCp2x:n,rightCp2y:a}}function iD(t,e){return"linear"===t.type?eD(t,e):"cubic"===t.type?function(t,e){const{cp0x:i,cp0y:s,cp1x:n,cp1y:a,cp2x:o,cp2y:r,cp3x:l,cp3y:c}=t,h=ta(i,n,o,l,e),[d,u]=ea(i,s,n,a,o,r,l,c,h),p=d[3].y;return{leftCp1x:d[1].x,leftCp1y:d[1].y,leftCp2x:d[2].x,leftCp2y:d[2].y,stepX:e,stepY0:p,stepY1:p,rightCp1x:u[1].x,rightCp1y:u[1].y,rightCp2x:u[2].x,rightCp2y:u[2].y}}(t,e):"step"===t.type?function(t){const{x0:e,y0:i,x1:s,y1:n,stepX:a}=t;return{leftCp1x:(e+a)/2,leftCp1y:i,leftCp2x:(e+a)/2,leftCp2y:i,stepX:a,stepY0:i,stepY1:n,rightCp1x:(a+s)/2,rightCp1y:n,rightCp2x:(a+s)/2,rightCp2y:n}}(t):eD(t,e)}function sD(t,e,i,s,n,a,o){switch(e){case 0:o?t.moveTo(n,a):t.moveTo(i,s);break;case 1:o?t.lineTo(n,a):t.lineTo(i,s)}}function nD(t,e,i,s,n,a){a?t.lineTo(e,i):t.lineTo(s,n)}function aD(t,e,i,s,n,a,o,r,l,c){c?t.cubicCurveTo(a,o,s,n,e,i):t.cubicCurveTo(s,n,a,o,r,l)}function oD(t,e,i,s,n,a,o){o?(t.lineTo(a,n),t.lineTo(a,i),t.lineTo(e,i)):(t.lineTo(a,i),t.lineTo(a,n),t.lineTo(s,n))}function rD(t,e,i,s){const[n,a]=UI(e);switch(sD(t,i,n.x,n.y,a.x,a.y,s),e.type){case"linear":nD(t,e.x0,e.y0,e.x1,e.y1,s);break;case"cubic":aD(t,e.cp0x,e.cp0y,e.cp1x,e.cp1y,e.cp2x,e.cp2y,e.cp3x,e.cp3y,s);break;case"step":oD(t,e.x0,e.y0,e.x1,e.y1,e.stepX,s);break;case"multi-line":!function(t,e,i,s,n,a,o){if(o){for(let e=a.length-1;e>=0;e--){const{x:i,y:s}=a[e];t.lineTo(i,s)}t.lineTo(e,i)}else{for(const{x:e,y:i}of a)t.lineTo(e,i);t.lineTo(s,n)}}(t,e.x0,e.y0,e.x1,e.y1,e.midPoints,s)}}function lD(t,e,i){const[s,n]=UI(t),[a,o]=UI(e);return[{x:tD(s.x,a.x,i),y:tD(s.y,a.y,i)},{x:tD(n.x,o.x,i),y:tD(n.y,o.y,i)}]}function cD(t,e,i,s,n,a){const[{x:o,y:r},{x:l,y:c}]=lD(e,i,s);if(sD(t,n,o,r,l,c,a),"cubic"===e.type&&"cubic"===i.type)aD(t,o,r,tD(e.cp1x,i.cp1x,s),tD(e.cp1y,i.cp1y,s),tD(e.cp2x,i.cp2x,s),tD(e.cp2y,i.cp2y,s),l,c,a);else if("step"===e.type&&"step"===i.type)oD(t,o,r,l,c,tD(e.stepX,i.stepX,s),a);else if("linear"===e.type&&"linear"===i.type)nD(t,o,r,l,c,a);else{let n;n="step"===e.type?e.stepX:"step"===i.type?i.stepX:(o+l)/2;const h=iD(e,n),d=iD(i,n),u=tD(h.leftCp1x,d.leftCp1x,s),p=tD(h.leftCp1y,d.leftCp1y,s),g=tD(h.leftCp2x,d.leftCp2x,s),m=tD(h.leftCp2y,d.leftCp2y,s),f=tD(h.stepX,d.stepX,s),y=tD(h.stepY0,d.stepY0,s),x=tD(h.stepY1,d.stepY1,s),b=tD(h.rightCp1x,d.rightCp1x,s),v=tD(h.rightCp1y,d.rightCp1y,s),M=tD(h.rightCp2x,d.rightCp2x,s),S=tD(h.rightCp2y,d.rightCp2y,s);a?(t.cubicCurveTo(M,S,b,v,f,x),t.lineTo(f,y),t.cubicCurveTo(g,m,u,p,o,r)):(t.cubicCurveTo(u,p,g,m,f,y),t.lineTo(f,x),t.cubicCurveTo(b,v,M,S,l,c))}}var hD=(t=>(t[t.Zero=0]="Zero",t[t.Split=1]="Split",t))(hD||{});function dD(t){return Ld(t).valueOf()}function uD(t,e){if(!e)return Number.NaN;if(t instanceof Date&&(t=t.getTime()),"continuous"===e.type&&"number"==typeof t)return(t-e.domain[0])/(e.domain[1]-e.domain[0])*(e.range[1]-e.range[0])+e.range[0];if("log"===e.type&&"number"==typeof t)return e.convert(t);if("category"!==e.type)return Number.NaN;const i=dD(t);let s=e.domain.findIndex(t=>dD(t)===i);return-1===s&&(s=e.domain.findIndex(e=>{return s=e,null!=(i=t)&&null!=s&&"object"==typeof i&&"object"==typeof s&&("id"in i&&"id"in s?i.id===s.id:i.toString()===s.toString());var i,s})),s>=0?e.inset+e.step*s:Number.NaN}function pD({data:t},e){return t.map((t,i)=>({xValue0Index:e.indexOf(dD(t.xValue0)),xValue1Index:e.indexOf(dD(t.xValue1)),datumIndex:i}))}function gD(t){return Object.values(t.scales).every(t=>"category"!==t.type||t.domain.length<1e3)}function mD(t,e,i,s,n){if(n.xValue1Index===n.xValue0Index+1)return t;const a=UI(t);let o,r;if("category"===e.scales.x?.type){const t=(a[1].x-a[0].x)/(n.xValue1Index-n.xValue0Index);o=a[0].x+(s-n.xValue0Index)*t,r=o+t}else{const t=i[s],n=i[s+1];o=uD(t,e.scales.x),r=uD(n,e.scales.x)}return YI(t,o,r)}function fD(t,e){const[i,s]=UI(t),n=uD(0,e.scales.y);return _I(t,{x:i.x,y:n},{x:s.x,y:n})}function yD(t){const[e,i]=UI(t);return WI(t,{x:(e.x+i.x)/2,y:(e.y+i.y)/2})}function xD(t,e,i,s,n,a){let o,r;if(n.xValue0Index>=a.xValue1Index){const t=s.findLast(t=>t.xValue1Index<=a.xValue1Index)?.datumIndex,e=null==t?void 0:i.data[t];o=e?.xValue1,r=e?.yValue1}else if(n.xValue0Index<=a.xValue0Index){const t=s.find(t=>t.xValue0Index>=a.xValue0Index)?.datumIndex,e=null==t?void 0:i.data[t];o=e?.xValue0,r=e?.yValue0}if(null==o||null==r)switch(e){case 0:return fD(t,i);case 1:return yD(t)}const l={x:uD(o,i.scales.x),y:uD(r,i.scales.y)};return _I(t,l,l)}function bD(t,e){if(null==e)return;const i=dD(t.xValue0),s=dD(t.xValue1);return e.find(t=>dD(t.xValue0)===i&&dD(t.xValue1)===s)?.span}function vD(t,e,i,s,n,a,o){const r=t.data[s.datumIndex],l=r.span,c=bD(r,n);if(null==c){const n=xD(l,e,t,i,s,a);o.added.push({from:n,to:l})}else o.removed.push({from:c,to:c}),o.moved.push({from:c,to:l}),o.added.push({from:l,to:l})}function MD(t,e,i,s,n,a,o){const r=t.data[s.datumIndex],l=r.span,c=bD(r,n);if(null==c){const n=xD(l,e,t,i,s,a);o.removed.push({from:l,to:n})}else o.removed.push({from:l,to:l}),o.moved.push({from:l,to:c}),o.added.push({from:c,to:c})}function SD(t,e,i,s,n){const a=s.scales.x,o=e[n.xValue0Index],r=e[n.xValue1Index];let l,c;if("continuous"===a?.type||"log"===a?.type?(l=i.data.findLast(t=>dD(t.xValue0)<=o),c=i.data.find(t=>dD(t.xValue1)>=r)):(l=i.data.find(t=>dD(t.xValue0)===o),c=i.data.find(t=>dD(t.xValue1)===r)),null==l||null==c)return;const[{x:h},{x:d}]=UI(t),u=uD(l.xValue0,i.scales.x),p=uD(l.yValue0,i.scales.y),g=uD(c.xValue1,i.scales.x),m=uD(c.yValue1,i.scales.y);let f=s.data[n.datumIndex].span;return f=_I(f,{x:u,y:p},{x:g,y:m}),f=YI(f,h,d),f}function ID(t,e,i,s,n,a,o,r,l){const c=n+1,h=o.find(t=>t.xValue0Index<=n&&t.xValue1Index>=c),d=a.find(t=>t.xValue0Index<=n&&t.xValue1Index>=c),u=e.zeroData,p=t.zeroData;if(null==h&&null!=d)return void vD(t,i,a,d,u,r,l);if(null!=h&&null==d)return void MD(e,i,o,h,p,r,l);if(null==h||null==d)return;let g;g=h.xValue0Index===d.xValue0Index&&h.xValue1Index===d.xValue1Index?0:h.xValue0Index<=d.xValue0Index&&h.xValue1Index>=d.xValue1Index?-1:h.xValue0Index>=d.xValue0Index&&h.xValue1Index<=d.xValue1Index?1:0;const m=mD(e.data[h.datumIndex].span,e,s,n,h),f=mD(t.data[d.datumIndex].span,t,s,n,d);if(1===g){const n=SD(m,s,e,t,d);null==n?MD(e,i,o,h,p,r,l):(l.removed.push({from:m,to:n}),l.moved.push({from:n,to:f}),l.added.push({from:f,to:f}))}else if(-1===g){const n=SD(f,s,t,e,h);null==n?vD(t,i,a,d,u,r,l):(l.removed.push({from:m,to:m}),l.moved.push({from:m,to:n}),l.added.push({from:n,to:f}))}else l.removed.push({from:m,to:m}),l.moved.push({from:m,to:f}),l.added.push({from:f,to:f})}function DD(t,e,i){const{span:s}=e;switch(i){case 0:return bD(e,t.zeroData)??fD(s,t);case 1:return yD(s)}}function kD(t,e,i){if(!gD(t)||!gD(e))return;if(!function(t,e){const i=e.scales.x,s=t.scales.x;if("category"!==i?.type||"category"!==s?.type)return!0;let n=-1/0;for(const t of i.domain){const e=uD(t,s);if(Number.isFinite(e)){if(e<n)return!1;n=e}}return!0}(t,e))return;const s=function(t,e){const i=new Map;for(const{xValue0:e,xValue1:s}of t.data){const t=dD(e),n=dD(s);i.set(t,e).set(n,s)}const s=Array.from(i,([t,e])=>({axisValue:t,value:e}));s.sort((e,i)=>uD(e.value,t.scales.x)-uD(i.value,t.scales.x));const n=[];for(const{xValue0:t,xValue1:s}of e.data){const e=dD(t),a=dD(s);i.has(e)||(i.set(e,t),n.push({axisValue:e,value:t})),i.has(a)||(i.set(a,s),n.push({axisValue:a,value:s}))}n.sort((t,i)=>uD(t.value,e.scales.x)-uD(i.value,e.scales.x));const a=s;let o=0;for(const t of n){for(let i=a.length-1;i>=o;i-=1)if(uD(t.value,e.scales.x)>uD(a[i].value,e.scales.x)){o=i+1;break}a.splice(o,0,t),o+=1}if(!function(t,e){let i=-1/0;for(const s of t){const t=uD(s.value,e.scales.x);if(Number.isFinite(t)){if(t<i)return!1;i=t}}return!0}(a,e))return;const r=a.map(t=>t.axisValue);return{axisValues:r,oldDataAxisIndices:pD(e,r),newDataAxisIndices:pD(t,r)}}(t,e);return null==s?function(t,e,i){const s=[],n=[];for(const t of e.data){const s=t.span,a=DD(e,t,i);n.push({from:s,to:a})}for(const e of t.data){const n=e.span,a=DD(t,e,i);s.push({from:a,to:n})}return{removed:n,moved:[],added:s}}(t,e,i):s.axisValues.length===s.oldDataAxisIndices.length+s.newDataAxisIndices.length+2?function(t,e){const i=[],s=[],n=[];for(let a=0;a<e.data.length;a+=1){const o=e.data[a].span,r=t.data[a].span;i.push({from:o,to:o}),s.push({from:o,to:r}),n.push({from:r,to:r})}return{removed:i,moved:s,added:n}}(t,e):function(t,e,i,s){const n={removed:[],moved:[],added:[]},{axisValues:a,oldDataAxisIndices:o,newDataAxisIndices:r}=t,l={xValue0Index:Math.max(o.at(0)?.xValue0Index??-1/0,r.at(0)?.xValue0Index??-1/0),xValue1Index:Math.min(o.at(-1)?.xValue1Index??1/0,r.at(-1)?.xValue1Index??1/0)};for(let t=0;t<a.length-1;t+=1)ID(e,i,s,a,t,r,o,l,n);return n}(s,t,e,i)}function AD(t){return"continuous"===t.type||"log"===t.type}function wD(t){return"category"===t.type}function CD(t,e){return void 0===t||void 0===e?void 0!==t||void 0!==e:AD(t)&&AD(e)?t.type===e.type&&Je(t.domain,e.domain)&&Je(t.range,e.range):!(!wD(t)||!wD(e))&&t.inset===e.inset&&t.step===e.step&&Je(t.domain,e.domain)}function ND(t){return null!=t&&("category"===t.type?t.domain.every(t=>null!=t):t.domain.every(t=>Number.isFinite(t)||t instanceof Date)&&t.range.every(t=>Number.isFinite(t)))}function LD(t,e){let i;const s=t.map(t=>t.point);switch(e.type){case"linear":i=ZI(s);break;case"smooth":i=JI(s,e.tension);break;case"step":i=QI(s,e.position)}return i.map((e,i)=>({span:e,xValue0:t[i].xDatum,yValue0:t[i].yDatum,xValue1:t[i+1].xDatum,yValue1:t[i+1].yDatum}))}function TD(t,e,i=.001){return Math.abs(t.x-e.x)<i&&Math.abs(t.y-e.y)<i}function ED({path:t},e){let i;for(const{span:s}of e){const[e,n]=UI(s);rD(t,s,null!=i&&TD(i,e)?2:0,!1),i=n}}function OD(t,e,i){let s;for(const n of i){const[i,a]=lD(n.from,n.to,t),o=null!=s&&TD(s,i)?2:0;cD(e.path,n.from,n.to,t,o,!1),s=a}}function RD(t,e,i){return{status:t,path:{addPhaseFn:(t,i)=>OD(t,i,e.added),updatePhaseFn:(t,i)=>OD(t,i,e.moved),removePhaseFn:(t,i)=>OD(t,i,e.removed)},pathProperties:PD(t,i)}}function PD(t,e){const i="none"===e?"updated":t,s={fromFn(e,s){const n={phase:ld[i]},a=e.previousDatum??s;return null!=a&&(n.segments=a),"removed"===t?n.finish={visible:!1}:"added"===t&&(n.start={visible:!0}),n},toFn(t,e){const s={phase:ld[i]},n=e;return null!=n&&(s.segments=n),s}};return"fade"===e?{fromFn(e,i){const n="added"===t?0:e.opacity,a="removed"===t?e.previousDatum??i:i;return{...s.fromFn(e,i),opacity:n,segments:a}},toFn(e,i){const n="removed"===t?0:1,a="removed"===t?e.previousDatum??i:i;return{...s.toFn(e,i),opacity:n,segments:a}}}:s}function zD(t,e,i){if("category"===t.scales.x?.type!=("category"===e.scales.x?.type)||!ND(t.scales.x)||!ND(e.scales.x))return;if(null==t.strokeData||null==e.strokeData)return;let s="updated";e.visible&&!t.visible?s="removed":!e.visible&&t.visible&&(s="added");const n=kD({scales:t.scales,data:t.strokeData.spans},{scales:e.scales,data:e.strokeData.spans},1);return null!=n?{status:s,stroke:RD(s,n,"fade"),hasMotion:(i?.changed??!0)||!CD(t.scales.x,e.scales.x)||!CD(t.scales.y,e.scales.y)||"updated"!==s}:void 0}function jD({path:t},{spans:e,phantomSpans:i}){let s=0,n={x:Number.NaN,y:Number.NaN},a={x:Number.NaN,y:Number.NaN};for(let o=0;o<e.length;o+=1){const{span:r}=e[o],{span:l}=i[o],{0:c,1:h}=UI(r),{0:d,1:u}=UI(l);if(TD(n,c)&&TD(a,d))rD(t,r,2,!1);else{for(let e=o-1;e>=s;e-=1)rD(t,i[e].span,1,!0);t.closePath(),rD(t,r,0,!1),s=o}n=h,a=u}for(let n=e.length-1;n>=s;n-=1)rD(t,i[n].span,1,!0);t.closePath()}function BD(t,{path:e},i,s){for(let n=0;n<i.length;n+=1){const a=i[n],o=s[n];cD(e,a.from,a.to,t,0,!1),cD(e,o.from,o.to,t,1,!0),e.closePath()}}function FD(t,e,i,s){return{status:t,path:{addPhaseFn:(t,s)=>BD(t,s,e.added,i.added),updatePhaseFn:(t,s)=>BD(t,s,e.moved,i.moved),removePhaseFn:(t,s)=>BD(t,s,e.removed,i.removed)},pathProperties:PD(t,s)}}function VD(t,e){if("category"===t.scales.x?.type!=("category"===e.scales.x?.type)||!ND(t.scales.x)||!ND(e.scales.x))return;let i="updated";e.visible&&!t.visible?i="removed":!e.visible&&t.visible&&(i="added");const s=kD({scales:t.scales,data:t.fillData.spans},{scales:e.scales,data:e.fillData.spans},0);if(null==s)return;const n=kD({scales:t.scales,data:t.fillData.phantomSpans},{scales:e.scales,data:e.fillData.phantomSpans},0);if(null==n)return;const a=kD({scales:t.scales,data:t.strokeData.spans,zeroData:t.fillData.phantomSpans},{scales:e.scales,data:e.strokeData.spans,zeroData:e.fillData.phantomSpans},0);if(null==a)return;const o="none";return{status:i,fill:FD(i,s,n,o),stroke:RD(i,a,o)}}function GD({id:t},e,i,...s){hd(t,"markers",e,s,{opacity:0},{opacity:1},{phase:i?ld[i]:"trailing"});for(const t of s)t.cleanup()}function $D({id:t},e,...i){hd(t,"markers",e,i,{scalingX:0,scalingY:0},{scalingX:1,scalingY:1},{phase:"initial"});for(const t of i)t.cleanup()}function HD({id:t,nodeDataDependencies:e},i,...s){const n=e.seriesRectWidth;cd(t,"markers",i,s,{fromFn:(t,e)=>{const i=e.midPoint?.x??n;let s=C(0,_l(i/n),1);return Number.isNaN(s)&&(s=0),{scalingX:0,scalingY:0,delay:s,duration:.2,phase:"initial"}},toFn:()=>({scalingX:1,scalingY:1})})}function UD(t){return{opacity:1,scalingX:1,scalingY:1}}function WD(t,e){return{x:e.point?.x??Number.NaN,y:e.point?.y??Number.NaN,scalingCenterX:e.point?.x??Number.NaN,scalingCenterY:e.point?.y??Number.NaN}}function _D(t,{datumIndex:e}){const i=t.getNodeData();if(void 0===i)return;const s=i[e],{point:n}=s??{};if(null==s||null==n)return;const a=t.getFormattedMarkerStyle(s),o=Ig.anchor(a.shape),r=n.focusSize??a.size,l=4+r,c=l/2,h=(o.x-.5)*r,d=(o.y-.5)*r,u=s.point.x-c-h,p=s.point.y-c-d;return Ta.toCanvas(t.contentGroup,new fs(u,p,l,l))}function YD(t,e,i,s=i){return!!(s.enabled??i.enabled)&&(e.step??Bc(e.range)/Math.max(1,t))>1}function KD(t,e,i,s){return s??(s={stroke:e.stroke,strokeOpacity:e.strokeOpacity,strokeWidth:e.strokeWidth}),hc.reduce((e,n)=>(e[n]=t.getMarkerStyle(i,{},void 0,{highlightState:n},void 0,s),e),{})}function ZD({id:t,visible:e,nodeDataDependencies:i},s,...n){const{seriesRectWidth:a,seriesRectHeight:o}=i;hd(t,"path_properties",s,n,{clipX:0},{clipX:a},{phase:"initial",start:{clip:!0,clipY:o,visible:e},finish:{clip:!1,visible:e}})}function XD({id:t},e,i,s="add",...n){hd(t,e,i,n,{opacity:0},{opacity:1},{phase:s})}function QD(t){return e=>({visible:t.getVisible(),opacity:t.getOpacity(),clipScalingX:1,clip:!1})}function qD({nodeDataDependencies:t},e){const i=t=>Number.isFinite(t)?t:0;e.clipX=i(t.seriesRectWidth),e.clipY=i(t.seriesRectHeight)}function JD(t){return t.isReversed()!==t.range[1]<t.range[0]}function tk(t,e,i,s,n,a=!0){if(0===e.scale.domain.length||0===i.scale.domain.length)return;const o="x"===t.key?e:i,{scale:r,direction:l}=o,c="x"===l,h=r.bandwidth??0,d=a?((r.step??0)-h)/2:0,u=Math.max(s.x,n.width-(s.x+s.width)),p=Math.max(s.y,n.height-(s.y+s.height)),g=()=>JD(c?e:i)?c?s.width+u:s.height+p:c?-u:-p,m=()=>JD(c?e:i)?c?-u:-p:c?s.width+u:s.height+p;return(t=>{const e=[];let i=-1;for(let s=0;s<t.length;s++){if(K(t[s]))continue;const{start:n,stop:a,...o}=t[s],l=t[i]?.stop,c=t.slice(s+1).find(t=>null!=t.start)?.start;let h=r.convert(n??l)-d,u=r.convert(a??c)+2*d;const p=null!=n&&Number.isNaN(h),f=null!=a&&Number.isNaN(u);p||f||(Number.isNaN(h)&&(h=g()),Number.isNaN(u)&&(u=m()),null!=a&&(i=s),e.push({start:h,stop:u,...o}))}return e})(t.segments).map(({stop:t,start:e,...i})=>({clipRect:{x0:c?e:-u,y0:c?-p:e,x1:c?t+h:s.width+u,y1:c?s.height+p:t+h},...i}))}var ek=new Set(["time","timestamp","date","datetime"]);function ik(t,e,i){if("x"!==t&&"y"!==t)return;if(!W(e))return;const s=ak(t,i);if(null==s||!(s in e))return;const n=e[s],a=ok(t,i),o=nk(s,n);return o?{type:o,position:a}:"number"==typeof n?{type:"number",position:a}:{type:"category",position:a}}function sk(t,e,i){if("x"!==t&&"y"!==t)return;if(!W(e))return;const s=ak(t,i);if(null==s||!(s in e))return;const n=ok(t,i),a=nk(s,e[s]);return a?{type:a,position:n}:void 0}function nk(t,e){if($(e)||ek.has(t)&&X(e))return"time"}function ak(t,e){let i;return"x"===t?"xKey"in e&&(i=e.xKey):"y"===t&&"yKey"in e&&(i=e.yKey),i}function ok(t,e){return"direction"in e&&"horizontal"===e.direction?"x"===t?"left":"bottom":"x"===t?"bottom":"left"}var rk=Dl(function(t,e,i,s,n,a){if(e.length<1e3)return;const[o,r]=mI(t,s);let l=gI(e,o,r,{xNeedsValueOf:n});const{indexData:c,valueData:h}=bI(e,i,i,o,r,l,{xNeedsValueOf:n,yNeedsValueOf:a});let d=[],u=[],p=-1;for(let t=0;t<e.length;t+=1){const i=MI(e,o,r,c,l,t,n);if(-1===i)continue;const s=u.push(t)-1;i!==p&&(d.push(s),p=i)}d.push(u.length-1);const g=[{maxRange:l,metaIndices:d,indices:u}];for(;u.length>10&&l>64;){({maxRange:l}=vI(c,h,l,{inPlace:!0}));const t=u;d=[],u=[],p=-1;for(const i of t){const t=MI(e,o,r,c,l,i,n);if(-1===t)continue;const s=u.push(i)-1;t!==p&&(d.push(s),p=t)}d.push(u.length-1),g.push({maxRange:l,metaIndices:d,indices:u})}return g.reverse(),g}),lk=class extends GI{constructor(t){super({moduleCtx:t,propertyKeys:zI,propertyNames:jI,categoryKey:"xValue",pathsPerSeries:["fill","stroke"],pathsZIndexSubOrderOffset:[0,1e3],datumSelectionGarbageCollection:!1,segmentedDataNodes:!1,pickModes:[2,0],animationResetFns:{path:QD({getVisible:()=>this.visible,getOpacity:()=>this.getOpacity()}),label:dI,datum:(t,e)=>({opacity:1,scalingX:1,scalingY:1,...WD(0,e)})},clipFocusBox:!1}),this.properties=new HI,this.connectsToYAxis=!0,this.dataAggregationFilters=void 0,this.backgroundGroup=new Oa({name:`${this.id}-background`,zIndex:0}),this._isStacked=void 0,this.fillSpans=[],this.phantomSpans=[],this.strokeSpans=[]}get pickModeAxis(){return"main"}get hasData(){return this.getHasData("xValue")}renderToOffscreenCanvas(){return super.renderToOffscreenCanvas()||null!=this.contextNodeData&&(this.contextNodeData.fillData.spans.length>VI||this.contextNodeData.strokeData.spans.length>VI)}attachSeries(t,e,i){super.attachSeries(t,e,i),t.appendChild(this.backgroundGroup)}detachSeries(t,e,i){super.detachSeries(t,e,i),this.backgroundGroup.remove()}attachPaths([t,e]){this.backgroundGroup.appendChild(t),this.contentGroup.appendChild(e),e.zIndex=-1}detachPaths([t,e]){t.remove(),e.remove()}isStacked(){return(this.seriesGrouping?.stackCount??1)>1}isNormalized(){return null!=this.properties.normalizedTo}setSeriesIndex(t){const e=this.isStacked()===this._isStacked;return this._isStacked=e,super.setSeriesIndex(t,e)}setZIndex(t){super.setZIndex(t),this.isStacked()?(this.backgroundGroup.zIndex=[0,t],this.contentGroup.zIndex=[1,t,0]):(this.backgroundGroup.zIndex=[1,t,0,0],this.contentGroup.zIndex=[1,t,0,1])}async processData(t){if(null==this.data)return;const{data:e,visible:i,seriesGrouping:{groupIndex:s=this.id,stackCount:n=1}={}}=this,{xKey:a,yKey:o,yFilterKey:r,connectMissingData:l,normalizedTo:c}=this.properties,h=!this.ctx.animationManager.isSkipped(),d=this.axes.x?.scale,u=this.axes.y?.scale,{xScaleType:p,yScaleType:g}=this.getScaleInformation({xScale:d,yScale:u}),m=n>1||null!=c,f={value:`area-stack-${s}-yValue`,marker:`area-stack-${s}-yValues-marker`},y={invalidValue:null};(V(c)||l)&&n>1&&(y.invalidValue=0),i||(y.forceValue=0);const x=[Sx(a,p,{id:"xValue"}),Ix(o,g,{id:"yValueRaw",...y}),...null==r?[]:[Ix(r,g,{id:"yFilterRaw"})]];m&&x.push(...Lx(o,"normal",{id:"yValueCumulative",...y,groupId:f.marker},g)),V(c)&&x.push(Ix(o,g,{id:"yValue",...y,groupId:f.value}),Px(Object.values(f),c)),h&&x.push(Fx());const{dataModel:b,processedData:v}=await this.requestDataModel(t,e,{props:x,groupByKeys:m,groupByData:!m});this.dataAggregationFilters=this.aggregateData(b,v),this.animationState.transition("updateData")}xCoordinateRange(t,e){const{marker:i}=this.properties,s=this.axes.x.scale.convert(t),n=i.enabled?.5*i.size*e:0;return[s-n,s+n]}yCoordinateRange(t,e){const{marker:i}=this.properties,s=this.axes.y.scale.convert(t[0]),n=i.enabled?.5*i.size*e:0;return[s-n,s+n]}yValueKey(){return this.isNormalized()?"yValue":"yValueRaw"}yCumulativeKey(t){return"grouped"===t.type?"yValueCumulative":this.yValueKey()}getSeriesDomain(t){const{dataModel:e,processedData:i,axes:s}=this;if(!e||!i)return[];const n=s.y;if("x"===t){const t=e.resolveProcessedDataDefById(this,"xValue"),s=e.getDomain(this,"xValue","key",i);return"key"===t?.def.type&&"category"===t.def.valueType?s:Ph(rx(s))}const a=this.domainForClippedRange("y",[this.yCumulativeKey(i)],"xValue");return Ph(n instanceof mb&&!(n instanceof fb)?Number.isFinite(a[1]-a[0])?[Math.min(a[0],0),Math.max(a[1],0)]:[]:a)}getSeriesRange(t,e){const[i,s]=this.domainForVisibleRange("y",[this.yCumulativeKey(this.processedData)],"xValue",e);return[Math.min(i,0),Math.max(s,0)]}getZoomRangeFittingItems(t,e,i){return this.zoomFittingVisibleItems("xValue",[this.yCumulativeKey(this.processedData)],t,e,i)}getVisibleItems(t,e,i){return this.countVisibleItems("xValue",[this.yCumulativeKey(this.processedData)],t,e,i)}aggregateData(t,e){if(yx(e))return;const i=this.axes.x;if(null==i)return;const{scale:s}=i,n=t.resolveKeysById(this,"xValue",e),a=t.resolveColumnById(this,this.yCumulativeKey(e),e),o=t.getDomain(this,"xValue","key",e),r=t.resolveColumnNeedsValueOf(this,"xValue",e),l=t.resolveColumnNeedsValueOf(this,this.yCumulativeKey(e),e);return rk(s.type,n,a,o,r,l)}stackAggregatedData(t){const{indices:e,metaIndices:i}=t,{visible:s,axes:n,dataModel:a,processedData:o,seriesBelowStackContext:r}=this,l=n.x,c=n.y;if(!s)return this.phantomSpans=[],this.fillSpans=[],this.strokeSpans=[],r;if(null==l||null==c||null==a||null==o)return;const{scale:h}=l,{scale:d}=c,u=(h.bandwidth??0)/2,p=a.resolveKeysById(this,"xValue",o),g=a.resolveColumnById(this,this.yCumulativeKey(o),o);let[m,f]=kc(1,i.length-1,l.range,t=>{const s=i[t],n=i[t+1],a=e[s],o=e[n],r=p[a],l=p[o],{0:c}=this.xCoordinateRange(r,0),{1:h}=this.xCoordinateRange(l,0);return[c,h]});m=Math.max(m-1,0),f=Math.min(f+1,i.length-1);let y=[];if(r?.fillSpans)y=r?.fillSpans;else for(let t=m;t<f;t+=1){const s=i[t],n=i[t+1],a=e[s],o=e[n],r=p[a],l=p[o],c={type:"linear",moveTo:!1,x0:h.convert(r)+u,y0:d.convert(0),x1:h.convert(l)+u,y1:d.convert(0)};y.push({span:c,xValue0:r,xValue1:l,yValue0:0,yValue1:0})}this.phantomSpans=y;const x=[],b=[];for(let t=m;t<f;t+=1){const s=i[t],n=i[t+1],a=e[s],o=e[n],r=p[a],l=p[o],c=g[a],m=g[o],f=[];for(let t=s+1;t<n;t++){const i=e[t];f.push({x:h.convert(p[i])+u,y:d.convert(g[i])})}const y={span:{type:"multi-line",moveTo:!1,x0:h.convert(r)+u,y0:d.convert(c),x1:h.convert(l)+u,y1:d.convert(m),midPoints:f},xValue0:r,xValue1:l,yValue0:c,yValue1:m};x.push(y),b.push(y)}return this.fillSpans=x,this.strokeSpans=b,{stack:[],fillSpans:x,strokeSpans:b}}stackYValueData(){const{visible:t,axes:e,dataModel:i,processedData:s,seriesBelowStackContext:n,properties:a}=this,o=e.x,r=e.y;if(null==o||null==r||null==i||null==s)return;const{interpolation:l}=a,{scale:c}=o,{scale:h}=r,d=(c.bandwidth??0)/2;let u=i.resolveKeysById(this,"xValue",s),p=i.resolveColumnById(this,this.yValueKey(),s);const g=!this.isStacked()&&this.properties.connectMissingData,m=s.invalidKeys?.get(this.id),f=(g?s.invalidData?.get(this.id):void 0)??m;null!=f&&(u=u.filter((t,e)=>!1===f[e]),p=p.filter((t,e)=>!1===f[e]));let y,[x,b]=kc(1,u.length,o.range,t=>this.xCoordinateRange(u[t],0));if(x=Math.max(x-2,0),b=Math.min(b+2,u.length),n?.fillSpans)y=n?.fillSpans;else{const t=[];for(let e=x;e<b;e+=1){const i=u[e];t.push({point:{x:c.convert(i)+d,y:h.convert(0)},xDatum:i,yDatum:0})}y=LD(t,{type:"linear"})}if(this.phantomSpans=y,!t)return this.fillSpans=y,this.strokeSpans=[],n;let v=n?.stack;if(null==v){v=[];for(let t=x;t<b-1;t+=1)v.push({leading:0,trailing:0,dataValid:!0,breakBefore:!1})}const M=v.slice();let S=!1;for(let t=0;t<M.length;t+=1){const e=x+t,i=x+t+1;let{leading:s,trailing:n,breakBefore:a}=v[t];const o=p[e],r=p[i],l=!Number.isFinite(o),c=!Number.isFinite(r),h=!l&&!c;h&&(s+=o,n+=r),0!==t&&h!==S&&(a=!0),S=h,M[t]={leading:s,trailing:n,dataValid:h,breakBefore:a}}const I=[],D=[],k=[];for(let t=0;t<M.length;t+=1){const{leading:e,dataValid:i,breakBefore:s}=M[t],n=x+t;if(s){if(0!==k.length){const e=M[t-1],i={point:{x:c.convert(u[n])+d,y:h.convert(e.trailing)},xDatum:u[n],yDatum:e.trailing};k.push(i);const s=LD(k,l);I.push(...s),D.push(...s)}k.length=0}if(i){const t={point:{x:c.convert(u[n])+d,y:h.convert(e)},xDatum:u[n],yDatum:e};k.push(t)}else I.push(y[t])}if(0!==k.length){const t=M.at(-1),e=x+M.length,i={point:{x:c.convert(u[e])+d,y:h.convert(t.trailing)},xDatum:u[e],yDatum:t.trailing};k.push(i);const s=LD(k,l);I.push(...s),D.push(...s),k.length=0}return this.fillSpans=I,this.strokeSpans=D,{stack:M,fillSpans:I,strokeSpans:D}}createStackContext(){const t=this.axes.x;if(null==t)return;const{scale:e}=t,[i,s]=e.range,n=Math.abs(s-i),a=this.dataAggregationFilters?.find(t=>t.maxRange>n);return a?this.stackAggregatedData(a):this.stackYValueData()}createNodeData(){const{axes:t,data:e,processedData:i,dataModel:s,dataAggregationFilters:n}=this,a=t.x,o=t.y;if(!(a&&o&&e&&s&&i))return;const{xKey:r,xName:l,yFilterKey:c,yKey:h,yName:d,legendItemName:u,marker:p,label:g,fill:m,stroke:f}=this.properties,y=a.scale,x=o.scale,{isContinuousY:b}=this.getScaleInformation({xScale:y,yScale:x}),v=(y.bandwidth??0)/2,M="grouped"===i.type,S=s.resolveKeysById(this,"xValue",i),I=s.resolveColumnById(this,"yValueRaw",i),D=M?s.resolveColumnById(this,"yValueCumulative",i):I,k=null==c?void 0:s.resolveColumnById(this,"yFilterRaw",i),A=this.getSeriesDomain("y"),w=[],C=[],{visibleSameStackCount:N}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);let L=!1;const T=i.dataSources.get(this.id)?.data??[],E=i.invalidData?.get(this.id),[O,R]=y.range,P=Math.abs(R-O),z=n?.find(t=>t.maxRange>P);let j=0,B=0;const F=z?.indices;[j,B]=this.visibleRangeIndices("xValue",a.range,F),j=Math.max(j-2,0),B=Math.min(B+2,F?.length??S.length),i.input.count<1e3&&(j=0,B=i.input.count);const G=(t,e,i)=>{let s;return(V(this.properties.normalizedTo)?b&&Nd(i):!Number.isNaN(i))&&(s=e),{x:y.convert(t)+v,y:x.convert(s),size:p.size}},$=t=>{const e=S[t];if(null==e)return;const i=T[t],s=I[t],n=D[t],a=Number.isFinite(s)&&!0!==E?.[t],o=G(e,+n,s),c=null==k?void 0:k[t]===s;if(!1===c&&(L=!0),a&&p&&C.push({series:this,itemId:h,datum:i,datumIndex:t,midPoint:{x:o.x,y:o.y},cumulativeValue:+n,yValue:s,xValue:e,yKey:h,xKey:r,point:o,fill:p.fill??m,stroke:p.stroke??f,strokeWidth:p.strokeWidth??this.properties.strokeWidth,selected:c}),g.enabled&&a){const e=this.getLabelText(s,i,h,"y",A,g,{value:s,datum:i,xKey:r,yKey:h,xName:l,yName:d,legendItemName:u});w.push({series:this,itemId:h,datum:i,datumIndex:t,x:o.x,y:o.y,labelText:e})}};for(let t=j;t<B;t+=1){const e=F?.[t]??t;null!=S[e]&&$(e)}const H=tk(this.properties.segmentation,a,o,this.chart.seriesRect,this.ctx.scene,!1);return{itemId:h,fillData:{itemId:h,spans:this.fillSpans,phantomSpans:this.phantomSpans},strokeData:{itemId:h,spans:this.strokeSpans},labelData:w,nodeData:C,scales:this.calculateScaling(),visible:this.visible,stackVisible:N>0,crossFiltering:L,styles:KD(this,this.properties,p),segments:H}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}updatePathNodes(t){const{paths:[e,i],visible:s,animationEnabled:n}=t,a=!0===this.contextNodeData?.crossFiltering,o=this.contextNodeData?.segments,r=zs(this.getHighlightStyle(),this.getStyle(!1)),{strokeWidth:l,stroke:c,strokeOpacity:h,lineDash:d,lineDashOffset:u,fill:p,fillOpacity:g,opacity:m}=r;i.setProperties({segments:o,fill:void 0,lineCap:"round",lineJoin:"round",pointerEvents:1,stroke:c,strokeWidth:l,strokeOpacity:h*(a?.25:1),lineDash:d,lineDashOffset:u,opacity:m,visible:s||n}),i.datum=o,ag(e,{fill:p,stroke:void 0,fillOpacity:g*(a?.125:1)},this.getShapeFillBBox()),e.setProperties({segments:o,lineJoin:"round",pointerEvents:1,fillShadow:this.properties.shadow,opacity:m,visible:s||n}),e.datum=o,qD(this,i),qD(this,e)}updatePaths(t){this.updateAreaPaths(t.paths,t.contextData)}updateAreaPaths(t,e){for(const i of t)i.visible=e.visible;if(e.visible)this.updateFillPath(t,e),this.updateStrokePath(t,e);else for(const e of t)e.path.clear(),e.markDirty("AreaSeries")}updateFillPath(t,e){const[i]=t;i.path.clear(),jD(i,e.fillData),i.markDirty("AreaSeries")}updateStrokePath(t,e){const{spans:i}=e.strokeData,[,s]=t;s.path.clear(),ED(s,i),s.markDirty("AreaSeries")}updateDatumSelection(t){const{nodeData:e,datumSelection:i}=t,{contextNodeData:s,processedData:n,axes:a,properties:o}=this,{marker:r,styler:l}=o,c=l?this.getStyle(!1).marker:void 0,h=!0===s?.crossFiltering||YD(n.input.count,a.x.scale,r,c);return r.isDirty()&&(i.clear(),i.cleanup()),i.update(h?e:[])}updateDatumStyles(t){const{datumSelection:e,isHighlight:i}=t,{marker:s}=this.properties,n=this.ctx.highlightManager.getActiveHighlight();e.each((a,o)=>{if(!e.isGarbage(a)){const e=this.getHighlightState(n,t.isHighlight,o.datumIndex),a=this.getStyle(i,e),{stroke:r,strokeWidth:l,strokeOpacity:c}=a,h=this.makeItemStylerParams(this.dataModel,this.processedData,o.datumIndex,a.marker);o.style=this.getMarkerStyle(s,o,h,{isHighlight:i,highlightState:e},a.marker,{stroke:r,strokeWidth:l,strokeOpacity:c})}})}updateDatumNodes(t){const{contextNodeData:e}=this;if(!e)return;const{datumSelection:i,isHighlight:s}=t,n=this.getShapeFillBBox(),a=this.ctx.highlightManager.getActiveHighlight();i.each((t,i)=>{const o=i.style??e.styles[this.getHighlightState(a,s,i.datumIndex)];this.applyMarkerStyle(o,t,i.point,n,{selected:i.selected})}),s||this.properties.marker.markClean()}updateLabelSelection(t){return t.labelSelection.update(this.isLabelEnabled()?t.labelData:[])}updateLabelNodes(t){const{isHighlight:e=!1}=t,i=this.ctx.highlightManager?.getActiveHighlight(),s=this.makeLabelFormatterParams();t.labelSelection.each((t,n)=>{const a=aI(this,n,s,this.properties.label,e,i),{enabled:o,fontStyle:r,fontWeight:l,fontSize:c,fontFamily:h,color:d}=a;o&&n?.labelText?(t.fontStyle=r,t.fontWeight=l,t.fontSize=c,t.fontFamily=h,t.textAlign="center",t.textBaseline="bottom",t.text=n.labelText,t.x=n.x,t.y=n.y-10,t.fill=d,t.visible=!0,t.fillOpacity=this.getHighlightStyle(e,n.datumIndex).opacity??1,t.setBoxing(a)):t.visible=!1})}makeStylerParams(t,e){const{id:i}=this,{marker:s,fill:n,fillOpacity:a,lineDash:o,lineDashOffset:r,stroke:l,strokeOpacity:c,strokeWidth:h,xKey:d,yKey:u}=this.properties,p=dc(e??0);return{marker:{fill:s.fill,fillOpacity:s.fillOpacity,size:s.size,shape:s.shape,stroke:s.stroke,strokeOpacity:s.strokeOpacity,strokeWidth:s.strokeWidth,lineDash:s.lineDash,lineDashOffset:s.lineDashOffset},highlightState:p,highlighted:t,fill:n,fillOpacity:a,lineDash:o,lineDashOffset:r,seriesId:i,stroke:l,strokeOpacity:c,strokeWidth:h,xKey:d,yKey:u}}makeItemStylerParams(t,e,i,s){const{xKey:n,yKey:a}=this.properties,o=t.resolveKeysById(this,"xValue",e)[i],r=t.resolveColumnById(this,"yValueRaw",e)[i],l=t.getDomain(this,"xValue","key",e),c=t.getDomain(this,this.yCumulativeKey(e),"value",e),h=this.filterItemStylerFillParams(s.fill)??s.fill;return{...Dc(o,r,n,a,l,c),xValue:o,yValue:r,...s,fill:h}}makeLabelFormatterParams(){const{xKey:t,xName:e,yKey:i,yName:s,legendItemName:n}=this.properties;return{xKey:t,xName:e,yKey:i,yName:s,legendItemName:n}}getTooltipContent(t){const{id:e,dataModel:i,processedData:s,axes:n,properties:a}=this,{xKey:o,xName:r,yKey:l,yName:c,tooltip:h,legendItemName:d}=a,u=n.x,p=n.y;if(!(i&&s&&u&&p))return;const g=s.dataSources.get(this.id)?.data?.[t],m=i.resolveKeysById(this,"xValue",s)[t],f=i.resolveColumnById(this,"yValueRaw",s)[t];if(null==m)return;const y=this.getStyle(!1),x=this.makeItemStylerParams(i,s,t,y.marker),b=this.getMarkerStyle(this.properties.marker,{datumIndex:t,datum:g},x,{isHighlight:!1},y.marker);return this.formatTooltipWithContext(h,{heading:this.getAxisValueText(u,"tooltip",m,g,o,d),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:l,value:this.getAxisValueText(p,"tooltip",f,g,l,d)}]},{seriesId:e,datum:g,title:c,xKey:o,xName:r,yKey:l,yName:c,...b,...this.getModuleTooltipParams()})}legendItemSymbol(){const{fill:t,stroke:e,fillOpacity:i,strokeOpacity:s,strokeWidth:n,lineDash:a,marker:o}=this.getStyle(!1),r=!o.enabled||null==o.fill,l=r?t:o.fill;return{marker:{...this.getMarkerStyle(this.properties.marker,{},void 0,{isHighlight:!1,checkForHighlight:!1},{size:o.size,shape:o.shape,fill:l,fillOpacity:r?i:o.fillOpacity,stroke:o.stroke}),enabled:o.enabled||n<=0},line:{stroke:e,strokeOpacity:s,strokeWidth:n,lineDash:a}}}getLegendData(t){if("category"!==t)return[];const{id:e,ctx:{legendManager:i},visible:s}=this,{yKey:n,yName:a,legendItemName:o,showInLegend:r}=this.properties;return[{legendType:t,id:e,itemId:n,legendItemName:o,seriesId:e,enabled:s&&i.getItemEnabled({seriesId:e,itemId:n}),label:{text:o??a??n},symbol:this.legendItemSymbol(),hideInLegend:!r}]}animateEmptyUpdateReady(t){const{datumSelection:e,labelSelection:i,contextData:s,paths:n}=t,{animationManager:a}=this.ctx;this.updateAreaPaths(n,s),ZD(this,a,...n),pd([e],WD),HD(this,a,e),cI(this,"labels",a,i)}animateReadyResize(t){const{contextData:e,paths:i}=t;this.updateAreaPaths(i,e),super.animateReadyResize(t)}animateWaitingUpdateReady(t){const{animationManager:e}=this.ctx,{datumSelection:i,labelSelection:s,contextData:n,paths:a,previousContextData:o}=t,[r,l]=a;if(!1===n.visible&&!1===o?.visible)return;if(null==r&&null==l)return;this.resetDatumAnimation(t),this.resetLabelAnimation(t);const c=()=>{this.resetPathAnimation(t),this.updateAreaPaths(a,n)},h=()=>{e.skipCurrentBatch(),c()};if(null==n||null==o)return c(),GD(this,e,"added",i),XD(this,"fill_path_properties",e,"add",r),XD(this,"stroke_path_properties",e,"add",l),void cI(this,"labels",e,s);if(n.crossFiltering!==o.crossFiltering)return void h();const d=VD(n,o);void 0!==d?"no-op"!==d.status&&(GD(this,e,void 0,i),cd(this.id,"fill_path_properties",e,[r],d.fill.pathProperties),nI(this.id,"fill_path_update",e,[r],d.fill.path),cd(this.id,"stroke_path_properties",e,[l],d.stroke.pathProperties),nI(this.id,"stroke_path_update",e,[l],d.stroke.path),cI(this,"labels",e,s),this.ctx.animationManager.animate({id:this.id,groupId:"reset_after_animation",phase:"trailing",from:{},to:{},onComplete:()=>this.updateAreaPaths(a,n)})):h()}isLabelEnabled(){return this.properties.label.enabled}nodeFactory(){return new Ig}getStyle(t,e){const{styler:i,marker:s,fill:n,fillOpacity:a,lineDash:o,lineDashOffset:r,stroke:l,strokeOpacity:c,strokeWidth:h}=this.properties,{size:d,shape:u,fill:p="transparent",fillOpacity:g}=s;let m={};if(i){const s=this.makeStylerParams(t,e),n=this.cachedCallWithContext(i,s)??{};m=this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],n,{pick:!1})??{}}return m.marker??(m.marker={}),{fill:m.fill??n,fillOpacity:m.fillOpacity??a,lineDash:m.lineDash??o,lineDashOffset:m.lineDashOffset??r,stroke:m.stroke??l,strokeOpacity:m.strokeOpacity??c,strokeWidth:m.strokeWidth??h,marker:{enabled:m.marker.enabled??s.enabled,fill:m.marker.fill??p,fillOpacity:m.marker.fillOpacity??g,shape:m.marker.shape??u,size:m.marker.size??d,lineDash:m.marker.lineDash??s.lineDash??o,lineDashOffset:m.marker.lineDashOffset??s.lineDashOffset??r,stroke:m.marker.stroke??s.stroke??l,strokeOpacity:m.marker.strokeOpacity??s.strokeOpacity??c,strokeWidth:m.marker.strokeWidth??s.strokeWidth??h}}}getFormattedMarkerStyle(t){const e=this.getStyle(!1),i=this.makeItemStylerParams(this.dataModel,this.processedData,t.datumIndex,e.marker);return this.getMarkerStyle(this.properties.marker,t,i,{isHighlight:!0},void 0,e)}computeFocusBounds(t){return _D(this,t)}hasItemStylers(){return null!=this.properties.styler||null!=this.properties.marker.itemStyler||null!=this.properties.label.itemStyler}};lk.className="AreaSeries",lk.type="area";var ck={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"area",moduleFactory:t=>new lk(t),stackable:!0,predictAxis:sk,defaultAxes:[{type:"number",position:"left"},{type:"category",position:"bottom"}],themeTemplate:{series:{nodeClickRange:"nearest",fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",Xm],["image",hf],["pattern",of]]},stroke:{$palette:"stroke"},fillOpacity:.8,strokeOpacity:1,strokeWidth:{$isUserOption:["./stroke",2,0]},lineDash:[0],lineDashOffset:0,shadow:{enabled:!1,color:dm,xOffset:3,yOffset:3,blur:5},interpolation:{type:"linear"},marker:{enabled:!1,shape:"circle",size:7,strokeWidth:{$isUserOption:["./stroke",1,0]},fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",ef],["pattern",of]]},stroke:{$palette:"stroke"}},label:{...mf,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},tooltip:{range:{$path:["/tooltip/range","nearest"]},position:{anchorTo:{$path:["/tooltip/position/anchorTo","node"]}}},highlight:ff(),segmentation:bf}}},hk={type:"series",name:"area",chartType:"cartesian",options:Ub,create:t=>new lk(t)},dk=class extends Uo{constructor(){super(...arguments),this.direction="x",this.featherRatio=0}get feathered(){return Math.abs(this.featherRatio)>1e-6}isPointInPath(t,e){return this.feathered?this.getBBox().containsPoint(t,e):super.isPointInPath(t,e)}updatePath(){if(!this.feathered)return void super.updatePath();const{path:t,borderPath:e,x:i,y:s,width:n,height:a,direction:o,featherRatio:r}=this;if(t.clear(),e.clear(),"x"===o){const e=Math.abs(r)*n;r>0?(t.moveTo(i,s),t.lineTo(i+n-e,s),t.lineTo(i+n,s+a/2),t.lineTo(i+n-e,s+a),t.lineTo(i,s+a),t.closePath()):(t.moveTo(i+e,s),t.lineTo(i+n,s),t.lineTo(i+n,s+a),t.lineTo(i+e,s+a),t.lineTo(i,s+a/2),t.closePath())}else{const e=Math.abs(r)*a;r>0?(t.moveTo(i,s+e),t.lineTo(i+n/2,s),t.lineTo(i+n,s+e),t.lineTo(i+n,s+a),t.lineTo(i,s+a),t.closePath()):(t.moveTo(i,s),t.lineTo(i+n,s),t.lineTo(i+n,s+a-e),t.lineTo(i+n/2,s+a),t.lineTo(i,s+a-e),t.closePath())}}renderStroke(t){if(!this.feathered)return void super.renderStroke(t);const{stroke:e,strokeWidth:i}=this;if(e&&i){const{globalAlpha:e}=t,{lineDash:s,lineDashOffset:n,lineCap:a,lineJoin:o,path:r}=this;this.applyStrokeAndAlpha(t),t.lineWidth=i,s&&t.setLineDash(s),n&&(t.lineDashOffset=n),a&&(t.lineCap=a),o&&(t.lineJoin=o),t.stroke(r.getPath2D()),t.globalAlpha=e}}};function uk(t,e){for(const s of e){const e=s.datum;void 0===e?i.error("undefined datum"):t.addValue(s,e)}}function pk(t,e){const{x:i,y:s}=e,{nearest:n,distanceSquared:a}=t.getQuadTree().find(i,s);if(void 0!==n)return{datum:n.value,distance:Math.sqrt(a)}}ls([Xs()],dk.prototype,"direction",2),ls([Xs()],dk.prototype,"featherRatio",2);var gk=class extends FI{constructor(){super(...arguments),this.direction="vertical"}};ls([ws],gk.prototype,"direction",2);var mk=class extends GI{constructor(){super(...arguments),this.groupScale=new Vu,this.smallestDataInterval=void 0,this.largestDataInterval=void 0}get hasData(){return this.getHasData("xValue")}padBandExtent(t,e){const i="boolean"==typeof e?1:.5,s=Q(this.smallestDataInterval)?this.smallestDataInterval*i:0,n=rx(t)??[Number.NaN,Number.NaN];return"boolean"==typeof e?n[e?0:1]-=(e?1:-1)*s:(n[0]-=s,n[1]+=s),Ph(n)}getBandScalePadding(){return{inner:.3,outer:.15}}shouldFlipXY(){return!this.isVertical()}isVertical(){return"vertical"===this.properties.direction}getBarDirection(){return this.shouldFlipXY()?"x":"y"}getCategoryDirection(){return this.shouldFlipXY()?"y":"x"}getValueAxis(){const t=this.getBarDirection();return this.axes[t]}getCategoryAxis(){const t=this.getCategoryDirection();return this.axes[t]}getBandwidth(t,e){return $c.is(t.scale)?t.scale.calcBandwidth(this.smallestDataInterval,e):t.scale.bandwidth}xCoordinateRange(t){const e=this.axes[this.getCategoryDirection()],i=e.scale,s=this.getBandwidth(e,0)??0,n=$c.is(i)?-.5*s:0,a=i.convert(t)+n;return[a,a+s]}yCoordinateRange(t){const e=this.axes[this.getBarDirection()].scale,i=t.map(t=>e.convert(t));if(1===i.length){const t=e.convert(0);return[Math.min(i[0],t),Math.max(i[0],t)]}return[Math.min(...i),Math.max(...i)]}updateGroupScale(t){const e=[],{groupScale:i}=this,s=this.getBandwidth(t),{index:n,visibleGroupCount:a}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);for(let t=0;t<a;t++)e.push(String(t));return i.domain=e,i.range=[0,s??0],t instanceof ab?i.paddingInner=t.groupPaddingInner:t instanceof ax?(i.paddingInner=t.groupPaddingInner,i.round=0!==i.padding):i.padding=0,{barWidth:i.bandwidth>=1?i.bandwidth:i.rawBandwidth,groupIndex:n}}resolveKeyDirection(t){return"x"===this.getBarDirection()?"x"===t?"y":"x":t}initQuadTree(t){uk(t,this.datumNodesIter())}pickNodeClosestDatum(t){return pk(this,t)}};function fk(t,e){return Array.from({length:t},(t,i)=>{const s=4*i,n=e[s+0],a=e[s+1];return Math.trunc((n+a)/2)})}var yk=class extends kd{constructor(){super(...arguments),this.placement="inside-center",this.spacing=0}};ls([ws],yk.prototype,"placement",2),ls([ws],yk.prototype,"spacing",2);var xk=class extends gk{constructor(){super(...arguments),this.fill="#c16068",this.fillOpacity=1,this.stroke="#874349",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.crisp=void 0,this.shadow=new II,this.label=new yk,this.tooltip=wI(),this.sparklineMode=!1}};function bk(t,e,i,s){if(null!=e){const[t,i]=e;if(0!==t||1!==i)return!1}if($c.is(t)){const e=t.calcBandwidth(s)-t.calcBandwidth(i);if(e>0&&e<1)return!1}if(Wc.is(t)){const{bandwidth:e,step:i}=t;if(e>0&&e<1)return!1;const s=i-e;if(s>0&&s<1)return!1}return!0}ls([ws],xk.prototype,"xKey",2),ls([ws],xk.prototype,"xName",2),ls([ws],xk.prototype,"yKey",2),ls([ws],xk.prototype,"yName",2),ls([ws],xk.prototype,"yFilterKey",2),ls([ws],xk.prototype,"stackGroup",2),ls([ws],xk.prototype,"normalizedTo",2),ls([ws],xk.prototype,"fill",2),ls([ws],xk.prototype,"fillOpacity",2),ls([ws],xk.prototype,"stroke",2),ls([ws],xk.prototype,"strokeWidth",2),ls([ws],xk.prototype,"strokeOpacity",2),ls([ws],xk.prototype,"lineDash",2),ls([ws],xk.prototype,"lineDashOffset",2),ls([ws],xk.prototype,"cornerRadius",2),ls([ws],xk.prototype,"crisp",2),ls([ws],xk.prototype,"styler",2),ls([ws],xk.prototype,"itemStyler",2),ls([ws],xk.prototype,"shadow",2),ls([ws],xk.prototype,"label",2),ls([ws],xk.prototype,"tooltip",2),ls([ws],xk.prototype,"sparklineMode",2);var vk=t=>L(t.yValue??0);function Mk(t,e,i){const{startingX:s,startingY:n}=function(t,e){const i=e[t?"y":"x"];let s=1/0,n=0;return i?(t?n=i.scale.convert($c.is(i.scale)?0:Math.max(...i.range)):s=i.scale.convert($c.is(i.scale)?0:Math.min(...i.range)),{startingX:s,startingY:n}):{startingX:s,startingY:n}}(t,e);return{isVertical:t,calculate:(e,i)=>{let a=t?e.x:s,o=t?n:e.y,r=t?e.width:0,l=t?0:e.height;const{opacity:c=1}=e;let h;return i&&(Number.isNaN(a)||Number.isNaN(o))&&(({x:a,y:o}=i),r=t?i.width:0,l=t?0:i.height,t&&!vk(i)?o+=i.height:!t&&vk(i)&&(a+=i.width)),h=null==e.clipBBox?void 0:vk(e)?t?new fs(a,o-l,r,l):new fs(a-r,o,r,l):new fs(a,o,r,l),{x:a,y:o,width:r,height:l,clipBBox:h,opacity:c}},mode:i}}function Sk(t,e){return{isVertical:t,calculate:e=>({x:t?e.x:e.x+e.width/2,y:t?e.y+e.height/2:e.y,width:t?e.width:0,height:t?0:e.height,clipBBox:e.clipBBox,opacity:e.opacity??1}),mode:e}}function Ik(t,e){const i=t=>null==t||Number.isNaN(t.x)||Number.isNaN(t.y);return{toFn:(e,s,n)=>"removed"===n&&null==e.datum&&"fade"===t.mode?{...Dk(e,s),opacity:0}:"removed"===n||i(s)?t.calculate(s,e.previousDatum):{x:s.x,y:s.y,width:s.width,height:s.height,clipBBox:s.clipBBox,opacity:s.opacity??1},fromFn:(s,n,a)=>{let o;"updated"===a&&i(n)?a="removed":"updated"===a&&i(s.previousDatum)&&(a="added"),"unknown"===a||"added"===a?(o=null==s.previousDatum&&"fade"===t.mode?{...Dk(s,n),opacity:0}:t.calculate(n,s.previousDatum),"unknown"===a&&(a=e)):o={x:s.x,y:s.y,width:s.width,height:s.height,clipBBox:s.clipBBox,opacity:s.opacity??1};const r=ld[a];return{...o,phase:r}},applyFn:(t,e,i)=>{t.setProperties(e),t.crisp="end"===i&&(t.datum?.crisp??!1)}}}function Dk(t,{x:e,y:i,width:s,height:n,clipBBox:a,opacity:o=1}){return{x:e,y:i,width:s,height:n,clipBBox:a,opacity:o,crisp:t.datum?.crisp??!1}}function kk(t,e){if(void 0===e)return;const{x:i,y:s,width:n,height:a}=e;return Ta.toCanvas(t.contentGroup,new fs(i,s,n,a))}function Ak(t,e,i,s,n,a,o){let r=a?.reduced?.diff?.[t];if(r?.changed)return r;if(!o)return{changed:!1,added:new Set,updated:new Set,removed:new Set,moved:new Set};const l=function(t,e){if(!e)return!1;const i=t.scales,s=e.scales;if(!CD(i.x,s.x))return!0;if(!CD(i.y,s.y))return!0;if(!wk(t)||!wk(e))return!1;return!CD(t.groupScale,e.groupScale)}(s,n);return null==r&&null!=a?.reduced?.diff?(r={changed:!0,added:new Set,updated:new Set,removed:new Set,moved:new Set},l?r.updated=new Set(Array.from(e,({datum:t})=>i(t))):r.added=new Set(Array.from(e,({datum:t})=>i(t)))):l&&(r={changed:!0,added:new Set,updated:new Set(Array.from(e,({datum:t})=>i(t))),removed:new Set,moved:new Set}),r}function wk(t){return"object"==typeof t&&null!==t&&"groupScale"in t}var Ck=Dl(function(t,e,i,s,n,a){if(e.length<1e3)return;const[o,r]=mI(t,n);let l=gI(e,o,r,{smallestKeyInterval:a}),{indexData:c,valueData:h}=bI(e,s,i??s,o,r,l,{positive:!0}),{indexData:d,valueData:u}=bI(e,s,i??s,o,r,l,{positive:!1}),p=fk(l,c),g=fk(l,d);const m=[{maxRange:l,positiveIndices:p,positiveIndexData:c,negativeIndices:g,negativeIndexData:d}];for(;l>64;)({indexData:c,valueData:h}=vI(c,h,l)),({indexData:d,valueData:u,maxRange:l}=vI(d,u,l)),p=fk(l,c),g=fk(l,d),m.push({maxRange:l,positiveIndices:p,positiveIndexData:c,negativeIndices:g,negativeIndexData:d});return m.reverse(),m}),Nk=class extends mk{constructor(t){super({moduleCtx:t,propertyKeys:zI,propertyNames:jI,categoryKey:"xValue",pickModes:[2,1,0],pathsPerSeries:[],datumSelectionGarbageCollection:!1,animationAlwaysUpdateSelections:!0,animationResetFns:{datum:Dk,label:dI}}),this.properties=new xk,this.connectsToYAxis=!0,this.dataAggregationFilters=void 0}get pickModeAxis(){return this.properties.sparklineMode?"main":void 0}crossFilteringEnabled(){return null!=this.properties.yFilterKey&&(null==this.seriesGrouping||0===this.seriesGrouping.stackIndex)}async processData(t){if(!this.data)return;const{xKey:e,yKey:i,yFilterKey:s,normalizedTo:n}=this.properties,{seriesGrouping:{groupIndex:a=this.id}={},data:o}=this,r=(this.seriesGrouping?.stackCount??0)>1||null!=n,l=r,c=!this.ctx.animationManager.isSkipped(),h=this.getCategoryAxis()?.scale,d=this.getValueAxis()?.scale,{isContinuousX:u,xScaleType:p,yScaleType:g}=this.getScaleInformation({xScale:h,yScale:d}),m=`bar-stack-${a}-yValues`,f=`${m}-trailing`,y=this.visible?{}:{forceValue:0},x=[Sx(e,p,{id:"xValue"}),Ix(i,g,{id:"yValue-raw",invalidValue:null,...y})];this.crossFilteringEnabled()&&x.push(Ix(s,g,{id:"yFilterValue",invalidValue:null,...y})),r&&x.push(...Lx(i,"normal",{id:"yValue-end",rangeId:"yValue-range",invalidValue:null,missingValue:0,groupId:m,separateNegative:!0,...y},g),...Lx(i,"trailing",{id:"yValue-start",invalidValue:null,missingValue:0,groupId:f,separateNegative:!0,...y},g)),u&&x.push(Tx,Ex),Q(n)&&x.push(Px([m,f],Math.abs(n))),c&&this.processedData&&x.push(Ux(this.id,this.processedData)),!c&&l||x.push(Fx());const{dataModel:b,processedData:v}=await this.requestDataModel(t,o,{props:x,groupByKeys:l,groupByData:!l});this.dataAggregationFilters=this.aggregateData(b,v),this.smallestDataInterval=v.reduced?.smallestKeyInterval,this.largestDataInterval=v.reduced?.largestKeyInterval,this.animationState.transition("updateData")}yCumulativeKey(t){return t.hasColumnById(this,"yValue-end")?"yValue-end":"yValue-raw"}getSeriesDomain(t){const{processedData:e,dataModel:i}=this;if(null==i||null==e)return[];if(t===this.getCategoryDirection()){const t=i.resolveProcessedDataDefById(this,"xValue"),s=i.getDomain(this,"xValue","key",e);return"key"===t?.def.type&&"category"===t.def.valueType?s:this.padBandExtent(s)}const s=this.yCumulativeKey(i);let n=this.domainForClippedRange(t,[s],"xValue");const a=this.crossFilteringEnabled()?i.getDomain(this,"yFilterValue","value",e):void 0;null!=a&&(n=[Math.min(n[0],a[0]),Math.max(n[1],a[1])]);const o=this.getValueAxis();return Ph(o instanceof mb&&!(o instanceof fb)?Number.isFinite(n[1]-n[0])?[Math.min(0,n[0]),Math.max(0,n[1])]:[]:n)}getSeriesRange(t,e){if(("horizontal"===this.properties.direction?"x":"y")!==t)return[];const i=this.yCumulativeKey(this.dataModel),[s,n]=this.domainForVisibleRange("y",[i],"xValue",e);return[Math.min(s,0),Math.max(n,0)]}getZoomRangeFittingItems(t,e,i){const s=this.yCumulativeKey(this.dataModel);return this.zoomFittingVisibleItems("xValue",[s],t,e,i)}getVisibleItems(t,e,i){const s=this.yCumulativeKey(this.dataModel);return this.countVisibleItems("xValue",[s],t,e,i)}aggregateData(t,e){if(yx(e))return;const i=this.axes.x;if(null==i)return;const s=t.resolveKeysById(this,"xValue",e),n=t.hasColumnById(this,"yValue-start"),a=n?t.resolveColumnById(this,"yValue-start",e):void 0,o=n?t.resolveColumnById(this,"yValue-end",e):t.resolveColumnById(this,"yValue-raw",e),{index:r}=t.resolveProcessedDataDefById(this,"xValue"),l=e.domain.keys[r];return Ck(i.scale.type,s,a,o,l,e.reduced?.smallestKeyInterval)}createNodeData(){const{dataModel:t,processedData:e,groupScale:i,dataAggregationFilters:s}=this,n=this.getCategoryAxis(),a=this.getValueAxis();if(!(t&&e&&n&&a))return;const o=e.dataSources?.get(this.id);if(null==o)return;const r=n.scale,l=a.scale,{xKey:c,yKey:h,xName:d,yName:u,legendItemName:p,label:g}=this.properties,m=this.getSeriesDomain("y"),f=a.isReversed(),{barWidth:y,groupIndex:x}=this.updateGroupScale(n),b=i.convert(String(x)),v=$c.is(r)?-.5*y:0,M=t.hasColumnById(this,"yValue-start"),S=t.resolveKeysById(this,"xValue",e),I=t.resolveColumnById(this,"yValue-raw",e),D=M?t.resolveColumnById(this,"yValue-start",e):void 0,k=M?t.resolveColumnById(this,"yValue-end",e):void 0,A=this.crossFilteringEnabled()?t.resolveColumnById(this,"yFilterValue",e):void 0,w=!this.ctx.animationManager.isSkipped(),C=t=>r.convert(S[t])+b+v,[N,L]=r.range,T=Math.abs(L-N),E=s?.find(t=>t.maxRange>T),O=null==E&&(this.properties.crisp??bk(n?.scale,n?.visibleRange,this.smallestDataInterval,this.largestDataInterval)),R=l.convert(0),P=({datum:t,datumIndex:e,xValue:i,yValue:s,cumulativeValue:n,phantom:a,currY:o,prevY:r,x:d,width:u,isPositive:p,yRange:m,labelText:y,opacity:x,featherRatio:b,crossScale:v=1})=>{const M=p!==f,S=l.convert(o),I=l.convert(r),D=l.convert(m),k="x"===this.getBarDirection(),A=.5*u*(1-v),w={x:k?Math.min(S,I):d+A,y:k?d+A:Math.min(S,I),width:k?Math.abs(I-S):u*v,height:k?u*v:Math.abs(I-S)},C=new fs(w.x,w.y,w.width,w.height),N={x:k?Math.min(R,D):d+A,y:k?d+A:Math.min(R,D),width:k?Math.abs(R-D):u*v,height:k?u*v:Math.abs(R-D)},L=this.shouldFlipXY()?w.height:w.width,T=g.spacing+("number"==typeof g.padding?g.padding:0);return{series:this,itemId:a?Wx(h,a):h,datum:t,datumIndex:e,cumulativeValue:n,phantom:a,xValue:i,yValue:s,yKey:h,xKey:c,capDefaults:{lengthRatioMultiplier:L,lengthMax:L},x:N.x,y:N.y,width:N.width,height:N.height,midPoint:{x:w.x+w.width/2,y:w.y+w.height/2},opacity:x,featherRatio:b,topLeftCornerRadius:k!==M,topRightCornerRadius:M,bottomRightCornerRadius:k===M,bottomLeftCornerRadius:!M,clipBBox:C,crisp:O,label:null==y?void 0:{text:y,...lI({isUpward:M,isVertical:!k,placement:g.placement,spacing:T,rect:w})},missing:null==s,focusable:!a}},z=[],j=[],B=[],F=(t,e,i,s,n,a,r=0,l=1)=>{const f=S[t];if(null==f)return;const y=o.data[t],x=I[t],b=null==A?void 0:Number(A[t]),v=x>=0&&!Object.is(x,-0);if(!Number.isFinite(n))return;if(null!=b&&!Number.isFinite(b))return;const M=g.enabled&&null!=x?this.getLabelText(b??x,y,h,"y",m,g,{datum:y,value:b??x,xKey:c,yKey:h,xName:d,yName:u,legendItemName:p}):void 0,D=null!=b&&b>x,k=P({datum:y,datumIndex:t,xValue:f,yValue:b??x,cumulativeValue:b??n,phantom:!1,currY:null==b?n:s+b,prevY:s,x:e,width:i,isPositive:v,yRange:Math.max(s+(b??-1/0),a),labelText:M,opacity:l,featherRatio:r,crossScale:D?.6:void 0});if(j.push(k),B.push(k),null!=b){const c=P({datum:o.data[t],datumIndex:t,xValue:f,yValue:b,cumulativeValue:b,phantom:!0,currY:n,prevY:s,x:e,width:i,isPositive:v,yRange:a,labelText:void 0,opacity:l,featherRatio:r,crossScale:void 0});z.push(c)}};if(null!=E){const{positiveIndices:t,positiveIndexData:e,negativeIndices:i,negativeIndexData:s}=E,a=f?-1:1;for(let o=0;o<2;o+=1){const l=0===o,c=l?t:i,h=l?e:s,d=l?2:3,u=l?3:2,[p,g]=this.visibleRangeIndices("xValue",n.range,c);for(let t=p;t<g;t+=1){const e=4*t,i=h[e+0],s=h[e+1],n=h[e+d],o=h[e+u];if(-1===i)continue;if(null==S[o]||null==S[n])continue;const c=C(Math.trunc((i+s)/2)),p=Math.abs(C(s)-C(i))+y;if(c-p<0||c>T)continue;const g=Math.abs(s-i)+1,m=Wc.is(r)?Math.min(r.bandwidth*Math.max(g-1,1)/(r.step*g),1):1;let f,x,b=0;if(M)f=Number(D[n]),x=Number(k[o]);else{const t=Number(I[o]);f=0,x=t,b=(l?1:-1)*a*(1-Number(I[n])/t)}F(o,c,p,f,x,x,b,m)}}}else if("grouped"===e.type){const i=e.invalidData?.get(this.id),s=y,a=M?t.resolveProcessedDataIndexById(this,"yValue-range"):-1,o=e.columnScopes.findIndex(t=>t.has(this.id)),{groups:r}=e,[l,c]=kc(1,r.length,n.range,t=>{const e=r[t].keys[0];return this.xCoordinateRange(e)});for(let t=l;t<c;t+=1){const e=r[t],{aggregation:n}=e,l=e.datumIndices[o];if(null!=l)for(const e of l){const o=t+e,r=C(o);if(!0===i?.[o])continue;const l=I[o];if(null==l)continue;const c=l>=0&&!Object.is(l,-0),h=M?Number(D?.[o]):0,d=M?Number(k?.[o]):l;let u=d;M&&(u=n[a][c?1:0]),F(o,r,s,h,d,u)}}}else{const t=e.invalidData?.get(this.id),i=y;let[s,a]=this.visibleRangeIndices("xValue",n.range);e.input.count<1e3&&(s=0,a=e.input.count);for(let e=s;e<a;e+=1){if(!0===t?.[e])continue;const s=I[e];if(null==s)continue;const n=C(e),a=Number(s);F(e,n,i,0,a,a)}}const V=tk(this.properties.segmentation,n,a,this.chart.seriesRect,this.ctx.scene);return{itemId:h,nodeData:z.length>0?[...z,...j]:j,labelData:B,scales:this.calculateScaling(),visible:this.visible||w,groupScale:this.getScaling(this.groupScale),styles:Cc(this.getItemStyle.bind(this)),segments:V}}nodeFactory(){return new dk}getHighlightData(t,e){const i=t.find(t=>t.datum===e.datum&&!t.phantom);return null==i?void 0:[{...i}]}updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,t=>this.getDatumId(t))}makeStylerParams(t,e){const{id:i}=this,{cornerRadius:s,fill:n,fillOpacity:a,lineDash:o,lineDashOffset:r,stackGroup:l,stroke:c,strokeOpacity:h,strokeWidth:d,xKey:u,yKey:p}=this.properties;return{cornerRadius:s,fill:n,fillOpacity:a,highlightState:dc(e??0),highlighted:t,lineDash:o,lineDashOffset:r,seriesId:i,stackGroup:l,stroke:c,strokeOpacity:h,strokeWidth:d,xKey:u,yKey:p}}makeItemStylerParams(t,e,i,s,n,a){const{id:o}=this,{xKey:r,yKey:l,stackGroup:c}=this.properties,h=e.dataSources.get(o)?.data?.[i],d=t.resolveColumnById(this,"yValue-raw",e)[i],u=t.getDomain(this,"xValue","key",e),p=t.getDomain(this,this.yCumulativeKey(t),"value",e),g=this.ctx.highlightManager?.getActiveHighlight(),m=this.getHighlightStateString(g,n,i),f=this.filterItemStylerFillParams(a.fill)??a.fill;return{seriesId:o,...Dc(s,d,r,l,u,p),datum:h,xValue:s,yValue:d,stackGroup:c,highlighted:n,highlightState:m,...a,fill:f}}getStyle(t,e,i){const{cornerRadius:s,fill:n,fillOpacity:a,lineDash:o,lineDashOffset:r,stroke:l,strokeOpacity:c,strokeWidth:h,styler:d}=this.properties;let u={};if(!t&&d){const t=this.makeStylerParams(e,i);u=this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],this.cachedCallWithContext(d,t)??{},{pick:!1})??{}}return{cornerRadius:u.cornerRadius??s,fill:u.fill??n,fillOpacity:u.fillOpacity??a,lineDash:u.lineDash??o,lineDashOffset:u.lineDashOffset??r,opacity:1,stroke:u.stroke??l,strokeOpacity:u.strokeOpacity??c,strokeWidth:u.strokeWidth??h}}getItemStyle(t,e,i){const{properties:s,dataModel:n,processedData:a}=this,{itemStyler:o}=s;let r=zs(this.getHighlightStyle(e,t,i),this.getStyle(void 0===t,e,i));if(o&&null!=n&&null!=a&&null!=t){const i=n.resolveKeysById(this,"xValue",a)[t],s=this.cachedDatumCallback(Wx(this.getDatumId({xValue:i,phantom:!1}),e?"highlight":"node"),()=>{const s=this.makeItemStylerParams(n,a,t,i,e,r);return this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],this.callWithContext(o,s))});s&&(r=zs(s,r))}return r}updateDatumStyles(t){const e=this.ctx.highlightManager.getActiveHighlight();t.datumSelection.each((i,s)=>{if(!t.datumSelection.isGarbage(i)){const i=this.getHighlightState(e,t.isHighlight,s.datumIndex);s.style=this.getItemStyle(s.datumIndex,t.isHighlight,i)}})}updateDatumNodes(t){const{contextNodeData:e}=this;if(!e)return;const i=this.ctx.highlightManager.getActiveHighlight(),{shadow:s}=this.properties,n="x"===this.getCategoryDirection(),a=this.getShapeFillBBox(),o=this.getBarDirection();t.datumSelection.each((r,l)=>{const c=l.style??e.styles[this.getHighlightState(i,t.isHighlight,l.datumIndex)];ag(r,c,a),r.drawingMode=t.drawingMode;const h=c.cornerRadius??0;r.topLeftCornerRadius=l.topLeftCornerRadius?h:0,r.topRightCornerRadius=l.topRightCornerRadius?h:0,r.bottomRightCornerRadius=l.bottomRightCornerRadius?h:0,r.bottomLeftCornerRadius=l.bottomLeftCornerRadius?h:0,r.visible=n?(l.clipBBox?.width??l.width)>0:(l.clipBBox?.height??l.height)>0,r.direction=o,r.featherRatio=l.featherRatio,r.crisp=l.crisp,r.fillShadow=s})}updateLabelSelection(t){const e=this.isLabelEnabled()?t.labelData:[];return t.labelSelection.update(e,t=>{t.pointerEvents=1})}updateLabelNodes(t){const{isHighlight:e=!1}=t,i={xKey:this.properties.xKey,xName:this.properties.xName??this.properties.xKey,yKey:this.properties.yKey,yName:this.properties.yName??this.properties.yKey,legendItemName:this.properties.legendItemName??this.properties.xName??this.properties.xKey},s=this.ctx.highlightManager?.getActiveHighlight();t.labelSelection.each((t,n)=>{t.fillOpacity=this.getHighlightStyle(e,n?.datumIndex).opacity??1,oI(this,t,i,this.properties.label,n.label,e,s)})}getTooltipContent(t){const{id:e,dataModel:i,processedData:s,properties:n}=this,{xKey:a,xName:o,yKey:r,yName:l,legendItemName:c,stackGroup:h,tooltip:d}=n,u=this.getCategoryAxis(),p=this.getValueAxis();if(!(i&&s&&u&&p))return;const g=s.dataSources.get(this.id)?.data?.[t],m=i.resolveKeysById(this,"xValue",s)[t],f=i.resolveColumnById(this,"yValue-raw",s)[t];if(null==m)return;const y=this.getItemStyle(t,!1);return this.formatTooltipWithContext(d,{heading:this.getAxisValueText(u,"tooltip",m,g,a,c),symbol:this.legendItemSymbol(),data:[{label:l,fallbackLabel:r,value:this.getAxisValueText(p,"tooltip",f,g,r,c)}]},{seriesId:e,datum:g,title:l,xKey:a,xName:o,yKey:r,yName:l,legendItemName:c,stackGroup:h,...y,...this.getModuleTooltipParams()})}legendItemSymbol(){const{fill:t,stroke:e,strokeWidth:i,fillOpacity:s,strokeOpacity:n,lineDash:a,lineDashOffset:o}=this.getStyle(!1,!1,0);return{marker:{fill:t??"rgba(0, 0, 0, 0)",stroke:e??"rgba(0, 0, 0, 0)",fillOpacity:s,strokeOpacity:n,strokeWidth:i,lineDash:a,lineDashOffset:o}}}getLegendData(t){const{showInLegend:e}=this.properties;if("category"!==t)return[];const{id:i,ctx:{legendManager:s},visible:n}=this,{yKey:a,yName:o,legendItemName:r}=this.properties;return[{legendType:"category",id:i,itemId:a,seriesId:i,enabled:n&&s.getItemEnabled({seriesId:i,itemId:a}),label:{text:r??o??a},symbol:this.legendItemSymbol(),legendItemName:r,hideInLegend:!e}]}animateEmptyUpdateReady({datumSelection:t,labelSelection:e,annotationSelections:i}){const s=Ik(Mk(this.isVertical(),this.axes,"normal"),"unknown");cd(this.id,"nodes",this.ctx.animationManager,[t],s),cI(this,"labels",this.ctx.animationManager,e),cI(this,"annotations",this.ctx.animationManager,...i)}animateWaitingUpdateReady(t){const{datumSelection:e,labelSelection:i,annotationSelections:s,contextData:n,previousContextData:a}=t;this.ctx.animationManager.stopByAnimationGroupId(this.id);const o=Ak(this.id,e,this.getDatumId.bind(this),t.contextData,a,this.processedData,this.processedDataUpdated),r=null==a?"fade":"normal",l=Ik(Mk(this.isVertical(),this.axes,r),"added");cd(this.id,"nodes",this.ctx.animationManager,[e],l,(t,e)=>this.getDatumId(e),o),o&&!o?.changed&&CD(n.groupScale,a?.groupScale)||(cI(this,"labels",this.ctx.animationManager,i),cI(this,"annotations",this.ctx.animationManager,...s))}getDatumId(t){return Wx(t.xValue,t.phantom)}isLabelEnabled(){return this.properties.label.enabled}computeFocusBounds({datumIndex:t}){const e=this.contextNodeData?.nodeData[t].clipBBox;return kk(this,e)}hasItemStylers(){return null!=this.properties.styler||null!=this.properties.itemStyler||null!=this.properties.label.itemStyler}};Nk.className="BarSeries",Nk.type="bar";var Lk={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"bar",moduleFactory:t=>new Nk(t),stackable:!0,groupable:!0,predictAxis:sk,defaultAxes:Um,themeTemplate:{zoom:{autoScaling:{enabled:{$and:[{$eq:[{$path:"../axes"},"x"]},{$not:{$eq:[{$path:"/series/0/direction"},"horizontal"]}}]}}},series:{direction:"vertical",fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",Xm],["image",hf],["pattern",of]]},stroke:{$palette:"stroke"},fillOpacity:1,strokeWidth:{$isUserOption:["./stroke",2,0]},lineDash:[0],lineDashOffset:0,label:{...mf,padding:{$isUserOption:["./spacing",0,8]},enabled:!1,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$if:[{$or:[{$eq:[{$path:"./placement"},"outside-start"]},{$eq:[{$path:"./placement"},"outside-end"]}]},{$ref:"textColor"},{$ref:"chartBackgroundColor"}]},placement:"inside-center"},shadow:{enabled:!1,color:dm,xOffset:3,yOffset:3,blur:5},errorBar:{cap:{lengthRatio:.3}},highlight:ff(),segmentation:bf}}},Tk={type:"series",name:"bar",chartType:"cartesian",options:Kb,create:t=>new Nk(t)};function Ek(t,e,i){const{xValues:s,yValues:n,xDomain:a,yDomain:o,xNeedsValueOf:r,yNeedsValueOf:l}=t,{x0:c,y0:h,x1:d,y1:u}=i;let p=0;for(const t of e){const e=s[t],i=n[t];if(null==e||null==i)continue;const g=yI(e,a.min,a.max,r),m=yI(i,o.min,o.max,l);g>=c&&g<=d&&m>=h&&m<=u&&(p+=1)}return p}function Ok(t,e,i){const{x0:s,y0:n,x1:a,y1:o}=i;let r=e.length<5&&a-s<.05&&o-n<.05||s===a&&n===o?null:function(t,e,i){const{xValues:s,yValues:n,xDomain:a,yDomain:o,xNeedsValueOf:r,yNeedsValueOf:l}=t,{x0:c,y0:h,x1:d,y1:u}=i,p=[{x0:1,y0:1,x1:0,y1:0,indices:[]},{x0:1,y0:1,x1:0,y1:0,indices:[]},{x0:1,y0:1,x1:0,y1:0,indices:[]},{x0:1,y0:1,x1:0,y1:0,indices:[]}],g=(c+d)/2,m=(h+u)/2;for(const t of e){const e=s[t],i=n[t];if(null==e||null==i)continue;const c=yI(e,a.min,a.max,r),h=yI(i,o.min,o.max,l),d=p[(c>g?1:0)+(h>m?2:0)];d.indices.push(t),d.x0=Math.min(d.x0,c),d.y0=Math.min(d.y0,h),d.x1=Math.max(d.x1,c),d.y1=Math.max(d.y1,h)}const f=[];for(const e of p){const{indices:i,x0:s,x1:n,y0:a,y1:o}=e;if(0===i.length)continue;const r=Ok(t,i,{x0:s,y0:a,x1:n,y1:o});f.push(r)}return f}(t,e,i);if(1===r?.length)return r[0];0===r?.length&&(r=null);const l=Math.hypot(a-s,o-n),c=function(t,e,i){const{xValues:s,yValues:n,xDomain:a,yDomain:o,xNeedsValueOf:r,yNeedsValueOf:l}=t,{x0:c,y0:h,x1:d,y1:u}=i;let p=0,g=1/0;const m=(c+d)/2,f=(h+u)/2;for(const t of e){const e=s[t],i=n[t];if(null==e||null==i)continue;const c=(yI(e,a.min,a.max,r)-m)**2+(yI(i,o.min,o.max,l)-f)**2;c<g&&(g=c,p=t)}return p}(t,e,i);return{scale:l,x0:s,y0:n,x1:a,y1:o,indices:e,primaryDatumIndex:c,children:r}}function Rk(t,e,i,s,n,a){const{xRange:o,yRange:r,xVisibleRange:[l,c],yVisibleRange:[h,d],minSize:u,maxSize:p}=i,{xValues:g,yValues:m,xd0:f,xd1:y,yd0:x,yd1:b,xNeedsValueOf:v,yNeedsValueOf:M}=e,S=1/Math.min(o/(c-l),r/(d-h)),I={xValues:g,yValues:m,xDomain:{min:f,max:y},yDomain:{min:x,max:b},xNeedsValueOf:v,yNeedsValueOf:M};for(const{sizeRatio:i,node:g}of e.filters){const e=.5*(u+i*(p-u)),m=e*S,f=t*m,y=l-e/o,x=c+e/o,b=h-e/r,v=d+e/r,M=[g];for(;M.length>0;){const e=M.pop();if(!(e.x1<y||e.x0>x||e.y1<b||e.y0>v))if(1!==t&&e.scale<=f)null!=s&&(s.count+=1),n?.push({datumIndex:e.primaryDatumIndex,count:e.indices.length,area:(e.x1-e.x0)*(e.y1-e.y0),dilation:C(1,e.scale/m,t)});else if(null==e.children){const{indices:t}=e;if(null!=s){const i=e.x0>=l&&e.x1<=c&&e.y0>=h&&e.y1<=d?t.length:Ek(I,t,{x0:l,y0:h,x1:c,y1:d});s.count+=i}a?.push(...t)}else M.push(...e.children)}}}function Pk(t,e,i){const s={count:0};return Rk(t,e,i,s,void 0,void 0),s.count}var zk=class extends DI{constructor(){super(...arguments),this.maxSize=30}};ls([ws,Xs()],zk.prototype,"maxSize",2),ls([ws,Js()],zk.prototype,"domain",2);var jk=class extends kd{constructor(){super(...arguments),this.placement="top"}};ls([ws],jk.prototype,"placement",2);var Bk=class extends FI{constructor(){super(...arguments),this.label=new jk,this.tooltip=wI(),this.maxRenderedItems=1/0,this.marker=new zk}};ls([ws],Bk.prototype,"xKey",2),ls([ws],Bk.prototype,"yKey",2),ls([ws],Bk.prototype,"sizeKey",2),ls([ws],Bk.prototype,"labelKey",2),ls([ws],Bk.prototype,"xFilterKey",2),ls([ws],Bk.prototype,"yFilterKey",2),ls([ws],Bk.prototype,"sizeFilterKey",2),ls([ws],Bk.prototype,"xName",2),ls([ws],Bk.prototype,"yName",2),ls([ws],Bk.prototype,"sizeName",2),ls([ws],Bk.prototype,"labelName",2),ls([ws],Bk.prototype,"title",2),ls([no("marker.shape")],Bk.prototype,"shape",2),ls([no("marker.size")],Bk.prototype,"size",2),ls([no("marker.maxSize")],Bk.prototype,"maxSize",2),ls([no("marker.domain")],Bk.prototype,"domain",2),ls([no("marker.fill")],Bk.prototype,"fill",2),ls([no("marker.fillOpacity")],Bk.prototype,"fillOpacity",2),ls([no("marker.stroke")],Bk.prototype,"stroke",2),ls([no("marker.strokeWidth")],Bk.prototype,"strokeWidth",2),ls([no("marker.strokeOpacity")],Bk.prototype,"strokeOpacity",2),ls([no("marker.lineDash")],Bk.prototype,"lineDash",2),ls([no("marker.lineDashOffset")],Bk.prototype,"lineDashOffset",2),ls([no("marker.itemStyler")],Bk.prototype,"itemStyler",2),ls([ws],Bk.prototype,"styler",2),ls([ws],Bk.prototype,"label",2),ls([ws],Bk.prototype,"tooltip",2),ls([ws],Bk.prototype,"maxRenderedItems",2);var Fk=class extends BI{constructor(t,e,i,s){super(t,e,i,s),this.sizeKey=s.properties.sizeKey}},Vk=class extends GI{constructor(t){super({moduleCtx:t,propertyKeys:{...zI,label:["labelKey"],size:["sizeKey"]},propertyNames:{...jI,label:["labelName"],size:["sizeName"]},categoryKey:void 0,pickModes:[2,1,0],pathsPerSeries:[],datumSelectionGarbageCollection:!1,animationResetFns:{label:dI,datum:UD},usesPlacedLabels:!0,clipFocusBox:!1}),this.NodeEvent=Fk,this.properties=new Bk,this.dataAggregation=void 0,this.sizeScale=new gb}get pickModeAxis(){return"main-category"}get type(){return super.type}get hasData(){return this.getHasData("xValue")}async processData(t){if(null==this.data||!this.visible)return;const e=this.axes.x?.scale,i=this.axes.y?.scale,{xScaleType:s,yScaleType:n}=this.getScaleInformation({xScale:e,yScale:i}),a=this.sizeScale.type,{xKey:o,yKey:r,sizeKey:l,xFilterKey:c,yFilterKey:h,sizeFilterKey:d,labelKey:u,marker:p}=this.properties,{dataModel:g,processedData:m}=await this.requestDataModel(t,this.data,{props:[Ix(o,s,{id:"xValue"}),Ix(r,n,{id:"yValue"}),...null==c?[]:[Ix(c,s,{id:"xFilterValue"})],...null==h?[]:[Ix(h,n,{id:"yFilterValue"})],...null==d?[]:[Ix(d,a,{id:"sizeFilterValue"})],...l?[Ix(l,a,{id:"sizeValue"})]:[],...u?[Ix(u,"category",{id:"labelValue"})]:[]]}),f=l?g.resolveProcessedDataIndexById(this,"sizeValue"):void 0,y=p.domain?[p.domain[0],p.domain[1]]:void 0;this.sizeScale.domain=y??(null==f?void 0:m.domain.values[f])??[],this.dataAggregation=this.aggregateData(g,m),this.animationState.transition("updateData")}xCoordinateRange(t,e,i){const{properties:s,sizeScale:n}=this,{size:a,sizeKey:o}=s,r=this.axes.x.scale.convert(t),l=null==o?void 0:this.dataModel.resolveColumnById(this,"sizeValue",this.processedData),c=.5*(null==l?a:n.convert(l[i]))*e;return[r-c,r+c]}yCoordinateRange(t,e,i){const{properties:s,sizeScale:n}=this,{size:a,sizeKey:o}=s,r=this.axes.y.scale.convert(t[0]),l=null==o?void 0:this.dataModel.resolveColumnById(this,"sizeValue",this.processedData),c=.5*(null==l?a:n.convert(l[i]))*e;return[r-c,r+c]}getSeriesDomain(t){const{dataModel:e,processedData:i}=this;if(!i||!e)return[];const s={x:"xValue",y:"yValue"},n=s[t],a=e.resolveProcessedDataDefById(this,n),o=e.getDomain(this,n,"value",i);if("value"===a?.def.type&&"category"===a?.def.valueType)return o;const r=s["x"===t?"y":"x"];return Ph(rx(this.domainForClippedRange(t,[n],r)))}getSeriesRange(t,e){return this.domainForVisibleRange("y",["yValue"],"xValue",e)}getVisibleItems(t,e,i){const{dataAggregation:s,axes:n}=this,a=n.x,o=n.y;return null==s||null==a||null==o?this.countVisibleItems("xValue",["yValue"],t,e,i):Pk(0,s,this.aggregationOptions(a,o,t,e??[0,1]))}aggregateData(t,e){if("grouped"===e.type)return;if(e.input.count<=this.properties.maxRenderedItems)return;const i=this.axes.x,s=this.axes.y;if(null==i||null==s)return;const n=i.scale,a=s.scale;if(!$c.is(n)||!$c.is(a))return;const{sizeScale:o,properties:r}=this,{sizeKey:l}=r,c=t.resolveColumnById(this,"xValue",e),h=t.resolveColumnById(this,"yValue",e),d=l?t.resolveColumnById(this,"sizeValue",e):void 0,u=t.getDomain(this,"xValue","value",e),p=t.getDomain(this,"yValue","value",e),g=l?o.domain:[0,0],m=t.resolveColumnNeedsValueOf(this,"xValue",e),f=t.resolveColumnNeedsValueOf(this,"yValue",e);return function(t,e,i,s,n,a,o,r,l,c){const[h,d]=mI(t,a),[u,p]=mI(e,o),[g,m]=r,f={xValues:i,yValues:s,xDomain:{min:h,max:d},yDomain:{min:u,max:p},xNeedsValueOf:l,yNeedsValueOf:c},y=[];if(null!=n&&m>g){const t=Array.from({length:3},()=>[]);for(let e=0;e<n.length;e+=1){const i=(n[e]-g)/(m-g),s=Math.trunc(3*i);s>=0&&s<3&&t[s].push(e)}for(let e=0;e<t.length;e+=1){const i=Ok(f,t[e],{x0:0,y0:0,x1:1,y1:1});if(null!=i){const t=e/3;y.push({sizeRatio:t,node:i})}}}else{const t=Ok(f,i.map((t,e)=>e),{x0:0,y0:0,x1:1,y1:1});null!=t&&y.push({sizeRatio:0,node:t})}return y.length>0?{xValues:i,yValues:s,xd0:h,xd1:d,yd0:u,yd1:p,filters:y,xNeedsValueOf:l,yNeedsValueOf:c}:void 0}(n.type,a.type,c,h,d,u,p,g,m,f)}aggregationOptions(t,e,i=t.visibleRange,s=e.visibleRange){const{processedData:n,dataModel:a}=this,{sizeKey:o}=this.properties,[r,l]=this.getSizeRange(),c=Math.abs(t.range[1]-t.range[0]),h=Math.abs(e.range[1]-e.range[0]),d=Math.max(r,1),u=o?Math.max(l,1):d,p=t.scale,g=e.scale;return null!=n&&null!=a&&($c.is(p)&&(i=_u(i,p.domain.map(Ou),a.getDomain(this,"xValue","value",n).map(Ou))),$c.is(g)&&(s=_u(s,g.domain.map(Ou),a.getDomain(this,"yValue","value",n).map(Ou)))),{xRange:c,yRange:h,minSize:d,maxSize:u,xVisibleRange:i,yVisibleRange:s}}createNodeData(){const{axes:t,dataModel:e,processedData:i,sizeScale:s,visible:n}=this,{xKey:a,yKey:o,sizeKey:r,xFilterKey:l,yFilterKey:c,sizeFilterKey:h,labelKey:d,xName:u,yName:p,sizeName:g,labelName:m,label:f,legendItemName:y,marker:x,maxRenderedItems:b}=this.properties,{enabled:v,placement:M}=f,S=Ig.anchor(x.shape),I=t.x,D=t.y;if(!(e&&i&&I&&D))return;const k=!this.ctx.animationManager.isSkipped(),A=e.resolveColumnById(this,"xValue",i),w=e.resolveColumnById(this,"yValue",i),C=null==r?void 0:e.resolveColumnById(this,"sizeValue",i),N=null==d?void 0:e.resolveColumnById(this,"labelValue",i),L=null==l?void 0:e.resolveColumnById(this,"xFilterValue",i),T=null==c?void 0:e.resolveColumnById(this,"yFilterValue",i),E=null==h?void 0:e.resolveColumnById(this,"sizeFilterValue",i);let O;O=d?[]:r?e.getDomain(this,"sizeValue","value",i):[];const R=I.scale,P=D.scale,z=(R.bandwidth??0)/2,j=(P.bandwidth??0)/2,B=[];s.range=this.getSizeRange();const F=Xi(f),V=i.dataSources.get(this.id)?.data;if(null==V)return;const $=Ad(f),H=(t,e,i,n)=>{const l=V[t],c=A[t],h=w[t],b=C?.[t],I=R.convert(c)+z,D=P.convert(h)+j;let k,H;if(null!=L&&null!=T&&(k=L[t]===c&&T[t]===h,null!=E&&k&&(k=E[t]===b)),v){let e,i,s;d&&N?(e=N[t],i=d,s="label"):r?(e=b,i=r,s="size"):(e=h,i=o,s="y");const n=this.getLabelText(e,l,i,s,O,f,{value:e,datum:l,xKey:a,yKey:o,sizeKey:r,labelKey:d,xName:u,yName:p,sizeName:g,labelName:m,legendItemName:y});let{width:c,height:x}=G(n)?Qi(n,f):F.measureLines(String(n));c+=$.left+$.right,x+=$.bottom+$.top,H={text:n,width:c,height:x}}else H={text:"",width:0,height:0};const U=null==b?s.range[0]:s.convert(b),W={x:I,y:D,size:Math.sqrt(i)*U};B.push({series:this,itemId:o,yKey:o,xKey:a,datum:l,datumIndex:t,xValue:c,yValue:h,sizeValue:b,capDefaults:{lengthRatioMultiplier:x.getDiameter(),lengthMax:1/0},point:W,midPoint:{x:I,y:D},label:H,anchor:S,placement:M,count:e,dilation:i,area:n,selected:k})},{dataAggregation:U}=this;if(n)if(null==U)for(let t=0;t<V.length;t++)H(t,1,1,0);else{const t=this.aggregationOptions(I,D),e=function(t,e,i){if(Pk(1,t,e)<=i)return 1;let s=1,n=2;for(;Pk(n,t,e)>i&&n<100;)s*=2,n*=2;for(let a=0;a<12;a+=1){const a=(n+s)/2;Pk(a,t,e)>i?s=a:n=a}return(s+n)/2}(U,t,b),{groupedAggregation:i,singleDatumIndices:s}=function(t,e,i){const s=[],n=[];return Rk(t,e,i,void 0,s,n),{groupedAggregation:s,singleDatumIndices:n}}(e,U,t);for(const{datumIndex:t,count:e,dilation:s,area:n}of i)H(t,e,s,n);for(const t of s)H(t,1,1,0)}return{itemId:o,nodeData:B,labelData:v?B:[],scales:this.calculateScaling(),visible:this.visible||k,styles:KD(this,this.properties,x)}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}getLabelData(){return this.isLabelEnabled()?this.contextNodeData?.labelData??[]:[]}updateDatumSelection(t){const{nodeData:e,datumSelection:i}=t,{sizeKey:s}=this.properties;let n;return this.properties.marker.isDirty()&&(i.clear(),i.cleanup()),s&&(n=t=>Wx(t.xValue,t.yValue,t.sizeValue,At(t.label.text))),i.update(e,void 0,n)}updateDatumStyles(t){const{datumSelection:e,isHighlight:i}=t,{xKey:s,yKey:n,sizeKey:a,labelKey:o,marker:r}=this.properties,l={xKey:s,yKey:n,sizeKey:a,labelKey:o},c=this.ctx.highlightManager.getActiveHighlight();e.each((s,n)=>{if(!e.isGarbage(s)){const e=this.getHighlightState(c,t.isHighlight,n.datumIndex),s=this.getStyle(t.isHighlight,e);n.style=this.getMarkerStyle(r,n,l,{isHighlight:i,highlightState:e,resolveMarkerSubPath:[]},s)}})}updateDatumNodes(t){const{contextNodeData:e}=this;if(!e)return;const{datumSelection:i,isHighlight:s,drawingMode:n}=t;this.sizeScale.range=this.getSizeRange();const a=this.getShapeFillBBox(),o=null!=this.dataAggregation,r=this.ctx.highlightManager.getActiveHighlight();i.each((t,i,l)=>{const{point:{size:c},count:h,area:d,dilation:u}=i;let p=i.style??e.styles[this.getHighlightState(r,s,i.datumIndex)];if(p={...p},p.size=c,u>1){const t=p.fillOpacity??0,e=.269669+683e-6*h+-37.534348*d+.004449*h*d+-0*h**2+44.428603*d**2;p.fillOpacity=C(t/u,t/.1*e,1)}this.applyMarkerStyle(p,t,i.point,a,{selected:i.selected}),t.drawingMode=n,t.zIndex=o?[-h,l]:0}),s||this.properties.marker.markClean()}updatePlacedLabelData(t){this.labelSelection.update(t.map(t=>({...t.datum,point:{x:t.x,y:t.y,size:t.datum.point.size}})),t=>{t.pointerEvents=1}),this.updateLabelNodes({labelSelection:this.labelSelection})}updateLabelNodes(t){const{isHighlight:e=!1}=t,i=this.ctx.highlightManager?.getActiveHighlight(),s=this.makeLabelFormatterParams();t.labelSelection.each((t,n)=>{const a=aI(this,n,s,this.properties.label,e,i);t.text=n.label.text,t.fill=a.color,t.x=n.point?.x??0,t.y=n.point?.y??0,t.fontStyle=a.fontStyle,t.fontWeight=a.fontWeight,t.fontSize=a.fontSize,t.fontFamily=a.fontFamily,t.textBaseline="top",t.fillOpacity=this.getHighlightStyle(e,n.datumIndex).opacity??1,t.setBoxing(a)})}makeStylerParams(t,e){const{id:i,properties:{size:s,maxSize:n,shape:a,fill:o,fillOpacity:r,lineDash:l,lineDashOffset:c,stroke:h,strokeOpacity:d,strokeWidth:u,xKey:p,yKey:g,sizeKey:m,labelKey:f}}=this,y=dc(e??0);return"bubble"===this.type?{highlightState:y,highlighted:t,size:s,maxSize:n,shape:a,fill:o,fillOpacity:r,lineDash:l,lineDashOffset:c,seriesId:i,sizeKey:m,stroke:h,strokeOpacity:d,strokeWidth:u,xKey:p,yKey:g,labelKey:f}:"scatter"===this.type?{highlightState:y,highlighted:t,size:s,shape:a,fill:o,fillOpacity:r,lineDash:l,lineDashOffset:c,seriesId:i,stroke:h,strokeOpacity:d,strokeWidth:u,xKey:p,yKey:g,labelKey:f}:this.type}makeLabelFormatterParams(){const{xKey:t,xName:e,yKey:i,yName:s,sizeKey:n,sizeName:a,labelKey:o,labelName:r,legendItemName:l}=this.properties;return{xKey:t,xName:e,yKey:i,yName:s,sizeKey:n,sizeName:a,labelKey:o,labelName:r,legendItemName:l}}getTooltipContent(t){const{id:e,dataModel:i,processedData:s,axes:n,properties:a,ctx:o}=this,{formatManager:r}=o,{xKey:l,xName:c,yKey:h,yName:d,sizeKey:u,sizeName:p,labelKey:g,labelName:m,title:f,tooltip:y,marker:x,legendItemName:b}=a,v=n.x,M=n.y;if(!(i&&s&&v&&M))return;const S=s.dataSources.get(this.id)?.data?.[t],I=i.resolveColumnById(this,"xValue",s)[t],D=i.resolveColumnById(this,"yValue",s)[t];if(null==I)return;const k=[];if(this.isLabelEnabled()&&null!=g){const n=i.resolveColumnById(this,"labelValue",s)[t],a=r.format(this.callWithContext.bind(this),{type:"category",value:n,datum:S,seriesId:e,legendItemName:b,key:g,source:"tooltip",property:"label",domain:[],boundSeries:this.getFormatterContext("label")});k.push({label:m,fallbackLabel:g,value:a??Zr(n)})}if(k.push({label:c,fallbackLabel:l,value:this.getAxisValueText(v,"tooltip",I,S,l,b)},{label:d,fallbackLabel:h,value:this.getAxisValueText(M,"tooltip",D,S,h,b)}),null!=u){const n=i.resolveColumnById(this,"sizeValue",s)[t],a=i.getDomain(this,"sizeValue","value",s),o=r.format(this.callWithContext.bind(this),{type:"number",value:n,datum:S,seriesId:e,legendItemName:b,key:u,source:"tooltip",property:"size",boundSeries:this.getFormatterContext("size"),domain:a,fractionDigits:void 0});k.push({label:p,fallbackLabel:u,value:o??Zr(n)})}const A=this.getMarkerStyle(x,{datum:S,datumIndex:t},{xKey:l,yKey:h,sizeKey:u,labelKey:g,highlighted:!0},{resolveMarkerSubPath:[]});return this.formatTooltipWithContext(y,{title:f,symbol:this.legendItemSymbol(),data:k},{seriesId:e,datum:S,title:h,xKey:l,xName:c,yKey:h,yName:d,sizeKey:u,sizeName:p,labelKey:g,labelName:m,legendItemName:b,...A,...this.getModuleTooltipParams()})}legendItemSymbol(){const t=this.getStyle(!1);return{marker:this.getMarkerStyle(this.properties.marker,{},void 0,{isHighlight:!1,checkForHighlight:!1,resolveMarkerSubPath:[]},t)}}getLegendData(){const{id:t,ctx:{legendManager:e},visible:i}=this,{yKey:s,yName:n,legendItemName:a,title:o,showInLegend:r}=this.properties;return[{legendType:"category",id:t,itemId:s,seriesId:t,enabled:i&&e.getItemEnabled({seriesId:t,itemId:s}),label:{text:a??o??n??s},symbol:this.legendItemSymbol(),legendItemName:a,hideInLegend:!r}]}animateEmptyUpdateReady({datumSelection:t,labelSelection:e}){$D(this,this.ctx.animationManager,t),cI(this,"labels",this.ctx.animationManager,e)}isLabelEnabled(){return this.properties.label.enabled}nodeFactory(){return new Ig}getStyle(t,e){const{properties:i}=this;let s={};if(i.styler){const n=this.makeStylerParams(t,e),a=this.cachedCallWithContext(i.styler,n)??{};s=this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],a,{pick:!1})??{}}return{fill:s.fill??i.fill,fillOpacity:s.fillOpacity??i.fillOpacity,lineDash:s.lineDash??i.lineDash,lineDashOffset:s.lineDashOffset??i.lineDashOffset,shape:s.shape??i.shape,size:s.size??i.size,maxSize:s.maxSize??i.maxSize,stroke:s.stroke??i.stroke,strokeOpacity:s.strokeOpacity??i.strokeOpacity,strokeWidth:s.strokeWidth??i.strokeWidth}}getSizeRange(){const{size:t,maxSize:e}=this.getStyle(!1);return[t,e]}getFormattedMarkerStyle(t){const{xKey:e,yKey:i,sizeKey:s,labelKey:n,marker:a}=this.properties;return this.getMarkerStyle(a,t,{xKey:e,yKey:i,sizeKey:s,labelKey:n},{resolveMarkerSubPath:[]})}computeFocusBounds(t){return _D(this,t)}hasItemStylers(){const{styler:t,itemStyler:e,marker:i,label:s}=this.properties;return!!(t??e??i.itemStyler??s.itemStyler)}initQuadTree(t){uk(t,this.datumNodesIter())}pickNodeDataClosestDatum(t){return pk(this,t)}};Vk.className="BubbleSeries",Vk.type="bubble";var Gk={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"bubble",moduleFactory:t=>new Vk(t),predictAxis:ik,defaultAxes:[{type:"number",position:"bottom"},{type:"number",position:"left"}],themeTemplate:{series:{shape:"circle",size:7,maxSize:30,fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",ef],["image",hf],["pattern",of]]},stroke:{$palette:"stroke"},fillOpacity:.8,maxRenderedItems:1e4,label:{...mf,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},tooltip:{range:{$path:["/tooltip/range","nearest"]},position:{anchorTo:{$path:["/tooltip/position/anchorTo","node"]}}},highlight:ff()}}},$k={type:"series",name:"bubble",chartType:"cartesian",options:Xb,create:t=>new Vk(t)},Hk=class extends FI{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.areaPlot=!1,this.aggregation="sum",this.shadow=new II,this.label=new kd,this.tooltip=wI()}getStyle(){const{fill:t,fillOpacity:e,stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:a,lineDashOffset:o,cornerRadius:r}=this;return{fill:t,fillOpacity:e,stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:a,lineDashOffset:o,cornerRadius:r,opacity:1}}};ls([ws],Hk.prototype,"xKey",2),ls([ws],Hk.prototype,"yKey",2),ls([ws],Hk.prototype,"xName",2),ls([ws],Hk.prototype,"yName",2),ls([ws],Hk.prototype,"fill",2),ls([ws],Hk.prototype,"fillOpacity",2),ls([ws],Hk.prototype,"stroke",2),ls([ws],Hk.prototype,"strokeWidth",2),ls([ws],Hk.prototype,"strokeOpacity",2),ls([ws],Hk.prototype,"lineDash",2),ls([ws],Hk.prototype,"lineDashOffset",2),ls([ws],Hk.prototype,"cornerRadius",2),ls([ws],Hk.prototype,"areaPlot",2),ls([ws],Hk.prototype,"bins",2),ls([ws],Hk.prototype,"aggregation",2),ls([ws],Hk.prototype,"binCount",2),ls([ws],Hk.prototype,"shadow",2),ls([ws],Hk.prototype,"label",2),ls([ws],Hk.prototype,"tooltip",2);var Uk=class extends GI{constructor(t){super({moduleCtx:t,propertyKeys:zI,propertyNames:jI,categoryKey:void 0,pickModes:[1,0],datumSelectionGarbageCollection:!0,animationResetFns:{datum:Dk,label:dI}}),this.properties=new Hk,this.calculatedBins=[]}get hasData(){return this.calculatedBins.length>0}deriveBins(t){const e=qu(t[0],t[1],10).ticks,i=sp(t[0],t[1],10),[s]=e;return[[s-i,s],...e.map(t=>[t,t+i])]}calculateNiceBins(t,e){const i=Math.floor(t[0]),s=t[1],n=e||1,{start:a,binSize:o}=this.calculateNiceStart(i,s,n);return this.getBins(a,s,o,n)}getBins(t,e,i,s){const n=[],a=this.calculatePrecision(i);for(let o=0;o<s;o++){const r=Math.round((t+o*i)*a)/a;let l=Math.round((t+(o+1)*i)*a)/a;o===s-1&&(l=Math.max(l,e)),n[o]=[r,l]}return n}calculatePrecision(t){let e=10;if(Number.isFinite(t)&&t>0)for(;t<1;)e*=10,t*=10;return e}calculateNiceStart(t,e,i){const s=Math.abs(e-t)/i,n=Math.floor(Math.log10(s)),a=Math.pow(10,n);return{start:Math.floor(t/a)*a,binSize:s}}async processData(t){const{visible:e}=this,{xKey:i,yKey:s,areaPlot:n,aggregation:a}=this.properties,o=this.axes.x?.scale,r=this.axes.y?.scale,{xScaleType:l,yScaleType:c}=this.getScaleInformation({yScale:r,xScale:o}),h=e?{}:{forceValue:0},d=[Sx(i,l),Ox];if(s){let t=ux("groupAgg",{visible:e});"count"===a||("sum"===a?t=dx("groupAgg",{visible:e}):"mean"===a&&(t=px("groupAgg",{visible:e}))),n&&(t=gx("groupAgg",t)),d.push(Ix(s,c,{invalidValue:void 0,...h}),t)}else{d.push(Dx("count"));let t=ux("groupAgg",{visible:e});n&&(t=gx("groupAgg",t)),d.push(t)}let u=[];const{dataModel:p,processedData:g}=await this.requestDataModel(t,this.data,{props:d,groupByFn:t=>{const e=Ph(t.domain.keys[0]);if(0===e.length)return t.domain.groups=[],()=>[];const i=X(this.properties.binCount)?this.calculateNiceBins(e,this.properties.binCount):this.properties.bins??this.deriveBins(e),s=i.length;return u=[...i],t=>{let e=t[0];if($(e)&&(e=e.getTime()),!X(e))return[];for(let t=0;t<s;t++){const n=i[t];if(e>=n[0]&&e<n[1])return n;if(t===s-1&&e<=n[1])return n}return[]}}}),m=g,f=new Map;for(const[t,e]of m.groups.entries()){const i=e.keys;f.set(Wx(...i),{group:e,groupIndex:t})}this.calculatedBins=u.map(t=>{const e=f.get(Wx(...t));if(e){const{group:i,groupIndex:s}=e,[[n,a]=[0,0]]=i.aggregation;return{domain:t,datum:[...p.forEachDatum(this,m,i,s)],groupIndex:s,frequency:this.frequency(i),total:n+a}}return{domain:t,datum:[],groupIndex:-1,frequency:0,total:0}}),this.animationState.transition("updateData")}xCoordinateRange(){return[Number.NaN,Number.NaN]}yCoordinateRange(){return[Number.NaN,Number.NaN]}getSeriesDomain(t){const{processedData:e,dataModel:i}=this;if(!e||!i||!this.calculatedBins.length)return[];const s=i.getDomain(this,"groupAgg","aggregate",e),n=this.calculatedBins[0].domain[0],a=this.calculatedBins[(this.calculatedBins?.length??0)-1].domain[1];return Ph("x"===t?[n,a]:s)}getSeriesRange(t,[e,i]){const{dataModel:s,processedData:n}=this;if(!s||"grouped"!==n?.type)return[Number.NaN,Number.NaN];const a=this.axes.x.scale;let o=-1/0;for(const{keys:t,aggregation:s}of n.groups){const[[n,r]=[0,0]]=s,[l,c]=t,[h,d]=jc([a.convert(l),a.convert(c)]);if(d>=e&&h<=i){const t=n+r;o=Math.max(o,t)}}return 0>o?[Number.NaN,Number.NaN]:[0,o]}frequency(t){return t.datumIndices.reduce((t,e)=>t+e.length,0)}createNodeData(){const{axes:t,processedData:e,dataModel:i}=this,s=t.x,n=t.y;if(!s||!n||!i)return;const{scale:a}=s,{scale:o}=n,{xKey:r,yKey:l,xName:c,yName:h,label:d}=this.properties,u=!this.ctx.animationManager.isSkipped(),p=[],g={itemId:this.properties.yKey??this.id,nodeData:p,labelData:p,scales:this.calculateScaling(),animationValid:!0,visible:this.visible||u,styles:Cc(this.getItemStyle.bind(this))};if(null==e||"grouped"!==e.type)return g;for(const{domain:t,datum:e,groupIndex:i,frequency:s,total:u}of this.calculatedBins){const[g,m]=t,f=a.convert(g),y=a.convert(m),x=o.convert(0),b=o.convert(u),v=Math.abs(y-f),M=Math.abs(b-x),S=Math.min(f,y),I=Math.min(x,b);let D;d.enabled&&0!==u&&(D={x:S+v/2,y:I+M/2,text:this.getLabelText(u,e,l,"y",[],d,{value:u,datum:e,xKey:r,yKey:l,xName:c,yName:h})});const k={x:S+v/2,y:I+M/2},A=n.isReversed();p.push({series:this,datumIndex:i,datum:e,aggregatedValue:u,frequency:s,domain:t,yKey:l,xKey:r,x:S,y:I,xValue:f,yValue:b,width:v,height:M,midPoint:k,topLeftCornerRadius:!A,topRightCornerRadius:!A,bottomRightCornerRadius:A,bottomLeftCornerRadius:A,label:D,crisp:!0})}return p.sort((t,e)=>t.x-e.x),g}nodeFactory(){return new Uo}updateDatumSelection(t){const{nodeData:e,datumSelection:i}=t;return i.update(e,void 0,t=>Wx(...t.domain))}getItemStyle(t,e,i){const{properties:s}=this;return zs(this.getHighlightStyle(e,t,i),s.getStyle())}updateDatumStyles(t){const{datumSelection:e,isHighlight:i}=t;e.each((t,s)=>{e.isGarbage(t)||(s.style=this.getItemStyle(s.datumIndex,i))})}updateDatumNodes(t){const{contextNodeData:e}=this;if(!e)return;const i=this.ctx.highlightManager.getActiveHighlight(),{shadow:s}=this.properties,n=this.getShapeFillBBox();t.datumSelection.each((a,o)=>{const r=o.style??e.styles[this.getHighlightState(i,t.isHighlight,o.datumIndex)],{cornerRadius:l=0}=r,{topLeftCornerRadius:c,topRightCornerRadius:h,bottomRightCornerRadius:d,bottomLeftCornerRadius:u}=o;ag(a,r,n),a.topLeftCornerRadius=c?l:0,a.topRightCornerRadius=h?l:0,a.bottomRightCornerRadius=d?l:0,a.bottomLeftCornerRadius=u?l:0,a.crisp=o.crisp,a.fillShadow=s})}updateLabelSelection(t){const{labelData:e,labelSelection:i}=t;return i.update(e,t=>{t.pointerEvents=1,t.textAlign="center",t.textBaseline="middle"})}updateLabelNodes(t){const e=this.isLabelEnabled(),i=this.ctx.highlightManager?.getActiveHighlight();t.labelSelection.each((t,s)=>{const n=aI(this,s,this.properties,this.properties.label,!1,i),{enabled:a,fontStyle:o,fontWeight:r,fontSize:l,fontFamily:c,color:h}=n;a&&e&&s?.label?(t.text=s.label.text,t.x=s.label.x,t.y=s.label.y,t.fontStyle=o,t.fontWeight=r,t.fontFamily=c,t.fontSize=l,t.fill=h,t.visible=!0,t.fillOpacity=this.getHighlightStyle(!1,s.datumIndex).opacity??1,t.setBoxing(n)):t.visible=!1})}initQuadTree(t){const{value:e}=this.contentGroup.children().next();e instanceof Oa&&uk(t,e.children())}pickNodeClosestDatum(t){return pk(this,t)}getTooltipContent(t){const{id:e,dataModel:i,processedData:s,axes:n,properties:a,ctx:{localeManager:o}}=this,{xKey:r,xName:l,yKey:c,yName:h,tooltip:d,legendItemName:u}=a,p=n.x,g=n.y;if(!i||"grouped"!==s?.type||!p||!g)return;const m=s.groups[t],{aggregation:f,keys:y}=m,[[x,b]=[0,0]]=f,v=this.frequency(m),M=y,[S,I]=M,D=x+b,k={data:[...i.forEachDatum(this,s,m,t)],aggregatedValue:D,frequency:v,domain:M},A=[{label:l,fallbackLabel:r,value:`${this.getAxisValueText(p,"tooltip",S,k,r,u)} - ${this.getAxisValueText(p,"tooltip",I,k,r,u)}`},{label:o.t("seriesHistogramTooltipFrequency"),value:this.getAxisValueText(g,"tooltip",v,k,c,u)}];if(null!=c){let t;switch(a.aggregation){case"sum":t=o.t("seriesHistogramTooltipSum",{yName:h??c});break;case"mean":t=o.t("seriesHistogramTooltipMean",{yName:h??c});break;case"count":t=o.t("seriesHistogramTooltipCount",{yName:h??c})}A.push({label:t,value:this.getAxisValueText(g,"tooltip",D,k,c,u)})}return this.formatTooltipWithContext(d,{symbol:this.legendItemSymbol(),data:A},{seriesId:e,datum:k,title:h,xKey:r,xName:l,yKey:c,yName:h,xRange:[S,I],frequency:v,...this.getItemStyle(t,!1)})}legendItemSymbol(){const{fill:t,fillOpacity:e,stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:a,lineDashOffset:o}=this.properties;return{marker:{fill:Xa(t)??"rgba(0, 0, 0, 0)",stroke:i??"rgba(0, 0, 0, 0)",fillOpacity:e,strokeOpacity:n,strokeWidth:s,lineDash:a,lineDashOffset:o}}}getLegendData(t){if("category"!==t)return[];const{id:e,ctx:{legendManager:i},visible:s}=this,{xKey:n,yName:a,showInLegend:o}=this.properties;return[{legendType:"category",id:e,itemId:n,seriesId:e,enabled:s&&i.getItemEnabled({seriesId:e,itemId:n}),label:{text:a??n??"Frequency"},symbol:this.legendItemSymbol(),hideInLegend:!o}]}animateEmptyUpdateReady({datumSelection:t,labelSelection:e}){const i=Ik(Mk(!0,this.axes,"normal"),"unknown");cd(this.id,"datums",this.ctx.animationManager,[t],i),cI(this,"labels",this.ctx.animationManager,e)}animateWaitingUpdateReady(t){const e=Ik(Mk(!0,this.axes,"normal"),"added"),i={changed:!0,added:new Set,updated:new Set,removed:new Set,moved:new Set};cd(this.id,"datums",this.ctx.animationManager,[t.datumSelection],e,(t,e)=>Wx(...e.domain),i),i?.changed&&cI(this,"labels",this.ctx.animationManager,t.labelSelection)}isLabelEnabled(){return this.properties.label.enabled}computeFocusBounds({datumIndex:t}){return kk(this,this.contextNodeData?.nodeData[t])}hasItemStylers(){return null!=this.properties.label.itemStyler}};Uk.className="HistogramSeries",Uk.type="histogram";var Wk={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"histogram",moduleFactory:t=>new Uk(t),predictAxis:sk,defaultAxes:[{type:"number",position:"bottom"},{type:"number",position:"left"}],themeTemplate:{series:{fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",Xm],["image",hf],["pattern",of]]},stroke:{$palette:"stroke"},strokeWidth:1,fillOpacity:1,strokeOpacity:1,lineDash:[0],lineDashOffset:0,label:{...mf,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"chartBackgroundColor"}},shadow:{enabled:!1,color:dm,xOffset:3,yOffset:3,blur:5},highlight:ff()}}},_k={type:"series",name:"histogram",chartType:"cartesian",enterprise:!0,options:qb,create:t=>new Uk(t)};function Yk(t,e,i,s,n,a,o,r){const l=t[a];if(null==l)return!1;const c=xI(Number.isFinite(e)?yI(l,e,i,o):fI(a,r),n);return a===s[c+0]||a===s[c+1]||a===s[c+2]||a===s[c+3]}var Kk=class extends FI{constructor(){super(...arguments),this.stroke="#874349",this.strokeWidth=2,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.interpolation=new $I,this.marker=new DI,this.label=new kd,this.tooltip=wI(),this.connectMissingData=!1,this.sparklineMode=!1}};ls([ws],Kk.prototype,"xKey",2),ls([ws],Kk.prototype,"yKey",2),ls([ws],Kk.prototype,"xName",2),ls([ws],Kk.prototype,"yName",2),ls([ws],Kk.prototype,"yFilterKey",2),ls([ws],Kk.prototype,"stackGroup",2),ls([ws],Kk.prototype,"normalizedTo",2),ls([ws],Kk.prototype,"title",2),ls([ws],Kk.prototype,"stroke",2),ls([ws],Kk.prototype,"strokeWidth",2),ls([ws],Kk.prototype,"strokeOpacity",2),ls([ws],Kk.prototype,"lineDash",2),ls([ws],Kk.prototype,"lineDashOffset",2),ls([ws],Kk.prototype,"interpolation",2),ls([ws],Kk.prototype,"styler",2),ls([ws],Kk.prototype,"marker",2),ls([ws],Kk.prototype,"label",2),ls([ws],Kk.prototype,"tooltip",2),ls([ws],Kk.prototype,"connectMissingData",2),ls([ws],Kk.prototype,"sparklineMode",2);var Zk=Dl(function(t,e,i,s,n,a){const o=e.length;if(o<1e3)return;const[r,l]=mI(t,s);let c=gI(e,r,l,{xNeedsValueOf:n});const{indexData:h,valueData:d}=bI(e,i,i,r,l,c,{xNeedsValueOf:n,yNeedsValueOf:a});let u=[];for(let t=0;t<o;t++)Yk(e,r,l,h,c,t,n,o)&&u.push(t);const p=[{maxRange:c,indices:u}];for(;u.length>10&&c>64;)({maxRange:c}=vI(h,d,c,{inPlace:!0})),u=u.filter(t=>Yk(e,r,l,h,c,t,n,o)),p.push({maxRange:c,indices:u});return p.reverse(),p}),Xk=class extends GI{constructor(t){super({moduleCtx:t,propertyKeys:zI,propertyNames:jI,categoryKey:"xValue",pickModes:[2,1,0],datumSelectionGarbageCollection:!1,segmentedDataNodes:!1,animationResetFns:{path:QD({getVisible:()=>this.visible,getOpacity:()=>this.getOpacity()}),label:dI,datum:(t,e)=>({opacity:1,scalingX:1,scalingY:1,...WD(0,e)})},clipFocusBox:!1}),this.properties=new Kk,this.dataAggregationFilters=void 0}get pickModeAxis(){return this.properties.sparklineMode?"main":"main-category"}get hasData(){return this.getHasData("xValue")}isNormalized(){return null!=this.properties.normalizedTo}async processData(t){if(null==this.data)return;const{data:e,visible:i,seriesGrouping:{groupIndex:s=this.id,stackCount:n=0}={}}=this,{xKey:a,yKey:o,yFilterKey:r,connectMissingData:l,normalizedTo:c}=this.properties,h=!this.ctx.animationManager.isSkipped(),d=this.axes.x?.scale,u=this.axes.y?.scale,{isContinuousX:p,xScaleType:g,yScaleType:m}=this.getScaleInformation({xScale:d,yScale:u}),f=n>1||null!=c,y={invalidValue:null};l&&f&&(y.invalidValue=0),f&&!i&&(y.forceValue=0);const x={value:`area-stack-${s}-yValue`,marker:`area-stack-${s}-yValues-marker`},b=[];p&&!f||b.push(Sx(a,g,{id:"xKey"})),b.push(Ix(a,g,{id:"xValue"}),Ix(o,m,{id:"yValueRaw",...y,invalidValue:void 0})),null!=r&&b.push(Ix(r,m,{id:"yFilterRaw"})),f&&b.push(...Lx(o,"normal",{id:"yValueCumulative",...y,groupId:x.marker},m)),V(c)&&b.push(Ix(o,m,{id:"yValue",...y,groupId:x.value}),Px(Object.values(x),c)),h&&(b.push(Fx(p?["xValue"]:void 0)),this.processedData&&b.push(Ux(this.id,this.processedData)));const{dataModel:v,processedData:M}=await this.requestDataModel(t,e,{props:b,groupByKeys:f,groupByData:!f});this.dataAggregationFilters=this.aggregateData(v,M),this.animationState.transition("updateData")}yValueKey(){return this.isNormalized()?"yValue":"yValueRaw"}yCumulativeKey(t){return"grouped"===t.type?"yValueCumulative":this.yValueKey()}xCoordinateRange(t,e){const{marker:i}=this.properties,s=this.axes.x.scale.convert(t),n=i.enabled?.5*i.size*e:0;return[s-n,s+n]}yCoordinateRange(t,e){const{marker:i}=this.properties,s=this.axes.y.scale.convert(t[0]),n=i.enabled?.5*i.size*e:0;return[s-n,s+n]}getSeriesDomain(t){const{dataModel:e,processedData:i,axes:s}=this;if(!e||!i)return[];const n=s.y;if("x"===t){const t=e.resolveProcessedDataDefById(this,"xValue"),s=e.getDomain(this,"xValue","value",i);return"value"===t?.def.type&&"category"===t.def.valueType?s:Ph(rx(s))}const a=this.domainForClippedRange("y",[this.yCumulativeKey(i)],"xValue");return this.isNormalized()&&n instanceof mb&&!(n instanceof fb)?Ph(Number.isFinite(a[1]-a[0])?[Math.min(a[0],0),Math.max(a[1],0)]:[]):Ph(a)}getSeriesRange(t,e){return this.domainForVisibleRange("y",[this.yCumulativeKey(this.processedData)],"xValue",e)}getZoomRangeFittingItems(t,e,i){return this.zoomFittingVisibleItems("xValue",[this.yCumulativeKey(this.processedData)],t,e,i)}getVisibleItems(t,e,i){return this.countVisibleItems("xValue",[this.yCumulativeKey(this.processedData)],t,e,i)}aggregateData(t,e){if("ungrouped"!==e.type)return;if(yx(e))return;const i=this.axes.x;if(null==i)return;const{scale:s}=i,n=t.resolveColumnById(this,"xValue",e),a=t.resolveColumnById(this,this.yCumulativeKey(e),e),o=t.getDomain(this,"xValue","value",e),r=t.resolveColumnNeedsValueOf(this,"xValue",e),l=t.resolveColumnNeedsValueOf(this,this.yCumulativeKey(e),e);return Zk(s.type,n,a,o,r,l)}createNodeData(){const{dataModel:t,processedData:e,axes:i,dataAggregationFilters:s}=this,n=i.x,a=i.y;if(!(t&&e&&n&&a))return;const{xKey:o,xName:r,yFilterKey:l,yKey:c,yName:h,marker:d,label:u,connectMissingData:p,interpolation:g,legendItemName:m}=this.properties,f=n.scale,y=a.scale,x=(f.bandwidth??0)/2,b=(y.bandwidth??0)/2,v=d.enabled?d.size:0,M=e.dataSources.get(this.id)?.data??[],S=t.resolveColumnById(this,"xValue",e),I=t.resolveColumnById(this,"yValueRaw",e),D=t.resolveColumnById(this,this.yCumulativeKey(e),e),k=null==l?void 0:t.resolveColumnById(this,"yFilterRaw",e),A=this.getSeriesDomain("y"),w={lengthRatioMultiplier:this.properties.marker.getDiameter(),lengthMax:1/0},C=[],N=[],L=t=>{const e=M[t],i=S[t],s=I[t],n=D[t],a=k?.[t],l=f.convert(i)+x,d=y.convert(n)+b;if(!Number.isFinite(l))return;if(null!=s){const p=u.enabled?this.getLabelText(s,e,c,"y",A,u,{value:s,datum:e,xKey:o,yKey:c,xName:r,yName:h,legendItemName:m}):void 0;C.push({series:this,datum:e,datumIndex:t,yKey:c,xKey:o,point:{x:l,y:d,size:v},midPoint:{x:l,y:d},cumulativeValue:n,yValue:s,xValue:i,capDefaults:w,labelText:p,selected:a})}const g=N.at(-1);if(null!=s){const t={point:{x:l,y:d},xDatum:i,yDatum:s};Array.isArray(g)?g.push(t):(null==g||(g.skip+=1),N.push([t]))}else p||(Array.isArray(g)||null==g?N.push({skip:0}):g.skip+=1)},[T,E]=f.range,O=Math.abs(E-T),R=s?.find(t=>t.maxRange>O),P=R?.indices;let[z,j]=this.visibleRangeIndices("xValue",n.range,P);z=Math.max(z-1,0),j=Math.min(j+1,P?.length??S.length),e.input.count<1e3&&(z=0,j=e.input.count);for(let t=z;t<j;t+=1)L(P?.[t]??t);const B=N.flatMap(t=>Array.isArray(t)?LD(t,g):[]),F={itemId:c,spans:B},V=k?.some((t,e)=>t===I[e])??!1,G=tk(this.properties.segmentation,n,a,this.chart.seriesRect,this.ctx.scene,!1);return{itemId:c,nodeData:C,labelData:C,strokeData:F,scales:this.calculateScaling(),visible:this.visible,crossFiltering:V,styles:KD(this,this.properties,d),segments:G}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}updatePathNodes(t){const{paths:[e],visible:i,animationEnabled:s}=t,n=!0===this.contextNodeData?.crossFiltering,a=zs(this.getHighlightStyle(),this.getStyle(!1)),{strokeWidth:o,stroke:r,strokeOpacity:l,lineDash:c,lineDashOffset:h,opacity:d}=a,u=this.contextNodeData?.segments;e.setProperties({segments:u,fill:void 0,lineJoin:"round",pointerEvents:1,opacity:d,stroke:r,strokeWidth:o,strokeOpacity:l*(n?.25:1),lineDash:c,lineDashOffset:h}),e.datum=u,s||(e.visible=i),qD(this,e)}updateDatumSelection(t){let{nodeData:e}=t;const{datumSelection:i}=t,{contextNodeData:s,processedData:n,axes:a,properties:o}=this,{marker:r}=o;return e=!0===s?.crossFiltering||YD(n.input.count,a.x.scale,r)?e:[],r.isDirty()&&(i.clear(),i.cleanup()),i.update(e,void 0,t=>Wx(t.xValue))}updateDatumStyles(t){const{datumSelection:e,isHighlight:i}=t,{marker:s}=this.properties,n=this.ctx.highlightManager.getActiveHighlight();e.each((a,o)=>{if(!e.isGarbage(a)){const e=this.getHighlightState(n,t.isHighlight,o.datumIndex),a=this.getStyle(i,e),{stroke:r,strokeWidth:l,strokeOpacity:c}=a,h=this.makeItemStylerParams(this.dataModel,this.processedData,o.datumIndex,a.marker);o.style=this.getMarkerStyle(s,o,h,{isHighlight:i,highlightState:e},a.marker,{stroke:r,strokeWidth:l,strokeOpacity:c})}})}updateDatumNodes(t){const{contextNodeData:e}=this;if(!e)return;const{datumSelection:i,isHighlight:s,drawingMode:n}=t,a=this.ctx.animationManager.isSkipped(),o=this.getShapeFillBBox(),r=this.ctx.highlightManager.getActiveHighlight();i.each((t,i)=>{const l=this.getHighlightState(r,s,i.datumIndex),c=i.style??e.styles[l];this.applyMarkerStyle(c,t,i.point,o,{applyTranslation:a,selected:i.selected}),t.drawingMode=n}),s||this.properties.marker.markClean()}updateLabelSelection(t){return t.labelSelection.update(this.isLabelEnabled()?t.labelData:[])}updateLabelNodes(t){const{isHighlight:e=!1}=t,i=this.ctx.highlightManager?.getActiveHighlight(),s=this.makeLabelFormatterParams();t.labelSelection.each((t,n)=>{const a=aI(this,n,s,this.properties.label,e,i),{enabled:o,fontStyle:r,fontWeight:l,fontSize:c,fontFamily:h,color:d}=a;o&&n?.labelText?(t.fontStyle=r,t.fontWeight=l,t.fontSize=c,t.fontFamily=h,t.textAlign="center",t.textBaseline="bottom",t.text=n.labelText,t.x=n.point.x,t.y=n.point.y-10,t.fill=d,t.visible=!0,t.fillOpacity=this.getHighlightStyle(e,n.datumIndex).opacity??1,t.setBoxing(a)):t.visible=!1})}makeStylerParams(t,e){const{id:i}=this,{marker:s,lineDash:n,lineDashOffset:a,stroke:o,strokeOpacity:r,strokeWidth:l,xKey:c,yKey:h}=this.properties,d=dc(e??0);return{marker:{fill:s.fill,fillOpacity:s.fillOpacity,size:s.size,shape:s.shape,stroke:s.stroke,strokeOpacity:s.strokeOpacity,strokeWidth:s.strokeWidth,lineDash:s.lineDash,lineDashOffset:s.lineDashOffset},highlightState:d,highlighted:t,lineDash:n,lineDashOffset:a,seriesId:i,stroke:o,strokeOpacity:r,strokeWidth:l,xKey:c,yKey:h}}makeItemStylerParams(t,e,i,s){const{xKey:n,yKey:a}=this.properties,o=t.resolveColumnById(this,"xValue",e)[i],r=t.resolveColumnById(this,"yValueRaw",e)[i],l=t.getDomain(this,"xValue","key",e),c=t.getDomain(this,this.yCumulativeKey(e),"value",e),h=this.filterItemStylerFillParams(s.fill)??s.fill;return{...Dc(o,r,n,a,l,c),xValue:o,yValue:r,...s,fill:h}}makeLabelFormatterParams(){const{xKey:t,xName:e,yKey:i,yName:s,legendItemName:n}=this.properties;return{xKey:t,xName:e,yKey:i,yName:s,legendItemName:n}}getTooltipContent(t){const{id:e,dataModel:i,processedData:s,axes:n,properties:a}=this,{xKey:o,xName:r,yKey:l,yName:c,tooltip:h,legendItemName:d}=a,u=n.x,p=n.y;if(!(i&&s&&u&&p))return;const g=s.dataSources.get(this.id)?.data?.[t],m=i.resolveColumnById(this,"xValue",s)[t],f=i.resolveColumnById(this,"yValueRaw",s)[t];if(null==m)return;const y=this.getStyle(!1),x=this.makeItemStylerParams(i,s,t,y.marker),b=this.getMarkerStyle(this.properties.marker,{datumIndex:t,datum:g},x,{isHighlight:!1},y.marker);return this.formatTooltipWithContext(h,{heading:this.getAxisValueText(u,"tooltip",m,g,o,d),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:l,value:this.getAxisValueText(p,"tooltip",f,g,l,d)}]},{seriesId:e,datum:g,title:c,xKey:o,xName:r,yKey:l,yName:c,...b,...this.getModuleTooltipParams()})}legendItemSymbol(){const{stroke:t,strokeOpacity:e,strokeWidth:i,lineDash:s,marker:n}=this.getStyle(!1);return{marker:{...this.getMarkerStyle(this.properties.marker,{},void 0,{isHighlight:!1,checkForHighlight:!1},{size:n.size,shape:n.shape,fill:n.fill,fillOpacity:n.fillOpacity,stroke:n.stroke,strokeOpacity:n.strokeOpacity,strokeWidth:n.strokeWidth,lineDash:n.lineDash,lineDashOffset:n.lineDashOffset}),enabled:this.properties.marker.enabled},line:{stroke:t,strokeOpacity:e,strokeWidth:i,lineDash:s}}}getLegendData(t){if("category"!==t)return[];const{id:e,ctx:{legendManager:i},visible:s}=this,{yKey:n,yName:a,title:o,legendItemName:r,showInLegend:l}=this.properties;return[{legendType:t,id:e,itemId:n,legendItemName:r,seriesId:e,enabled:s&&i.getItemEnabled({seriesId:e,itemId:n}),label:{text:r??o??a??n},symbol:this.legendItemSymbol(),hideInLegend:!l}]}updatePaths(t){this.updateLinePaths(t.paths,t.contextData)}updateLinePaths(t,e){const i=e.strokeData.spans,[s]=t;s.path.clear(),ED(s,i),s.markDirty("LineSeries")}animateEmptyUpdateReady(t){const{datumSelection:e,labelSelection:i,annotationSelections:s,contextData:n,paths:a}=t,{animationManager:o}=this.ctx;this.updateLinePaths(a,n),ZD(this,o,...a),pd([e],WD),HD(this,o,e),cI(this,"labels",o,i),cI(this,"annotations",o,...s)}animateReadyResize(t){const{contextData:e,paths:i}=t;this.updateLinePaths(i,e),super.animateReadyResize(t)}animateWaitingUpdateReady(t){const{animationManager:e}=this.ctx,{datumSelection:i,labelSelection:s,annotationSelections:n,contextData:a,paths:o,previousContextData:r}=t,[l]=o;if(!1===a.visible&&!1===r?.visible)return;this.resetDatumAnimation(t),this.resetLabelAnimation(t);const c=()=>{this.resetPathAnimation(t),this.updateLinePaths(o,a)},h=()=>{e.skipCurrentBatch(),c()};if(null==a||null==r)return c(),GD(this,e,"added",i),XD(this,"path_properties",e,"add",l),cI(this,"labels",e,s),void cI(this,"annotations",e,...n);if(a.crossFiltering!==r.crossFiltering)return void h();const d=zD(a,r,this.processedData?.reduced?.diff?.[this.id]);void 0!==d?"no-op"!==d.status&&(cd(this.id,"path_properties",e,[l],d.stroke.pathProperties),"added"===d.status?this.updateLinePaths(o,a):"removed"===d.status?this.updateLinePaths(o,r):nI(this.id,"path_update",e,[l],d.stroke.path),d.hasMotion&&(GD(this,e,void 0,i),cI(this,"labels",e,s),cI(this,"annotations",e,...n)),this.ctx.animationManager.animate({id:this.id,groupId:"reset_after_animation",phase:"trailing",from:{},to:{},onComplete:()=>this.updateLinePaths(o,a)})):h()}isLabelEnabled(){return this.properties.label.enabled}getBandScalePadding(){return{inner:1,outer:.1}}nodeFactory(){return new Ig}getStyle(t,e){const{styler:i,marker:s,lineDash:n,lineDashOffset:a,stroke:o,strokeOpacity:r,strokeWidth:l}=this.properties,{size:c,shape:h,fill:d="transparent",fillOpacity:u}=s;let p={};if(i){const s=this.makeStylerParams(t,e),n=this.cachedCallWithContext(i,s)??{};p=this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],n,{pick:!1})??{}}return p.marker??(p.marker={}),{lineDash:p.lineDash??n,lineDashOffset:p.lineDashOffset??a,stroke:p.stroke??o,strokeOpacity:p.strokeOpacity??r,strokeWidth:p.strokeWidth??l,marker:{fill:p.marker.fill??d,fillOpacity:p.marker.fillOpacity??u,shape:p.marker.shape??h,size:p.marker.size??c,lineDash:p.marker.lineDash??s.lineDash??n,lineDashOffset:p.marker.lineDashOffset??s.lineDashOffset??a,stroke:p.marker.stroke??s.stroke??o,strokeOpacity:p.marker.strokeOpacity??s.strokeOpacity??r,strokeWidth:p.marker.strokeWidth??s.strokeWidth??l}}}getFormattedMarkerStyle(t){const e=this.getStyle(!1),i=this.makeItemStylerParams(this.dataModel,this.processedData,t.datumIndex,e.marker);return this.getMarkerStyle(this.properties.marker,t,i,{isHighlight:!0},void 0,e)}computeFocusBounds(t){return _D(this,t)}hasItemStylers(){return null!=this.properties.styler||null!=this.properties.marker.itemStyler||null!=this.properties.label.itemStyler}};Xk.className="LineSeries",Xk.type="line";var Qk={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"line",moduleFactory:t=>new Xk(t),stackable:!0,predictAxis:sk,defaultAxes:[{type:"number",position:"left"},{type:"category",position:"bottom"}],themeTemplate:{series:{stroke:Ym,strokeWidth:2,strokeOpacity:1,lineDash:[0],lineDashOffset:0,interpolation:{type:"linear"},marker:{shape:"circle",size:7,strokeWidth:{$isUserOption:["./stroke",1,0]},fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",ef],["image",hf],["pattern",of]]},stroke:{$palette:"stroke"}},label:{...mf,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},errorBar:{cap:{lengthRatio:1}},tooltip:{range:{$path:["/tooltip/range","nearest"]},position:{anchorTo:{$path:["/tooltip/position/anchorTo","node"]}}},highlight:ff(),segmentation:bf}}},qk={type:"series",name:"line",chartType:"cartesian",options:iv,create:t=>new Xk(t)},Jk=class extends Vk{};Jk.className="ScatterSeries",Jk.type="scatter";var tA={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["cartesian"],identifier:"scatter",moduleFactory:t=>new Jk(t),predictAxis:ik,defaultAxes:[{type:"number",position:"bottom"},{type:"number",position:"left"}],themeTemplate:{series:{shape:"circle",size:7,fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",ef],["image",hf],["pattern",of]]},stroke:{$palette:"stroke"},fillOpacity:.8,maxRenderedItems:1e4,label:{...mf,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},errorBar:{cap:{lengthRatio:1}},tooltip:{range:{$path:["/tooltip/range","nearest"]},position:{anchorTo:{$path:["/tooltip/position/anchorTo","node"]}}},highlight:ff()}}},eA={type:"series",name:"scatter",chartType:"cartesian",options:nv,create:t=>new Jk(t)},iA=class t{constructor(t,e,i,s){this.startAngle=t,this.endAngle=e,this.innerRadius=i,this.outerRadius=s}clone(){const{startAngle:e,endAngle:i,innerRadius:s,outerRadius:n}=this;return new t(e,i,s,n)}equals(t){return this.startAngle===t.startAngle&&this.endAngle===t.endAngle&&this.innerRadius===t.innerRadius&&this.outerRadius===t.outerRadius}[ds](e,i){return new t(this.startAngle*(1-i)+e.startAngle*i,this.endAngle*(1-i)+e.endAngle*i,this.innerRadius*(1-i)+e.innerRadius*i,this.outerRadius*(1-i)+e.outerRadius*i)}};function sA({startAngle:t,endAngle:e,innerRadius:i,outerRadius:s}){let n=1/0,a=1/0,o=-1/0,r=-1/0;const l=(t,e)=>{n=Math.min(t,n),a=Math.min(e,a),o=Math.max(t,o),r=Math.max(e,r)};return l(i*Math.cos(t),i*Math.sin(t)),l(i*Math.cos(e),i*Math.sin(e)),l(s*Math.cos(t),s*Math.sin(t)),l(s*Math.cos(e),s*Math.sin(e)),un(0,t,e)&&l(s,0),un(.5*Math.PI,t,e)&&l(0,s),un(Math.PI,t,e)&&l(-s,0),un(1.5*Math.PI,t,e)&&l(0,-s),new fs(n,a,o-n,r-a)}function nA(t,e,i){const s=Math.sqrt(Math.pow(t,2)+Math.pow(e,2)),{innerRadius:n,outerRadius:a}=i;if(i.startAngle===i.endAngle||s<Math.min(n,a)||s>Math.max(n,a))return!1;const o=dn(i.startAngle),r=dn(i.endAngle),l=Math.atan2(e,t);return o<r?l<=r&&l>=o:l<=r&&l>=-Math.PI||l>=o&&l<=Math.PI}function aA(t,e){const{startAngle:i,endAngle:s,innerRadius:n,outerRadius:a}=e,o={x:a*Math.cos(i),y:a*Math.sin(i)},r={x:a*Math.cos(s),y:a*Math.sin(s)},l=0===n?{x:0,y:0}:{x:n*Math.cos(i),y:n*Math.sin(i)},c=0===n?{x:0,y:0}:{x:n*Math.cos(s),y:n*Math.sin(s)};return Xn(t.start.x,t.start.y,t.end.x,t.end.y,o.x,o.y,l.x,l.y)||Xn(t.start.x,t.start.y,t.end.x,t.end.y,r.x,r.y,c.x,c.y)||function(t,e,i,s,n,a,o,r,l,c){if(Number.isNaN(0)||Number.isNaN(0))return 0;[n,s]=[s,n];const h=(c-r)/(l-o),d=r-h*o,u=Math.pow(h,2)+1,p=2*(h*(d-0)-0),g=Math.pow(0,2)+Math.pow(d-0,2)-Math.pow(i,2),m=Math.pow(p,2)-4*u*g;if(m<0)return 0;const f=(-p+Math.sqrt(m))/2/u,y=(-p-Math.sqrt(m))/2/u;let x=0;for(const t of[f,y]){if(!(t>=Math.min(o,l)&&t<=Math.max(o,l)))continue;const e=t-0,i=h*t+d-0;un(Math.atan2(i,e),s,n)&&x++}return x}(0,0,a,i,s,0,t.start.x,t.start.y,t.end.x,t.end.y)}function oA(t,e,i,s){if(0===i&&0===s)return 0;if(Math.asin(Math.abs(1*i)/(t+1*i))+Math.asin(Math.abs(1*s)/(t+1*s))-e<0)return 1;let n=0,a=1;for(let o=0;o<8;o+=1){const o=(n+a)/2;Math.asin(Math.abs(o*i)/(t+o*i))+Math.asin(Math.abs(o*s)/(t+o*s))-e<0?n=o:a=o}return n}function rA(t,e){return mn(t,e)<1e-6?e:cn(t-e)+e}function lA(t,e,i=0){const s=Math.abs(e-t)>=2*Math.PI?2*Math.PI:cn(e-t);return{startAngle:t=rA(t,i),endAngle:e=t+s}}function cA(t,e,i,s,n,a){const o=Math.sin(a),r=Math.cos(a),l=t**2+e**2-i**2;let c,h,d,u;if(r>.5){const i=o/r,s=1+i**2,n=-2*(t+e*i),a=n**2-4*s*l;if(a<0)return;const p=(-n+Math.sqrt(a))/(2*s),g=(-n-Math.sqrt(a))/(2*s);c=p,h=p*i,d=g,u=g*i}else{const i=r/o,s=1+i**2,n=-2*(e+t*i),a=n**2-4*s*l;if(a<0)return;const p=(-n+Math.sqrt(a))/(2*s),g=(-n-Math.sqrt(a))/(2*s);c=p*i,h=p,d=g*i,u=g}const p=d*r+u*o,g=c*r+h*o>0?rA(Math.atan2(h-e,c-t),s):Number.NaN,m=p>0?rA(Math.atan2(u-e,d-t),s):Number.NaN;return g>=s&&g<=n?g:m>=s&&m<=n?m:void 0}function hA(t,e,i,s,n,a){const o=Math.hypot(t,e),r=o-(o**2-i**2+a**2)/(2*o),l=Math.atan2(e,t),c=Math.acos(-r/i),h=rA(l+c,s),d=rA(l-c,s);return h>=s&&h<=n?h:d>=s&&d<=n?d:void 0}var dA=class{constructor(t,e,i,s,n){this.cx=t,this.cy=e,this.r=i,this.a0=s,this.a1=n,this.a0>=this.a1&&(this.a0=Number.NaN,this.a1=Number.NaN)}isValid(){return Number.isFinite(this.a0)&&Number.isFinite(this.a1)}pointAt(t){return{x:this.cx+this.r*Math.cos(t),y:this.cy+this.r*Math.sin(t)}}clipStart(t){null==t||!this.isValid()||t<this.a0||(this.a0=t,(Number.isNaN(t)||this.a0>=this.a1)&&(this.a0=Number.NaN,this.a1=Number.NaN))}clipEnd(t){null==t||!this.isValid()||t>this.a1||(this.a1=t,(Number.isNaN(t)||this.a0>=this.a1)&&(this.a0=Number.NaN,this.a1=Number.NaN))}},uA=class extends Go{constructor(){super(...arguments),this.centerX=0,this.centerY=0,this.innerRadius=10,this.outerRadius=20,this.startAngle=0,this.endAngle=2*Math.PI,this.clipSector=void 0,this.concentricEdgeInset=0,this.radialEdgeInset=0,this.startOuterCornerRadius=0,this.endOuterCornerRadius=0,this.startInnerCornerRadius=0,this.endInnerCornerRadius=0}set inset(t){this.concentricEdgeInset=t,this.radialEdgeInset=t}set cornerRadius(t){this.startOuterCornerRadius=t,this.endOuterCornerRadius=t,this.startInnerCornerRadius=t,this.endInnerCornerRadius=t}computeBBox(){return sA(this).translate(this.centerX,this.centerY)}normalizedRadii(){const{concentricEdgeInset:t}=this;let{innerRadius:e,outerRadius:i}=this;return e=e>0?e+t:0,i=Math.max(i-t,0),{innerRadius:e,outerRadius:i}}normalizedClipSector(){const{clipSector:t}=this;if(null==t)return;const{startAngle:e,endAngle:i}=lA(this.startAngle,this.endAngle),{innerRadius:s,outerRadius:n}=this.normalizedRadii(),a=lA(t.startAngle,t.endAngle,e);return new iA(Math.max(e,a.startAngle),Math.min(i,a.endAngle),Math.max(s,t.innerRadius),Math.min(n,t.outerRadius))}getAngleOffset(t){return t>0?this.radialEdgeInset/t:0}arc(t,e,i,s,n,a,o,r){if(t<=0)return;const{startAngle:l,endAngle:c}=lA(this.startAngle,this.endAngle),{innerRadius:h,outerRadius:d}=this.normalizedRadii(),u=this.normalizedClipSector();if(r&&h<=0)return;const p=r?this.getAngleOffset(h+t):this.getAngleOffset(d-t),g=o?l+p+e:c-p-e,m=r?h+t:d-t,f=m*Math.cos(g),y=m*Math.sin(g);if(null!=u){const t=1e-6;if(!(o||g>=l-t&&g<=u.endAngle-t))return;if(o&&!(g>=u.startAngle+t&&g<=c-t))return;if(r&&m<u.innerRadius-t)return;if(!r&&m>u.outerRadius+t)return}const x=new dA(f,y,t,i,s);if(null!=u){let e,c;if(r?(x.clipStart(cA(f,y,t,i,s,u.endAngle)),x.clipEnd(cA(f,y,t,i,s,u.startAngle))):(x.clipStart(cA(f,y,t,i,s,u.startAngle)),x.clipEnd(cA(f,y,t,i,s,u.endAngle))),o?(e=hA(f,y,t,i,s,u.innerRadius),c=hA(f,y,t,i,s,u.outerRadius)):(e=hA(f,y,t,i,s,u.outerRadius),c=hA(f,y,t,i,s,u.innerRadius)),x.clipStart(e),x.clipEnd(c),null!=e){const{x:t,y:i}=x.pointAt(e),s=rA(Math.atan2(i,t),l);o?a?.clipStart(s):n.clipEnd(s)}if(null!=c){const{x:t,y:e}=x.pointAt(c),i=rA(Math.atan2(e,t),l);o?n.clipStart(i):a?.clipEnd(i)}}if(null!=u){const{x:t,y:e}=x.pointAt((x.a0+x.a1)/2);if(!nA(t,e,u))return}const{x:b,y:v}=x.pointAt(o===r?x.a0:x.a1),M=rA(Math.atan2(v,b),l),S=r?a:n;return o?S?.clipStart(M):S?.clipEnd(M),x}updatePath(){const{path:t,centerX:e,centerY:i,concentricEdgeInset:s,radialEdgeInset:n}=this;let{startOuterCornerRadius:a,endOuterCornerRadius:o,startInnerCornerRadius:r,endInnerCornerRadius:l}=this;const{startAngle:c,endAngle:h}=lA(this.startAngle,this.endAngle),{innerRadius:d,outerRadius:u}=this.normalizedRadii(),p=this.normalizedClipSector(),g=h-c,m=g>=2*Math.PI-1e-6;if(t.clear(),0===d&&0===u||d>u)return;if((p?.startAngle??c)===(p?.endAngle??h))return;if(m&&null==this.clipSector&&0===a&&0===o&&0===r&&0===l)return t.moveTo(e+u*Math.cos(c),i+u*Math.sin(c)),t.arc(e,i,u,c,h),d>s&&(t.moveTo(e+d*Math.cos(h),i+d*Math.sin(h)),t.arc(e,i,d,h,c,!0)),void t.closePath();if(null==this.clipSector&&Math.abs(d-u)<1e-6)return t.arc(e,i,u,c,h,!1),t.arc(e,i,u,h,c,!0),void t.closePath();const f=this.getAngleOffset(d),y=this.getAngleOffset(u);if(g<2*y)return;const x=(p?.innerRadius??d)>s,b=d<s||g<2*f,v=u-d,M=Math.max(a,r,o,l),S=M>0?Math.min(v/M,1):1;a*=S,o*=S,r*=S,l*=S;const I=oA(u,g-2*y,-a,-o);if(a*=I,o*=I,!b&&x){const t=oA(d,g-2*f,r,l);r*=t,l*=t}else r=0,l=0;const D=Math.max(a+r,o+l),k=D>0?Math.min(v/D,1):1;a*=k,o*=k,r*=k,l*=k;let A=0,w=0;const C=a/(u-a),N=o/(u-o);if(C>=0&&C<.999999)A=Math.asin(C);else{A=g/2;const t=u/(1/Math.sin(A)+1);a=Math.min(t,a)}if(N>=0&&N<.999999)w=Math.asin(N);else{w=g/2;const t=u/(1/Math.sin(w)+1);o=Math.min(t,o)}const L=Math.asin(r/(d+r)),T=Math.asin(l/(d+l)),E=p?.outerRadius??u,O=this.getAngleOffset(E),R=new dA(0,0,E,c+O,h-O),P=p?.innerRadius??d,z=this.getAngleOffset(P),j=x?new dA(0,0,P,c+z,h-z):void 0;null!=p&&(R.clipStart(p.startAngle),R.clipEnd(p.endAngle),j?.clipStart(p.startAngle),j?.clipEnd(p.endAngle));const B=this.arc(a,A,c-.5*Math.PI,c+A,R,j,!0,!1),F=this.arc(o,w,h-w,h+.5*Math.PI,R,j,!1,!1),V=this.arc(l,T,h+.5*Math.PI,h+Math.PI-T,R,j,!1,!0),G=this.arc(r,L,c+Math.PI+L,c+1.5*Math.PI,R,j,!0,!0);if(b){const s=g<.5*Math.PI?n*(1+Math.cos(g))/Math.sin(g):Number.NaN;let a;a=s>0&&s<u?Math.max(Math.hypot(n,s),d):n,a=Math.max(a,d);const o=c+.5*g;t.moveTo(e+a*Math.cos(o),i+a*Math.sin(o))}else if(!0===G?.isValid()||!0===j?.isValid());else{const s=c+g/2,n=d*Math.cos(s),a=d*Math.sin(s);t.moveTo(e+n,i+a)}if(!0===B?.isValid()){const{cx:s,cy:n,r:a,a0:o,a1:r}=B;t.arc(e+s,i+n,a,o,r)}if(R.isValid()){const{r:s,a0:n,a1:a}=R;t.arc(e,i,s,n,a)}if(!0===F?.isValid()){const{cx:s,cy:n,r:a,a0:o,a1:r}=F;t.arc(e+s,i+n,a,o,r)}if(!b){if(!0===V?.isValid()){const{cx:s,cy:n,r:a,a0:o,a1:r}=V;t.arc(e+s,i+n,a,o,r)}if(!0===j?.isValid()){const{r:s,a0:n,a1:a}=j;t.arc(e,i,s,a,n,!0)}if(!0===G?.isValid()){const{cx:s,cy:n,r:a,a0:o,a1:r}=G;t.arc(e+s,i+n,a,o,r)}}t.closePath()}isPointInPath(t,e){const{startAngle:i,endAngle:s,innerRadius:n,outerRadius:a}=this.clipSector??this;return nA(t-this.centerX,e-this.centerY,{startAngle:i,endAngle:s,innerRadius:Math.min(n,a),outerRadius:Math.max(n,a)})}};uA.className="Sector",ls([Xs()],uA.prototype,"centerX",2),ls([Xs()],uA.prototype,"centerY",2),ls([Xs()],uA.prototype,"innerRadius",2),ls([Xs()],uA.prototype,"outerRadius",2),ls([Xs()],uA.prototype,"startAngle",2),ls([Xs()],uA.prototype,"endAngle",2),ls([qs({equals:(t,e)=>t.equals(e)})],uA.prototype,"clipSector",2),ls([Xs()],uA.prototype,"concentricEdgeInset",2),ls([Xs()],uA.prototype,"radialEdgeInset",2),ls([Xs()],uA.prototype,"startOuterCornerRadius",2),ls([Xs()],uA.prototype,"endOuterCornerRadius",2),ls([Xs()],uA.prototype,"startInnerCornerRadius",2),ls([Xs()],uA.prototype,"endInnerCornerRadius",2);var pA=class extends sr{constructor(){super(...arguments),this.showInLegend=!1}};ls([ws],pA.prototype,"showInLegend",2);var gA=class extends kd{constructor(){super(...arguments),this.spacing=2}set(t,e){return super.set(t)}};ls([ws],gA.prototype,"text",2),ls([ws],gA.prototype,"spacing",2);var mA=class extends Pn{constructor(){super(...arguments),this.fill="transparent",this.fillOpacity=1}};ls([ws],mA.prototype,"fill",2),ls([ws],mA.prototype,"fillOpacity",2);var fA=class extends kd{constructor(){super(...arguments),this.offset=3,this.minAngle=0,this.minSpacing=4,this.maxCollisionOffset=50,this.avoidCollisions=!0}};ls([ws],fA.prototype,"offset",2),ls([ws],fA.prototype,"minAngle",2),ls([ws],fA.prototype,"minSpacing",2),ls([ws],fA.prototype,"maxCollisionOffset",2),ls([ws],fA.prototype,"avoidCollisions",2);var yA=class extends kd{constructor(){super(...arguments),this.positionOffset=0,this.positionRatio=.5}};ls([ws],yA.prototype,"positionOffset",2),ls([ws],yA.prototype,"positionRatio",2);var xA=class extends Pn{constructor(){super(...arguments),this.length=10,this.strokeWidth=1}};ls([ws],xA.prototype,"colors",2),ls([ws],xA.prototype,"length",2),ls([ws],xA.prototype,"strokeWidth",2),ls([ws],xA.prototype,"itemStyler",2);var bA=class extends Sc{constructor(){super(...arguments),this.defaultColorRange=[],this.defaultPatternFills=[],this.fills=Object.values(om),this.strokes=Object.values(rm),this.fillOpacity=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.outerRadiusOffset=0,this.outerRadiusRatio=1,this.strokeWidth=1,this.sectorSpacing=0,this.hideZeroValueSectorsInLegend=!1,this.innerLabels=new zn(gA),this.title=new pA,this.innerCircle=new mA,this.shadow=new II,this.calloutLabel=new fA,this.sectorLabel=new yA,this.calloutLine=new xA,this.tooltip=wI()}};function vA(t,e,i,s){const n=[i.convert(0),i.convert(1)],a=[s.convert(0),s.convert(1)],o=Math.PI/-2+pn(e),r=t?"initial":"update";return{nodes:{toFn:(t,e,i,{prevLive:s})=>{let{startAngle:a,endAngle:r,innerRadius:l,outerRadius:c}=e;const{stroke:h,fill:d}=e.sectorFormat;if("removed"===i&&s?(a=s.datum?.endAngle,r=s.datum?.endAngle):"removed"!==i||s||(a=o,r=o),"removed"===i){const t=(({radius:t})=>({innerRadius:n[0],outerRadius:n[0]+(n[1]-n[0])*t}))(e);l=t.innerRadius,c=t.outerRadius}return{startAngle:a,endAngle:r,outerRadius:c,innerRadius:l,stroke:h,fill:d}},fromFn:(e,i,s,{prevFromProps:n})=>{let{startAngle:l,endAngle:c,innerRadius:h,outerRadius:d}=e,{fill:u,stroke:p}=i.sectorFormat;if("updated"===s&&null==e.previousDatum&&(s="added"),"unknown"===s||"added"===s&&!n?(l=o,c=o,h=i.innerRadius,d=i.outerRadius):"added"===s&&n&&(l=n.endAngle??o,c=n.endAngle??o,h=n.innerRadius??i.innerRadius,d=n.outerRadius??i.outerRadius),"added"===s&&!t){const t=(({radius:t})=>({innerRadius:a[0],outerRadius:a[0]+(a[1]-a[0])*t}))(i);h=t.innerRadius,d=t.outerRadius}return"updated"===s&&(u=e.fill??u,p=("string"==typeof e.stroke?e.stroke:void 0)??p),{startAngle:l,endAngle:c,innerRadius:h,outerRadius:d,fill:u,stroke:p,phase:r}}},innerCircle:{fromFn:(t,e)=>({size:t.previousDatum?.radius??t.size??0,phase:r}),toFn:(t,e)=>({size:e.radius??0})}}}function MA(t,e){return{startAngle:e.startAngle,endAngle:e.endAngle,innerRadius:e.innerRadius,outerRadius:e.outerRadius,stroke:e.sectorFormat.stroke}}function SA(t,e){const i=e.y-t.centerY,s=e.x-t.centerX,n=Math.atan2(i,s),a=t.getItemNodes();for(const t of a)if(!0!==t.datum.missing&&un(n,t.startAngle,t.endAngle)){const e=Math.hypot(s,i);let n=0;return e<t.innerRadius?n=t.innerRadius-e:e>t.outerRadius&&(n=e-t.outerRadius),{datum:t.datum,distance:n}}}ls([ws],bA.prototype,"angleKey",2),ls([ws],bA.prototype,"angleName",2),ls([ws],bA.prototype,"angleFilterKey",2),ls([ws],bA.prototype,"radiusKey",2),ls([ws],bA.prototype,"radiusName",2),ls([ws],bA.prototype,"radiusMin",2),ls([ws],bA.prototype,"radiusMax",2),ls([ws],bA.prototype,"calloutLabelKey",2),ls([ws],bA.prototype,"calloutLabelName",2),ls([ws],bA.prototype,"sectorLabelKey",2),ls([ws],bA.prototype,"sectorLabelName",2),ls([ws],bA.prototype,"legendItemKey",2),ls([ws],bA.prototype,"defaultColorRange",2),ls([ws],bA.prototype,"defaultPatternFills",2),ls([ws],bA.prototype,"fills",2),ls([ws],bA.prototype,"strokes",2),ls([ws],bA.prototype,"fillOpacity",2),ls([ws],bA.prototype,"strokeOpacity",2),ls([ws],bA.prototype,"lineDash",2),ls([ws],bA.prototype,"lineDashOffset",2),ls([ws],bA.prototype,"cornerRadius",2),ls([ws],bA.prototype,"itemStyler",2),ls([ws],bA.prototype,"rotation",2),ls([ws],bA.prototype,"outerRadiusOffset",2),ls([ws],bA.prototype,"outerRadiusRatio",2),ls([ws],bA.prototype,"innerRadiusOffset",2),ls([ws],bA.prototype,"innerRadiusRatio",2),ls([ws],bA.prototype,"strokeWidth",2),ls([ws],bA.prototype,"sectorSpacing",2),ls([ws],bA.prototype,"hideZeroValueSectorsInLegend",2),ls([ws],bA.prototype,"innerLabels",2),ls([ws],bA.prototype,"title",2),ls([ws],bA.prototype,"innerCircle",2),ls([ws],bA.prototype,"shadow",2),ls([ws],bA.prototype,"calloutLabel",2),ls([ws],bA.prototype,"sectorLabel",2),ls([ws],bA.prototype,"calloutLine",2),ls([ws],bA.prototype,"tooltip",2);var IA=(t=>(t[t.BACKGROUND=0]="BACKGROUND",t[t.FOREGROUND=1]="FOREGROUND",t[t.HIGHLIGHT=2]="HIGHLIGHT",t[t.LABEL=3]="LABEL",t))(IA||{}),DA={angle:["angleKey"],radius:["radiusKey"]},kA={angle:["angleName"],radius:["radiusName"]},AA=class extends PI{constructor({categoryKey:t,pickModes:e=[1,0],canHaveAxes:i=!1,animationResetFns:s,...n}){super({...n,categoryKey:t,pickModes:e,canHaveAxes:i}),this.directions=["angle","radius"],this.itemGroup=this.contentGroup.appendChild(new Oa),this.nodeData=[],this.itemSelection=gd.select(this.itemGroup,()=>this.nodeFactory(),!1),this.labelSelection=gd.select(this.labelGroup,()=>this.labelFactory(),!1),this.highlightSelection=gd.select(this.highlightGroup,()=>this.nodeFactory()),this.centerX=0,this.centerY=0,this.radius=0,this.animationResetFns=s,this.animationState=new Sd("empty",{empty:{update:{target:"ready",action:t=>this.animateEmptyUpdateReady(t)},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",highlight:t=>this.animateReadyHighlight(t),highlightMarkers:t=>this.animateReadyHighlightMarkers(t),resize:t=>this.animateReadyResize(t),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:t=>this.animateWaitingUpdateReady(t)},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:t=>this.animateClearingUpdateEmpty(t)},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}getItemNodes(){return[...this.itemGroup.children()]}getNodeData(){return this.nodeData}setZIndex(t){super.setZIndex(t),this.contentGroup.zIndex=[t,1],this.highlightGroup.zIndex=[t,2],this.labelGroup.zIndex=[t,3]}resetAnimation(t){"initial"===t?this.animationState.transition("reset"):"ready"===t&&this.animationState.transition("skip")}labelFactory(){const t=new _o;return t.pointerEvents=1,t}addChartEventListeners(){this.cleanup.register(this.ctx.eventsHub.on("legend:item-click",t=>this.onLegendItemClick(t)),this.ctx.eventsHub.on("legend:item-double-click",t=>this.onLegendItemDoubleClick(t)))}getInnerRadius(){return 0}computeLabelsBBox(t,e){return null}getShapeFillBBox(){const t=this.radius;return{series:new fs(-t,-t,2*t,2*t),axis:new fs(-t,-t,2*t,2*t)}}resetAllAnimation(){const{item:t,label:e}=this.animationResetFns??{};this.ctx.animationManager.stopByAnimationGroupId(this.id),t&&pd([this.itemSelection,this.highlightSelection],t),e&&pd([this.labelSelection],e),this.itemSelection.cleanup(),this.labelSelection.cleanup(),this.highlightSelection.cleanup()}animateEmptyUpdateReady(t){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation()}animateWaitingUpdateReady(t){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation()}animateReadyHighlight(t){const{item:e}=this.animationResetFns??{};e&&pd([this.highlightSelection],e)}animateReadyHighlightMarkers(t){}animateReadyResize(t){this.resetAllAnimation()}animateClearingUpdateEmpty(t){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation()}computeFocusBounds(t){const e=this.getNodeData()?.[t.datumIndex];if(void 0!==e)return this.itemSelection.select(t=>t instanceof Go&&t.datum===e)[0]}getSeriesRange(t,e){return[Number.NaN,Number.NaN]}isSeriesHighlighted(t,e){const{series:i,legendItemName:s,itemId:n}=t??{},a="number"==typeof n?e?.[n]:void 0;return i===this||null!=a&&a===s}},wA=class extends rg{constructor(t,e,i,s){super(t,e,i,s),this.angleKey=s.properties.angleKey,this.radiusKey=s.properties.radiusKey,this.calloutLabelKey=s.properties.calloutLabelKey,this.sectorLabelKey=s.properties.sectorLabelKey}},CA=class extends AA{constructor(t){super({moduleCtx:t,categoryKey:void 0,propertyKeys:{...DA,sectorLabel:["sectorLabelKey"],calloutLabel:["calloutLabelKey"]},propertyNames:{...kA,sectorLabel:["sectorLabelName"],calloutLabel:["calloutLabelName"]},pickModes:[1,0],animationResetFns:{item:MA,label:dI}}),this.properties=new bA,this.phantomNodeData=void 0,this.backgroundGroup=new za({name:`${this.id}-background`,zIndex:0}),this.noVisibleData=!1,this.previousRadiusScale=new gb,this.radiusScale=new gb,this.phantomGroup=this.backgroundGroup.appendChild(new Oa({name:"phantom"})),this.phantomSelection=gd.select(this.phantomGroup,()=>this.nodeFactory(),!1),this.calloutLabelGroup=this.contentGroup.appendChild(new Oa({name:"pieCalloutLabels"})),this.calloutLabelSelection=new gd(this.calloutLabelGroup,Oa),this.zerosumRingsGroup=this.backgroundGroup.appendChild(new Oa({name:`${this.id}-zerosumRings`})),this.zerosumOuterRing=this.zerosumRingsGroup.appendChild(new Ig({shape:"circle"})),this.zerosumInnerRing=this.zerosumRingsGroup.appendChild(new Ig({shape:"circle"})),this.innerLabelsGroup=this.contentGroup.appendChild(new Oa({name:"innerLabels"})),this.innerCircleGroup=this.backgroundGroup.appendChild(new Oa({name:`${this.id}-innerCircle`})),this.innerLabelsSelection=gd.select(this.innerLabelsGroup,_o),this.innerCircleSelection=gd.select(this.innerCircleGroup,()=>new Ig({shape:"circle"})),this.surroundingRadius=void 0,this.NodeEvent=wA,this.angleScale=new gb,this.angleScale.domain=[0,1],this.angleScale.range=[-Math.PI,Math.PI].map(t=>t+Math.PI/2),this.phantomGroup.opacity=.2,this.innerLabelsGroup.pointerEvents=1}get calloutNodeData(){return this.phantomNodeData??this.nodeData}get hasData(){return this.getHasData("angleValue")}attachSeries(t,e,i){super.attachSeries(t,e,i),t?.appendChild(this.backgroundGroup)}detachSeries(t,e,i){super.detachSeries(t,e,i),this.backgroundGroup.remove()}setZIndex(t){super.setZIndex(t),this.backgroundGroup.zIndex=[0,t]}nodeFactory(){const t=new uA;return t.miterLimit=1e9,t}getSeriesDomain(t){return"angle"===t?this.angleScale.domain:this.radiusScale.domain}async processData(t){if(null==this.data)return;const{visible:e,id:s,ctx:{legendManager:n}}=this,{angleKey:a,angleFilterKey:o,radiusKey:r,calloutLabelKey:l,sectorLabelKey:c,legendItemKey:h}=this.properties,d=()=>(t,i)=>e&&n.getItemEnabled({seriesId:s,itemId:i})?t:0,u=!this.ctx.animationManager.isSkipped(),p=[],g=[];h?p.push(Sx(h,"category",{id:"legendItemKey"})):l?p.push(Sx(l,"category",{id:"calloutLabelKey"})):c&&p.push(Sx(c,"category",{id:"sectorLabelKey"}));const m=this.radiusScale.type,f=this.angleScale.type;r&&g.push(wx(r,{id:"radiusValue",min:this.properties.radiusMin??0,max:this.properties.radiusMax,missingValue:this.properties.radiusMax??1,processor:d}),Ix(r,m,{id:"radiusRaw",processor:d}),jx("radiusValue",[0,1],1,this.properties.radiusMin??0,this.properties.radiusMax)),l&&g.push(Ix(l,"category",{id:"calloutLabelValue"})),c&&g.push(Ix(c,"category",{id:"sectorLabelValue"})),h&&g.push(Ix(h,"category",{id:"legendItemValue"})),o&&g.push(Cx(o,f,{id:"angleFilterValue",onlyPositive:!0,invalidValue:0,processor:d}),Ix(o,f,{id:"angleFilterRaw"}),jx("angleFilterValue",[0,1],0,0)),u&&this.processedData?.reduced?.animationValidation?.uniqueKeys&&p.length>0&&g.push(Ux(this.id,this.processedData)),g.push(Fx()),await this.requestDataModel(t,this.data,{props:[...p,Cx(a,f,{id:"angleValue",onlyPositive:!0,invalidValue:0,processor:d}),Ix(a,f,{id:"angleRaw"}),jx("angleValue",[0,1],0,0),...g]});for(const t of this.processedData?.defs?.values??[]){const{id:e,missing:s,property:n}=t,a=zh(this,s);"angleRaw"!==e&&a>0&&i.warnOnce(`no value was found for the key '${String(n)}' on ${a} data element${a>1?"s":""}`)}this.animationState.transition("updateData")}maybeRefreshNodeData(){if(!this.nodeDataRefresh)return;const{nodeData:t=[],phantomNodeData:e}=this.createNodeData()??{};this.nodeData=t,this.phantomNodeData=e,this.nodeDataRefresh=!1}getProcessedDataValues(t,e){return{angleValues:t.resolveColumnById(this,"angleValue",e),angleRawValues:t.resolveColumnById(this,"angleRaw",e),angleFilterValues:null==this.properties.angleFilterKey?void 0:t.resolveColumnById(this,"angleFilterValue",e),angleFilterRawValues:null==this.properties.angleFilterKey?void 0:t.resolveColumnById(this,"angleFilterRaw",e),radiusValues:this.properties.radiusKey?t.resolveColumnById(this,"radiusValue",e):void 0,radiusRawValues:this.properties.radiusKey?t.resolveColumnById(this,"radiusRaw",e):void 0,calloutLabelValues:this.properties.calloutLabelKey?t.resolveColumnById(this,"calloutLabelValue",e):void 0,sectorLabelValues:this.properties.sectorLabelKey?t.resolveColumnById(this,"sectorLabelValue",e):void 0,legendItemValues:this.properties.legendItemKey?t.resolveColumnById(this,"legendItemValue",e):void 0}}createNodeData(){const{id:t,processedData:e,dataModel:i,angleScale:s,ctx:{legendManager:n},visible:a}=this,{rotation:o,innerRadiusRatio:r}=this.properties;if(!i||"ungrouped"!==e?.type)return;const l=this.getProcessedDataValues(i,e),{angleValues:c,angleRawValues:h,angleFilterValues:d,angleFilterRawValues:u,radiusValues:p,radiusRawValues:g,legendItemValues:m}=l,f=u?.some((t,e)=>t>h[e])??!1;let y=0,x=0;const b=[],v=null==u?void 0:[],M=e.dataSources.get(this.id)?.data??[],S=e.invalidData?.get(this.id);for(const[e,i]of M.entries()){if(!0===S?.[e])continue;const r=f?d[e]:c[e],M=null==u||f?1:Math.sqrt(u[e]/h[e]),I=s.convert(y)+pn(o);y=r,x+=r;const D=s.convert(y)+pn(o),k=Math.abs(D-I),A=I+k/2,w=h[e],C=(p?.[e]??1)*M,N=g?.[e],L=m?.[e],T=this.getLabels(e,i,A,k,l),E=this.getItemStyle({datum:i,datumIndex:e},!1),O={itemId:e,series:this,datum:i,datumIndex:e,angleValue:w,midAngle:A,midCos:Math.cos(A),midSin:Math.sin(A),startAngle:I,endAngle:D,radius:C,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(C),0),sectorFormat:E,radiusValue:N,legendItemValue:L,enabled:a&&n.getItemEnabled({seriesId:t,itemId:e}),focusable:!0,...T};b.push(O),null!=v&&v.push({...O,radius:1,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(1),0),focusable:!1})}return this.zerosumOuterRing.visible=0===x,this.zerosumInnerRing.visible=0===x&&null!=r&&1!==r&&r>0,{itemId:t,nodeData:b,labelData:b,phantomNodeData:v}}getLabelContent(t,e,i){const{id:s,ctx:n,properties:a}=this,{formatManager:o}=n,{calloutLabel:r,sectorLabel:l,calloutLabelKey:c,sectorLabelKey:h,legendItemKey:d}=a,u=i.calloutLabelValues?.[t],p=i.sectorLabelValues?.[t],g=i.legendItemValues?.[t],m={datum:e,angleKey:this.properties.angleKey,angleName:this.properties.angleName,radiusKey:this.properties.radiusKey,radiusName:this.properties.radiusName,calloutLabelKey:this.properties.calloutLabelKey,calloutLabelName:this.properties.calloutLabelName,sectorLabelKey:this.properties.sectorLabelKey,sectorLabelName:this.properties.sectorLabelName,legendItemKey:this.properties.legendItemKey},f={callout:void 0,sector:void 0,legendItem:void 0};return c&&(f.callout=this.getLabelText(u,e,c,"calloutLabel",[],r,{...m,value:u})),h&&(f.sector=this.getLabelText(p,e,h,"sectorLabel",[],l,{...m,value:p})),null!=d&&null!=g&&(f.legendItem=o.format(this.callWithContext.bind(this),{type:"category",value:g,datum:e,seriesId:s,legendItemName:void 0,key:d,source:"legend-label",property:"legendItem",domain:[],boundSeries:this.getFormatterContext("legendItem")})??g),f}getLabels(t,e,i,s,n){const{properties:a}=this,{calloutLabel:o,sectorLabel:r,legendItemKey:l}=a,c=this.getLabelContent(t,e,n),h={};return o.enabled&&c.callout&&s>=pn(o.minAngle)&&(h.calloutLabel={...this.getTextAlignment(i),text:c.callout,hidden:!1,collisionTextAlign:void 0,collisionOffsetY:0,box:void 0}),r.enabled&&c.sector&&(h.sectorLabel={text:c.sector}),l&&c.legendItem&&(h.legendItem={key:l,text:c.legendItem}),h}getTextAlignment(t){const e=[{textAlign:"center",textBaseline:"bottom"},{textAlign:"left",textBaseline:"middle"},{textAlign:"center",textBaseline:"top"},{textAlign:"right",textBaseline:"middle"}],i=dn(t)- -.75*Math.PI;var s,n;return e[(s=Math.floor(i/(Math.PI/2)),n=e.length,Math.floor(s%n+(s<0?Math.abs(n):0)))]}getFillParams(t,e,i){if(pa(t)&&"item"!==t.bounds)return{centerX:0,centerY:0,innerRadius:e,outerRadius:i}}getItemStyle({datum:t,datumIndex:e},i,s,n){const{fills:a,strokes:o,itemStyler:r}=this.properties,l=o[e],c=a[e],{fill:h,fillOpacity:d,stroke:u,strokeWidth:p,strokeOpacity:g,lineDash:m,lineDashOffset:f,cornerRadius:y,opacity:x}=zs(this.getHighlightStyle(i,e,s,n),{fill:c,stroke:l},this.properties);let b;return r&&(b=this.cachedDatumCallback(this.getDatumId(e)+(i?"-highlight":"-hide"),()=>{const s=this.makeItemStylerParams(t,e,i,{fill:h,fillOpacity:d,stroke:u,strokeWidth:p,strokeOpacity:g,lineDash:m,lineDashOffset:f,cornerRadius:y});return this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],this.callWithContext(r,s),{proxyPaths:{fill:["fills",`${e}`],stroke:["strokes",`${e}`]}})})),{fill:b?.fill??h,fillOpacity:b?.fillOpacity??d,stroke:b?.stroke??u,strokeWidth:b?.strokeWidth??p,strokeOpacity:b?.strokeOpacity??g,lineDash:b?.lineDash??m,lineDashOffset:b?.lineDashOffset??f,cornerRadius:b?.cornerRadius??y,opacity:x}}makeItemStylerParams(t,e,i,s){const{angleKey:n,radiusKey:a,calloutLabelKey:o,sectorLabelKey:r,legendItemKey:l}=this.properties,c=this.filterItemStylerFillParams(s.fill)??s.fill;return{datum:t,angleKey:n,radiusKey:a,calloutLabelKey:o,sectorLabelKey:r,legendItemKey:l,...s,fill:c,highlighted:i,highlightState:this.getHighlightStateString(this.ctx.highlightManager?.getActiveHighlight(),i,e),seriesId:this.id}}getCalloutLineStyle(t,e){const{properties:i}=this;let s={};if(i.calloutLine.itemStyler){const n=this.getHighlightStateString(this.ctx.highlightManager?.getActiveHighlight(),e,t.datumIndex),a={angleKey:i.angleKey,angleName:i.angleName??i.angleKey,calloutLabelKey:i.calloutLabelKey,calloutLabelName:i.calloutLabelName??i.calloutLabelKey,datum:t.datum,highlighted:e,highlightState:n,legendItemKey:i.legendItemKey,radiusKey:i.radiusKey,radiusName:i.radiusName??i.radiusKey,sectorLabelKey:i.sectorLabelKey,sectorLabelName:i.sectorLabelName??i.sectorLabelKey,seriesId:this.id};s=this.cachedCallWithContext(i.calloutLine.itemStyler,a)??{}}return{length:s.length??i.calloutLine.length,strokeWidth:s.strokeWidth??i.calloutLine.strokeWidth,color:s.color,colors:i.calloutLine.colors}}getInnerRadius(){const{radius:t}=this,{innerRadiusRatio:e=1,innerRadiusOffset:i=0}=this.properties,s=t*e+i;return s===t||s<0?0:s}getOuterRadius(){const{outerRadiusRatio:t,outerRadiusOffset:e}=this.properties;return Math.max(this.radius*t+e,0)}updateRadiusScale(t){const e=[this.getInnerRadius(),this.getOuterRadius()];this.radiusScale.range=e,t&&(this.previousRadiusScale.range=e);const i=t=>({...t,innerRadius:Math.max(this.radiusScale.convert(0),0),outerRadius:Math.max(this.radiusScale.convert(t.radius),0)});this.nodeData=this.nodeData.map(i),this.phantomNodeData=this.phantomNodeData?.map(i)}getTitleTranslationY(){const t=Math.max(0,this.radiusScale.range[1]);return 0===t?Number.NaN:-t-(2+(this.properties.title?.spacing??0))-Math.max(0,-t)}update({seriesRect:t}){const{title:e}=this.properties,i={seriesRectWidth:t?.width,seriesRectHeight:t?.height},s=null!=Ka(this.nodeDataDependencies,i);if(s&&(this._nodeDataDependencies=i),this.maybeRefreshNodeData(),this.updateTitleNodes(),this.updateRadiusScale(s),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.backgroundGroup.translationX=this.centerX,this.backgroundGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),e){const t=this.getTitleTranslationY();e.node.y=Number.isFinite(t)?t:0;const i=e.node.getBBox();e.node.visible=e.enabled&&Number.isFinite(t)&&!this.bboxIntersectsSurroundingSeries(i)}for(const t of[this.zerosumInnerRing,this.zerosumOuterRing])t.fillOpacity=0,t.stroke=this.properties.calloutLabel.color,t.strokeWidth=1,t.strokeOpacity=1;this.updateNodeMidPoint(),this.updateSelections(),this.updateNodes(t)}updateTitleNodes(){const{oldTitle:t}=this,{title:e}=this.properties;t!==e&&(t&&t.node.remove(),e&&(e.node.textBaseline="bottom",this.labelGroup?.appendChild(e.node)),this.oldTitle=e)}updateNodeMidPoint(){const t=t=>{const e=t.innerRadius+(t.outerRadius-t.innerRadius)/2;t.midPoint={x:t.midCos*Math.max(0,e),y:t.midSin*Math.max(0,e)}};for(const e of this.nodeData)t(e);if(this.phantomNodeData)for(const e of this.phantomNodeData)t(e)}updateSelections(){this.updateGroupSelection(),this.updateInnerCircleSelection()}updateGroupSelection(){const{itemSelection:t,highlightSelection:e,phantomSelection:i,calloutLabelSelection:s,labelSelection:n,innerLabelsSelection:a}=this,o=this.nodeData.map(t=>({...t,sectorFormat:{...t.sectorFormat}})),r=(t,e)=>{t.update(e,void 0,t=>this.getDatumId(t.datumIndex)),this.ctx.animationManager.isSkipped()&&t.cleanup()};r(t,this.nodeData),r(e,o),r(i,this.phantomNodeData??[]),s.update(this.calloutNodeData,t=>{const e=new md;e.tag=0,e.pointerEvents=1,t.appendChild(e);const i=new _o;i.tag=1,i.pointerEvents=1,t.appendChild(i)}),n.update(this.nodeData),a.update(this.properties.innerLabels,t=>{t.pointerEvents=1})}updateInnerCircleSelection(){const{innerCircle:t}=this.properties;let e=0;const i=this.getInnerRadius();if(i>0){const t=Math.min(i,this.getOuterRadius()),s=1;e=Math.ceil(2*t+s)}const s=t?[{radius:e}]:[];this.innerCircleSelection.update(s)}updateNodes(t){const e=this.ctx.highlightManager.getActiveHighlight(),{visible:i,dataModel:s,processedData:n}=this;if(this.backgroundGroup.visible=i,this.contentGroup.visible=i,!s||!n)return;const{legendItemValues:a}=this.getProcessedDataValues(s,n),o=this.isSeriesHighlighted(e,a),r=this.ctx.chartService.highlight?.drawingMode??"overlay";this.highlightGroup.visible=i&&o,this.labelGroup.visible=i,this.innerCircleSelection.each((t,{radius:e})=>{t.setProperties({fill:this.properties.innerCircle?.fill,opacity:this.properties.innerCircle?.fillOpacity,size:e})});const l=this.radiusScale.range[0],c=this.radiusScale.range[1],h=this.getShapeFillBBox(),d=this.ctx.animationManager.isSkipped(),u=(t,e,i,s,n)=>{const o=this.getItemStyle(e,s,void 0,a);e.sectorFormat.fill=o.fill,e.sectorFormat.stroke=o.stroke,d&&(t.startAngle=e.startAngle,t.endAngle=e.endAngle,t.innerRadius=e.innerRadius,t.outerRadius=e.outerRadius),(s||d)&&(t.fill=o.fill,t.stroke=o.stroke);const r=this.getFillParams(o.fill,l,c);ag(t,o,h,r),t.drawingMode=n,t.cornerRadius=o.cornerRadius,t.fillShadow=this.properties.shadow;const u=Math.max((this.properties.sectorSpacing+(null==o.stroke?0:o.strokeWidth))/2,0);t.inset=u,t.lineJoin=this.properties.sectorSpacing>=0||u>0?"miter":"round"};this.itemSelection.each((t,e,i)=>u(t,e,0,!1,"overlay")),this.phantomSelection.each((t,e,i)=>u(t,e,0,!1,"overlay")),this.highlightSelection.each((t,i,s)=>{u(t,i,0,!0,r),t.visible=i.itemId===e?.itemId}),this.updateCalloutLineNodes(),this.updateCalloutLabelNodes(t),this.updateSectorLabelNodes(),this.updateInnerLabelNodes(),this.updateZerosumRings(),this.animationState.transition("update")}updateCalloutLineNodes(){const{strokes:t}=this.properties,{offset:e}=this.properties.calloutLabel;for(const i of this.calloutLabelSelection.selectByTag(0)){const s=i.closestDatum(),{length:n,strokeWidth:a,color:o,colors:r}=this.getCalloutLineStyle(s,!1),l=a,c=ga(r)?r:t,{calloutLabel:h,outerRadius:d,datumIndex:u}=s;if(h?.text&&!h.hidden&&0!==d){i.visible=!0,i.strokeWidth=l,i.stroke=o??c[u%c.length],i.strokeOpacity=this.getHighlightStyle(!1,s.datumIndex).opacity??1,i.fill=void 0;const t=s.midCos*d,a=s.midSin*d;let r=s.midCos*(d+n),p=s.midSin*(d+n);if((h.collisionTextAlign??0!==h.collisionOffsetY)&&null!=h.box){const t=h.box;let i=r,s=p;r<t.x?i=t.x:r>t.x+t.width&&(i=t.x+t.width),p<t.y?s=t.y:p>t.y+t.height&&(s=t.y+t.height);const n=i-r,a=s-p,o=Math.sqrt(Math.pow(n,2)+Math.pow(a,2)),l=o-e;l>0&&(r+=n*l/o,p+=a*l/o)}i.x1=t,i.y1=a,i.x2=r,i.y2=p}else i.visible=!1}}getLabelOverflow(t,e){const i=-this.centerX,s=i+e.width,n=-this.centerY,a=n+e.height;let o=t.width;return t.x+1<i?o=(t.x+t.width-i)/t.width:t.x+t.width-1>s&&(o=(s-t.x)/t.width),{maxWidth:o,hasVerticalOverflow:t.y+1<n||t.y+t.height-1>a,hasSurroundingSeriesOverflow:this.bboxIntersectsSurroundingSeries(t)}}bboxIntersectsSurroundingSeries(t){const{surroundingRadius:e}=this;if(null==e)return!1;const i=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],s=e**2;return i.some(t=>t.x**2+t.y**2>s)}computeCalloutLabelCollisionOffsets(){const{radiusScale:t}=this,{calloutLabel:e}=this.properties,{offset:i,minSpacing:s}=e,n=t.convert(0),a=this.calloutNodeData,o=a.filter(t=>{return!(!(e=t).calloutLabel||0===e.outerRadius);var e});for(const t of o){const e=t.calloutLabel;null!=e&&(e.hidden=!1,e.collisionTextAlign=void 0,e.collisionOffsetY=0)}if(o.length<=1)return;const r=o.filter(t=>t.midCos<0).sort((t,e)=>t.midSin-e.midSin),l=o.filter(t=>t.midCos>=0).sort((t,e)=>t.midSin-e.midSin),c=o.filter(t=>t.midSin<0&&"center"===t.calloutLabel?.textAlign).sort((t,e)=>t.midCos-e.midCos),h=o.filter(t=>t.midSin>=0&&"center"===t.calloutLabel?.textAlign).sort((t,e)=>t.midCos-e.midCos),d=t=>{const s=t.calloutLabel;if(null==s)return fs.zero.clone();const n=Ad(this.getLabelStyle(t,e)),a=this.getCalloutLineStyle(t,!1).length,o=t.outerRadius+a+i,r=t.midCos*o,l=t.midSin*o+s.collisionOffsetY,c=s.collisionTextAlign??s.textAlign,h=s.textBaseline;return _o.measureBBox(s.text,r,l,{font:this.properties.calloutLabel,textAlign:c,textBaseline:h}).grow(n)},u=(t,e,i)=>{const n=d(t).grow(s/2),a=d(e).grow(s/2);n.x<a.x+a.width&&n.x+n.width>a.x&&("to-top"===i?n.y<a.y+a.height:n.y+n.height>a.y)&&(e.calloutLabel.collisionOffsetY="to-top"===i?n.y-a.y-a.height:n.y+n.height-a.y)},p=t=>{const e=t.slice().sort((t,e)=>Math.abs(t.midSin)-Math.abs(e.midSin))[0],i=t.indexOf(e);for(let e=i-1;e>=0;e--){const i=t[e+1],s=t[e];u(i,s,"to-top")}for(let e=i+1;e<t.length;e++){const i=t[e-1],s=t[e];u(i,s,"to-bottom")}},g=t=>{const e=o.some(t=>0!==t.calloutLabel.collisionOffsetY),i=t.map(t=>d(t)),r=i.map(t=>t.clone().grow(s/2));let l=!1;for(let e=0;e<r.length&&!l;e++){const i=r[e];for(let s=e+1;s<t.length;s++){const t=r[s];if(i.collidesBBox(t)){l=!0;break}}}const c=a.map(t=>{const{startAngle:e,endAngle:i,outerRadius:s}=t;return{startAngle:e,endAngle:i,innerRadius:n,outerRadius:s}}),h=i.some(t=>c.some(e=>function(t,e){const i={x:t.x,y:t.y},s={x:t.x+t.width,y:t.y},n={x:t.x,y:t.y+t.height},a={x:t.x+t.width,y:t.y+t.height};return aA({start:i,end:s},e)||aA({start:n,end:a},e)}(t,e)));if(l||e||h)for(const e of t){if("center"!==e.calloutLabel.textAlign)continue;const t=e.calloutLabel;e.midCos<0?t.collisionTextAlign="right":e.midCos>0?t.collisionTextAlign="left":t.collisionTextAlign="center"}};p(r),p(l),g(c),g(h)}getLabelStyle(t,e){const i=this.ctx.highlightManager?.getActiveHighlight();return aI(this,t,this.properties,e,!1,i)}updateCalloutLabelNodes(t){const{radiusScale:e}=this,{calloutLabel:i}=this.properties,s=new _o;for(const n of this.calloutLabelSelection.selectByTag(1)){const a=n.closestDatum(),o=a.calloutLabel,r=e.convert(a.radius),l=Math.max(0,r);if(!o?.text||0===l||o.hidden){n.visible=!1;continue}const c=this.getLabelStyle(a,i),h=l+this.getCalloutLineStyle(a,!1).length+i.offset,d=a.midCos*h,u=a.midSin*h+o.collisionOffsetY,p={textAlign:o.collisionTextAlign??o.textAlign,textBaseline:o.textBaseline};s.text=o.text,s.x=d,s.y=u,s.setFont(c),s.setAlign(p),s.setBoxing(c);const g=s.getBBox();let m=o.text,f=!0;if(i.avoidCollisions){const{maxWidth:e,hasVerticalOverflow:i}=this.getLabelOverflow(g,t);if(g.width>e){const t={font:this.properties.calloutLabel,textWrap:"on-space",overflow:"hide",maxWidth:e};m=Ji(o.text,t)}f=!i}n.text=m,n.x=d,n.y=u,n.setFont(c),n.setAlign(p),n.setBoxing(c),n.fill=c.color,n.fillOpacity=this.getHighlightStyle(!1,a.datumIndex).opacity??1,n.visible=f}}computeLabelsBBox(t,e){const{calloutLabel:i}=this.properties,{offset:s,maxCollisionOffset:n,minSpacing:a}=i;if(!i.avoidCollisions)return null;this.maybeRefreshNodeData(),this.updateRadiusScale(!1),this.computeCalloutLabelCollisionOffsets();const o=[],r=new _o;let l;const{title:c}=this.properties;if(c?.text&&c.enabled){const t=this.getTitleTranslationY();Number.isFinite(t)&&(r.text=c.text,r.x=0,r.y=t,r.setFont(c),r.setAlign({textBaseline:"bottom",textAlign:"center"}),l=r.getBBox(),o.push(l))}for(const c of this.calloutNodeData){const h=c.calloutLabel;if(!h||0===c.outerRadius)continue;const d=this.getLabelStyle(c,i),u=this.getCalloutLineStyle(c,!1).length,p=c.outerRadius+u+s,g=c.midCos*p,m=c.midSin*p+h.collisionOffsetY;r.text=h.text,r.x=g,r.y=m,r.setFont(d),r.setAlign({textAlign:h.collisionTextAlign??h.textAlign,textBaseline:h.textBaseline}),r.setBoxing(d);const f=r.getBBox();if(h.box=f,Math.abs(h.collisionOffsetY)>n)h.hidden=!0;else{if(l){const t=-this.centerY,e=new fs(l.x-a,t,l.width+2*a,l.y+l.height+a-t);if(f.collidesBBox(e)){h.hidden=!0;continue}}if(t.hideWhenNecessary){const{maxWidth:t,hasVerticalOverflow:i,hasSurroundingSeriesOverflow:s}=this.getLabelOverflow(f,e),n=f.width>t;if(i||n||s){h.hidden=!0;continue}}h.hidden=!1,o.push(f)}}return 0===o.length?null:fs.merge(o)}updateSectorLabelNodes(){const{properties:t}=this,{positionOffset:e,positionRatio:i}=this.properties.sectorLabel,s=this.radiusScale.convert(0),n=s<=0&&1===this.ctx.legendManager.getData(this.id)?.filter(t=>t.enabled).length,a={textAlign:"center",textBaseline:"middle"};this.labelSelection.each((o,r)=>{const{outerRadius:l,startAngle:c,endAngle:h}=r;let d=!1;if(r.sectorLabel&&0!==l){const u=this.getLabelStyle(r,t.sectorLabel),p=s*(1-i)+l*i+e;o.fill=u.color,o.fillOpacity=this.getHighlightStyle(!1,r.datumIndex).opacity??1,o.text=r.sectorLabel.text,n?(o.x=0,o.y=0):(o.x=r.midCos*p,o.y=r.midSin*p),o.setFont(u),o.setAlign(a),o.setBoxing(u);const g=o.getBBox(),m=[[g.x,g.y],[g.x+g.width,g.y],[g.x+g.width,g.y+g.height],[g.x,g.y+g.height]],f={startAngle:c,endAngle:h,innerRadius:s,outerRadius:l};m.every(([t,e])=>nA(t,e,f))&&(d=!0)}o.visible=d})}updateInnerLabelNodes(){const t=[],e=[];this.innerLabelsSelection.each((i,s)=>{const{fontStyle:n,fontWeight:a,fontSize:o,fontFamily:r,color:l}=s;i.fontStyle=n,i.fontWeight=a,i.fontSize=o,i.fontFamily=r,i.text=s.text,i.x=0,i.y=0,i.fill=l,i.textAlign="center",t.push(i.getBBox()),e.push(s.spacing)});const i=t=>0===t?0:e[t],s=t=>t===e.length-1?0:e[t],n=t.reduce((t,e)=>Math.max(t,e.width),0),a=t.reduce((t,e,n)=>t+e.height+i(n)+s(n),0),o=this.getInnerRadius(),r=Math.sqrt(Math.pow(n/2,2)+Math.pow(a/2,2))<=(o>0?o:this.getOuterRadius()),l=[];for(let e=0,n=-a/2;e<t.length;e++){const a=t[e].height+n+i(e);l.push(a),n=a+s(e)}this.innerLabelsSelection.each((e,i,s)=>{e.visible=r,Array.isArray(e.text)?e.y=l[s]-t[s].height:e.y=l[s]})}updateZerosumRings(){this.zerosumOuterRing.size=2*this.getOuterRadius(),this.zerosumInnerRing.size=2*this.getInnerRadius()}pickNodeClosestDatum(t){return SA(this,t)}getTooltipContent(t){const{id:e,dataModel:i,processedData:s,properties:n,ctx:{formatManager:a}}=this,{legendItemKey:o,calloutLabelKey:r,calloutLabelName:l,sectorLabelKey:c,sectorLabelName:h,angleKey:d,angleName:u,radiusKey:p,radiusName:g,tooltip:m}=n,f=this.properties.title.node.getPlainText();if(!i||!s)return;const y=s.dataSources.get(this.id)?.data?.[t],x=this.getProcessedDataValues(i,s),{angleRawValues:b}=x,v=b[t],M=this.getLabelContent(t,y,x),S=M.legendItem??M.callout??M.sector??u,I=i.getDomain(this,"angleRaw","value",s),D=a.format(this.callWithContext.bind(this),{type:"number",value:v,datum:y,seriesId:e,legendItemName:void 0,key:d,source:"tooltip",property:"angle",domain:I,boundSeries:this.getFormatterContext("angle"),fractionDigits:void 0})??Zr(v,3);return this.formatTooltipWithContext(m,{title:f,symbol:this.legendItemSymbol(t),data:[{label:At(S),fallbackLabel:d,value:D}]},{seriesId:e,datum:y,title:u,legendItemKey:o,calloutLabelKey:r,calloutLabelName:l,sectorLabelKey:c,sectorLabelName:h,angleKey:d,angleName:u,radiusKey:p,radiusName:g,...this.getItemStyle({datum:y,datumIndex:t},!1)})}legendItemSymbol(t){const e=this.processedData?.dataSources.get(this.id)?.data?.[t],i=this.getItemStyle({datum:e,datumIndex:t},!1),{fillOpacity:s,strokeOpacity:n,strokeWidth:a,lineDash:o,lineDashOffset:r}=this.properties;let{fill:l}=i;const{stroke:c}=i;return pa(l)&&(l={...l,gradient:"linear",rotation:0,reverse:!1}),{marker:{fill:l,stroke:c,fillOpacity:s,strokeOpacity:n,strokeWidth:a,lineDash:o,lineDashOffset:r}}}getLegendData(t){const{visible:e,processedData:i,dataModel:s,id:n,ctx:{legendManager:a}}=this;if(!s||!i||"category"!==t)return[];const{angleKey:o,calloutLabelKey:r,sectorLabelKey:l,legendItemKey:c,showInLegend:h}=this.properties;if(!(c||r&&r!==o||l&&l!==o))return[];const d=this.getProcessedDataValues(s,i),{angleRawValues:u}=d,p=this.properties.title?.showInLegend&&this.properties.title.text,g=[],m=this.properties.hideZeroValueSectorsInLegend,f=i.dataSources.get(this.id)?.data,y=i.invalidData?.get(this.id);for(let t=0;t<i.input.count;t++){const i=f?.[t],s=u[t];if(!0===y?.[t]||m&&0===s)continue;const x=[];p&&x.push(p);const b=this.getLabelContent(t,i,d);c&&void 0!==b.legendItem?x.push(b.legendItem):r&&r!==o&&void 0!==b.callout?x.push(b.callout):l&&l!==o&&void 0!==b.sector&&x.push(b.sector),0!==x.length&&g.push({legendType:"category",id:n,datum:i,itemId:t,seriesId:n,hideToggleOtherSeries:!0,enabled:e&&a.getItemEnabled({seriesId:n,itemId:t}),label:{text:x.map(t=>At(t)).join(" - ")},symbol:this.legendItemSymbol(t),legendItemName:null==c?void 0:i[c],hideInLegend:!h})}return g}setLegendState(t){const{id:e,ctx:{legendManager:i,updateService:s}}=this;for(const[s,n]of t.entries())i.toggleItem(n,e,s);i.update(),s.update(5)}animateEmptyUpdateReady(t){const{animationManager:e}=this.ctx,i=vA(!0,this.properties.rotation,this.radiusScale,this.previousRadiusScale);cd(this.id,"nodes",e,[this.itemSelection,this.highlightSelection,this.phantomSelection],i.nodes,(t,e)=>this.getDatumId(e.datumIndex)),cd(this.id,"innerCircle",e,[this.innerCircleSelection],i.innerCircle),cI(this,"callout",e,this.calloutLabelSelection),cI(this,"sector",e,this.labelSelection),cI(this,"inner",e,this.innerLabelsSelection),this.previousRadiusScale.range=this.radiusScale.range}animateWaitingUpdateReady(){const{itemSelection:t,highlightSelection:e,phantomSelection:i,processedData:s,radiusScale:n,previousRadiusScale:a}=this,{animationManager:o}=this.ctx,r=s?.reduced?.diff?.[this.id];this.ctx.animationManager.stopByAnimationGroupId(this.id);const l=0===(r?.moved.size??0),c=(s?.defs.keys.length??0)>0;l&&c&&(s?.reduced?.animationValidation?.uniqueKeys??1)||this.ctx.animationManager.skipCurrentBatch();const h=!this.nodeData.some(t=>t.enabled),d=vA(!1,this.properties.rotation,n,a);cd(this.id,"nodes",o,[t,e,i],d.nodes,(t,e)=>this.getDatumId(e.datumIndex),r),cd(this.id,"innerCircle",o,[this.innerCircleSelection],d.innerCircle),cI(this,"callout",this.ctx.animationManager,this.calloutLabelSelection),cI(this,"sector",this.ctx.animationManager,this.labelSelection),this.noVisibleData!==h&&(this.noVisibleData=h,cI(this,"inner",this.ctx.animationManager,this.innerLabelsSelection)),this.previousRadiusScale.range=this.radiusScale.range}animateClearingUpdateEmpty(){const{itemSelection:t,highlightSelection:e,phantomSelection:i,radiusScale:s,previousRadiusScale:n}=this,{animationManager:a}=this.ctx,o=vA(!1,this.properties.rotation,s,n);cd(this.id,"nodes",a,[t,e,i],o.nodes,(t,e)=>this.getDatumId(e.datumIndex)),cd(this.id,"innerCircle",a,[this.innerCircleSelection],o.innerCircle),hI(this,"callout",this.ctx.animationManager,this.calloutLabelSelection),hI(this,"sector",this.ctx.animationManager,this.labelSelection),hI(this,"inner",this.ctx.animationManager,this.innerLabelsSelection),this.previousRadiusScale.range=this.radiusScale.range}getDatumId(t){const{dataModel:e,processedData:i}=this;if(!e||!i)return`${t}`;const{calloutLabelKey:s,sectorLabelKey:n,legendItemKey:a}=this.properties;return i.reduced?.animationValidation?.uniqueKeys?a?Wx(e.resolveKeysById(this,"legendItemKey",i)[t]):s?Wx(e.resolveKeysById(this,"calloutLabelKey",i)[t]):n?Wx(e.resolveKeysById(this,"sectorLabelKey",i)[t]):`${t}`:`${t}`}hasItemStylers(){return!(null==this.properties.itemStyler&&null==this.properties.calloutLabel.itemStyler&&null==this.properties.sectorLabel.itemStyler&&this.properties.innerLabels.every(t=>null==t.itemStyler))}};CA.className="DonutSeries",CA.type="donut";var NA={series:{title:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:qo.LARGE},fontFamily:{$ref:"fontFamily"},color:{$ref:"subtleTextColor"},spacing:5},calloutLabel:{...mf,enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},offset:3,minAngle:.001},sectorLabel:{...mf,enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"chartBackgroundColor"},positionOffset:0,positionRatio:.5},calloutLine:{length:10,strokeWidth:2,colors:{$map:[{$if:[{$or:[{$isGradient:{$value:"$1"}},{$isPattern:{$value:"$1"}},{$isImage:{$value:"$1"}}]},{$path:["../../strokes/$index",{$ref:"foregroundColor"}]},{$value:"$1"}]},{$if:[{$eq:[{$path:"../strokeWidth"},0]},{$path:"../fills"},{$path:"../strokes"}]}]}},fills:{$applyCycle:[{$cacheMax:{$size:{$path:["./data",{$path:"/data"}]}}},{$palette:"fills"},{$applySwitch:[{$path:["/type",void 0,{$value:"$1"}]},{$value:"$1"},["gradient",nf],["pattern",of],["image",hf]]}]},strokes:{$applyCycle:[{$cacheMax:{$size:{$path:["./data",{$path:"/data"}]}}},{$palette:"strokes"}]},fillOpacity:1,strokeOpacity:1,strokeWidth:{$isUserOption:["./strokes/0",2,0]},lineDash:[0],lineDashOffset:0,rotation:0,sectorSpacing:1,shadow:{enabled:!1,color:dm,xOffset:3,yOffset:3,blur:5},highlight:ff()},legend:{enabled:!0}},LA={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["polar"],identifier:"donut",moduleFactory:t=>new CA(t),themeTemplate:{...NA,series:{...NA.series,innerRadiusRatio:{$if:[{$eq:[{$path:["./innerRadiusOffset",void 0]},void 0]},.7,void 0]},innerLabels:{$apply:{...mf,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:2}},highlight:yf()}}},TA={type:"series",name:"donut",chartType:"polar",options:cv,create:t=>new CA(t)},EA=class extends CA{};EA.className="PieSeries",EA.type="pie";var OA={type:"series",optionsKey:"series[]",packageType:"community",chartTypes:["polar"],identifier:"pie",moduleFactory:t=>new EA(t),themeTemplate:NA},RA={type:"series",name:"pie",chartType:"polar",options:rv,create:t=>new EA(t)};var PA=Symbol("IGNORED_PROP");function zA(t,e){const i={};for(const s of Object.keys(e)){const n=e[s];n!==PA&&Object.hasOwn(t,s)&&(i[s]=n)}return i}function jA(t){const{enabled:e,mode:i,showArrow:s,range:n,position:a,pagination:o,delay:r,wrapping:l,interaction:c,renderer:h,...d}=t,u=zA(t,{enabled:e,showArrow:s,range:n,position:a,interaction:c,renderer:h,...d});return{chartTooltipOptions:zA(t,{enabled:PA,showArrow:PA,range:PA,position:PA,mode:i,pagination:o,delay:r,wrapping:l,...d}),seriesTooltipOptions:u}}function BA(t,e){if(null==e)return t;const{targets:i,...s}=e;return null!=(t=zs(t,s)).targets&&null!=i&&(t.targets=Bs(t.targets,i)),t}var FA={stroke:Cm},VA={fill:Em},GA={color:"white",fill:Cm},$A={color:Cm},HA={color:Lm,fontSize:{$rem:qo.LARGE},fontFamily:{$ref:"fontFamily"}},UA={...HA,fontSize:{$ref:"fontSize"},color:Pm,fill:Om,stroke:Rm,strokeWidth:1,divider:{stroke:zm,strokeWidth:1,strokeOpacity:.5}},WA={...FA,background:{fill:Tm,fillOpacity:.2},handle:{...VA},text:{...$A},statistics:{...UA}},_A={line:{...FA,handle:{...VA},text:{...$A}},"horizontal-line":{...FA,handle:{...VA},axisLabel:{...GA},text:{...$A}},"vertical-line":{...FA,handle:{...VA},axisLabel:{...GA},text:{...$A}},"disjoint-channel":{...FA,background:{fill:Tm,fillOpacity:.2},handle:{...VA},text:{...$A}},"parallel-channel":{...FA,background:{fill:Tm,fillOpacity:.2},handle:{...VA},text:{...$A}},"fibonacci-retracement":{...FA,strokes:Nm,rangeStroke:Cm,handle:{...VA},text:{...$A,position:"center"},label:{...HA,color:void 0,fontSize:{$rem:qo.SMALLER}}},"fibonacci-retracement-trend-based":{...FA,strokes:Nm,rangeStroke:Cm,handle:{...VA},text:{...$A,position:"center"},label:{...HA,color:void 0,fontSize:{$rem:qo.SMALLER}}},callout:{...FA,...HA,color:{$ref:"textColor"},handle:{...VA},fill:Tm,fillOpacity:.2},comment:{...HA,color:"white",fontWeight:700,handle:{...VA},fill:Cm},note:{...HA,color:Gm,fill:Cm,stroke:{$ref:"chartBackgroundColor"},strokeWidth:1,strokeOpacity:1,handle:{...VA},background:{fill:Fm,stroke:Vm,strokeWidth:1}},text:{...HA,handle:{...VA}},arrow:{...FA,handle:{...VA},text:{...$A}},"arrow-up":{fill:{$palette:"up.fill"},handle:{...VA,stroke:Cm}},"arrow-down":{fill:{$palette:"down.fill"},handle:{...VA,stroke:Cm}},"date-range":{...WA},"price-range":{...WA},"date-price-range":{...WA},"quick-date-price-range":{up:{...FA,fill:Tm,fillOpacity:.2,handle:{...VA},statistics:{...UA,color:"#fff",fill:Tm,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}}},down:{...FA,stroke:Bm,fill:jm,fillOpacity:.2,handle:{...VA,stroke:Bm},statistics:{...UA,color:"#fff",fill:jm,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}}}},axesButtons:{enabled:!0}},YA=["ohlc","line","step-line","hlc","high-low","candlestick","hollow-candlestick"],KA=[{icon:"trend-line-drawing",tooltip:"toolbarAnnotationsLineAnnotations",value:"line-menu"},{icon:"fibonacci-retracement-drawing",tooltip:"toolbarAnnotationsFibonacciAnnotations",value:"fibonacci-menu"},{icon:"text-annotation",tooltip:"toolbarAnnotationsTextAnnotations",value:"text-menu"},{icon:"arrow-drawing",tooltip:"toolbarAnnotationsShapeAnnotations",value:"shape-menu"},{icon:"measurer-drawing",tooltip:"toolbarAnnotationsMeasurerAnnotations",value:"measurer-menu"},{icon:"delete",tooltip:"toolbarAnnotationsClearAll",value:"clear"}],ZA="range-area";function XA(t,e){return[{type:"candlestick",focusPriority:0,...t,...e}]}function QA(t,e){return e[t]??e.default}var qA={title:{enabled:!1},label:{enabled:!1},line:{enabled:!1},gridLine:{enabled:!1},crosshair:{enabled:!1,stroke:wm,lineDash:[0],label:{enabled:!1}}},JA={...qA,nice:!1},tw={mode:"compact",position:{anchorTo:"node",placement:["right","left"]},showArrow:!1},ew={style:[{stroke:{$ref:"gridLineColor"}}],width:2},iw={number:{gridLine:ew},time:{gridLine:ew},category:{gridLine:ew}},sw={overrides:{common:{animation:{enabled:!1},contextMenu:{enabled:!1},keyboard:{enabled:!1},background:{visible:!1},navigator:{enabled:!1},padding:{top:0,right:0,bottom:0,left:0},axes:{number:{...JA,interval:{values:[0]}},log:{...JA},time:{...JA},category:{...qA}}},bar:{series:{crisp:!1,label:{placement:"inside-end",padding:4},sparklineMode:!0},tooltip:{...tw,position:{...tw.position,anchorTo:"pointer"},range:"nearest"},axes:iw},line:{seriesArea:{padding:{top:2,right:2,bottom:2,left:2}},series:{sparklineMode:!0,strokeWidth:1,marker:{enabled:!1,size:3}},tooltip:tw},area:{seriesArea:{padding:{top:1,right:0,bottom:1,left:0}},series:{strokeWidth:1,fillOpacity:.4},tooltip:tw}}},nw=kl(function(t,e){return"string"==typeof t?{...e,baseTheme:t}:null!=t?{...t,baseTheme:nw(t.baseTheme,e)}:e});function aw(t){if(Array.isArray(t)&&0!==t.length){const e=t.find(t=>null!=t);if("number"==typeof e)return{data:t.map((t,e)=>({x:e,y:t})),series:[{xKey:"x",yKey:"y"}],datumKey:"y"};if(Array.isArray(e))return{data:t.map(t=>({x:t?.[0],y:t?.[1],datum:t})),series:[{xKey:"x",yKey:"y"}],datumKey:"datum"}}else if(0===t?.length)return{data:t,series:[{xKey:"x",yKey:"y"}],datumKey:"y"};return{data:t}}function ow(t){switch(t?.type){case"number":{const{type:e,min:i,max:s,reverse:n}=t;return zA(t,{type:e,reverse:n,min:i,max:s})}case"time":{const{type:e,min:i,max:s,reverse:n}=t;return zA(t,{type:e,reverse:n,min:i,max:s})}default:{const{paddingInner:e,paddingOuter:i,reverse:s}=t??{};return zA({...t,type:"category"},{type:"category",reverse:s,paddingInner:e,paddingOuter:i})}}}function rw(t,e,i){const s={};return null!=t?.stroke&&(s.style=[{stroke:t?.stroke}],s.enabled??(s.enabled=!0)),null!=t?.strokeWidth&&(s.width=t?.strokeWidth,s.enabled??(s.enabled=!0)),"bar"===i.type&&"horizontal"!==i.direction&&(s.enabled??(s.enabled=!0)),null!=t?.visible&&(s.enabled=t.visible),s.enabled??(s.enabled=e),s}var lw=kl((t,e,i)=>s=>{const n=s.datum[s.xKey],a=s.datum[s.yKey],o=null==i?s.datum:s.datum[i],r=e?.renderer?.({context:t,datum:o,xValue:n,yValue:a});if("string"==typeof r)return r;const l=r?.content??a.toFixed(2);return r?.title?{heading:void 0,title:void 0,data:[{label:r.title,value:l}]}:{heading:void 0,title:l,data:[]}}),cw={chartType:ue("candlestick","hollow-candlestick","ohlc","line","step-line","hlc","high-low"),dateKey:ie,openKey:ie,highKey:ie,lowKey:ie,closeKey:ie,volumeKey:ie,navigator:Zt,volume:Zt,rangeButtons:Zt,statusBar:Zt,toolbar:Zt,zoom:Zt,sync:Zt,theme:Jt,container:Jt,width:Jt,height:Jt,minWidth:Jt,minHeight:Jt,listeners:Jt,initialState:Jt,title:Jt,data:Kt,formatter:Jt},hw={theme:Jt,container:Jt,animation:Jt,background:Jt,contextMenu:Jt,context:()=>!0,listeners:Jt,locale:Jt,width:Jt,height:Jt,minWidth:Jt,minHeight:Jt,title:Jt,subtitle:Jt,footnote:Jt,padding:Jt,tooltip:{...Ny,...vy.tooltip}};hw.overrideDevicePixelRatio=Vt(re);var dw=["showInLegend","showInMiniChart","grouped","stacked","stackGroup","tooltip","listeners","errorBar","xKey","yKey","type"],uw={visible:Zt,reverse:Zt,stroke:Qt,strokeWidth:re},pw={context:()=>!0,tooltip:Jt,theme:Jt,background:Jt,container:Jt,width:Jt,height:Jt,minWidth:Jt,minHeight:Jt,padding:Jt,listeners:Jt,locale:Jt,data:Jt,styleNonce:ie,axis:Ut({number:{...uw,min:Wt(te,he("max")),max:Wt(te,de("min"))},category:{...uw,paddingInner:ce,paddingOuter:ce},time:{...uw,min:Wt(_t(te,qt),he("max")),max:Wt(_t(te,qt),de("min"))}},"axis options","category"),min:Wt(te,he("max")),max:Wt(te,de("min")),crosshair:{enabled:Zt,snap:Zt,...Ae,...Oe},xKey:ie,yKey:ie};pw.overrideDevicePixelRatio=Vt(te);var gw={type:"preset",name:"price-volume",enterprise:!0,options:cw,create:function(t,e,s){const{dateKey:n="date",highKey:a="high",openKey:o="open",lowKey:r="low",closeKey:l="close",volumeKey:c="volume",chartType:h="candlestick",navigator:d=!1,volume:u=!0,rangeButtons:p=!0,statusBar:g=!0,toolbar:m=!0,zoom:f=!0,sync:y=!1,theme:x,data:b,formatter:v,...M}=t,S=function(t,e,s,n,a,o){const r={xKey:e,openKey:a,closeKey:o,highKey:s,lowKey:n},l={xKey:e,yKey:o},c={pickOutsideVisibleMinorAxis:!0};switch(t??"candlestick"){case"ohlc":return function(t,e){return[{type:"ohlc",focusPriority:0,...t,...e}]}(c,r);case"line":case"step-line":return function(t,e){return[{type:"line",focusPriority:0,...t,...e}]}(c,l);case"hlc":return function(t,e,{xKey:i,highKey:s,closeKey:n,lowKey:a}){return[{type:ZA,focusPriority:0,...t,xKey:i,yHighKey:s,yLowKey:n,fill:fm,stroke:gm},{type:ZA,focusPriority:0,...t,xKey:i,yHighKey:n,yLowKey:a,fill:ym,stroke:mm},{type:"line",...t,...e}]}(c,l,r);case"high-low":return function(t,{xKey:e,highKey:i,lowKey:s}){return[{type:"range-bar",...t,xKey:e,yHighKey:i,yLowKey:s,fill:bm,stroke:xm,tooltip:{range:"nearest"},focusPriority:0}]}(c,r);case"candlestick":case"hollow-candlestick":return XA(c,r);default:return i.warnOnce(`unknown chart type: ${t}; expected one of: ${YA.join(", ")}`),XA(c,r)}}(h,n,a,r,o,l),I=function(t,e,i,s,n){return s?[{type:"bar",xKey:"date",yKey:n,tooltip:{enabled:!1},itemStyler({datum:s}){const{up:n,down:a}=t().palette;return{fill:s[e]<s[i]?n?.fill:a?.fill}},focusPriority:1,highlight:{enabled:!1}}]:[]}(s,o,l,u,c),D={navigator:{enabled:d,...u?{miniChart:{enabled:d,series:[{type:"line",xKey:n,yKey:c,stroke:Ym,marker:{enabled:!1}}]},height:40,minHandle:{height:46},maxHandle:{height:46}}:null}},k={annotations:{enabled:m,optionsToolbar:{enabled:m},snap:!0,toolbar:{enabled:m,buttons:KA,padding:0},data:b,xKey:n,volumeKey:u?c:void 0}},A=g?{statusBar:{enabled:!0,data:b,highKey:a,openKey:o,lowKey:r,closeKey:l,volumeKey:u?c:void 0}}:null,w={zoom:{enabled:f,autoScaling:{enabled:!0},enableIndependentAxes:!0}},C={ranges:{enabled:p}},N=y?{sync:{enabled:y,nodeInteraction:!0,zoom:!0}}:null,L=u?[{type:"number",position:"left",keys:[c],label:{enabled:!1},crosshair:{enabled:!1},gridLine:{enabled:!1},nice:!1,layoutConstraints:{stacked:!1,width:20,unit:"percent",align:"end"}}]:[];return{theme:{baseTheme:"string"==typeof x?x:"ag-financial",...zs("object"==typeof x?x:null,{overrides:{common:{title:{padding:4},padding:{top:6,right:8,bottom:6},chartToolbar:{enabled:m},annotations:{..._A},axes:{number:{interval:{maxSpacing:45},label:{format:".2f"}}}},bar:{series:{fillOpacity:.5}},line:{series:{marker:{enabled:!1},...QA(h,{hlc:{stroke:{$palette:"altNeutral.stroke"},strokeWidth:2},line:{stroke:{$palette:"neutral.stroke"}},"step-line":{stroke:{$palette:"neutral.stroke"},interpolation:{type:"step"}}})}},candlestick:{series:{...QA(h,{"hollow-candlestick":{item:{up:{fill:"transparent"}}}})}},"range-area":{series:{fillOpacity:.3,strokeWidth:2}}}})},animation:{enabled:!1},legend:{enabled:!1},series:[...I,...S],axes:[{type:"number",position:"right",keys:[o,l,a,r],crosshair:{enabled:!0,snap:!1},layoutConstraints:{stacked:!1,width:100,unit:"percent",align:"start"}},...L,{type:"ordinal-time",position:"bottom",line:{enabled:!1},label:{enabled:!0},crosshair:{enabled:!0}}],tooltip:{enabled:!1},data:b,formatter:v,...k,...D,...A,...w,...C,...N,...M}}},mw={type:"preset",name:"gauge-preset",enterprise:!0,options:Ut({"linear-gauge":{...Vs(zy,["type"]),...hw},"radial-gauge":{...Vs(By,["type"]),...hw}},"gauge options"),create:function(t,e){switch(t.type){case"radial-gauge":return function(t){const{animation:e,background:i,container:s,contextMenu:n,context:a,footnote:o,height:r,listeners:l,locale:c,minHeight:h,minWidth:d,overrideDevicePixelRatio:u,padding:p,subtitle:g,theme:m,title:f,width:y,type:x,cursor:b,nodeClickRange:v,tooltip:M={},value:S,scale:I={},startAngle:D,endAngle:k,highlightStyle:A,highlight:w,segmentation:C,bar:N,needle:L,targets:T,outerRadius:E,innerRadius:O,outerRadiusRatio:R,innerRadiusRatio:P,cornerRadius:z,cornerMode:j,label:B,secondaryLabel:F,spacing:V,...G}=t,{chartTooltipOptions:$,seriesTooltipOptions:H}=jA(M);return{...zA(t,{animation:e,background:i,container:s,contextMenu:n,context:a,footnote:o,height:r,listeners:l,locale:c,minHeight:h,minWidth:d,overrideDevicePixelRatio:u,padding:p,subtitle:g,theme:m,title:f,tooltip:$,width:y}),series:[zA(t,{needle:null==L?PA:{enabled:!0,...L},startAngle:D,endAngle:k,scale:I,type:x,cursor:b,context:a,nodeClickRange:v,tooltip:H,value:S,highlightStyle:A,highlight:w,segmentation:C,bar:N,targets:T,outerRadius:E,innerRadius:O,outerRadiusRatio:R,innerRadiusRatio:P,cornerRadius:z,cornerMode:j,label:B,secondaryLabel:F,spacing:V,...G})]}}(BA(t,e));case"linear-gauge":return function(t){const{animation:e,background:i,container:s,contextMenu:n,context:a,footnote:o,height:r,listeners:l,locale:c,minHeight:h,minWidth:d,overrideDevicePixelRatio:u,padding:p,subtitle:g,theme:m,title:f,width:y,type:x,cursor:b,nodeClickRange:v,tooltip:M={},value:S,scale:I={},direction:D="vertical",thickness:k,highlightStyle:A,highlight:w,segmentation:C,bar:N,targets:L,cornerRadius:T,cornerMode:E,label:O,...R}=t,{chartTooltipOptions:P,seriesTooltipOptions:z}=jA(M);return{...zA(t,{animation:e,background:i,container:s,contextMenu:n,context:a,footnote:o,height:r,listeners:l,locale:c,minHeight:h,minWidth:d,overrideDevicePixelRatio:u,padding:p,subtitle:g,theme:m,title:f,tooltip:P,width:y}),series:[zA(t,{scale:I,type:x,cursor:b,context:a,nodeClickRange:v,tooltip:z,value:S,direction:D,thickness:k,highlightStyle:A,highlight:w,segmentation:C,bar:N,targets:L,cornerRadius:T,cornerMode:E,label:O,...R})]}}(BA(t,e));default:return{}}}},fw={type:"preset",name:"sparkline",options:Ut({area:{...pw,...Vs(Ub,dw)},bar:{...pw,...Vs(Kb,dw)},line:{...pw,...Vs(iv,dw)}},"sparkline options"),create:function(t){const{background:e,container:i,height:s,listeners:n,locale:a,minHeight:o,minWidth:r,overrideDevicePixelRatio:l,padding:c,width:h,theme:d,data:u,crosshair:p,axis:g,min:m,max:f,tooltip:y,context:x,styleNonce:b,...v}=t,M=zA(t,{background:e,container:i,height:s,listeners:n,locale:a,minHeight:o,minWidth:r,overrideDevicePixelRatio:l,padding:c,width:h,styleNonce:b,tooltip:PA,context:PA,data:PA,crosshair:PA,axis:PA,min:PA,max:PA,theme:PA}),{data:S,series:[I]=[],datumKey:D}=aw(u),k=v;null!=I&&Object.assign(k,I),k.tooltip={...y,renderer:lw(x,y,D)},M.theme=nw(d,sw),M.data=S,M.series=[k];const A="bar"!==k.type||"horizontal"!==k.direction,[w,C]=A?["bottom","left"]:["left","bottom"],N={...ow(g),position:w,...zA(t,{crosshair:p})},L={type:"number",gridLine:rw(g,!1,t),position:C,...zA(t,{min:m,max:f})};return M.axes=A?[L,N]:[N,L],M},processData:aw};function yw(t){const e=new Map;for(const i of t){if(!(i instanceof GI))continue;const t=(i.seriesGrouping?.stackCount??0)>0?i.seriesGrouping?.groupIndex:void 0;if(null==t){i.seriesBelowStackContext=void 0,i.createStackContext();continue}const s=`${i.type}-${t}`;let n=e.get(s);null==n&&(n=[],e.set(s,n)),n.push(i)}for(const t of e.values()){let e;t.sort((t,e)=>(t.seriesGrouping?.stackIndex??0)-(e.seriesGrouping?.stackIndex??0));for(const i of t)i.seriesBelowStackContext=e,e=i.createStackContext()}}var xw=["top","right","bottom","left"],bw=class t extends sm{constructor(t,e){super(t,e),this.paired=!0,this.axes=[],this.lastUpdateClipRect=void 0,this.lastLayoutWidth=Number.NaN,this.lastLayoutHeight=Number.NaN}onAxisChange(t,e){super.onAxisChange(t,e),this.syncAxisChanges(t,e),null!=this.ctx&&this.ctx.zoomManager.updateAxes(t)}destroySeries(t){super.destroySeries(t),this.lastLayoutWidth=Number.NaN,this.lastLayoutHeight=Number.NaN}getChartType(){return"cartesian"}setRootClipRects(t){const{seriesRoot:e,annotationRoot:i}=this;e.setClipRect(t),i.setClipRect(t)}async processData(){await super.processData(),"init"===this.syncStatus&&(this.syncStatus="domains-calculated"),this.ctx.updateService.dispatchProcessData({series:{shouldFlipXY:this.shouldFlipXY()}})}async processDomains(){await super.processDomains();for(const t of this.axes){const e=await this.getSyncedDomain(t);null!=e&&t.setDomains(e)}}performLayout(t){const{seriesRoot:e,annotationRoot:i}=this,{clipSeries:s,seriesRect:n,visible:a}=this.updateAxes(t.layoutBox);this.seriesRoot.visible=a,this.seriesRect=n,this.animationRect=t.layoutBox;const{x:o,y:r}=n;if(t.width!==this.lastLayoutWidth||t.height!==this.lastLayoutHeight)for(const t of[e,i])t.translationX=Math.floor(o),t.translationY=Math.floor(r);else{const{translationX:t,translationY:s}=e;hd(this.id,"seriesRect",this.ctx.animationManager,[e,i],{translationX:t,translationY:s},{translationX:Math.floor(o),translationY:Math.floor(r)},{phase:"update"})}this.lastLayoutWidth=t.width,this.lastLayoutHeight=t.height;const l=this.modulesManager.getModule("seriesArea"),c=n.clone().grow(l.getPadding()),h=l.clip||s?c:void 0,{lastUpdateClipRect:d}=this;this.lastUpdateClipRect=h,this.ctx.animationManager.isActive()&&null!=d?this.ctx.animationManager.animate({id:this.id,groupId:"clip-rect",phase:"update",from:d,to:c,onUpdate:t=>this.setRootClipRects(t),onComplete:()=>this.setRootClipRects(h)}):this.setRootClipRects(h),this.ctx.layoutManager.emitLayoutComplete(t,{axes:this.axes.map(t=>t.getLayoutState()),series:{visible:a,rect:n,paddedRect:c},clipSeries:s}),yw(this.series)}updateAxes(t){const{clipSeries:e,seriesRect:i,overflows:s}=this.resolveAxesLayout(t);for(const e of this.axes)e.update(),e.setCrossLinesVisible(!s),this.clipAxis(e,i,t);return{clipSeries:e,seriesRect:i,visible:!s}}resolveAxesLayout(t){let e,s,n=0;const a=this.axes.filter(t=>null!=t.crossAt?.value);do{if(s=e??this.getDefaultState(),e=this.updateAxesPass(new Map(s.axisAreaWidths),t.clone(),a),n++>10){i.warn("Max iterations reached. Unable to stabilize axes layout.");break}}while(!this.isLayoutStable(e,s));return this.lastAreaWidths=e.axisAreaWidths,e}updateAxesPass(e,i,s){const n=new Map,a={};let o=!1,r=!1;for(const t of xw){const e=this.modulesManager.getModule("seriesArea").getPadding()[t],s=this.axes.findLast(e=>e.position===t);s?s.seriesAreaPadding=e:i.shrink(e,t)}const l=(e.get("left")??0)+(e.get("right")??0),c=(e.get("top")??0)+(e.get("bottom")??0),h=this.buildCrossLinePadding(e),d=h.left+h.right,u=h.top+h.bottom;i.width<=l+d||i.height<=c+u?o=!0:i.shrink(h);const{scene:p}=this.ctx,g=i.clone().shrink(Object.fromEntries(e));for(const t of this.axes){const{position:e="left",direction:i}=t,s="y"===i;let o;this.sizeAxis(t,g,e),o=null==t.thickness?Mw(s,p)*(t.maxThicknessRatio??1):t.thickness;const{primaryTickCount:l,bbox:c}=t.calculateLayout(t.nice?a[i]:void 0,{sizeLimit:o,padding:this.padding});a[i]??(a[i]=l),r||(r=t.dataDomain.clipped||t.visibleRange[0]>0||t.visibleRange[1]<1),null==t.thickness&&(o=Math.min(Mw(s,c)??0,o)),n.set(t.id,Math.ceil(o))}let m;s.length>0&&(m=this.calculateAxesCrossPositions(n,g,s));const f=qe(this.axes,t=>t.position??"left"),y=new Map,x=new Map;for(const[e,i]of ri(f)){let s=Mw("left"!==e&&"right"!==e,p)%p.pixelRatio,a=0;for(const e of i??[]){x.set(e.id,s);const i=n.get(e.id)??0;a=Math.max(a,s+i),e.layoutConstraints.stacked&&(s+=i+t.AxesPadding)}y.set(e,Math.ceil(a))}for(const[t,e]of ri(f))this.positionAxes({axes:e??[],position:t,axisWidths:n,axisOffsets:x,axisAreaWidths:y,axisBound:i,seriesRect:g});return null!=m&&this.applyAxisCrossing(g,m),{clipSeries:r,seriesRect:g,axisAreaWidths:y,overflows:o}}calculateAxesCrossPositions(t,e,i){const s=new Map,n=this.axes.find(t=>"x"===t.direction),a=this.axes.find(t=>"y"===t.direction);for(const o of i){const{crossPosition:i,visible:r}=this.calculateAxisCrossPosition(o,n,a);o.setAxisVisible(r),this.adjustAxisWidth(o,t,i,e,r),null!=i&&s.set(o.id,i)}return s}calculateAxisCrossPosition(t,e,i){const s="x"===t.direction?i:e;if(!s)return{crossPosition:void 0,visible:!0};const{scale:{domain:n,bandwidth:a},range:o}=s,r=(a??0)/2,l=s.scale.convert(t.crossAt?.value,{clamp:!1})+r;return s.inRange(l)?{crossPosition:l,visible:!0}:!1===t.crossAt?.sticky?{crossPosition:void 0,visible:!1}:{crossPosition:Number.isNaN(l)?o[n[0]]:zc(l,o),visible:!0}}adjustAxisWidth(t,e,i,s,n){const a=!0===t.getModuleMap().getModule("crosshair")?.enabled,o=!0===this.modulesManager.getModule("annotations")?.enabled,r=this.ctx.annotationManager.createMemento(),l=o||r.some(e=>{switch(e.type){case"vertical-line":return"x"===t.direction;case"horizontal-line":return"y"===t.direction;default:return!1}});if(a||l)return;const c=e.get(t.id)??0,h=n?this.calculateAxisBleedingWidth(t,c,i,s):0;e.set(t.id,h)}calculateAxisBleedingWidth(t,e,i,s){if(null==i)return e;switch(t.position){case"left":case"top":return Math.max(0,e-i);case"right":return Math.max(0,i+e-s.width);case"bottom":return Math.max(0,i+e-s.height);default:return e}}applyAxisCrossing(t,e){for(const i of this.axes){const s=e.get(i.id);if(null==s){i.crossAxisTranslation.x=0,i.crossAxisTranslation.y=0;continue}const n="x"===i.direction;i.crossAxisTranslation.x=n?0:t.x+s-i.translation.x,i.crossAxisTranslation.y=n?t.y+s-i.translation.y:0}}buildCrossLinePadding(t){var e;const i={top:0,right:0,bottom:0,left:0};for(const t of this.axes){const{position:s,label:n}=t;if(t.crossLines)for(const a of t.crossLines)a instanceof Bd&&(a.position=s??"top",(e=a.label).parallel??(e.parallel=n.parallel)),a.calculatePadding?.(i)}for(const[e,s=0]of ri(i))i[e]=Math.max(s-(t.get(e)??0),0);return i}clampToOutsideSeriesRect(t,e,i,s){const n="x"===i?t.x:t.y,a="x"===i?t.width:t.height;return 1===s?Math.min(e,n+a):Math.max(e,n)}async getSyncedDomain(t){const e=this.modulesManager.getModule("sync");if(e?.enabled)return await e.getSyncedDomain(t)}syncAxisChanges(t,e){const i=this.modulesManager.getModule("sync");if(!i?.enabled)return;const s=new Set(e??[]);for(const e of t)s.delete(e);for(const t of s)i.removeAxis(t)}sizeAxis(t,e,i){const s=t instanceof mb,n="left"===i||"right"===i,{width:a,height:o}=e,r=n?o:a;let l=0,c=r,{min:h,max:d}=this.ctx.zoomManager.getAxisZoom(t.id);const{width:u,unit:p,align:g}=t.layoutConstraints;c="px"===p?l+u:c*u/100,"end"===g&&(l=r-(c-l),c=r),n&&(s?[l,c]=[c,l]:[h,d]=[1-d,1-h]),t.range=[l,c],t.visibleRange=[h,d],t.gridLength=n?a:o}positionAxes(t){const{axes:e,axisBound:i,axisWidths:s,axisOffsets:n,axisAreaWidths:a,seriesRect:o,position:r}=t,l=a.get(r)??0;let c="x",h="y",d=1;"top"!==r&&"bottom"!==r||(c="y",h="x");let u=i[c];"right"!==r&&"bottom"!==r||(d=-1,u+="x"===c?i.width:i.height);for(const t of e){const e=a.get("x"===h?"left":"top")??0,r=s.get(t.id)??0,p=n.get(t.id)??0;t.gridPadding=l-p-r,t.translation[h]=i[h]+e,t.translation[c]=this.clampToOutsideSeriesRect(o,u+d*(p+r),c,d)}}shouldFlipXY(){return this.series.every(t=>t instanceof GI&&t.shouldFlipXY())}getDefaultState(){const t=new Map;if(this.lastAreaWidths)for(const{position:e="left"}of this.axes){const i=this.lastAreaWidths.get(e);null!=i&&t.set(e,i)}return{axisAreaWidths:t,clipSeries:!1,overflows:!1}}isLayoutStable(t,e){if(e.overflows!==t.overflows||e.clipSeries!==t.clipSeries)return!1;for(const i of t.axisAreaWidths.keys())if(!e.axisAreaWidths.has(i))return!1;for(const[i,s]of e.axisAreaWidths.entries()){const e=t.axisAreaWidths.get(i);if((null!=s||null!=e)&&s!==e)return!1}return!0}clipAxis(t,e,i){const s=Math.ceil(t.gridLine?.width??0),n=Math.ceil(t.line?.width??0);let{width:a,height:o}=e;switch(a+="x"===t.direction?s:n,o+="y"===t.direction?s:n,t.clipGrid(e.x,e.y,a,o),t.position){case"left":case"right":t.clipTickLines(i.x,e.y-s,i.width+s,e.height+2*s);break;case"top":case"bottom":t.clipTickLines(e.x-s,i.y,e.width+2*s,i.height+s)}}};bw.className="CartesianChart",bw.type="cartesian",bw.AxesPadding=15,ls([ro({changeValue(t,e){this.onAxisChange(t,e)}})],bw.prototype,"axes",2);var vw=bw;function Mw(t,e){return t?e?.width:e?.height}var Sw={mode:Vt(ue("integrated","standalone")),container:se,context:()=>!0,theme:Jt,series:Kt,annotations:Jt,navigator:Jt,initialState:{chartType:ie,annotations:Jt,legend:me({visible:Zt,seriesId:ie,itemId:ie,legendItemName:ie},"legend state array"),zoom:Jt}},Iw={...vy,...Sw,axes:ne(2),data:Kt},Dw={...vy,...Sw,axes:ne(2),data:Kt},kw={...vy,...Sw,data:Kt,topology:Ci},Aw={...vy,...Sw,data:Kt},ww=new Set(["number","log","time"]),Cw=t=>W(t)&&!ww.has(t.type),Nw={type:"chart",name:"cartesian",options:Iw,detect:_p,create:(t,e)=>new vw(t,e),validate(t,e,i){const s=[];"histogram"===t?.series?.[0]?.type&&t?.axes?.some(Cw)&&(s.push(new Pt("invalid","only continuous axis types when histogram series is used",t.axes,i,"axes")),t=Vs(t,["axes"]));const n=jt(t,e,i);return n.invalid.push(...s),n}},Lw=()=>{throw new Error("Enterprise module placeholder cannot be initialised")},Tw={type:"chart",name:"standalone",placeholder:!0,options:{},detect:Kp,create:Lw},Ew={type:"chart",name:"topology",placeholder:!0,options:{},detect:Yp,create:Lw},Ow=class extends su{constructor(){super(...arguments),this.shape="polygon",this.innerRadiusRatio=0,this.defaultTickMinSpacing=20}update(){super.update(),this.tickLineGroup.visible=this.tick.enabled,this.tickLabelGroup.visible=this.label.enabled}layoutCrossLines(){const t=this.label.getSideFlag(),e=this.hasDefinedDomain()||this.hasVisibleSeries(),{rotation:i,parallelFlipRotation:s,regularFlipRotation:n}=this.calculateRotations();for(const a of this.crossLines)a.sideFlag=-t,a.direction=i===-Math.PI/2?"angle":"radius",a.parallelFlipRotation=s,a.regularFlipRotation=n,a.calculateLayout?.(e,this.reverse)}updatePosition(){super.updatePosition();const t=Math.floor(this.translation.x),e=Math.floor(this.translation.y);this.tickLineGroup.translationX=t,this.tickLineGroup.translationY=e,this.tickLabelGroup.translationX=t,this.tickLabelGroup.translationY=e,this.crossLineRangeGroup.translationX=t,this.crossLineRangeGroup.translationY=e,this.crossLineLineGroup.translationX=t,this.crossLineLineGroup.translationY=e,this.crossLineLabelGroup.translationX=t,this.crossLineLabelGroup.translationY=e,this.tickLabelGroupSelection.each((t,e)=>({x:e.x,y:e.y,rotationCenterX:e.rotationCenterX,rotationCenterY:e.rotationCenterY,rotation:e.rotation}))}computeLabelsBBox(t,e){return null}computeRange(){}getAxisLinePoints(){}};ls([ws],Ow.prototype,"shape",2),ls([ws],Ow.prototype,"innerRadiusRatio",2);var Rw=class extends sm{constructor(t,e){super(t,e),this.padding=new so(40),this.ctx.axisManager.axisGroup.zIndex=8}getChartType(){return"polar"}async performLayout(t){const{layoutBox:e}=t,i=e.clone().shrink(this.modulesManager.getModule("seriesArea").getPadding());this.seriesRect=i,this.animationRect=i,this.seriesRoot.translationX=i.x,this.seriesRoot.translationY=i.y,await this.computeCircle(i);for(const t of this.axes)t.update();this.ctx.layoutManager.emitLayoutComplete(t,{series:{visible:!0,rect:i,paddedRect:e}})}updateAxes(t,e,i,s){const n=this.axes.find(t=>"angle"===t.direction),a=this.axes.find(t=>"radius"===t.direction);if(!(n instanceof Ow&&a instanceof Ow))return;const o=n.scale,r=a.innerRadiusRatio;n.innerRadiusRatio=r,n.computeRange(),n.gridLength=s,a.gridAngles=o.ticks({nice:n.nice,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0})?.ticks?.map(t=>o.convert(t)),a.gridRange=n.range,a.range=[s,s*r];for(const s of[n,a])s.translation.x=t.x+e,s.translation.y=t.y+i,s.calculateLayout()}async computeCircle(t){const e=this.series.filter(Pw),i=this.axes.filter(zw),s=(i,s,n)=>{this.updateAxes(t,i,s,n);for(const t of e)t.centerX=i,t.centerY=s,t.radius=n;const a=e.filter(t=>"donut"===t.type||"pie"===t.type);if(a.length>1){const t=a.map(t=>{const e=t.getInnerRadius();return{series:t,innerRadius:e}}).sort((t,e)=>t.innerRadius-e.innerRadius);t.at(-1).series.surroundingRadius=void 0;for(let e=0;e<t.length-1;e++)t[e].series.surroundingRadius=t[e+1].innerRadius}},n=t.width/2,a=t.height/2,o=Math.max(0,Math.min(t.width,t.height)/2);let r=o;s(n,a,r);const l=async({hideWhenNecessary:l=!1}={})=>{const c=[];for(const s of ai(i,e)){const e=await s.computeLabelsBBox({hideWhenNecessary:l},t);e&&c.push(e)}if(0===c.length)return void s(n,a,o);const h=fs.merge(c),d=this.refineCircle(h,r,t);s(d.centerX,d.centerY,d.radius),r=d.radius};await l(),await l(),await l(),await l({hideWhenNecessary:!0}),await l({hideWhenNecessary:!0});for(const s of ai(i,e))await s.computeLabelsBBox({hideWhenNecessary:!0},t);return{radius:r,centerX:n,centerY:a}}refineCircle(t,e,i){const s=-e,n=-e,a=e,o=e;let r=Math.max(0,s-t.x),l=Math.max(0,n-t.y),c=Math.max(0,t.x+t.width-a),h=Math.max(0,t.y+t.height-o);r=c=Math.max(r,c),l=h=Math.max(l,h);const d=i.width-r-c,u=i.height-l-h;let p=Math.min(d,u)/2;const g=.5*i.width/2,m=.5*i.height/2,f=Math.min(g,m);if(p<f){p=f;const t=r+c;if(2*p+(l+h)>i.height){const t=i.height-2*p;2*Math.min(l,h)>t?(l=t/2,h=t/2):l>h?l=t-h:h=t-l}if(2*p+t>i.width){const t=i.width-2*p;2*Math.min(r,c)>t?(r=t/2,c=t/2):r>c?r=t-c:c=t-r}}const y=r+2*p+c,x=l+2*p+h;return{centerX:(i.width-y)/2+r+p,centerY:(i.height-x)/2+l+p,radius:p}}};function Pw(t){return t instanceof AA}function zw(t){return t instanceof Ow}Rw.className="PolarChart",Rw.type="polar";var jw=[Nw,Lb,Tb,Eb,Ob,Rb,Pb,hk,Tk,$k,_k,qk,eA,{type:"chart",name:"polar",options:Dw,detect:function(t){const e=Wp(t);return td.isPolar(e)||function(t){const e=Zh(t)?.find(t=>"polar"===t);return"polar"===e}(e)},create:(t,e)=>new Rw(t,e),validate(t,e,i){const s=[],n=t?.series?.[0]?.type;"pie"!==n&&"donut"!==n||t?.axes&&(s.push(new zt([],t.axes,i,"axes")),t=Vs(t,["axes"]));const a=jt(t,e,i);return a.invalid.push(...s),a}},TA,RA,Tw,Ew,gw,mw,fw],Bw=class t{constructor(t,e,i,s,n,a=1e3){this.name=t,this.buildItem=e,this.releaseItem=i,this.destroyItem=s,this.maxPoolSize=n,this.cleanupTimeMs=a,this.freePool=[],this.busyPool=new Set}static getPool(e,i,s,n,a){return this.pools.has(e)||this.pools.set(e,new t(e,i,s,n,a)),this.pools.get(e)}isFull(){return this.freePool.length+this.busyPool.size>=this.maxPoolSize}hasFree(){return this.freePool.length>0}obtain(e){if(!this.hasFree()&&this.isFull())throw new Error("AG Charts - pool exhausted");let i=this.freePool.pop();return null==i?(i=this.buildItem(e),t.debug(()=>[`Pool[name=${this.name}]: Created instance (${this.freePool.length} / ${this.busyPool.size+1} / ${this.maxPoolSize})`,i])):t.debug(()=>[`Pool[name=${this.name}]: Re-used instance (${this.freePool.length} / ${this.busyPool.size+1} / ${this.maxPoolSize})`,i]),this.busyPool.add(i),{item:i,release:()=>this.release(i)}}obtainFree(){const e=this.freePool.pop();if(null==e)throw new Error("AG Charts - pool has no free instances");return t.debug(()=>[`Pool[name=${this.name}]: Re-used instance (${this.freePool.length} / ${this.busyPool.size+1} / ${this.maxPoolSize})`,e]),this.busyPool.add(e),{item:e,release:()=>this.release(e)}}release(e){if(!this.busyPool.has(e))throw new Error("AG Charts - cannot free item from pool which is not tracked as busy.");t.debug(()=>[`Pool[name=${this.name}]: Releasing instance (${this.freePool.length} / ${this.busyPool.size} / ${this.maxPoolSize})`,e]),this.releaseItem(e),this.busyPool.delete(e),this.freePool.push(e),t.debug(()=>[`Pool[name=${this.name}]: Returned instance to free pool (${this.freePool.length} / ${this.busyPool.size} / ${this.maxPoolSize})`,e]);const i=Date.now(),s=i+.5*this.cleanupTimeMs;this.cleanPoolTimer&&(this.cleanPoolDue??1/0)<s&&(clearTimeout(this.cleanPoolTimer),this.cleanPoolTimer=void 0),this.cleanPoolTimer||(this.cleanPoolDue=i+this.cleanupTimeMs,this.cleanPoolTimer=setTimeout(this.cleanPool.bind(this),this.cleanupTimeMs))}cleanPool(){const e=this.freePool.splice(0);for(const t of e)this.destroyItem(t);t.debug(()=>[`Pool[name=${this.name}]: Cleaned pool of ${e.length} items (${this.freePool.length} / ${this.busyPool.size} / ${this.maxPoolSize})`])}destroy(){this.cleanPool();for(const t of this.busyPool.values())this.destroyItem(t);this.busyPool.clear()}};Bw.pools=new Map,Bw.debug=bs.create(!0,"pool");var Fw=Bw;p.registerMany(jw,cr);var Vw=bs.create(!0,"opts"),Gw=class{static licenseCheck(t){this.licenseChecked||(this.licenseManager=PM.licenseManager?.(t),this.licenseManager?.validateLicense(),this.licenseChecked=!0)}static getLicenseDetails(t){return PM.licenseManager?.({}).getLicenseDetails(t)}static getInstance(t){return Hw.getInstance(t)}static create(t,e){const i=bs.check("scene:stats","scene:stats:verbose")?performance.now():void 0;return Vw.group("AgCharts.create()",()=>{t=bs.inDevelopmentMode(()=>_s(Xa(t)))??t,this.licenseCheck(t);const s=Hw.createOrUpdate({userOptions:t,licenseManager:this.licenseManager,optionsMetadata:e,apiStartTime:i});return this.licenseManager?.isDisplayWatermark()&&this.licenseManager&&PM.injectWatermark?.(s.chart.ctx.domManager,this.licenseManager.getWatermarkMessage()),s})}static createFinancialChart(t){return Vw.group("AgCharts.createFinancialChart()",()=>this.create(t,{presetType:"price-volume"}))}static createGauge(t){return Vw.group("AgCharts.createGauge()",()=>this.create(t,{presetType:"gauge-preset"}))}static __createSparkline(t){return Vw.group("AgCharts.__createSparkline()",()=>{const{pool:e,...i}=t;return this.create(i,{presetType:"sparkline",pool:e??!0,domMode:"minimal",withDragInterpretation:!1})})}};Gw.licenseChecked=!1;var $w=class t{static getInstance(t){const e=sm.getInstance(t);return e?NS.chartInstances.get(e):void 0}static initialiseModules(){t.initialised||(function(){hs.register(OS,sI,eI,TS,ck,Lk,Gk,Qk,tA,LA,OA,Wk);for(const t of[mb,ax,xb,ab,fb,Ib])Yh.register(t.type,{moduleFactory:e=>new t(e)})}(),function(){for(const t of hs.modules){if("enterprise"!==t.packageType||Xh(t)||i.errorOnce("Unexpected enterprise module registered: "+t.identifier),"root"===t.type&&t.themeTemplate)for(const e of t.chartTypes)id.set(e,t.themeTemplate);if("series"===t.type){if(t.chartTypes.length>1)throw new Error(`AG Charts - Module definition error: ${t.identifier}`);sd.register(t.identifier,t)}if("series-option"===t.type&&t.themeTemplate)for(const e of t.seriesTypes)sd.setThemeTemplate(e,t.themeTemplate);if("axis-option"===t.type&&t.themeTemplate)for(const e of t.axisTypes){const i=Yh.getThemeTemplate(e),s=zs(t.themeTemplate,i);Yh.setThemeTemplate(e,s)}"axis"===t.type&&Yh.register(t.identifier,t),"legend"===t.type&&Qh.register(t.identifier,t)}if(hs.hasEnterpriseModules()){const t=Kh.filter(({useCount:t})=>null==t||0===t);t.length>0&&i.errorOnce("Enterprise modules expected but not registered: ",t)}}(),t.initialised=!0)}static createOrUpdate(e){let{proxy:i}=e;const{userOptions:s,licenseManager:n,processedOverrides:a=i?.chart?.chartOptions.processedOverrides??{},specialOverrides:o=i?.chart?.chartOptions.specialOverrides??{},optionsMetadata:r=i?.chart?.chartOptions.optionMetadata??{},deltaOptions:l,data:c,stripSymbols:h=!1,apiStartTime:d}=e,u=null==PM.styles?[]:[["ag-charts-enterprise",PM.styles]];t.initialiseModules(),Vw(()=>[">>> AgCharts.createOrUpdate() user options",Xa(s)]);const{presetType:g}=r;let m=s;Gw.optionsMutationFn&&m&&(m=Gw.optionsMutationFn(Xa(m,kS.OPTIONS_CLONE_OPTS_FAST),g),Vw(()=>[">>> AgCharts.createOrUpdate() MUTATED user options",Xa(m)]));const f=this.getPool(r);let y,x=!1,b=i?.chart;null==b&&f?.hasFree()&&(y=f.obtainFree(),b=y.item);const{document:v,window:M,styleContainer:S,...I}=m??{},D=b?.getChartOptions(),k=new kS(D,I,a,{...o,document:v,window:M,styleContainer:S},r,l,h,d);null!=b&&p.detectChartDefinition(k.processedOptions)===p.detectChartDefinition(b.chartOptions.processedOptions)||(y?.release(),y=this.getPool(k.optionMetadata)?.obtain(k),y?b=y.item:(x=!0,b=t.createChartInstance(k,b))),k.optionsGraph&&b.ctx.optionsGraphService.updateCallback((t,e,i)=>k.optionsGraph?.resolvePartial(t,e,i));for(const[t,e]of u)b.ctx.domManager.addStyles(t,e);return b.ctx.fontManager.updateFonts(k.googleFonts),null!=c&&b.ctx.dataService.restoreData(c),null==i?(i=new NS(b,t.callbackApi,n),i.releaseChart=y?.release):(y||x)&&(i.releaseChart?.(),i.chart=b,i.releaseChart=y?.release),Vw.check()&&void 0!==globalThis.window&&(globalThis.agChartInstances??(globalThis.agChartInstances={}),globalThis.agChartInstances[b.id]=b),b.queuedUserOptions.push(k.userOptions),b.queuedChartOptions.push(k),b.requestFactoryUpdate(t=>{Vw.group(">>>> Chart.applyOptions()",()=>{t.applyOptions(k);const e=t.queuedUserOptions.indexOf(k.userOptions)+1;t.queuedUserOptions.splice(0,e),t.queuedChartOptions.splice(0,e)})}),i}static markRemovedProperties(t,e,i=!1){if("object"!=typeof t)return i;for(const e of Object.keys(t))void 0===t[e]&&(Object.assign(t,{[e]:Symbol("UNSET")}),i||(i=!0));return i}static updateUserDelta(e,i,s){const n=qa(i=Xa(i,kS.OPTIONS_CLONE_OPTS_FAST),t.markRemovedProperties,new Set(["data"]),void 0,void 0,!1);Vw(()=>[">>> AgCharts.updateUserDelta() user delta",Xa(i)]),t.createOrUpdate({proxy:e,deltaOptions:i,stripSymbols:n,apiStartTime:s})}static createChartInstance(t,e){const i=e?.destroy({keepTransferableResources:!0});return p.detectChartDefinition(t.processedOptions).create(t,i)}static getPool(t){if(!0===t.pool)return Fw.getPool(t.presetType??"default",this.createChartInstance,this.detachAndClear,this.destroy,1/0)}};$w.caretaker=new ur(cr),$w.initialised=!1,$w.callbackApi={caretaker:$w.caretaker,create:(t,e,i,s,n)=>$w.createOrUpdate({userOptions:t,processedOverrides:e,specialOverrides:i,optionsMetadata:s,data:n}),update:(t,e,i,s)=>$w.createOrUpdate({userOptions:t,proxy:e,specialOverrides:i,apiStartTime:s}),updateUserDelta:(t,e,i)=>$w.updateUserDelta(t,e,i)},$w.detachAndClear=t=>t.detachAndClear(),$w.destroy=t=>t.destroy();var Hw=$w;rs({},{Arc:()=>Uw,BBox:()=>fs,Caption:()=>sr,CategoryScale:()=>Vu,Group:()=>Oa,Line:()=>md,LinearScale:()=>gb,Marker:()=>Ig,Path:()=>Go,RadialColumnShape:()=>_w,Rect:()=>Uo,Scene:()=>pl,Sector:()=>uA,Shape:()=>ba,TranslatableGroup:()=>za,getRadialColumnWidth:()=>Yw,toRadians:()=>pn});var Uw=class extends Go{constructor(){super(...arguments),this.centerX=0,this.centerY=0,this.radius=10,this.startAngle=0,this.endAngle=2*Math.PI,this.counterClockwise=!1,this.type=0}get fullPie(){return N(cn(this.startAngle),cn(this.endAngle))}updatePath(){const t=this.path;t.clear(),t.arc(this.centerX,this.centerY,this.radius,this.startAngle,this.endAngle,this.counterClockwise),1===this.type?t.closePath():2!==this.type||this.fullPie||(t.lineTo(this.centerX,this.centerY),t.closePath())}computeBBox(){return new fs(this.centerX-this.radius,this.centerY-this.radius,2*this.radius,2*this.radius)}isPointInPath(t,e){const i=this.getBBox();return 0!==this.type&&i.containsPoint(t,e)&&this.path.isPointInPath(t,e)}};function Ww(t,e,i){const s=Math.hypot(t,e),n=Math.atan2(e,t)+i;return{x:Math.cos(n)*s,y:Math.sin(n)*s}}Uw.className="Arc",ls([Xs()],Uw.prototype,"centerX",2),ls([Xs()],Uw.prototype,"centerY",2),ls([Xs()],Uw.prototype,"radius",2),ls([Xs()],Uw.prototype,"startAngle",2),ls([Xs()],Uw.prototype,"endAngle",2),ls([Xs()],Uw.prototype,"counterClockwise",2),ls([Xs()],Uw.prototype,"type",2);var _w=class extends Go{constructor(){super(...arguments),this.isBeveled=!0,this.columnWidth=0,this.startAngle=0,this.endAngle=0,this.outerRadius=0,this.innerRadius=0,this.axisInnerRadius=0,this.axisOuterRadius=0,this.isRadiusAxisReversed=!1}set cornerRadius(t){}computeBBox(){const{innerRadius:t,outerRadius:e,columnWidth:i}=this,s=this.getRotation(),n=-i/2,a=i/2,o=-e,r=-t;let l=1/0,c=1/0,h=-1/0,d=-1/0;for(let t=0;t<4;t+=1){const{x:e,y:i}=Ww(t%2==0?n:a,t<2?o:r,s);l=Math.min(e,l),c=Math.min(i,c),h=Math.max(e,h),d=Math.max(i,d)}return new fs(l,c,h-l,d-c)}getRotation(){const{startAngle:t,endAngle:e}=this;return cn(t+mn(t,e)/2+Math.PI/2)}updatePath(){const{isBeveled:t}=this;t?this.updateBeveledPath():this.updateRectangularPath(),this.checkPathDirty()}updateRectangularPath(){const{columnWidth:t,innerRadius:e,outerRadius:i,path:s}=this,n=-t/2,a=t/2,o=-i,r=-e,l=this.getRotation(),c=[[n,r],[n,o],[a,o],[a,r]].map(([t,e])=>Ww(t,e,l));s.clear(!0),s.moveTo(c[0].x,c[0].y),s.lineTo(c[1].x,c[1].y),s.lineTo(c[2].x,c[2].y),s.lineTo(c[3].x,c[3].y),s.closePath()}updateBeveledPath(){const{columnWidth:t,path:e,outerRadius:i,innerRadius:s,axisInnerRadius:n,axisOuterRadius:a,isRadiusAxisReversed:o}=this,r=N(s,n),l=Math.asin(t/2/s),c=this.getRotation(),h=(t,e)=>Ww(t,e,c),d=(t,e)=>Math.hypot(t,e),u=(t,e)=>e>t?0:Math.sqrt(t**2-e**2),p=(t,e,i)=>i?t<e:t>e,g=r&&!Number.isNaN(l)&&l<Math.PI/6;let m=-t/2,f=t/2;const y=-i,x=-s*(g?Math.cos(l):1),b=p(a,d(s,t/2),!o);if(b){const t=u(a,s);m=-t,f=t}e.clear(!0);const v=h(m,x);e.moveTo(v.x,v.y);const M=N(s,i),S=p(a,d(i,t/2),!o);if(M&&g)e.arc(0,0,s,cn(-l-Math.PI/2)+c,cn(l-Math.PI/2)+c,!1);else if(S){const s=-u(a,t/2),n=u(a,i);if(!b){const t=h(m,s);e.lineTo(t.x,t.y)}if(e.arc(0,0,a,Math.atan2(s,m)+c,Math.atan2(y,-n)+c,!1),!N(n,0)){const t=h(n,y);e.lineTo(t.x,t.y)}e.arc(0,0,a,Math.atan2(y,n)+c,Math.atan2(s,f)+c,!1)}else{const t=h(m,y),i=h(f,y);e.lineTo(t.x,t.y),e.lineTo(i.x,i.y)}const I=h(f,x);if(e.lineTo(I.x,I.y),g)e.arc(0,0,s,cn(l-Math.PI/2)+c,cn(-l-Math.PI/2)+c,!0);else{const t=h(m,x);e.lineTo(t.x,t.y)}e.closePath()}};function Yw(t,e,i,s,n){const a=mn(t,e),o=a*(1-s)/2;if(t+=o,e-=o,a<.001)return 2*i*n;if(a>=2*Math.PI){const i=t+a/2;t=i-Math.PI,e=i+Math.PI}const r=i*Math.cos(t),l=i*Math.sin(t),c=i*Math.cos(e),h=i*Math.sin(e),d=Math.floor(Math.hypot(r-c,l-h)),u=2*i*n;return Math.max(1,Math.min(u,d))}_w.className="RadialColumnShape",ls([Xs()],_w.prototype,"isBeveled",2),ls([Xs()],_w.prototype,"columnWidth",2),ls([Xs()],_w.prototype,"startAngle",2),ls([Xs()],_w.prototype,"endAngle",2),ls([Xs()],_w.prototype,"outerRadius",2),ls([Xs()],_w.prototype,"innerRadius",2),ls([Xs()],_w.prototype,"axisInnerRadius",2),ls([Xs()],_w.prototype,"axisOuterRadius",2),ls([Xs()],_w.prototype,"isRadiusAxisReversed",2);rs({},{ChartTheme:()=>kf,DEFAULT_ANNOTATION_HANDLE_FILL:()=>Em,DEFAULT_ANNOTATION_STATISTICS_COLOR:()=>Pm,DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE:()=>zm,DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL:()=>jm,DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE:()=>Bm,DEFAULT_ANNOTATION_STATISTICS_FILL:()=>Om,DEFAULT_ANNOTATION_STATISTICS_STROKE:()=>Rm,DEFAULT_CAPTION_ALIGNMENT:()=>pm,DEFAULT_CAPTION_LAYOUT_STYLE:()=>um,DEFAULT_FIBONACCI_STROKES:()=>Nm,DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL:()=>Tm,DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR:()=>Cm,DEFAULT_GRIDLINE_ENABLED:()=>Hm,DEFAULT_POLAR_SERIES_STROKE:()=>Am,DEFAULT_SEPARATION_LINES_COLOUR:()=>hm,DEFAULT_SHADOW_COLOUR:()=>dm,DEFAULT_SPARKLINE_CROSSHAIR_STROKE:()=>wm,DEFAULT_TEXTBOX_COLOR:()=>Gm,DEFAULT_TEXTBOX_FILL:()=>Fm,DEFAULT_TEXTBOX_STROKE:()=>Vm,DEFAULT_TEXT_ANNOTATION_COLOR:()=>Lm,DEFAULT_TOOLBAR_POSITION:()=>$m,IS_DARK_THEME:()=>cm,PALETTE_ALT_DOWN_FILL:()=>Im,PALETTE_ALT_DOWN_STROKE:()=>Mm,PALETTE_ALT_NEUTRAL_FILL:()=>Dm,PALETTE_ALT_NEUTRAL_STROKE:()=>km,PALETTE_ALT_UP_FILL:()=>Sm,PALETTE_ALT_UP_STROKE:()=>vm,PALETTE_DOWN_FILL:()=>ym,PALETTE_DOWN_STROKE:()=>mm,PALETTE_NEUTRAL_FILL:()=>bm,PALETTE_NEUTRAL_STROKE:()=>xm,PALETTE_UP_FILL:()=>fm,PALETTE_UP_STROKE:()=>gm,getChartTheme:()=>EM,resolveOperation:()=>Zw,themeNames:()=>Kw,themeSymbols:()=>lm,themes:()=>TM});var Kw=Object.keys(TM);function Zw(t){const e=kf.getDefaultPublicParameters(),i=kf.getDefaultColors();return new SS({line:{operation:t}},{series:[{type:"line"}]},e,i).resolve().operation}function Xw(){return(t,e)=>{const s=[`Property [${t}] is deprecated.`,e].filter(Boolean).join(" ");i.warnOnce(s)}}function Qw(t,e){const i=Xw(),s=e?.default;return Ns((e,n,a)=>(a!==s&&i(n.toString(),t),a))}function qw(t,e){const i=Xw();return Ns((s,n,a)=>(a!==s[t]&&(i(n.toString(),`Use [${t}] instead.`),Us(s,t,e?e(a):a)),Ds),(e,s)=>(i(s.toString(),`Use [${t}] instead.`),$s(e,t)))}rs({},{Color:()=>In,interpolateColor:()=>jl}),rs({},{AGGREGATION_INDEX_X_MAX:()=>1,AGGREGATION_INDEX_X_MIN:()=>0,AGGREGATION_INDEX_Y_MAX:()=>3,AGGREGATION_INDEX_Y_MIN:()=>2,AGGREGATION_SPAN:()=>4,AbstractBarSeries:()=>mk,AbstractBarSeriesProperties:()=>gk,ActionOnSet:()=>ro,AnchoredPopover:()=>EC,Animation:()=>ql,AnimationManager:()=>sc,Arc:()=>Uw,Axis:()=>su,AxisGroupZIndexMap:()=>tu,AxisInterval:()=>Vd,AxisLabel:()=>Gd,AxisTick:()=>Hd,BASE_FONT_SIZE:()=>Qo,BBox:()=>fs,Background:()=>ES,BackgroundModule:()=>OS,BandScale:()=>Wc,BarSeries:()=>Nk,BarSeriesModule:()=>Lk,BaseModuleInstance:()=>cs,BaseProperties:()=>Pn,BaseToolbar:()=>FC,Border:()=>RS,ButtonWidget:()=>Hr,CallbackCache:()=>Va,Caption:()=>sr,CartesianAxis:()=>Gp,CartesianCrossLine:()=>Bd,CartesianSeries:()=>GI,CartesianSeriesNodeEvent:()=>BI,CartesianSeriesProperties:()=>FI,CategoryAxis:()=>ax,CategoryScale:()=>Vu,ChangeDetectableProperties:()=>SI,Chart:()=>sm,ChartAxisDirection:()=>nr,ChartOptions:()=>kS,ChartUpdateType:()=>yl,CollapseMode:()=>hD,Color:()=>In,ColorScale:()=>Ln,ConicGradient:()=>En,ContextMenuBuiltins:()=>oc,ContextMenuRegistry:()=>rc,ContinuousScale:()=>$c,DEFAULT_CARTESIAN_DIRECTION_KEYS:()=>zI,DEFAULT_CARTESIAN_DIRECTION_NAMES:()=>jI,DEFAULT_POLAR_DIRECTION_KEYS:()=>DA,DEFAULT_POLAR_DIRECTION_NAMES:()=>kA,DEFAULT_TOOLTIP_CLASS:()=>kg,DEFAULT_TOOLTIP_DARK_CLASS:()=>Ag,DIRECTION_SWAP_AXES:()=>Um,DOMManager:()=>Fr,DataChangeDescription:()=>Ih,DataController:()=>_h,DataModel:()=>$h,DataModelSeries:()=>PI,DataService:()=>xl,DataSet:()=>Hh,Debug:()=>bs,Deprecated:()=>Qw,DeprecatedAndRenamedTo:()=>qw,DiscreteTimeAxis:()=>Sb,DiscreteTimeScale:()=>_c,DragInterpreter:()=>Oc,DraggablePopover:()=>RC,DropShadow:()=>II,ExtendedPath2D:()=>ra,FILL_GRADIENT_BLANK_DEFAULTS:()=>Zm,FILL_GRADIENT_CONIC_SERIES_DEFAULTS:()=>af,FILL_GRADIENT_LINEAR_DEFAULTS:()=>Xm,FILL_GRADIENT_LINEAR_HIERARCHY_DEFAULTS:()=>Qm,FILL_GRADIENT_LINEAR_SHADED_DEFAULTS:()=>Jm,FILL_GRADIENT_LINEAR_SINGLE_DEFAULTS:()=>qm,FILL_GRADIENT_RADIAL_DEFAULTS:()=>tf,FILL_GRADIENT_RADIAL_REVERSED_DEFAULTS:()=>ef,FILL_GRADIENT_RADIAL_REVERSED_SERIES_DEFAULTS:()=>nf,FILL_GRADIENT_RADIAL_SERIES_DEFAULTS:()=>sf,FILL_IMAGE_BLANK_DEFAULTS:()=>df,FILL_IMAGE_DEFAULTS:()=>hf,FILL_PATTERN_BLANK_DEFAULTS:()=>lf,FILL_PATTERN_DEFAULTS:()=>of,FILL_PATTERN_HIERARCHY_DEFAULTS:()=>cf,FILL_PATTERN_SINGLE_DEFAULTS:()=>rf,FONT_SIZE:()=>Xo,FONT_SIZE_RATIO:()=>qo,FillGradientDefaults:()=>xc,FillImageDefaults:()=>vc,FillPatternDefaults:()=>bc,FloatingToolbar:()=>$C,FormatManager:()=>zl,Gradient:()=>Tn,Group:()=>Oa,GroupedCategoryAxis:()=>ab,HdpiCanvas:()=>hl,HierarchyNode:()=>nC,HierarchySeries:()=>aC,HierarchySeriesProperties:()=>oC,HighlightManager:()=>lc,HighlightProperties:()=>pc,HighlightState:()=>cc,HighlightStyle:()=>Mc,Image:()=>kC,InteractionManager:()=>ec,InteractionState:()=>tc,InterpolationProperties:()=>$I,Invalidating:()=>An,LABEL_BOXING_DEFAULTS:()=>mf,LARGEST_KEY_INTERVAL:()=>Ex,LEGEND_CONTAINER_THEME:()=>xf,Label:()=>kd,LayoutElement:()=>nh,LayoutManager:()=>ah,LegendMarkerLabel:()=>US,Line:()=>md,LineSeries:()=>Xk,LineSeriesModule:()=>Qk,LinearGradient:()=>On,LinearScale:()=>gb,LogScale:()=>pb,LonLatBBox:()=>rC,MIN_CATEGORY_SPACING:()=>5,Marker:()=>Ig,Menu:()=>OC,MenuItemRadioWidget:()=>wC,MenuItemWidget:()=>AC,MenuWidget:()=>NC,MercatorScale:()=>pC,ModuleRegistry:()=>p,Motion:()=>Bl,NODE_UPDATE_STATE_TO_PHASE_MAPPING:()=>ld,NativeWidget:()=>Yr,NewAreaSeriesModule:()=>hk,NewBarSeriesModule:()=>Tk,NewBubbleSeriesModule:()=>$k,NewHistogramSeriesModule:()=>_k,NewLineSeriesModule:()=>qk,NewScatterSeriesModule:()=>eA,NiceMode:()=>Wd,Node:()=>on,NumberAxis:()=>mb,ObserveChanges:()=>lo,OrdinalTimeScale:()=>mp,PHASE_METADATA:()=>Kl,PHASE_ORDER:()=>Yl,PREV_NEXT_KEYS:()=>Dr,Padding:()=>so,ParallelStateMachine:()=>Id,Path:()=>Go,PointerEvents:()=>nn,PolarAxis:()=>Ow,PolarSeries:()=>AA,PolarZIndexMap:()=>IA,Popover:()=>TC,PropertiesArray:()=>zn,Property:()=>ws,ProxyInteractionService:()=>al,ProxyOnWrite:()=>ao,ProxyProperty:()=>no,ProxyPropertyOnWrite:()=>oo,QUICK_TRANSITION:()=>.2,QuadtreeNearest:()=>TI,RENDER_TO_OFFSCREEN_CANVAS_THRESHOLD:()=>VI,RadialColumnShape:()=>_w,Range:()=>Cd,Rect:()=>Uo,RepeatType:()=>Zl,Rotatable:()=>Aa,RotatableGroup:()=>Pa,RotatableText:()=>Yo,SAFE_FILLS_OPERATION:()=>_m,SAFE_FILL_OPERATION:()=>Wm,SAFE_RANGE2_OPERATION:()=>Km,SAFE_STROKE_FILL_OPERATION:()=>Ym,SEGMENTATION_DEFAULTS:()=>bf,SKIP_JS_BUILTINS:()=>Hs,SMALLEST_KEY_INTERVAL:()=>Tx,SORT_DOMAIN_GROUPS:()=>Ox,Scalable:()=>Ca,ScalableGroup:()=>Ra,ScaleAlignment:()=>Dn,Scene:()=>pl,SceneArrayChangeDetection:()=>Js,SceneChangeDetection:()=>Xs,SceneObjectChangeDetection:()=>qs,SceneRefChangeDetection:()=>Qs,Sector:()=>uA,SectorBox:()=>iA,SegmentOptions:()=>fc,Segmentation:()=>yc,SegmentedPath:()=>CI,Selection:()=>gd,Series:()=>dg,SeriesContentZIndexMap:()=>eg,SeriesGroupingChangedEvent:()=>lg,SeriesItemHighlightStyle:()=>uc,SeriesMarker:()=>DI,SeriesNodeEvent:()=>rg,SeriesNodePickMode:()=>og,SeriesProperties:()=>Sc,SeriesTooltip:()=>AI,SeriesZIndexMap:()=>tg,Shape:()=>ba,SliderWidget:()=>tl,SpanJoin:()=>KI,StateMachine:()=>Sd,StateMachineProperty:()=>xd,StopProperties:()=>Bn,SvgPath:()=>IC,TIME_AXIS_KEYS:()=>ek,TRIPLE_EQ:()=>Zs,Text:()=>_o,ThemeConstants:()=>Zo,ThemeSymbols:()=>lm,TimeAxisParentLevel:()=>yb,TimeScale:()=>dp,Toolbar:()=>VC,ToolbarButtonProperties:()=>PC,ToolbarButtonWidget:()=>jC,ToolbarWidget:()=>il,Tooltip:()=>Vg,TooltipManager:()=>Lc,TooltipPosition:()=>Fg,Transformable:()=>Ta,TransformableGroup:()=>ja,TransformableText:()=>Ko,Translatable:()=>Na,TranslatableGroup:()=>za,TranslatableSvgPath:()=>DC,UnitTimeScale:()=>xp,UpdateService:()=>gh,Vec2:()=>Jw,Vec4:()=>Yc,WIDGET_HTML_EVENTS:()=>ho,Widget:()=>wo,WidgetEventUtil:()=>mo,ZIndexMap:()=>ml,ZoomManager:()=>ih,accumulateGroup:()=>Gx,accumulatedValue:()=>mx,accumulativeValueProperty:()=>Cx,addEscapeEventListener:()=>fr,addHitTestersToQuadtree:()=>uk,addMouseCloseListener:()=>yr,addOverrideFocusVisibleEventListener:()=>vr,addTouchCloseListener:()=>xr,adjustLabelPlacement:()=>lI,aggregationDomain:()=>mI,aggregationIndexForXRatio:()=>xI,aggregationRangeFittingPoints:()=>gI,aggregationXRatioForDatumIndex:()=>fI,aggregationXRatioForXValue:()=>yI,angleBetween:()=>mn,angleCategoryAxisOptionsDefs:()=>Bb,angleNumberAxisOptionsDefs:()=>jb,angularPadding:()=>yn,animationValidation:()=>Fx,annotationCalloutStylesDefs:()=>kv,annotationChannelStyleDefs:()=>Mv,annotationChannelTextDefs:()=>gv,annotationCommentStylesDefs:()=>Av,annotationCrossLineStyleDefs:()=>vv,annotationDisjointChannelStyleDefs:()=>Sv,annotationFibonacciStylesDefs:()=>Dv,annotationLineStyleDefs:()=>bv,annotationLineTextDefs:()=>pv,annotationMeasurerStylesDefs:()=>Nv,annotationNoteStylesDefs:()=>wv,annotationOptionsDef:()=>Tv,annotationParallelChannelStyleDefs:()=>Iv,annotationQuickMeasurerStylesDefs:()=>Lv,annotationShapeStylesDefs:()=>Cv,annotationTextStylesDef:()=>uv,applyShapeFillBBox:()=>ng,applyShapeStyle:()=>ag,areScalingEqual:()=>CD,area:()=>gx,autoSizedLabelOptionsDefs:()=>Ay,axisLabelsOverlap:()=>Ip,bezier2DDistance:()=>aa,bezier2DExtrema:()=>sa,boxPlotHighlightStyleOptionsDef:()=>Rv,boxPlotSeriesThemeableOptionsDef:()=>zv,boxPlotStyleOptionsDef:()=>Ov,buildResetPathFn:()=>QD,calculateDataDiff:()=>Ak,calculateLabelRotation:()=>Rp,calculateLabelTranslation:()=>fC,calculatePlacement:()=>fg,calculateSegments:()=>tk,callWithContext:()=>Fa,candlestickSeriesThemeableOptionsDef:()=>Fv,cartesianAxisBandHighlightOptions:()=>tx,cartesianAxisCrosshairOptions:()=>ex,cartesianAxisLabelOptionsDefs:()=>_y,cartesianAxisOptionsDefs:()=>Jy,cartesianChartOptionsDefs:()=>Iw,cartesianCrossLineOptionsDefs:()=>Uy,cartesianNumericAxisLabel:()=>Yy,cartesianTimeAxisLabel:()=>Ky,cartesianTimeAxisParentLevel:()=>Xy,checkCrisp:()=>bk,chordSeriesThemeableOptionsDef:()=>Vv,clampArray:()=>zc,clipSpanX:()=>YI,clippedRoundRect:()=>Ho,collapseSpanToPoint:()=>WI,collapsedStartingBarPosition:()=>Mk,commonAxisIntervalOptionsDefs:()=>Qy,commonAxisLabelOptionsDefs:()=>Wy,commonAxisOptionsDefs:()=>qy,commonChartOptionsDefs:()=>vy,commonCrossLineLabelOptionsDefs:()=>$y,commonCrossLineOptionsDefs:()=>Hy,commonSeriesOptionsDefs:()=>Sy,commonSeriesThemeableOptionsDefs:()=>My,compactAggregationIndices:()=>vI,compareDates:()=>Hu,computeBarFocusBounds:()=>kk,computeMarkerFocusBounds:()=>_D,coneFunnelSeriesThemeableOptionsDef:()=>Gv,continuousAxisOptions:()=>ix,countExpandingSearch:()=>wc,createAggregationIndices:()=>bI,createButton:()=>yC,createCheckbox:()=>xC,createDatumId:()=>Wx,createDeprecationWarning:()=>Xw,createIcon:()=>MC,createIdsGenerator:()=>Mp,createSelect:()=>bC,createTextArea:()=>vC,dateToNumber:()=>Ou,dateTruncationForDomain:()=>ju,datesSortOrder:()=>Wu,datumKeys:()=>Fh,datumStylerProperties:()=>Dc,deconstructSelectionsOrNodes:()=>Xl,deepClone:()=>Xa,deepFreeze:()=>_s,diff:()=>Ux,discreteTimeAxisIntervalOptionsDefs:()=>sx,drawCorner:()=>Vo,drawMarkerUnitPolygon:()=>vg,durationDay:()=>lu,durationHour:()=>ru,durationMinute:()=>ou,durationMonth:()=>cu,durationSecond:()=>au,durationWeek:()=>6048e5,durationYear:()=>hu,easing:()=>Bl,enterpriseModule:()=>PM,errorBarOptionsDefs:()=>Cy,errorBarThemeableOptionsDefs:()=>wy,estimateTickCount:()=>cp,evaluateBezier:()=>Jn,expandLegendPosition:()=>WS,extent:()=>rx,extractDecoratedProperties:()=>Os,fillsOptionsDef:()=>Ey,findMinMax:()=>jc,findQuadtreeMatch:()=>pk,findRangeExtent:()=>Bc,fixNumericExtent:()=>Ph,focusCursorAtEnd:()=>Ha,formatNumber:()=>qr,formatObjectValidator:()=>xy,formatPercent:()=>Xr,formatTicks:()=>wp,formatValue:()=>Zr,fromToMotion:()=>cd,funnelSeriesThemeableOptionsDef:()=>$v,generateTicks:()=>zp,getAngleRatioRadians:()=>fn,getColorStops:()=>Vn,getCrossLineValue:()=>Td,getDateTicksForInterval:()=>pp,getDatumRefPoint:()=>Ac,getElementBBox:()=>$a,getIconClassNames:()=>Wa,getItemStyles:()=>Cc,getItemStylesPerItemId:()=>Nc,getLabelStyles:()=>aI,getLastFocus:()=>Cr,getMarkerStyles:()=>KD,getMissCount:()=>zh,getPath:()=>$s,getPathComponents:()=>Vh,getRadialColumnWidth:()=>Yw,getSequentialColors:()=>uf,getShapeFill:()=>ig,getShapeStyle:()=>sg,getTextAlign:()=>Ep,getTextBaseline:()=>Tp,getTimeIntervalTicks:()=>Np,groupAccumulativeValueProperty:()=>Lx,groupAverage:()=>px,groupCount:()=>ux,groupSum:()=>dx,hasNoModifiers:()=>Mr,heatmapSeriesThemeableOptionsDef:()=>Hv,highlightStates:()=>hc,initRovingTabIndex:()=>kr,interpolatePoints:()=>LD,interpolationOptionsDefs:()=>Ty,intervalCeil:()=>vu,intervalEpoch:()=>Lu,intervalExtent:()=>Iu,intervalFloor:()=>bu,intervalHierarchy:()=>Tu,intervalMilliseconds:()=>Eu,intervalNext:()=>Su,intervalPrevious:()=>Mu,intervalRange:()=>Au,intervalRangeCount:()=>ku,intervalRangeStartIndex:()=>wu,intervalStep:()=>Nu,intervalUnit:()=>Cu,isAgStandaloneChartOptions:()=>Kp,isAgTopologyChartOptions:()=>Yp,isBetweenAngles:()=>un,isButtonClickEvent:()=>wr,isChartAxisDirection:()=>ar,isContinuous:()=>Nd,isDecoratedObject:()=>Ts,isDenseInterval:()=>rp,isGradientFill:()=>pa,isGradientOrPatternFill:()=>ya,isImageFill:()=>fa,isInputPending:()=>Ua,isObjectWithProperty:()=>Ys,isObjectWithStringProperty:()=>Ks,isPatternFill:()=>ma,isProperties:()=>jn,isScaleValid:()=>ND,jsonApply:()=>Ja,jsonDiff:()=>Ka,jsonPropertyCompare:()=>Za,jsonWalk:()=>qa,keyProperty:()=>Sx,legendSymbolSvg:()=>Dg,lineDistanceSquared:()=>Hn,linearGaugeSeriesOptionsDef:()=>zy,linearGaugeSeriesThemeableOptionsDef:()=>Py,linearGaugeTargetOptionsDef:()=>Oy,linearPoints:()=>ZI,listDecoratedProperties:()=>Es,lowestGranularityForInterval:()=>Ru,lowestGranularityUnitForTicks:()=>Pu,lowestGranularityUnitForValue:()=>zu,makeAccessibleClickListener:()=>Ar,makeSeriesTooltip:()=>wI,mapLineBackgroundSeriesThemeableOptionsDef:()=>_v,mapLineSeriesThemeableOptionsDef:()=>Wv,mapMarkerSeriesThemeableOptionsDef:()=>Yv,mapShapeBackgroundSeriesThemeableOptionsDef:()=>Zv,mapShapeSeriesThemeableOptionsDef:()=>Kv,mapValues:()=>Fs,markerEnabled:()=>YD,markerFadeInAnimation:()=>GD,markerOptionsDefs:()=>Dy,markerScaleInAnimation:()=>$D,markerStyleOptionsDefs:()=>Iy,markerSwipeScaleInAnimation:()=>HD,memo:()=>Sl,merge:()=>js,mergeArrayDefaults:()=>Bs,mergeDefaults:()=>zs,midpointStartingBarPosition:()=>Sk,minimumTimeAxisDatumGranularity:()=>bb,moduleRegistry:()=>hs,motion:()=>UC,multiSeriesHighlightStyle:()=>ff,nearestSquared:()=>ps,nearestSquaredInContainer:()=>gs,nextPowerOf2:()=>Fc,nightingaleSeriesThemeableOptionsDef:()=>Qv,normaliseGroupTo:()=>Px,normalisePropertyTo:()=>jx,normalisedExtentWithMetadata:()=>lx,normalizeAngle180:()=>dn,normalizeAngle360:()=>cn,normalizeAngle360FromDegrees:()=>xn,normalizeAngle360Inclusive:()=>hn,normalizeContinuousDomains:()=>Hc,numberFormatValidator:()=>by,objectsEqual:()=>Rs,objectsEqualWith:()=>Ps,ohlcSeriesThemeableOptionsDef:()=>Uv,ordinalTimeAxisOptionsDefs:()=>zb,pairUpSpans:()=>kD,partialAssign:()=>Ws,pathFadeInAnimation:()=>XD,pathMotion:()=>nI,pathSwipeInAnimation:()=>ZD,pick:()=>Gs,pickByMatchingAngle:()=>SA,plotAreaPathFill:()=>jD,plotInterpolatedAreaSeriesFillSpans:()=>BD,plotInterpolatedLinePathStroke:()=>OD,plotLinePathStroke:()=>ED,pointsEq:()=>TD,polarChartOptionsDefs:()=>Dw,predictCartesianAxis:()=>ik,predictCartesianTimeAxis:()=>sk,predictTimeAxisType:()=>nk,prepareAreaFillAnimationFns:()=>FD,prepareAreaPathAnimation:()=>VD,prepareAxisAnimationContext:()=>_d,prepareAxisAnimationFunctions:()=>Zd,prepareBarAnimationFunctions:()=>Ik,prepareLinePathAnimation:()=>zD,prepareLinePathPropertyAnimation:()=>PD,prepareLinePathStrokeAnimationFns:()=>RD,preparePieSeriesAnimationFunctions:()=>vA,previousPowerOf2:()=>Vc,processedDataIsAnimatable:()=>yx,pyramidSeriesThemeableOptionsDef:()=>qv,radarAreaSeriesThemeableOptionsDef:()=>Jv,radarLineSeriesThemeableOptionsDef:()=>tM,radialBarSeriesThemeableOptionsDef:()=>eM,radialColumnSeriesThemeableOptionsDef:()=>iM,radialGaugeSeriesOptionsDef:()=>By,radialGaugeSeriesThemeableOptionsDef:()=>jy,radialGaugeTargetOptionsDef:()=>Ry,radialSeriesStylerDef:()=>Xv,radiusCategoryAxisOptionsDefs:()=>Vb,radiusNumberAxisOptionsDefs:()=>Fb,range:()=>op,rangeAreaSeriesThemeableOptionsDef:()=>oM,rangeBarSeriesThemeableOptionsDef:()=>lM,rangeValidator:()=>oy,rangedValueProperty:()=>wx,rescaleSpan:()=>_I,resetAxisFillSelectionFn:()=>Jd,resetAxisGroupFn:()=>Xd,resetAxisLabelSelectionFn:()=>Qd,resetAxisLineSelectionFn:()=>qd,resetBarSelectionsFn:()=>Dk,resetLabelFn:()=>dI,resetMarkerFn:()=>UD,resetMarkerPositionFn:()=>WD,resetMotion:()=>pd,resetPieSelectionsFn:()=>MA,rowCountProperty:()=>Dx,sankeySeriesThemeableOptionsDef:()=>cM,scale:()=>uD,sectorBox:()=>sA,seriesLabelFadeInAnimation:()=>cI,seriesLabelFadeOutAnimation:()=>hI,seriesLabelOptionsDefs:()=>ky,setElementBBox:()=>Ga,setPath:()=>Us,shadowOptionsDefs:()=>Ly,shallowClone:()=>Qa,simpleMemorize:()=>kl,simpleMemorize2:()=>Dl,singleSeriesHighlightStyle:()=>yf,smoothPoints:()=>JI,solveBezier:()=>ta,sortAndUniqueDates:()=>Uu,spanRange:()=>UI,splitBezier2D:()=>ea,stackCartesianSeries:()=>yw,standaloneChartOptionsDefs:()=>Aw,staticFromToMotion:()=>hd,stepPoints:()=>QI,stopPageScrolling:()=>Nr,sum:()=>hx,sumValues:()=>cx,sunburstSeriesThemeableOptionsDef:()=>hM,textOrSegments:()=>ry,tickFormat:()=>ap,ticksEqual:()=>kp,ticksSpacing:()=>Ap,timeInterval:()=>Gy,timeIntervalMaxLabelSize:()=>Lp,timeIntervalUnit:()=>Fy,toDegrees:()=>gn,toHighlightString:()=>dc,toRadians:()=>pn,toolbarButtonOptionsDefs:()=>fy,tooltipContentAriaLabel:()=>Cg,tooltipHtml:()=>Og,tooltipOptionsDefs:()=>Ny,topologyChartOptionsDefs:()=>kw,trailingAccumulatedValue:()=>fx,trailingAccumulatedValueProperty:()=>Nx,treemapSeriesThemeableOptionsDef:()=>dM,updateClipPath:()=>qD,updateLabelNode:()=>oI,validateCrossLineValue:()=>Ed,valueProperty:()=>Ix,visibleRangeIndices:()=>kc,waterfallSeriesThemeableOptionsDef:()=>pM,withTemporaryDomain:()=>Cp,without:()=>Vs});var Jw={add:function(t,e){return"number"==typeof e?{x:t.x+e,y:t.y+e}:{x:t.x+e.x,y:t.y+e.y}},angle:function(t,e){return null==e?Math.atan2(t.y,t.x):Math.atan2(t.y,t.x)-Math.atan2(e.y,e.x)},apply:function(t,e){return t.x=e.x,t.y=e.y,t},equal:function(t,e){return t.x===e.x&&t.y===e.y},distance:function(t,e){return eC(tC(t,e))},distanceSquared:function(t,e){return iC(tC(t,e))},from:function(t,e){if("number"==typeof t)return{x:t,y:e};if("currentX"in t)return{x:t.currentX,y:t.currentY};if("offsetWidth"in t)return{x:t.offsetWidth,y:t.offsetHeight};if("width"in t)return[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y+t.height}];if("x1"in t)return[{x:t.x1,y:t.y1},{x:t.x2,y:t.y2}];throw new Error(`Values can not be converted into a vector: [${JSON.stringify(t)}] [${e}]`)},gradient:function(t,e,i){const s=e.x-t.x;return(null==i?e.y-t.y:i-e.y-(i-t.y))/s},intercept:function(t,e,i){return(null==i?t.y:i-t.y)-e*t.x},intersectAtX:function(t,e,i=0,s){const n=t===1/0?1/0:t*i+e;return{x:i,y:null==s?n:s-n}},intersectAtY:function(t,e,i=0,s){return{x:t===1/0?1/0:(i-e)/t,y:null==s?i:s-i}},length:eC,lengthSquared:iC,multiply:function(t,e){return"number"==typeof e?{x:t.x*e,y:t.y*e}:{x:t.x*e.x,y:t.y*e.y}},normalized:function(t){const e=eC(t);return{x:t.x/e,y:t.y/e}},origin:function(){return{x:0,y:0}},required:function(t){return{x:t?.x??0,y:t?.y??0}},rotate:function(t,e,i={x:0,y:0}){const s=eC(t);return{x:i.x+s*Math.cos(e),y:i.y+s*Math.sin(e)}},round:function(t,e=2){return{x:T(t.x,e),y:T(t.y,e)}},sub:tC};function tC(t,e){return"number"==typeof e?{x:t.x-e,y:t.y-e}:{x:t.x-e.x,y:t.y-e.y}}function eC(t){return Math.hypot(t.x,t.y)}function iC(t){return t.x*t.x+t.y*t.y}var sC=class t{constructor(t,e,i,s,n,a,o,r,l,c){this.series=t,this.datumIndex=e,this.datum=i,this.sizeValue=s,this.colorValue=n,this.sumSize=a,this.depth=o,this.parent=r,this.children=l,this.style=c,this.midPoint={x:0,y:0}}get hasChildren(){return this.children.length>0}walk(e,i=t.Walk.PreOrder){i===t.Walk.PreOrder&&e(this);for(const t of this.children)t.walk(e,i);i===t.Walk.PostOrder&&e(this)}*[Symbol.iterator](){yield this;for(const t of this.children)yield*t}};sC.Walk={PreOrder:0,PostOrder:1};var nC=sC,aC=class extends dg{constructor(t){super({moduleCtx:t,pickModes:[1,0]}),this.colorDomain=[0,0],this.maxDepth=0,this.colorScale=new Ln,this.animationState=new Sd("empty",{empty:{update:{target:"ready",action:t=>this.animateEmptyUpdateReady(t)},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",highlight:t=>this.animateReadyHighlight(t),resize:t=>this.animateReadyResize(t),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:t=>this.animateWaitingUpdateReady(t)},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:t=>this.animateClearingUpdateEmpty(t)},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}resetAnimation(t){"initial"===t?this.animationState.transition("reset"):"ready"===t&&this.animationState.transition("skip")}processData(){const{NodeClass:t}=this,{childrenKey:e,sizeKey:i,colorKey:s,colorRange:n}=this.properties;let a=0,o=1/0,r=-1/0;const l=(n,l,h)=>{const d=null==h.depth?0:h.depth+1,u=null==e?void 0:n[e],p=null==u||0===u.length;let g=null==i?void 0:n[i];g=Number.isFinite(g)?Math.max(g,0):p?1:0;const m=g;a=Math.max(a,d);const f=null==s?void 0:n[s];"number"==typeof f&&(o=Math.min(o,f),r=Math.max(r,f));const y=this.getItemStyle({datumIndex:l,datum:n,depth:d,colorValue:f},p,!1);return c(new t(this,l,n,g,f,m,d,h,[],y),u)},c=(t,e)=>{const{datumIndex:i}=t;if(e)for(const[s,n]of e.entries()){const e=l(n,i.concat(s),t);t.children.push(e),t.sumSize+=e.sumSize}return t},h=c(new t(this,[],void 0,0,void 0,0,void 0,void 0,[],{}),this.data?.data),d=[o,r];this.colorScale.domain=o<r?[o,r]:[0,1],this.colorScale.range=n??["black"],this.colorScale.update(),this.rootNode=h,this.maxDepth=a,this.colorDomain=d}update({seriesRect:t}){this.updateSelections(),this.updateNodes();const e=this.getAnimationData();this.checkResize(t)&&this.animationState.transition("resize",e),this.animationState.transition("update",e)}resetAllAnimation(t){this.ctx.animationManager.stopByAnimationGroupId(this.id)}animateEmptyUpdateReady(t){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(t)}animateWaitingUpdateReady(t){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(t)}animateReadyHighlight(t){}animateReadyResize(t){this.resetAllAnimation(t)}animateClearingUpdateEmpty(t){this.ctx.animationManager.skipCurrentBatch(),this.resetAllAnimation(t)}getAnimationData(){return{}}isProcessedDataAnimatable(){return!0}checkProcessedDataAnimatable(){this.isProcessedDataAnimatable()||this.ctx.animationManager.skipCurrentBatch()}dataCount(){return Number.NaN}getSeriesDomain(){return[Number.NaN,Number.NaN]}getSeriesRange(t,e){return[Number.NaN,Number.NaN]}getLegendData(t){const{colorKey:e,colorRange:i}=this.properties,{id:s,ctx:{legendManager:n},visible:a}=this;return"gradient"===t&&null!=e&&null!=i?[{legendType:"gradient",enabled:a&&n.getItemEnabled({seriesId:s}),seriesId:s,series:this.getFormatterContext("color"),colorRange:i,colorDomain:this.colorDomain}]:[]}getDatumIdFromData(t){return t.datumIndex.join(":")}getDatumId(t){return this.getDatumIdFromData(t)}removeMeIndexPathForIndex(t){return this.datumSelection.at(t+1)?.datum.datumIndex??[]}removeMeIndexForIndexPath(t){for(const{index:e,datum:i}of this.datumSelection)if(Je(i.datumIndex,t))return e-1;return 0}pickFocus(t){if(!this.rootNode?.children.length)return;const e=C(0,t.datumIndex-t.datumIndexDelta,this.datumSelection.length-1),{datumIndexDelta:i,otherIndexDelta:s}=t;let n=this.removeMeIndexPathForIndex(e);const a=n.reduce((t,e)=>t.children[e],this.rootNode);if(s>0&&a.hasChildren)n=[...n,0];else if(s<0&&n.length>1)n=n.slice(0,-1);else if(0===s&&0!==i){const t=a.parent.children.length-1;n=n.slice(),n[n.length-1]=C(0,n.at(-1)+i,t)}const o=n.reduce((t,e)=>t.children[e],this.rootNode),r=this.computeFocusBounds(this.datumSelection.at(e+1));return null!=r?{datum:o,datumIndex:this.removeMeIndexForIndexPath(n),otherIndex:o.depth,bounds:r,clipFocusBox:!0}:void 0}getDatumAriaText(t,e){if(t instanceof this.NodeClass)return this.ctx.localeManager.t("ariaAnnounceHierarchyDatum",{level:(t.depth??-1)+1,count:t.children.length,description:e});i.error(`datum is not HierarchyNode: ${JSON.stringify(t)}`)}getCategoryValue(t){}datumIndexForCategoryValue(t){}},oC=class extends Sc{constructor(){super(...arguments),this.childrenKey="children",this.fills=Object.values(om),this.strokes=Object.values(rm)}};ls([ws],oC.prototype,"childrenKey",2),ls([ws],oC.prototype,"sizeKey",2),ls([ws],oC.prototype,"colorKey",2),ls([ws],oC.prototype,"colorName",2),ls([ws],oC.prototype,"fills",2),ls([ws],oC.prototype,"strokes",2),ls([ws],oC.prototype,"colorRange",2);var rC=class t{constructor(t,e,i,s){this.lon0=t,this.lat0=e,this.lon1=i,this.lat1=s}extend(t,e,i,s){return this.lon0=Math.min(this.lon0,t),this.lat0=Math.min(this.lat0,e),this.lon1=Math.max(this.lon1,i),this.lat1=Math.max(this.lat1,s),this}merge(t){return this.extend(t.lon0,t.lat0,t.lon1,t.lat1)}static extend(e,i,s,n,a){return e?e.extend(i,s,n,a):new t(i,s,n,a)}},lC=Math.PI/180,cC=t=>t*lC,hC=t=>-Math.log(Math.tan(.25*Math.PI+t*lC*.5)),dC=t=>t/lC,uC=t=>(Math.atan(Math.exp(-t))-.25*Math.PI)/(.5*lC),pC=class t extends kn{constructor(e,i){super(),this.domain=e,this.range=i,this.type="mercator",this.defaultTickCount=0,this.bounds=t.bounds(e)}static bounds(t){const[[e,i],[s,n]]=t,a=cC(e),o=hC(i),r=cC(s),l=hC(n);return new fs(Math.min(a,r),Math.min(o,l),Math.abs(r-a),Math.abs(l-o))}static fixedScale(){return new t([[dC(0),uC(0)],[dC(1),uC(1)]],[[0,0],[1,1]])}toDomain(){}normalizeDomains(...t){let e=-1/0,i=1/0,s=-1/0,n=1/0;for(const a of t)for(const[t,o]of a)e=Math.min(t,e),i=Math.max(t,i),s=Math.min(o,s),n=Math.max(o,n);return{domain:[[e,s],[i,n]],animatable:!0}}convert([t,e]){const[[i,s],[n,a]]=this.range,o=(n-i)/this.bounds.width,r=(a-s)/this.bounds.height;return[(cC(t)-this.bounds.x)*o+i,(hC(e)-this.bounds.y)*r+s]}invert([t,e]){const[[i,s],[n,a]]=this.range,o=(n-i)/this.bounds.width,r=(a-s)/this.bounds.height;return[dC((t-i)/o+this.bounds.x),uC((e-s)/r+this.bounds.y)]}},gC={top:{xTranslationDirection:0,yTranslationDirection:-1},bottom:{xTranslationDirection:0,yTranslationDirection:1},left:{xTranslationDirection:-1,yTranslationDirection:0},right:{xTranslationDirection:1,yTranslationDirection:0},"top-left":{xTranslationDirection:1,yTranslationDirection:-1},"top-right":{xTranslationDirection:-1,yTranslationDirection:-1},"bottom-left":{xTranslationDirection:1,yTranslationDirection:1},"bottom-right":{xTranslationDirection:-1,yTranslationDirection:1},inside:{xTranslationDirection:0,yTranslationDirection:0},"inside-left":{xTranslationDirection:1,yTranslationDirection:0},"inside-right":{xTranslationDirection:-1,yTranslationDirection:0},"inside-top":{xTranslationDirection:0,yTranslationDirection:1},"inside-bottom":{xTranslationDirection:0,yTranslationDirection:-1},"inside-top-left":{xTranslationDirection:1,yTranslationDirection:1},"inside-bottom-left":{xTranslationDirection:1,yTranslationDirection:-1},"inside-top-right":{xTranslationDirection:-1,yTranslationDirection:1},"inside-bottom-right":{xTranslationDirection:-1,yTranslationDirection:-1}},mC={top:{xTranslationDirection:1,yTranslationDirection:0},bottom:{xTranslationDirection:-1,yTranslationDirection:0},left:{xTranslationDirection:0,yTranslationDirection:-1},right:{xTranslationDirection:0,yTranslationDirection:1},"top-left":{xTranslationDirection:-1,yTranslationDirection:-1},"top-right":{xTranslationDirection:-1,yTranslationDirection:1},"bottom-left":{xTranslationDirection:1,yTranslationDirection:-1},"bottom-right":{xTranslationDirection:1,yTranslationDirection:1},inside:{xTranslationDirection:0,yTranslationDirection:0},"inside-left":{xTranslationDirection:0,yTranslationDirection:1},"inside-right":{xTranslationDirection:0,yTranslationDirection:-1},"inside-top":{xTranslationDirection:-1,yTranslationDirection:0},"inside-bottom":{xTranslationDirection:1,yTranslationDirection:0},"inside-top-left":{xTranslationDirection:-1,yTranslationDirection:1},"inside-bottom-left":{xTranslationDirection:1,yTranslationDirection:1},"inside-top-right":{xTranslationDirection:-1,yTranslationDirection:-1},"inside-bottom-right":{xTranslationDirection:1,yTranslationDirection:-1}};function fC({yDirection:t,padding:e=0,position:i="top",bbox:s}){const n=t?gC:mC,{xTranslationDirection:a,yTranslationDirection:o}=n[i];return{xTranslation:a*(e+s.width/2),yTranslation:o*(e+s.height/2)}}function yC(t,e){const i=j("button",SC("ag-charts-input ag-charts-button",e));return void 0===t.label?(i.append(MC(t.icon)),i.ariaLabel=t.altText):i.append(t.label),i.addEventListener("click",t.onPress),ui(i,e),i}function xC(t,e){const i=j("input",SC("ag-charts-input ag-charts-checkbox",e));return i.type="checkbox",i.checked=t.checked,i.addEventListener("change",e=>t.onChange(i.checked,e)),i.addEventListener("keydown",t=>{wr(t)&&(t.preventDefault(),i.click())}),ui(i,e),i}function bC(t,e){const i=j("select",SC("ag-charts-input ag-charts-select",e));return i.append(...t.options.map(t=>{const e=j("option");return e.value=t.value,e.textContent=t.label,e})),di(i,"data-preventdefault",!1),i.value=t.value,i.addEventListener("change",e=>t.onChange(i.value,e)),ui(i,e),i}function vC(t,e){const i=j("textarea",SC("ag-charts-input ag-charts-textarea",e));return i.value=t.value,i.addEventListener("input",e=>t.onChange(i.value,e)),ui(i,e),di(i,"data-preventdefault",!1),i}function MC(t){const e=j("span",`ag-charts-icon ag-charts-icon-${t}`);return di(e,"aria-hidden",!0),e}function SC(t,e){return null==e?t:`${t} ${e.class}`}var IC=class extends Go{constructor(t=""){super(),this._d="",this.d=t}get d(){return this._d}set d(t){t!==this._d&&(this._d=t,this.path.clear(),this.path.appendSvg(t),this.checkPathDirty())}},DC=class extends(Na(IC)){isPointInPath(t,e){return super.isPointInPath(t-this.translationX,e-this.translationY)}},kC=class extends on{constructor(t){super(),this.sourceImage=t,this.x=0,this.y=0,this.width=0,this.height=0,this.opacity=1}render(t){const{ctx:e}=t,i=this.sourceImage;i&&(e.globalAlpha=this.opacity,e.drawImage(i,0,0,i.width,i.height,this.x,this.y,this.width,this.height)),super.render(t)}};ls([Xs()],kC.prototype,"x",2),ls([Xs()],kC.prototype,"y",2),ls([Xs()],kC.prototype,"width",2),ls([Xs()],kC.prototype,"height",2),ls([Xs()],kC.prototype,"opacity",2),rs({},{ButtonWidget:()=>Hr,MenuItemRadioWidget:()=>wC,MenuItemWidget:()=>AC,MenuWidget:()=>NC,NativeWidget:()=>Yr,SliderWidget:()=>tl,ToolbarWidget:()=>il,WIDGET_HTML_EVENTS:()=>ho,Widget:()=>wo,WidgetEventUtil:()=>mo});var AC=class extends $r{constructor(){super(j("div"),"menuitem")}},wC=class extends $r{constructor(){super(j("div"),"menuitemradio")}setChecked(t){di(this.elem,"aria-checked",t)}},CC=["Escape","ArrowLeft"],NC=class t extends Wr{constructor(t="vertical"){super(t,"menu"),this.handleMouseEnter=(t,e)=>{e.hasPopup()||this.expandSubMenu(t,void 0)},this.handleMouseMove=(t,e)=>{e.focus({preventScroll:!0})}}destructor(){this.collapse({mode:"2"})}addSeparator(){const t=P().createElement("div");return di(t,"role","separator"),this.elem.appendChild(t),t}onChildAdded(t){super.onChildAdded(t),t.addListener("mouseenter",this.handleMouseEnter),t.addListener("mousemove",this.handleMouseMove)}onChildRemoved(t){super.onChildRemoved(t),t.removeListener("mouseenter",this.handleMouseEnter),t.removeListener("mousemove",this.handleMouseMove)}addSubMenu(){const e=new AC,i=new t(this.orientation);i.id=Ri();const s=()=>{this.collapseExpandedSubMenu(i),e.expandControlled()};return e.setControlled(i),e.setAriaHasPopup("menu"),e.addListener("click",s),e.addListener("mouseenter",s),e.addListener("keydown",t=>{Mr(t.sourceEvent)&&"ArrowRight"===t.sourceEvent.code&&(this.collapseExpandedSubMenu(i),e.expandControlled())}),this.addChild(e),{subMenuButton:e,subMenu:i}}expandSubMenu(t,e){const{expansionScope:i}=this;i&&(this.collapseExpandedSubMenu(e),e?.expand(t))}collapseExpandedSubMenu(t){const{expansionScope:e}=this;e&&(e.expandedSubMenu?.collapse({mode:"4"}),e.expandedSubMenu=t)}expand(t){if(null!=this.expansionScope)return;this.expansionScope={lastFocus:Cr(t.sourceEvent),expandedSubMenu:void 0,abort:()=>this.collapse({mode:"1"}),close:()=>this.collapse({mode:"0"}),removers:new Mi};const e=this.expansionScope,i=this.children.map(t=>t.getElement());di(e.lastFocus,"aria-expanded",!0),e.removers.register(yr(this.elem,e.abort),xr(this.elem,e.abort),...this.children.map(t=>fr(t.getElement(),e.close,CC)),t?.overrideFocusVisible&&vr(this.elem,i,t.overrideFocusVisible)),this.internalListener?.dispatch("expand-widget",this,{type:"expand-widget"}),this.children[0]?.focus({preventScroll:!0})}collapse(t){const{mode:e="0"}=t??{};if(void 0===this.expansionScope)return;const{lastFocus:i,removers:s,expandedSubMenu:n}=this.expansionScope;this.expansionScope=void 0,n?.collapse({mode:"3"}),di(i,"aria-expanded",!1),"0"===e&&i?.focus({preventScroll:!0}),s.flush(),this.internalListener?.dispatch("collapse-widget",this,{type:"collapse-widget",mode:e})}},LC="canvas-overlay",TC=class extends cs{constructor(t,e,i){super(),this.ctx=t,this.hideFns=[],this.setOwnedWidget=(()=>{let t;return e=>{t?.destroy(),t=e}})(),this.moduleId=`popover-${e}`,this.element=i?.detached?j("div"):t.domManager.addChild(LC,this.moduleId),this.element.setAttribute("role","presentation"),this.hideFns.push(()=>this.setOwnedWidget(void 0)),this.cleanup.register(()=>t.domManager.removeChild(LC,this.moduleId))}attachTo(t){this.element.parentElement||t.element.append(this.element)}hide(t){const{lastFocus:e=this.lastFocus}=t??{};if(0!==this.element.children.length){for(const t of this.hideFns)t();e?.focus(),this.lastFocus=void 0}}removeChildren(){this.element.replaceChildren()}initPopoverElement(t,e){if(!this.element.parentElement)throw new Error("Can not show popover that has not been attached to a parent.");return t??(t=j("div","ag-charts-popover")),t.classList.toggle("ag-charts-popover",!0),null!=e.ariaLabel&&t.setAttribute("aria-label",e.ariaLabel),null!=e.class&&t.classList.add(e.class),this.element.replaceChildren(t),t}showWidget(t,e,i){this.setOwnedWidget(e),this.initPopoverElement(e.getElement(),i),e.addListener("collapse-widget",()=>{t.setControlled(void 0),this.setOwnedWidget(void 0)}),t.setControlled(e),t.expandControlled()}showWithChildren(t,e){const i=this.initPopoverElement(void 0,e);if(i.replaceChildren(...t),this.hideFns.push(()=>this.removeChildren()),e.onHide&&this.hideFns.push(e.onHide),e.initialFocus&&e.sourceEvent){const t=Cr(e.sourceEvent);void 0!==t&&(this.lastFocus=t,this.initialFocus=e.initialFocus)}return i}getPopoverElement(){return this.element.firstElementChild}updatePosition(t){const e=this.getPopoverElement();e&&(e.style.setProperty("right","unset"),e.style.setProperty("bottom","unset"),null!=t.x&&e.style.setProperty("left",`${Math.floor(t.x)}px`),null!=t.y&&e.style.setProperty("top",`${Math.floor(t.y)}px`),this.initialFocus?.focus(),this.initialFocus=void 0)}},EC=class extends TC{setAnchor(t,e){this.anchor=t,this.fallbackAnchor=e,this.updatePosition(t),this.repositionWithinBounds()}updateAnchor(t){const e=t.anchor??this.anchor,i=t.fallbackAnchor??this.fallbackAnchor;e&&this.setAnchor(e,i)}showWidget(t,e,i){super.showWidget(t,e,i),this.updateAnchor(i)}showWithChildren(t,e){const i=super.showWithChildren(t,e);return this.updateAnchor(e),z().requestAnimationFrame(()=>{this.repositionWithinBounds()}),i}repositionWithinBounds(){const{anchor:t,ctx:e,fallbackAnchor:i}=this,s=this.getPopoverElement();if(!t||!s)return;const n=e.domManager.getBoundingClientRect(),{offsetWidth:a,offsetHeight:o}=s;let r=C(0,t.x,n.width-a),l=C(0,t.y,n.height-o);r!==t.x&&null!=i?.x&&(r=C(0,i.x-a,n.width-a)),l!==t.y&&null!=i?.y&&(l=C(0,i.y-o,n.height-o)),this.updatePosition({x:r,y:l})}},OC=class extends EC{show(t,e){const i=new NC("vertical");for(const t of e.items)i.addChild(this.createRow(e,t,i));i.addClass("ag-charts-menu"),this.showWidget(t,i,e)}allocRow(t,e){if(null==t.menuItemRole||"menuitem"===t.menuItemRole)return new AC;{t.menuItemRole;const i=new wC;return i.setChecked(t.value===e.value),i}}createRow(t,e,i){const s=e.value===t.value,n=this.allocRow(t,e);if(n.addClass("ag-charts-menu__row"),n.toggleClass("ag-charts-menu__row--active",s),"string"==typeof e.value&&(n.getElement().dataset.popoverId=e.value),null!=e.icon){const t=j("span",`ag-charts-menu__icon ${Wa(e.icon)}`);n.getElement().appendChild(t)}const a=null!=e.strokeWidth;if(a&&(n.toggleClass("ag-charts-menu__row--stroke-width-visible",a),n.setCSSVariable("--strokeWidth",a?`${e.strokeWidth}px`:null)),null!=e.label){const t=j("span","ag-charts-menu__label");t.textContent=this.ctx.localeManager.t(e.label),n.getElement().appendChild(t)}return"altText"in e&&n.setAriaLabel(this.ctx.localeManager.t(e.altText)),n.addListener("click",({sourceEvent:s})=>{t.onPress?.(e),s.preventDefault(),s.stopPropagation(),i.collapse()}),n}},RC=class extends TC{constructor(){super(...arguments),this.dragged=!1}setDragHandle(t){t.addListener("drag-start",e=>{t.addClass(this.dragHandleDraggingClass),this.onDragStart(e)}),t.addListener("drag-move",this.onDragMove.bind(this)),t.addListener("drag-end",()=>{t.removeClass(this.dragHandleDraggingClass),this.onDragEnd.bind(this)})}onDragStart(t){const e=this.getPopoverElement();e&&(t.sourceEvent.preventDefault(),this.dragged=!0,this.dragStartState={client:Jw.from(t.clientX,t.clientY),position:Jw.from(Number(e.style.getPropertyValue("left").replace("px","")),Number(e.style.getPropertyValue("top").replace("px","")))})}onDragMove(t){const{dragStartState:e}=this,i=this.getPopoverElement();if(!e||!i)return;const s=Jw.sub(Jw.from(t.clientX,t.clientY),e.client),n=Jw.add(e.position,s),a=this.ctx.domManager.getBoundingClientRect(),o={};n.x>=0&&n.x+i.offsetWidth<=a.width&&(o.x=n.x),n.y>=0&&n.y+i.offsetHeight<=a.height&&(o.y=n.y),this.updatePosition(o)}onDragEnd(){this.dragStartState=void 0}},PC=class extends Pn{};ls([ws],PC.prototype,"icon",2),ls([ws],PC.prototype,"label",2),ls([ws],PC.prototype,"ariaLabel",2),ls([ws],PC.prototype,"tooltip",2);var zC={"disjoint-channel":"false","fibonacci-menu":"menu","fibonacci-retracement":"false","fibonacci-retracement-trend-based":"false","fill-color":"dialog","horizontal-line":"false","line-color":"dialog","line-menu":"menu","line-stroke-width":"menu","line-style-type":"menu","measurer-menu":"menu","pan-end":"false","pan-left":"false","pan-right":"false","pan-start":"false","parallel-channel":"false","shape-menu":"menu","text-color":"dialog","text-menu":"menu","text-size":"menu","vertical-line":"false","zoom-in":"false","zoom-out":"false",callout:"false",clear:"false",comment:"false",delete:"false",line:"false",lock:"false",menu:"menu",note:"false",reset:"false",settings:"dialog",text:"false"},jC=class extends Hr{constructor(t){super(),this.localeManager=t}update(t){const{localeManager:e}=this;t.tooltip&&(this.elem.title=e.t(t.tooltip));let i="";null!=t.icon&&(i=`<span class="${Wa(t.icon)} ag-charts-toolbar__icon"></span>`),null!=t.label&&(i=`${i}<span class="ag-charts-toolbar__label">${e.t(t.label)}</span>`);const s="string"!=typeof(n=t.value)?"false":zC[n];var n;"false"==s?(this.setAriaHasPopup(void 0),this.setAriaExpanded(void 0)):(this.setAriaHasPopup(s),this.setAriaExpanded(!1)),this.elem.innerHTML=i}setChecked(t){di(this.elem,"aria-checked",t)}},BC="ag-charts-toolbar__button--active",FC=class extends il{constructor({eventsHub:t,localeManager:e},i,s){super(s),this.ariaLabelId=i,this.horizontalSpacing=10,this.verticalSpacing=10,this.events=new vl,this.hasPrefix=!1,this.buttonWidgets=[],this.updateAriaLabel=()=>this.setAriaLabel(this.localeManager.t(this.ariaLabelId)),this.eventsHub=t,this.localeManager=e,this.addClass("ag-charts-toolbar"),this.toggleClass("ag-charts-toolbar--horizontal","horizontal"===s),this.toggleClass("ag-charts-toolbar--vertical","vertical"===s),this.eventsHub.on("locale:change",this.updateAriaLabel),this.updateAriaLabel()}setAriaLabelId(t){this.ariaLabelId=t,this.updateAriaLabel()}addToolbarListener(t,e){return this.events.addListener(t,e)}clearButtons(){this.expanded?.collapse({mode:"2"});for(const t of this.buttonWidgets)t.destroy();this.buttonWidgets.splice(0)}updateButtons(t){const{buttonWidgets:e}=this;for(const[e,i]of t.entries())(this.buttonWidgets.at(e)??this.createButton(e,i)).update(i);for(let i=t.length;i<e.length;i++){const t=this.buttonWidgets.at(i);t?.destroy()}this.buttonWidgets.splice(t.length),this.refreshButtonClasses()}updateButtonByIndex(t,e){this.buttonWidgets.at(t)?.update(e)}clearActiveButton(){for(const t of this.buttonWidgets)t.toggleClass(BC,!1)}toggleActiveButtonByIndex(t){if(-1!==t)for(const[e,i]of this.buttonWidgets.entries())i.toggleClass(BC,null!=t&&t===e)}toggleButtonEnabledByIndex(t,e){-1!==t&&this.buttonWidgets.at(t)?.setEnabled(e)}toggleSwitchCheckedByIndex(t,e){-1!==t&&this.buttonWidgets.at(t)?.setChecked(e)}getButtonBounds(){return this.buttonWidgets.map(t=>this.getButtonWidgetBounds(t))}setButtonHiddenByIndex(t,e){this.buttonWidgets.at(t)?.setHidden(e)}getButtonWidgetBounds(t){const e=this.getBounds(),i=t.getBounds();return new fs(i.x+e.x,i.y+e.y,i.width,i.height)}refreshButtonClasses(){const{buttonWidgets:t,hasPrefix:e}=this;let i,s,n;for(const[a,o]of t.entries())i=!e&&0===a||n!=o.section,s=a===t.length-1||o.section!=t.at(a+1)?.section,o.toggleClass("ag-charts-toolbar__button--first",i),o.toggleClass("ag-charts-toolbar__button--last",s),o.toggleClass("ag-charts-toolbar__button--gap",a>0&&i),n=o.section}createButton(t,e){const i=this.createButtonWidget();return i.addClass("ag-charts-toolbar__button"),i.addListener("click",s=>{const n={event:s,button:{index:t,...e instanceof Pn?e.toJson():e},buttonBounds:this.getButtonWidgetBounds(i),buttonWidget:i};this.events.dispatch("button-pressed",n)}),i.addListener("focus",()=>{const e={button:{index:t}};this.events.dispatch("button-focused",e)}),i.addListener("expand-controlled-widget",t=>{this.expanded?.collapse({mode:"4"}),this.expanded=t.controlled;const e=this.expanded.addListener("collapse-widget",()=>{this.expanded=void 0,e()})}),e.section&&(i.section=e.section),this.buttonWidgets.push(i),this.addChild(i),i}},VC=class extends FC{createButtonWidget(){return new jC(this.localeManager)}},GC=class extends RC{constructor(t,e,i){super(t,e),this.onPopoverMoved=i,this.dragHandleDraggingClass="ag-charts-floating-toolbar__drag-handle--dragging"}show(t,e={}){this.showWithChildren(t,{...e,class:"ag-charts-floating-toolbar"})}hide(){this.dragged=!1,super.hide()}getBounds(){const t=this.getPopoverElement();return new fs(t?.offsetLeft??0,t?.offsetTop??0,t?.offsetWidth??0,t?.offsetHeight??0)}hasBeenDragged(){return this.dragged}setAnchor(t,e,i){const s=this.getPopoverElement();if(!s)return;const n=t.position??"above",{offsetWidth:a,offsetHeight:o}=s;let r=t.y-o-i,l=t.x-a/2;"below"===n?r=t.y+i:"right"===n?(r=t.y-o/2,l=t.x+e):"above-left"===n&&(l=t.x),this.updatePosition({x:l,y:r})}ignorePointerEvents(){const t=this.getPopoverElement();t&&(t.style.pointerEvents="none")}capturePointerEvents(){const t=this.getPopoverElement();t&&(t.style.pointerEvents="unset")}updatePosition(t){const e=this.getBounds(),i=this.ctx.domManager.getBoundingClientRect();t.x=Math.floor(C(0,t.x,i.width-e.width)),t.y=Math.floor(C(0,t.y,i.height-e.height)),super.updatePosition(t),this.onPopoverMoved()}},$C=class extends FC{constructor(t,e,i){super(t,e,"horizontal"),this.hasPrefix=!0,this.popover=new GC(t,i,this.onPopoverMoved.bind(this)),this.dragHandle=new HC(t.localeManager.t("toolbarAnnotationsDragHandle")),this.popover.setDragHandle(this.dragHandle)}destroy(){super.destroy(),this.popover.destroy()}show(t={}){this.popover.show([this.dragHandle.getElement(),this.getElement()],t)}hide(){this.popover.hide()}setAnchor(t){this.popover.setAnchor(t,this.horizontalSpacing,this.verticalSpacing)}hasBeenDragged(){return this.popover.hasBeenDragged()}ignorePointerEvents(){this.popover.ignorePointerEvents()}capturePointerEvents(){this.popover.capturePointerEvents()}onPopoverMoved(){const t=this.popover.getBounds();if(this.popoverBounds?.equals(t))return;this.popoverBounds=t.clone();const e=this.getButtonBounds();this.events.dispatch("toolbar-moved",{popoverBounds:t,buttonBounds:e})}getButtonWidgetBounds(t){const e=this.popover.getBounds(),i=super.getButtonWidgetBounds(t),s=this.dragHandle.getBounds();return new fs(i.x+e.x-s.width,i.y+e.y,i.width,i.height)}},HC=class extends Yr{constructor(t){super(j("div","ag-charts-floating-toolbar__drag-handle"));const e=new Yr(j("span",`${Wa("drag-handle")} ag-charts-toolbar__icon`));e.setAriaHidden(!0),this.addChild(e),this.elem.title=t}},UC={...rd,...ud};Gw.create.bind(Gw),Gw.__createSparkline.bind(Gw);export{Gw as AgCharts};