{% extends "base.html" %}

{% block title %}{{ budget.name }}{% endblock title %}

{% block backButton %}<sl-button href="/" class="me-5" variant="primary" outline><sl-icon slot="prefix" name="caret-left"></sl-icon>Back</sl-button>{% endblock backButton %}



{% block content %}
<script>
    const GET_PAGE_URL = "{{ url_for('home.get_page', budget_id=budget.id) }}";
    const SEARCH_PAGE_URL = "{{ url_for('home.search', b_id=budget.id) }}";
    const MOVE_TRANSACTION_URL = "{{ url_for('home.move_transaction', sb_id=budget.id, t_id=0) }}".slice(0, -1);
    const DELETE_TRANSACTION_URL = "{{ url_for('home.delete_transaction', b_id=budget.id, t_id=0) }}".slice(0, -1);
    const params = new URLSearchParams(window.location.search);
    const TOTAL_TRANSACTIONS = {{ total }};
    const CURRENT_PAGE = {{ page }};
    const NUM_PAGES = {{ num_pages }};
    const budgetsArray = {{ budgets|budgets_array|tojson }};
    const transactionsPy = {{ transactions|tojson }};
</script>
<script src="/static/js/searchItem.mjs" type="module"></script>

<sl-card class="mb-4">
    <div class="row" slot="header">
        <div class="fw-bold fs-1">
            {{ budget.name }}
        </div>
        <div class="fs-4 mb-0 subhead">
            Total: <span id="budgetTotal">{{ budget.total|prettify_money }}</span>
        </div>
    </div>

    <form id="addTransaction" method="POST" action="{{ url_for('home.add_transaction', budget_id=budget.id) }}">
        <div class="row">
            <div class="col-12 col-md-8 col-xl-6 mb-2">
                <sl-input type="text" id="name" name="name" placeholder="Spent too much?" autocomplete="niklas" required></sl-input>
            </div>
            <div class="col-6 col-md-4 col-xl-2 mb-2">
                <sl-input class="amount-input-86" type="number" step=".01" id="amount" name="amount" placeholder="0.00" autocomplete="niklas" required></sl-input>
            </div>
            <div class="col-6 col-md-4 col-xl-2 mb-2">
                <sl-input type="date" id="date" name="date" required></sl-input>
            </div>
            <div class="col-12 col-md-8 col-xl-2 mb-2">
                <sl-button class="w-100" variant="primary" id="transSubmit" type="submit" disabled>Add Transaction</sl-button>
            </div>
        </div>
    </form>
</sl-card>

<search-budget-card></search-budget-card>

<sl-card class="mb-4">
    <div id="transactionList" class="">
        <div id="emptyTransaction" class="" hidden="true">
            <div class="d-flex justify-content-center">
                <p class="fs-5">No transactions found</p>
            </div>
        </div>
    </div>
</sl-card>

<nav aria-label="...">
    <sl-button-group label="Pagination" class="pagination">
        <sl-button id="prev" variant="primary" outline label="Previous page"><sl-icon name="chevron-left"></sl-icon></sl-button>
        <sl-button id="next" variant="primary" outline label="Next page"><sl-icon name="chevron-right"></sl-icon></sl-button>
    </sl-button-group>
</nav>

<div id="moveModals"></div>
<div id="deleteModals"></div>


    <script src="/static/js/setdate.js"></script>
    <script src="/static/js/transaction.mjs" type="module"></script>
    <script src="/static/js/viewbudget.mjs" type="module"></script>
    <script src="/static/js/viewBudgetSearchCard.mjs" type="module"></script>

{% endblock content %}
